<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><head><script async src="https://www.googletagmanager.com/gtag/js?id=G-551JRG13S2"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-551JRG13S2")}</script></head><title>计算机网络--进化版 | Satti's Blog</title>
<meta name=keywords content="408"><meta name=description content="八股&ndash;计算机网络"><meta name=author content="Satti"><link rel=canonical href=https://Sattiluvcat.github.io/en/posts/notes/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C--%E8%BF%9B%E5%8C%96%E7%89%88/><link crossorigin=anonymous href=/assets/css/stylesheet.c5df81d78a700d63222bf88c998222af7e6085cc41585cba2eff58e49fd49e25.css integrity="sha256-xd+B14pwDWMiK/iMmYIir35ghcxBWFy6Lv9Y5J/UniU=" rel="preload stylesheet" as=style><link rel=icon type=image/png href=/favicon-48x48.png sizes=48x48><link rel=icon type=image/svg+xml href=/favicon.svg><link rel="shortcut icon" href=/favicon.ico><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><meta name=apple-mobile-web-app-title content="MyWebSite"><link rel=manifest href=/site.webmanifest><link rel=alternate hreflang=en href=https://Sattiluvcat.github.io/en/posts/notes/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C--%E8%BF%9B%E5%8C%96%E7%89%88/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:ital,wght@0,100..800;1,100..800&display=swap" rel=stylesheet><script type=text/javascript async src="https://cdn.bootcss.com/mathjax/2.7.3/MathJax.js?config=TeX-AMS-MML_HTMLorMML">MathJax.Hub.Config({tex2jax:{inlineMath:[["$","$"],["\\(","\\)"]],displayMath:[["$$","$$"],["[[","]]"]],processEscapes:!0,processEnvironments:!0,skipTags:["script","noscript","style","textarea","pre"],TeX:{equationNumbers:{autoNumber:"AMS"},extensions:["AMSmath.js","AMSsymbols.js"]}}}),MathJax.Hub.Queue(function(){var e,t=MathJax.Hub.getAllJax();for(e=0;e<t.length;e+=1)t[e].SourceElement().parentNode.className+=" has-jax"})</script><style>code.has-jax{font:inherit;font-size:100%;background:inherit;border:inherit;color:#515151}</style><script async src="https://www.googletagmanager.com/gtag/js?id=G-551JRG13S2"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-551JRG13S2")}</script><meta property="og:title" content="计算机网络--进化版"><meta property="og:description" content="八股&ndash;计算机网络"><meta property="og:type" content="article"><meta property="og:url" content="https://Sattiluvcat.github.io/en/posts/notes/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C--%E8%BF%9B%E5%8C%96%E7%89%88/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-03-31T15:37:06+08:00"><meta property="article:modified_time" content="2025-03-31T23:14:06+08:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="计算机网络--进化版"><meta name=twitter:description content="八股&ndash;计算机网络"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"文章","item":"https://Sattiluvcat.github.io/en/posts/"},{"@type":"ListItem","position":2,"name":"Notes📓","item":"https://Sattiluvcat.github.io/en/posts/notes/"},{"@type":"ListItem","position":3,"name":"计算机网络--进化版","item":"https://Sattiluvcat.github.io/en/posts/notes/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C--%E8%BF%9B%E5%8C%96%E7%89%88/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"计算机网络--进化版","name":"计算机网络--进化版","description":"八股\u0026ndash;计算机网络","keywords":[408],"articleBody":" 网络模型 OSI \u0026 TCP/IP 物理层–数据链路层–网络层–传输层–会话层–表示层–应用层 网络接口层–网络层（IP）–传输层（TCP、UDP）–应用层 应用层 基本概念 应用层协议举例 HTTP/HTTPS/CDN/DNS/FTP HTTP报文组成 请求报文：请求行（请求方法、请求目标URL/URI、HTTP协议版本）+ 请求头（附加信息，如User-Agent）+ 空行 + 请求体（可选，一般POST会用） 响应报文：状态行（协议版本、状态码、状态信息）+ 响应头 + 空行+ 响应体 常用状态码 1xx：提示信息，协议处理的中间态 2xx：成功 3xx：重定向（301永久重定向、302临时重定向–\u003e客户端请求资源发生了变动） 4xx：客户端错误（404：无法找到此页面；405：请求的方法类型不支持） 400：客户端请求错误 5xx：服务器错误（500：服务器内部出错） 502、503、504：错的网关、服务器无法获得、网关超时 502与504的区别 502 Bad Gateway：网关/代理服务器（如nginx）执行请求时，从上游收到无效响应（如后端执行报错） 504 Gateway Time-out：网关/代理服务器（如nginx）执行请求时，未能及时收到响应 HTTP \u0026 HTTPS HTTP请求的类型 GET：用于请求获取指定资源，通常用于获取数据 请求参数一般写在URL里，URL只能支持ASCII 按RFC规定的语义，遵守幂等性（无论调用多少次，都不会对产生改变） POST：用于向服务器提交数据，通常用于提交表单数据或进行资源的创建 PUT：用于向服务器更新指定资源，通常用于更新已存在的资源 DELETE：用于请求服务器删除指定资源 HEAD：类似于GET请求，但只返回资源的头部信息，用于获取资源的元数据而不获取实际内容 HTTP长连接是啥 建立TCP连接后，发送和接收多个 HTTP 请求/应答，避免连接建立与释放的开销 特点：任意一端未明确提出断开连接，则保持长连接（短连接是发送接收一次就释放） HTTP1.1怎么对请求拆包 请求头中包含\"Content-Length\"字段，表示正文的字节数–\u003e服务器读取相应数量的字节 HTTP断点重传是什么 客户端记录下当前的下载进度，需要续传时通知服务端本次需要下载的内容片段 断点续传中4个HTTP头不可少的，分别是Range头、Content-Range头、Accept-Ranges头、Content-Length头 Accept-Ranges：服务端发送，表示接受带Range的请求 Range：客户端发，需要续传的片段 Content-Range：服务端发送，传输的片段范围 Content-Length：服务端发送，传输片段的长度 HTTP为什么不安全 明文传输，有窃听、篡改、冒充风险 HTTP和HTTPS 的区别 HTTP 是超文本传输协议，信息是明文传输 –\u003e HTTPS在TCP和网络层间加入SSL/TLS安全协议 HTTP只需TCP三次握手即可传输报文 –\u003e HTTPSTCP握手后还需要SSL/TLS握手 HTTP 默认端口号是 80 –\u003e HTTPS 默认端口号是 443 HTTPS 协议需要向 CA（证书权威机构）申请数字证书，保证服务器身份可信 HTTPS握手过程 加密（用非对称加密方式协商出对称加密密钥）\u0026身份校验防范中间人 * 第一次握手：客户端向服务器发起加密通信请求（客户端支持的 TLS 协议版本、产生的随机数、支持的密码套件列表 * 密码套件列表=对称加密算法（发送与接收方持有相同公钥）+非对称加密算法（接收方持有私钥，发送方持有公钥，公钥加密只有私钥能解，反之亦然）+数据摘要算法（如MD5，类似哈希过程） * 第二次握手：服务器收到客户端请求后，向客户端发出响应（确认 TLS 协议版本、服务器生产的随机数、确认的密码套件列表、服务器的数字证书） * 随机数和预主密钥共同生成主密钥 * 第三次握手：客户端收到服务器的回应，首先通过浏览器或者操作系统中的 CA 公钥，确认服务器数字证书的有效性–\u003e客户端从数字证书中取出服务器的公钥，用其加密报文并发送：一个随机数（预主密钥）、加密通信算法改变通知、客户端握手结束通知（同时把之前所有内容的发生的数据做摘要，供服务端校验） * 第四次握手：服务器收到客户端的第三个随机数（pre-master key预主密钥）之后，通过协商的加密算法，（通过三个随机数）计算出本次通信的会话密钥，向客户端发送加密通信算法改变通知、服务器握手结束通知（同时把之前所有内容的发生的数据做摘要，供客户端校验） * 握手结束，进入加密通信，使用HTTP协议，但用会话密钥加密内容 Http1.1和2.0的区别 头部压缩：同时发出多个请求，他们的头是一样的或是相似的，协议会消除重复的部分——客户端和服务器同时维护一张头信息表，所有字段都会存入这个表，生成一个 索引号 二进制格式：头信息和数据体都是二进制，统称为帧 并发传输：引出 Stream 概念，多个 Stream 复用在一条 TCP 连接 HTTP2.0服务器可以主动向客户端发送资源 TCP连接后什么时候中断（HTTP） 服务端或者客户端执行 close 系统调用，会发送FIN报文，之后四次挥手 发送方发送了数据之后，接收方超过一段时间没有响应ACK报文，发送方重传数据达到最大次数 HTTP长时间没有进行请求和响应 DNS Domain Name System，默认端口53\nDNS解析的工作流程 客户端发出 DNS 请求，查找域名对应IP，并发给本地 DNS 服务器 本地域名服务器在缓存中找，找不到去问根域名服务器 根域名转发顶级域名（如.com）服务器地址给本地DNS 顶级域名转发权威域名（如server.com）服务器地址给本地DNS 权威DNS查询后将对应IP地址发给本地DNS 本地 DNS 将 IP 地址返回客户端 底层是TCP还是UDP UDP–\u003e低延迟（无连接）、简单快速（没有连接管理与流量控制机制，传输效率高）、轻量级（头部小，网络资源占用小） Cookie HTTP有无状态 无状态==\u003e每个请求都独立，服务器不会在多个请求之间保留关于客户端状态的信息 可以通过一些机制实现状态保持，如Cookie、Session Cookie、Session的区别 存储位置：Cookie的数据存储在客户端（通常是浏览器）；Session的数据存储在服务器端（服务器分配唯一ID，通过Cookie发给客户端，客户端之后请求带上此ID） 数据容量：单个Cookie的大小限制通常在4KB左右，大多浏览器限制每个域名的总Cookie数量；Session大小理论上不限制 安全性：Cookie相对不安全，因为数据存储在客户端，容易受到XSS（跨站脚本攻击）的威胁；Session一般更安全，但需要防范Session劫持和会话固定攻击 生命周期：Cookie可以设置过期时间，过期后自动删除，也可以设置为会话Cookie（浏览器关闭自动删除）；默认情况下，当用户关闭浏览器时，Session结束（也可服务端设置过期时间） token，session，cookie的区别 session存储于服务器，通常存放于cookie中。服务器收到cookie后解析出sessionId，依赖于cookie cookie类似令牌，装有sessionId，存储在客户端，浏览器通常会自动添加 token类似令牌，无状态，用户信息都被加密到token中，需要手动添加 客户端禁用cookie，session还能用么 不可。服务器将无法把会话 ID 发送给客户端，客户端也无法在后续请求中携带绘画ID返回给服务器 可以通过URL重写（URL上添加sessionID） 、隐藏表单字段（在每个需要Session信息的HTML表单中包含一个存储Session ID的隐藏字段） LocalStorage 存在浏览器端，不会自动发送给服务器 JWT令牌 JWT 令牌和传统方式有什么区别 无状态性：JWT是无状态的令牌，不需要在服务器端存储会话信息，但包括必要信息–\u003e适合分布式系统 安全性：JWT使用密钥对令牌进行签名，持有正确密钥的服务器才能对其验证解析 跨域支持：JWT令牌可以在不同域之间传递（请求头/参数中携带令牌，则无需cookie也可跨域身份验证） JWT令牌有哪些字段 头部（Header）、载荷（Payload）和签名（Signature） 头部和载荷均为JSON格式，使用Base64编码进行序列化，而签名部分是对头部、载荷和密钥进行签名后的结果 缺点 一旦派发出去，在失效之前都是有效的，无法及时撤销 可增加黑名单机制（Redis） 泄露了怎么解决 及时失效 刷新——设定有效期 黑名单 其它 HTTP长连接和WebSocket区别 TCP 协议本身是全双工，但 HTTP/1.1 是半双工 vs 全双工的 WebSocket 应用场景：HTTP/1.1 里，只要客户端不问，服务端就不答–\u003e简单场景（定时轮询/长轮询实现服务器推送效果） vs 客户端和服务端频繁交互场景用WebSocket Nginx哪些负载均衡算法 轮询（按顺序分配请求）、IP哈希（确定后端服务器）、URL哈希、最短响应时间（后端服务器响应时间）、加权轮询 传输层 握手 tcp头部 序列号：建立连接时用随机数作为初始值，（SYN包）发送一次累加一次数据长度–\u003e解决网络包乱序问题 确认应答号：下次期望收到的序列号 == 对方认为此序号前的数据都被正常接收–\u003e解决丢包问题 控制位：ACK–\u003e为1表示确认应答字段有效；RST–\u003e为1表示连接异常需断开；SYN–\u003e为1表示希望建立连接，并设定序列号初始值；FIN–\u003e为1表示再无数据发送，希望断开 TCP三次握手 before：服务端主动监听某个端口，处于 LISTEN 状态 第一次：客户端随机初始化序号（client_isn），SYN置为1，发送，进入syn_sent状态 第二次：服务端随机初始化序号（server_isn），SYN、ACK置为1，确认应答号 client_isn + 1，发送，进入syn_rcvd状态 第三次：客户端ACK置为1，确认应答号 server_isn + 1，发送，可带数据，进入established状态 三次握手的原因 阻止重复历史连接的初始化——建立了历史连接，会造成资源浪费 两次握手：客户端发送连接A，中断，发送连接B，A被接收服务端建立连接，服务端发送数据与握手，客户端判断其为历史连接，发送RST声明。==\u003e资源浪费 同步初始序列号——发送一个初始序列号，需要对方返回应答报文（确认对方接收到），两方则需三次 接收方可去除重复数据 \u0026 接收方可以根据数据包的序列号按序接收 \u0026 标识发送出去的数据包中，哪些已被对方收到 四次握手可以被优化为三次（对方的初始序列号与应答报文可以一次发送） 避免资源浪费——服务端会建立多个无效连接（客户端未收到ACK，发送了多个SYN报文） 客户端第三次发送的确认包丢失了会发生什么 ACK报文不会重传，若丢失则由对方重传对应报文 超时重传，两次序列号一致，每次超时时间是上次的2倍 SYN+ACK报文丢失怎么办 客户端重传，服务端也重传 收到重复的SYN报文，服务端怎么办 再次发送第二次握手报文 第一次握手，客户端发送SYN报后，服务端回复ACK报，服务端内部做了什么 服务端收到请求–\u003e内核将连接存储到半连接队列–\u003e服务端响应SYN+ACK–\u003e收到第三次握手的ACK–\u003e内核将连接从半连接队列移除，创建新的完全链接并添加至accept全连接队列，等待进程调用accept时取出连接 半连接队列、全连接队列，都有最大长度限制，超过限制时，内核会直接丢弃，或返回 RST 包 挥手 四次挥手过程 客户端主动调用关闭连接的函数，发送FIN报文（代表不再发送数据），进入 FIN_WAIT_1 状态 服务端回复ACK，进入 CLOSE_WAIT 状态 服务端收到FIN时，TCP协议栈在FIN中插入EOF文件结束符，EOF会被放到所有已收到的数据后 服务端read数据，读到EOF，发送需要发送数据（若无则不发送）后调用关闭连接的函数–\u003e发FIN包（表示不再发数据），服务端进入 LAST_ACK 状态 客户端接收 FIN 包，发送 ACK，客户端进入 TIME_WAIT 状态 服务端收到ACK，进入最后的CLOSE状态 客户端经过2MSL时间后进入CLOSE状态 第二次、第三次挥手可以合并吗 当被动关闭方「没有数据要发送」并且「开启了 TCP 延迟确认机制」，会合并传输 TCP 延迟确认：接收方在收到数据后，并不会立即回复ACK，而是延迟一定时间 第三次挥手一直没发，会怎么样 主动方发送通道已关闭。若用shutdown关闭连接，将一直处于FIN_WAIT2状态（可能还可以发送或接收数据）；若用close关闭（成为孤儿连接），状态不可持续，tcp_fin_timeout控制时长为60s shutdown可以选择是否关闭发送/接受能力 客户端FIN包丢失，状态何如 重传（2倍时间），若全无回应，不再发送报文，等待一段时间后（上次的2倍）直接进入close状态，服务端还是established状态 为什么还要等2msl MSL 是 Maximum Segment Lifetime，报文最大生存时间（在网络中） 网络中可能存在来自发送方的数据包，被处理后优惠向对方发送响应（一来一回）。eg.最后的ACK丢失，FIN会超时重传，再重发ACK，正好2MSL 服务端出现大量timewait的原因 没开长连接（一般web实现中都是由服务端断开连接，任意一方请求头有Connection:close都会关闭长连接） 长连接超时（可能网络问题，服务端发送的内容都丢失） 长连接请求数过多（如nginx管理，设置keepalive_requests） TCP与UDP 区别 不需要连接；面向连接 支持一对一、一对多、多对一、多对多；only一对一 尽最大努力交付，不保证可靠（但可以其为基础实现可靠传输协议QUIC）；可靠交付 无拥塞控制、流量控制；有 首部开销小（8个字节固定）；最少20个 一个包一个包发送，有边界但可能丢包乱序；流式传输，没有边界，但保证顺序和可靠 TCP为什么可靠 连接管理（三次\u0026四次） 序列号：对每个字节的数据都进行了编号 确认应答 超时重传：超时/确认包丢失都会触发 流量、拥塞控制：根据接收端的处理能力，决定发送端的发送速度 / 当网络拥堵严重时，发送端减少数据发送 TCP粘包怎么解决 问题：不知道用户消息的边界，二u发有效划分用户消息 解决： 固定长度的消息 特殊字符边界 自定义消息结构：可以自定义消息结构，由包头和数据组成，其中包头固定大小，有字段说明数据大小 TCP拥塞控制 拥塞窗口 cwnd是发送方维护的状态变量（等于发送窗口与接收窗口的最小值），根据网络拥塞程度（未及时回复ACK，发生超时重传即认为拥塞）动态变化 算法： 慢启动：发送方每收到一个 ACK，拥塞窗口 cwnd 的大小就会加 1，直到慢启动门限ssthresh（一个变量），大小超过门限采用拥塞避免算法（指数增长） 拥塞避免：每当收到一个 ACK 时，cwnd 增加 1/cwnd（线性增长） 拥塞发生：（触发重传后）（超时重传）ssthresh设为cwnd/2，cwnd重置为初始值 快速重传：接收方发现丢了中间包，发送三次前一个包的ACK，发送端可快速重传 快速恢复：（触发重传后）（快速重传）ssthresh = cwnd/2 ，cwnd = cwnd/2，进入快速恢复（cwnd = ssthresh + 3，收到了三个数据包–\u003e重传丢失包–\u003e收到重复ACK则cwnd加1；收到新ACK，cwnd 设置为 ssthresh的值，相当于进入拥塞避免状态 场景 打开网页的网络过程 解析URL：分析需要的传输协议和请求的资源路径（不合法将内容交给搜索引擎） 缓存判断：浏览器缓存 → 系统缓存（hosts 文件） → 路由器缓存 → ISP 的 DNS 缓存 DNS解析：像本地DNS服务器发送请求…直到获得IP地址 获取MAC地址：数据链路层需要。将IP地址与子网掩码结合判断是否与请求主机在同一子网，在同一子网可以用ARP协议获取到目标主机的MAC地址，不在同一子网则转发至网关由其转发（通过 ARP 协议来获取网关的 MAC 地址，此时目的主机的 MAC 地址应该为网关的地址） 建立TCP连接：路由器转发SYN包 HTTPS的TLS四次握手 发送HTTP请求 服务器处理请求并返回响应 网站无法显示怎么办 确定服务端还是客户端问题–\u003e客户端能否上网 抓包确认DNS是否解析出IP地址–\u003e确认是否建立三次握手–\u003e查看服务端响应码（若4xx则url有问题，5xx则服务器有问题，200则可能前端有问题） 客户端网络正常但访问慢，查看客户端网口流量，可能TCP丢包 服务端正常启动，客户端请求不到为什么，怎么排查 检查IP地址：ping 端口号检查：在本机Telnet接口的IP和端口号 检查服务器防火墙 检查是否有网络代理 若有响应但状态码错误，502、503、504可能因为并发压测产生 ping不通但http成功，why ping是icmp协议，http是tcp协议，可能服务器的防火墙禁止icmp协议 如何判断两个服务器正常连接 tcp保活机制，连续几次不响应则认为已死 网络攻击 ddos：分布式拒绝服务 sql注入：应用程序直接使用用户提供的输入作为SQL查询的一部分 输入验证与转义 参数化查询，如#{} 限制数据库权限 csrf攻击：跨站请求伪造 xss攻击：跨站脚本攻击 dns劫持：攻击者在用户查询DNS服务器时篡改响应，将请求域名映射到虚假IP地址 ","wordCount":"7056","inLanguage":"en","datePublished":"2025-03-31T15:37:06+08:00","dateModified":"2025-03-31T23:14:06+08:00","author":[{"@type":"Person","name":"Satti"}],"mainEntityOfPage":{"@type":"WebPage","@id":"https://Sattiluvcat.github.io/en/posts/notes/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C--%E8%BF%9B%E5%8C%96%E7%89%88/"},"publisher":{"@type":"Organization","name":"Satti's Blog","logo":{"@type":"ImageObject","url":"https://Sattiluvcat.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://Sattiluvcat.github.io/en/ accesskey=h title="Satti's Blog (Alt + H)"><img src=https://Sattiluvcat.github.io/img/label1.jpg alt aria-label=logo height=35>Satti's Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://Sattiluvcat.github.io/en/search/ title="🔍搜索 (Alt + /)" accesskey=/><span>🔍搜索</span></a></li><li><a href=https://Sattiluvcat.github.io/en/ title=🏠主页><span>🏠主页</span></a></li><li><a href=https://Sattiluvcat.github.io/en/tags title=📑标签><span>📑标签</span></a></li><li><a href=https://Sattiluvcat.github.io/en/lulu/ title=😽Lulu><span>😽Lulu</span></a></li><li><a href=https://Sattiluvcat.github.io/en/archives/ title=📅时间轴><span>📅时间轴</span></a></li><li><a href=https://Sattiluvcat.github.io/en/about/ title=😎关于><span>😎关于</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://Sattiluvcat.github.io/en/>Home</a>&nbsp;»&nbsp;<a href=https://Sattiluvcat.github.io/en/posts/>文章</a>&nbsp;»&nbsp;<a href=https://Sattiluvcat.github.io/en/posts/notes/>Notes📓</a></div><h1 class="post-title entry-hint-parent">计算机网络--进化版</h1><div class=post-meta><span title='2025-03-31 15:37:06 +0800 +0800'>2025-03-31</span>&nbsp;·&nbsp;15 min&nbsp;·&nbsp;<span title='Last updated 2025-03-31 23:14:06 +0800 +0800'>Last updated on 2025-03-31</span>&nbsp;·&nbsp;Satti</div></header><aside id=toc-container class="toc-container wide"><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#%e7%bd%91%e7%bb%9c%e6%a8%a1%e5%9e%8b aria-label=网络模型>网络模型</a></li><li><a href=#%e5%ba%94%e7%94%a8%e5%b1%82 aria-label=应用层>应用层</a><ul><li><a href=#%e5%9f%ba%e6%9c%ac%e6%a6%82%e5%bf%b5 aria-label=基本概念>基本概念</a></li><li><a href=#http--https aria-label="HTTP & HTTPS">HTTP & HTTPS</a></li><li><a href=#dns aria-label=DNS>DNS</a></li><li><a href=#cookie aria-label=Cookie>Cookie</a></li><li><a href=#jwt%e4%bb%a4%e7%89%8c aria-label=JWT令牌>JWT令牌</a></li><li><a href=#%e5%85%b6%e5%ae%83 aria-label=其它>其它</a></li></ul></li><li><a href=#%e4%bc%a0%e8%be%93%e5%b1%82 aria-label=传输层>传输层</a><ul><li><a href=#%e6%8f%a1%e6%89%8b aria-label=握手>握手</a></li><li><a href=#%e6%8c%a5%e6%89%8b aria-label=挥手>挥手</a></li><li><a href=#tcp%e4%b8%8eudp aria-label=TCP与UDP>TCP与UDP</a></li></ul></li><li><a href=#%e5%9c%ba%e6%99%af aria-label=场景>场景</a></li><li><a href=#%e7%bd%91%e7%bb%9c%e6%94%bb%e5%87%bb aria-label=网络攻击>网络攻击</a></li></ul></div></details></div></aside><script>let activeElement,elements;window.addEventListener("DOMContentLoaded",function(){checkTocPosition(),elements=document.querySelectorAll("h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]"),activeElement=elements[0];const t=encodeURI(activeElement.getAttribute("id")).toLowerCase();document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active")},!1),window.addEventListener("resize",function(){checkTocPosition()},!1),window.addEventListener("scroll",()=>{activeElement=Array.from(elements).find(e=>{if(getOffsetTop(e)-window.pageYOffset>0&&getOffsetTop(e)-window.pageYOffset<window.innerHeight/2)return e})||activeElement,elements.forEach(e=>{const t=encodeURI(e.getAttribute("id")).toLowerCase();e===activeElement?document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active"):document.querySelector(`.inner ul li a[href="#${t}"]`).classList.remove("active")})},!1);const main=parseInt(getComputedStyle(document.body).getPropertyValue("--article-width"),10),toc=parseInt(getComputedStyle(document.body).getPropertyValue("--toc-width"),10),gap=parseInt(getComputedStyle(document.body).getPropertyValue("--gap"),10);function checkTocPosition(){const e=document.body.scrollWidth;e-main-toc*2-gap*4>0?document.getElementById("toc-container").classList.add("wide"):document.getElementById("toc-container").classList.remove("wide")}function getOffsetTop(e){if(!e.getClientRects().length)return 0;let t=e.getBoundingClientRect(),n=e.ownerDocument.defaultView;return t.top+n.pageYOffset}</script><div class=post-content><p> </p><p> </p><h2 id=网络模型>网络模型<a hidden class=anchor aria-hidden=true href=#网络模型>#</a></h2><ol><li>OSI & TCP/IP<ul><li><strong>物</strong>理层&ndash;数据<strong>链</strong>路层&ndash;<strong>网</strong>络层&ndash;传<strong>输</strong>层&ndash;<strong>会</strong>话层&ndash;表<strong>示</strong>层&ndash;应<strong>用</strong>层</li><li>网络<strong>接</strong>口层&ndash;<strong>网</strong>络层（IP）&ndash;传<strong>输</strong>层（TCP、UDP）&ndash;应<strong>用</strong>层</li></ul></li></ol><h2 id=应用层>应用层<a hidden class=anchor aria-hidden=true href=#应用层>#</a></h2><h3 id=基本概念>基本概念<a hidden class=anchor aria-hidden=true href=#基本概念>#</a></h3><ol><li>应用层协议举例<ul><li>HTTP/HTTPS/CDN/DNS/FTP</li></ul></li><li>HTTP报文组成<ul><li>请求报文：请求行（请求方法、请求目标URL/URI、HTTP协议版本）+ 请求头（附加信息，如User-Agent）+ 空行 + 请求体（可选，一般POST会用）</li><li>响应报文：状态行（协议版本、<strong>状态码</strong>、状态信息）+ 响应头 + 空行+ 响应体</li></ul></li><li>常用状态码<ul><li>1xx：提示信息，协议处理的中间态</li><li>2xx：成功</li><li>3xx：重定向（301永久重定向、302临时重定向&ndash;>客户端请求资源发生了变动）</li><li>4xx：客户端错误（404：无法找到此页面；405：请求的方法类型不支持）<ul><li>400：客户端请求错误</li></ul></li><li>5xx：服务器错误（500：服务器内部出错）<ul><li>502、503、504：错的网关、服务器无法获得、网关超时</li></ul></li></ul></li><li>502与504的区别<ul><li>502 Bad Gateway：网关/代理服务器（如nginx）执行请求时，从上游收到无效响应（如后端执行报错）</li><li>504 Gateway Time-out：网关/代理服务器（如nginx）执行请求时，未能及时收到响应</li></ul></li></ol><h3 id=http--https>HTTP & HTTPS<a hidden class=anchor aria-hidden=true href=#http--https>#</a></h3><ol><li>HTTP请求的类型<ul><li>GET：用于请求获取指定资源，通常用于获取数据<ul><li>请求参数一般写在URL里，URL只能支持ASCII</li><li>按RFC规定的语义，遵守幂等性（无论调用多少次，都不会对产生改变）</li></ul></li><li>POST：用于向服务器提交数据，通常用于提交表单数据或进行资源的创建</li><li>PUT：用于向服务器更新指定资源，通常用于更新已存在的资源</li><li>DELETE：用于请求服务器删除指定资源</li><li>HEAD：类似于GET请求，但只返回资源的头部信息，用于获取资源的元数据而不获取实际内容</li></ul></li><li>HTTP长连接是啥<ul><li>建立TCP连接后，发送和接收多个 HTTP 请求/应答，避免连接建立与释放的开销</li><li>特点：任意一端未明确提出断开连接，则保持长连接（短连接是发送接收一次就释放）</li></ul></li><li>HTTP1.1怎么对请求拆包<ul><li>请求头中包含"Content-Length"字段，表示正文的字节数&ndash;>服务器读取相应数量的字节</li></ul></li><li>HTTP断点重传是什么<ul><li>客户端记录下当前的下载进度，需要续传时通知服务端本次需要下载的内容片段</li><li>断点续传中4个HTTP头不可少的，分别是Range头、Content-Range头、Accept-Ranges头、Content-Length头<ul><li>Accept-Ranges：服务端发送，表示接受带Range的请求</li><li>Range：客户端发，需要续传的片段</li><li>Content-Range：服务端发送，传输的片段范围</li><li>Content-Length：服务端发送，传输片段的长度</li></ul></li></ul></li><li>HTTP为什么不安全<ul><li>明文传输，有窃听、篡改、冒充风险</li></ul></li><li>HTTP和HTTPS 的区别<ul><li>HTTP 是超文本传输协议，信息是明文传输 &ndash;> HTTPS在TCP和网络层间加入<strong>SSL/TLS</strong>安全协议</li><li>HTTP只需TCP三次握手即可传输报文 &ndash;> HTTPSTCP握手后还需要SSL/TLS握手</li><li>HTTP 默认端口号是 80 &ndash;> HTTPS 默认端口号是 443</li><li>HTTPS 协议需要向 CA（证书权威机构）申请数字证书，保证服务器身份可信</li></ul></li><li>HTTPS握手过程</li></ol><blockquote><p>加密（用非对称加密方式协商出对称加密密钥）&身份校验防范中间人<br>* 第一次握手：客户端向服务器发起加密通信请求（客户端支持的 TLS 协议版本、产生的随机数、支持的密码套件列表
* 密码套件列表=对称加密算法（发送与接收方持有相同公钥）+非对称加密算法（接收方持有私钥，发送方持有公钥，公钥加密只有私钥能解，反之亦然）+数据摘要算法（如MD5，类似哈希过程）
* 第二次握手：服务器收到客户端请求后，向客户端发出响应（确认 TLS 协议版本、服务器生产的随机数、确认的密码套件列表、服务器的数字证书）
* 随机数和预主密钥共同生成主密钥
* 第三次握手：客户端收到服务器的回应，首先通过浏览器或者操作系统中的 <strong>CA 公钥</strong>，确认服务器数字证书的有效性&ndash;>客户端从数字证书中取出服务器的公钥，用其<strong>加密</strong>报文并发送：一个随机数（预主密钥）、加密通信算法改变通知、客户端握手结束通知（同时把之前所有内容的发生的数据做摘要，供服务端校验）
* 第四次握手：服务器收到客户端的第三个随机数（pre-master key预主密钥）之后，通过协商的加密算法，（通过三个随机数）计算出本次通信的会话密钥，向客户端发送加密通信算法改变通知、服务器握手结束通知（同时把之前所有内容的发生的数据做摘要，供客户端校验）
* 握手结束，进入加密通信，使用HTTP协议，但用会话密钥加密内容
<img loading=lazy src=image.png alt="alt text"></p></blockquote><ol start=8><li>Http1.1和2.0的区别<ul><li>头部压缩：同时发出多个请求，他们的头是一样的或是相似的，协议会消除重复的部分——客户端和服务器同时维护一张头信息表，所有字段都会存入这个表，生成一个 <em>索引号</em></li><li>二进制格式：头信息和数据体都是二进制，统称为帧</li><li>并发传输：引出 Stream 概念，多个 Stream 复用在一条 TCP 连接</li><li>HTTP2.0服务器可以主动向客户端发送资源</li></ul></li><li>TCP连接后什么时候中断（HTTP）<ul><li>服务端或者客户端执行 close 系统调用，会发送FIN报文，之后四次挥手</li><li>发送方发送了数据之后，接收方超过一段时间没有响应ACK报文，发送方重传数据达到最大次数</li><li>HTTP长时间没有进行请求和响应</li></ul></li></ol><h3 id=dns>DNS<a hidden class=anchor aria-hidden=true href=#dns>#</a></h3><blockquote><p>Domain Name System，默认端口53</p></blockquote><ol><li>DNS解析的工作流程<ul><li>客户端发出 DNS 请求，查找域名对应IP，并发给本地 DNS 服务器</li><li>本地域名服务器在缓存中找，找不到去问根域名服务器</li><li>根域名转发顶级域名（如<code>.com</code>）服务器地址给本地DNS</li><li>顶级域名转发权威域名（如<code>server.com</code>）服务器地址给本地DNS</li><li>权威DNS查询后将对应IP地址发给本地DNS</li><li>本地 DNS 将 IP 地址返回客户端</li></ul></li><li>底层是TCP还是UDP<ul><li>UDP&ndash;>低延迟（无连接）、简单快速（没有连接管理与流量控制机制，传输效率高）、轻量级（头部小，网络资源占用小）</li></ul></li></ol><h3 id=cookie>Cookie<a hidden class=anchor aria-hidden=true href=#cookie>#</a></h3><ol><li>HTTP有无状态<ul><li>无状态==>每个请求都独立，<strong>服务器</strong>不会在多个请求之间保留关于客户端状态的信息</li><li>可以通过一些机制实现状态保持，如Cookie、Session</li></ul></li><li>Cookie、Session的区别<ul><li>存储位置：Cookie的数据存储在客户端（通常是浏览器）；Session的数据存储在服务器端（服务器分配唯一ID，通过Cookie发给客户端，客户端之后请求带上此ID）</li><li>数据容量：单个Cookie的大小限制通常在4KB左右，大多浏览器限制每个域名的总Cookie数量；Session大小理论上不限制</li><li>安全性：Cookie相对不安全，因为数据存储在客户端，容易受到XSS（跨站脚本攻击）的威胁；Session一般更安全，但需要防范Session劫持和会话固定攻击</li><li>生命周期：Cookie可以设置过期时间，过期后自动删除，也可以设置为会话Cookie（浏览器关闭自动删除）；默认情况下，当用户关闭浏览器时，Session结束（也可服务端设置过期时间）</li></ul></li><li>token，session，cookie的区别<ul><li>session存储于服务器，通常存放于cookie中。服务器收到cookie后解析出sessionId，依赖于cookie</li><li>cookie类似令牌，装有sessionId，存储在客户端，浏览器通常会自动添加</li><li>token类似令牌，无状态，用户信息都被加密到token中，需要手动添加</li></ul></li><li>客户端禁用cookie，session还能用么<ul><li>不可。服务器将无法把会话 ID 发送给客户端，客户端也无法在后续请求中携带绘画ID返回给服务器</li><li>可以通过URL重写（URL上添加sessionID） 、隐藏表单字段（在每个需要Session信息的HTML表单中包含一个存储Session ID的隐藏字段）</li></ul></li><li>LocalStorage<ul><li>存在浏览器端，不会自动发送给服务器</li></ul></li></ol><h3 id=jwt令牌>JWT令牌<a hidden class=anchor aria-hidden=true href=#jwt令牌>#</a></h3><ol><li>JWT 令牌和传统方式有什么区别<ul><li>无状态性：JWT是无状态的令牌，不需要在服务器端存储会话信息，但包括必要信息&ndash;>适合分布式系统</li><li>安全性：JWT使用密钥对令牌进行签名，持有正确密钥的服务器才能对其验证解析</li><li>跨域支持：JWT令牌可以在不同域之间传递（请求头/参数中携带令牌，则无需cookie也可跨域身份验证）</li></ul></li><li>JWT令牌有哪些字段<ul><li>头部（Header）、载荷（Payload）和签名（Signature）</li><li>头部和载荷均为JSON格式，使用Base64编码进行序列化，而签名部分是对头部、载荷和密钥进行签名后的结果</li></ul></li><li>缺点<ul><li>一旦派发出去，在失效之前都是有效的，无法及时撤销</li><li>可增加黑名单机制（Redis）</li></ul></li><li>泄露了怎么解决<ul><li>及时失效</li><li>刷新——设定有效期</li><li>黑名单</li></ul></li></ol><h3 id=其它>其它<a hidden class=anchor aria-hidden=true href=#其它>#</a></h3><ol><li>HTTP长连接和WebSocket区别<ul><li>TCP 协议本身是全双工，但 HTTP/1.1 是半双工 vs 全双工的 WebSocket</li><li>应用场景：HTTP/1.1 里，只要客户端不问，服务端就不答&ndash;>简单场景（定时轮询/长轮询实现服务器推送效果） vs 客户端和服务端频繁交互场景用WebSocket</li></ul></li><li>Nginx哪些负载均衡算法<ul><li>轮询（按顺序分配请求）、IP哈希（确定后端服务器）、URL哈希、最短响应时间（后端服务器响应时间）、加权轮询</li></ul></li></ol><h2 id=传输层>传输层<a hidden class=anchor aria-hidden=true href=#传输层>#</a></h2><h3 id=握手>握手<a hidden class=anchor aria-hidden=true href=#握手>#</a></h3><ol><li>tcp头部<ul><li>序列号：建立连接时用随机数作为初始值，（SYN包）发送一次累加一次数据长度&ndash;>解决网络包乱序问题</li><li>确认应答号：下次期望收到的序列号 == 对方认为此序号前的数据都被正常接收&ndash;>解决丢包问题</li><li>控制位：ACK&ndash;>为1表示确认应答字段有效；RST&ndash;>为1表示连接异常需断开；SYN&ndash;>为1表示希望建立连接，并设定序列号初始值；FIN&ndash;>为1表示再无数据发送，希望断开
<img loading=lazy src=image-1.png alt="alt text"></li></ul></li><li>TCP三次握手<ul><li>before：服务端主动监听某个端口，处于 LISTEN 状态</li><li>第一次：客户端随机初始化序号（client_isn），SYN置为1，发送，进入<code>syn_sent</code>状态</li><li>第二次：服务端随机初始化序号（server_isn），SYN、ACK置为1，确认应答号 <strong>client_isn</strong> + 1，发送，进入<code>syn_rcvd</code>状态</li><li>第三次：客户端ACK置为1，确认应答号 <strong>server_isn</strong> + 1，发送，<strong>可带数据</strong>，进入<code>established</code>状态</li></ul></li><li>三次握手的原因<ul><li>阻止重复历史连接的初始化——建立了历史连接，会造成资源浪费<ul><li>两次握手：客户端发送连接A，中断，发送连接B，A被接收服务端建立连接，服务端发送数据与握手，客户端判断其为历史连接，发送RST声明。==>资源浪费</li></ul></li><li>同步初始序列号——发送一个初始序列号，需要对方返回应答报文（确认对方接收到），两方则需三次<ul><li>接收方可去除重复数据 & 接收方可以根据数据包的序列号按序接收 & 标识发送出去的数据包中，哪些已被对方收到</li><li>四次握手可以被优化为三次（对方的初始序列号与应答报文可以一次发送）</li></ul></li><li>避免资源浪费——服务端会建立多个无效连接（客户端未收到ACK，发送了多个SYN报文）</li></ul></li><li>客户端第三次发送的确认包丢失了会发生什么<ul><li><strong>ACK报文不会重传</strong>，若丢失则由对方重传对应报文</li><li><strong>超时重传，两次序列号一致</strong>，每次超时时间是上次的2倍</li></ul></li><li>SYN+ACK报文丢失怎么办<ul><li>客户端重传，服务端也重传</li></ul></li><li>收到重复的SYN报文，服务端怎么办<ul><li>再次发送第二次握手报文</li></ul></li><li>第一次握手，客户端发送SYN报后，服务端回复ACK报，服务端内部做了什么<ul><li>服务端收到请求&ndash;>内核将连接存储到<strong>半连接队列</strong>&ndash;>服务端响应SYN+ACK&ndash;>收到第三次握手的ACK&ndash;>内核将连接从半连接队列移除，创建新的完全链接并添加至accept<strong>全连接队列</strong>，等待进程调用accept时取出连接</li><li>半连接队列、全连接队列，都有最大长度限制，超过限制时，内核会直接丢弃，或返回 RST 包</li></ul></li></ol><h3 id=挥手>挥手<a hidden class=anchor aria-hidden=true href=#挥手>#</a></h3><ol><li>四次挥手过程<ul><li>客户端主动调用关闭连接的函数，发送FIN报文（代表不再发送数据），进入 <code>FIN_WAIT_1</code> 状态</li><li>服务端回复ACK，进入 <code>CLOSE_WAIT</code> 状态<ul><li>服务端收到FIN时，TCP协议栈在FIN中插入EOF文件结束符，EOF会被放到所有已收到的数据后</li></ul></li><li>服务端read数据，读到EOF，发送需要发送数据（若无则不发送）后调用关闭连接的函数&ndash;>发FIN包（表示不再发数据），服务端进入 <code>LAST_ACK</code> 状态</li><li>客户端接收 FIN 包，发送 ACK，客户端进入 <code>TIME_WAIT</code> 状态</li><li>服务端收到ACK，进入最后的CLOSE状态</li><li>客户端经过2MSL时间后进入CLOSE状态
<img loading=lazy src=image-2.png alt="alt text"></li></ul></li><li>第二次、第三次挥手可以合并吗<ul><li>当被动关闭方「没有数据要发送」并且「开启了 TCP 延迟确认机制」，会合并传输<ul><li>TCP 延迟确认：接收方在收到数据后，并不会立即回复ACK，而是延迟一定时间</li></ul></li></ul></li><li>第三次挥手一直没发，会怎么样<ul><li>主动方发送通道已关闭。若用shutdown关闭连接，将一直处于FIN_WAIT2状态（可能还可以发送或接收数据）；若用close关闭（成为孤儿连接），状态不可持续，tcp_fin_timeout控制时长为60s<ul><li>shutdown可以选择是否关闭发送/接受能力</li></ul></li></ul></li><li>客户端FIN包丢失，状态何如<ul><li>重传（2倍时间），若全无回应，不再发送报文，等待一段时间后（上次的2倍）直接进入close状态，服务端还是established状态</li></ul></li><li>为什么还要等2msl<ul><li>MSL 是 Maximum Segment Lifetime，报文最大生存时间（在网络中）</li><li>网络中可能存在来自发送方的数据包，被处理后优惠向对方发送响应（一来一回）。eg.最后的ACK丢失，FIN会超时重传，再重发ACK，正好2MSL</li></ul></li><li>服务端出现大量timewait的原因<ul><li>没开长连接（一般web实现中都是由服务端断开连接，任意一方请求头有<code>Connection:close</code>都会关闭长连接）</li><li>长连接超时（可能网络问题，服务端发送的内容都丢失）</li><li>长连接请求数过多（如nginx管理，设置<code>keepalive_requests</code>）</li></ul></li></ol><h3 id=tcp与udp>TCP与UDP<a hidden class=anchor aria-hidden=true href=#tcp与udp>#</a></h3><ol><li>区别<ul><li>不需要连接；面向连接</li><li>支持一对一、一对多、多对一、多对多；only一对一</li><li>尽最大努力交付，不保证可靠（但可以其为基础实现可靠传输协议<code>QUIC</code>）；可靠交付</li><li>无拥塞控制、流量控制；有</li><li>首部开销小（8个字节固定）；最少20个</li><li>一个包一个包发送，有边界但可能丢包乱序；流式传输，没有边界，但保证顺序和可靠</li></ul></li><li>TCP为什么可靠<ul><li>连接管理（三次&四次）</li><li>序列号：对每个字节的数据都进行了编号</li><li>确认应答</li><li>超时重传：超时/确认包丢失都会触发</li><li>流量、拥塞控制：根据接收端的处理能力，决定发送端的发送速度 / 当网络拥堵严重时，发送端减少数据发送</li></ul></li><li>TCP粘包怎么解决<ul><li>问题：不知道用户消息的边界，二u发有效划分用户消息</li><li>解决：<ul><li>固定长度的消息</li><li>特殊字符边界</li><li>自定义消息结构：可以自定义消息结构，由包头和数据组成，其中包头固定大小，有字段说明数据大小</li></ul></li></ul></li><li>TCP拥塞控制<ul><li>拥塞窗口 cwnd是发送方维护的状态变量（等于发送窗口与接收窗口的最小值），根据网络拥塞程度（未及时回复ACK，发生超时重传即认为拥塞）动态变化</li><li>算法：<ul><li>慢启动：发送方每收到一个 ACK，拥塞窗口 cwnd 的大小就会加 1，直到慢启动门限ssthresh（一个变量），大小超过门限采用拥塞避免算法（指数增长）</li><li>拥塞避免：每当收到一个 ACK 时，cwnd 增加 1/cwnd（线性增长）</li><li>拥塞发生：（触发重传后）（超时重传）ssthresh设为cwnd/2，cwnd重置为初始值<ul><li>快速重传：接收方发现丢了中间包，发送三次前一个包的ACK，发送端可快速重传</li></ul></li><li>快速恢复：（触发重传后）（快速重传）ssthresh = cwnd/2 ，cwnd = cwnd/2，进入快速恢复（cwnd = ssthresh + 3，收到了三个数据包&ndash;>重传丢失包&ndash;>收到重复ACK则cwnd加1；收到新ACK，cwnd 设置为 ssthresh的值，相当于进入拥塞避免状态</li></ul></li></ul></li></ol><h2 id=场景>场景<a hidden class=anchor aria-hidden=true href=#场景>#</a></h2><ol><li>打开网页的网络过程<ul><li>解析URL：分析需要的传输协议和请求的资源路径（不合法将内容交给搜索引擎）</li><li>缓存判断：浏览器缓存 → 系统缓存（hosts 文件） → 路由器缓存 → ISP 的 DNS 缓存</li><li>DNS解析：像本地DNS服务器发送请求…直到获得IP地址</li><li>获取MAC地址：数据链路层需要。将IP地址与子网掩码结合判断是否与请求主机在同一子网，在同一子网可以用ARP协议获取到目标主机的MAC地址，不在同一子网则转发至网关由其转发（通过 ARP 协议来获取网关的 MAC 地址，此时目的主机的 MAC 地址应该为网关的地址）</li><li>建立TCP连接：路由器转发SYN包</li><li>HTTPS的TLS四次握手</li><li>发送HTTP请求</li><li>服务器处理请求并返回响应</li></ul></li><li>网站无法显示怎么办<ul><li>确定服务端还是客户端问题&ndash;>客户端能否上网</li><li>抓包确认DNS是否解析出IP地址&ndash;>确认是否建立三次握手&ndash;>查看服务端响应码（若4xx则url有问题，5xx则服务器有问题，200则可能前端有问题）</li><li>客户端网络正常但访问慢，查看客户端网口流量，可能TCP丢包</li></ul></li><li>服务端正常启动，客户端请求不到为什么，怎么排查<ul><li>检查IP地址：ping</li><li>端口号检查：在本机Telnet接口的IP和端口号</li><li>检查服务器防火墙</li><li>检查是否有网络代理</li><li>若有响应但状态码错误，502、503、504可能因为并发压测产生</li></ul></li><li>ping不通但http成功，why<ul><li>ping是icmp协议，http是tcp协议，可能服务器的防火墙禁止icmp协议</li></ul></li><li>如何判断两个服务器正常连接<ul><li>tcp保活机制，连续几次不响应则认为已死</li></ul></li></ol><h2 id=网络攻击>网络攻击<a hidden class=anchor aria-hidden=true href=#网络攻击>#</a></h2><ol><li>ddos：分布式拒绝服务</li><li>sql注入：应用程序直接使用用户提供的输入作为SQL查询的一部分<ul><li>输入验证与转义</li><li>参数化查询，如<code>#{}</code></li><li>限制数据库权限</li></ul></li><li>csrf攻击：跨站请求伪造</li><li>xss攻击：跨站脚本攻击</li><li>dns劫持：攻击者在用户查询DNS服务器时篡改响应，将请求域名映射到虚假IP地址</li></ol><script type=module>  
    import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs'; 
    mermaid.initialize({ startOnLoad: true });  
</script><script>Array.from(document.getElementsByClassName("language-mermaid")).forEach(e=>{e.parentElement.outerHTML=`<div class="mermaid">${e.innerHTML}</div>`})</script><style>.mermaid svg{display:block;margin:auto}</style></div><footer class=post-footer><ul class=post-tags><li><a href=https://Sattiluvcat.github.io/en/tags/408/>408</a></li></ul><nav class=paginav><a class=prev href=https://Sattiluvcat.github.io/en/posts/hobbies/%E7%94%B5%E5%BD%B1top5/><span class=title>« Prev</span><br><span>个人电影Top5</span>
</a><a class=next href=https://Sattiluvcat.github.io/en/posts/notes/%E5%85%AB%E8%82%A1--%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/><span class=title>Next »</span><br><span>八股--数据结构</span></a></nav><ul class=share-buttons><li><a target=_blank rel="noopener noreferrer" aria-label="share 计算机网络--进化版 on x" href="https://x.com/intent/tweet/?text=%e8%ae%a1%e7%ae%97%e6%9c%ba%e7%bd%91%e7%bb%9c--%e8%bf%9b%e5%8c%96%e7%89%88&amp;url=https%3a%2f%2fSattiluvcat.github.io%2fen%2fposts%2fnotes%2f%25E8%25AE%25A1%25E7%25AE%2597%25E6%259C%25BA%25E7%25BD%2591%25E7%25BB%259C--%25E8%25BF%259B%25E5%258C%2596%25E7%2589%2588%2f&amp;hashtags=408"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446C483.971.0 512 28.03 512 62.554zM269.951 190.75 182.567 75.216H56L207.216 272.95 63.9 436.783h61.366L235.9 310.383l96.667 126.4H456L298.367 228.367l134-153.151H371.033zM127.633 110h36.468l219.38 290.065H349.5z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share 计算机网络--进化版 on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fSattiluvcat.github.io%2fen%2fposts%2fnotes%2f%25E8%25AE%25A1%25E7%25AE%2597%25E6%259C%25BA%25E7%25BD%2591%25E7%25BB%259C--%25E8%25BF%259B%25E5%258C%2596%25E7%2589%2588%2f&amp;title=%e8%ae%a1%e7%ae%97%e6%9c%ba%e7%bd%91%e7%bb%9c--%e8%bf%9b%e5%8c%96%e7%89%88&amp;summary=%e8%ae%a1%e7%ae%97%e6%9c%ba%e7%bd%91%e7%bb%9c--%e8%bf%9b%e5%8c%96%e7%89%88&amp;source=https%3a%2f%2fSattiluvcat.github.io%2fen%2fposts%2fnotes%2f%25E8%25AE%25A1%25E7%25AE%2597%25E6%259C%25BA%25E7%25BD%2591%25E7%25BB%259C--%25E8%25BF%259B%25E5%258C%2596%25E7%2589%2588%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share 计算机网络--进化版 on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fSattiluvcat.github.io%2fen%2fposts%2fnotes%2f%25E8%25AE%25A1%25E7%25AE%2597%25E6%259C%25BA%25E7%25BD%2591%25E7%25BB%259C--%25E8%25BF%259B%25E5%258C%2596%25E7%2589%2588%2f&title=%e8%ae%a1%e7%ae%97%e6%9c%ba%e7%bd%91%e7%bb%9c--%e8%bf%9b%e5%8c%96%e7%89%88"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share 计算机网络--进化版 on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fSattiluvcat.github.io%2fen%2fposts%2fnotes%2f%25E8%25AE%25A1%25E7%25AE%2597%25E6%259C%25BA%25E7%25BD%2591%25E7%25BB%259C--%25E8%25BF%259B%25E5%258C%2596%25E7%2589%2588%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share 计算机网络--进化版 on whatsapp" href="https://api.whatsapp.com/send?text=%e8%ae%a1%e7%ae%97%e6%9c%ba%e7%bd%91%e7%bb%9c--%e8%bf%9b%e5%8c%96%e7%89%88%20-%20https%3a%2f%2fSattiluvcat.github.io%2fen%2fposts%2fnotes%2f%25E8%25AE%25A1%25E7%25AE%2597%25E6%259C%25BA%25E7%25BD%2591%25E7%25BB%259C--%25E8%25BF%259B%25E5%258C%2596%25E7%2589%2588%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share 计算机网络--进化版 on telegram" href="https://telegram.me/share/url?text=%e8%ae%a1%e7%ae%97%e6%9c%ba%e7%bd%91%e7%bb%9c--%e8%bf%9b%e5%8c%96%e7%89%88&amp;url=https%3a%2f%2fSattiluvcat.github.io%2fen%2fposts%2fnotes%2f%25E8%25AE%25A1%25E7%25AE%2597%25E6%259C%25BA%25E7%25BD%2591%25E7%25BB%259C--%25E8%25BF%259B%25E5%258C%2596%25E7%2589%2588%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentcolor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share 计算机网络--进化版 on ycombinator" href="https://news.ycombinator.com/submitlink?t=%e8%ae%a1%e7%ae%97%e6%9c%ba%e7%bd%91%e7%bb%9c--%e8%bf%9b%e5%8c%96%e7%89%88&u=https%3a%2f%2fSattiluvcat.github.io%2fen%2fposts%2fnotes%2f%25E8%25AE%25A1%25E7%25AE%2597%25E6%259C%25BA%25E7%25BD%2591%25E7%25BB%259C--%25E8%25BF%259B%25E5%258C%2596%25E7%2589%2588%2f"><svg width="30" height="30" viewBox="0 0 512 512" fill="currentcolor" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"><path d="M449.446.0C483.971.0 512 28.03 512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446zM183.8767 87.9921h-62.034L230.6673 292.4508V424.0079h50.6655V292.4508L390.1575 87.9921H328.1233L256 238.2489z"/></svg></a></li></ul></footer><div id=disqus_thread></div><script>(function(){var e=document,t=e.createElement("script");t.src="https://www-sattiluvcat-github-io.disqus.com/embed.js",t.setAttribute("data-timestamp",+new Date),(e.head||e.body).appendChild(t)})()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><script id=dsq-count-scr src=//www-sattiluvcat-github-io.disqus.com/count.js async></script></article></main><footer class=footer><span>&copy; 2025 <a href=https://Sattiluvcat.github.io/en/>Satti's Blog</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-551JRG13S2"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-551JRG13S2")</script></body></html>