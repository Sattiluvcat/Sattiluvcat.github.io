[{"content":"Â å·´é»å¤œæ—…äºº æœ€å–œæ¬¢çš„è¿˜æ˜¯ç”˜æ–¯å¸ƒè¿ç€é£æŠ«ç€å¤œè‰²å›å®¶çš„ç‰‡æ®µ ç¦»å©šä¹‹åå¥¹éœ€è¦è‡ªå·±è°‹ç”Ÿï¼Œè¢«è¿«èµ°å‡ºä¾é™„åˆ«äººçš„å¢ƒåœ°ï¼Œä½†åˆæ€ä¹ˆä¸ç®—å¹¸äº‹ï¼Ÿ\nå¥¹åœ¨å¤œé—´ç”µå°åˆšåˆšæ‰¾åˆ°å·¥ä½œï¼Œäººç”Ÿæ˜æ˜è¿˜åœ¨è°·åº•ï¼Œä½†æ˜¯ä»è¿™ä¸ªç¬é—´å¼€å§‹ä¸€åˆ‡éƒ½å˜å¾—æœ‰å¸Œæœ› å‡Œæ™¨çš„é£å¹ä¹±äº†å¥¹çš„é£è¡£ï¼Œä½†ä¹Ÿä¸ä¼šå†æœ‰ä»€ä¹ˆå½±å“ æ•´éƒ¨ç”µå½±æœ‰ä¸€ç§å¤å¤åˆæŸ”å’Œçš„æ°›å›´ï¼Œç”˜æ–¯å¸ƒç‹¬ç«‹è‡ªä¸»è‡ªåŠ›æ›´ç”Ÿçš„partæ„Ÿè§‰æ ¼å¤–åŠ¨å®¹ï¼ˆå¤§æ¦‚å› ä¸ºå½“æ—¶å¯¹å…¶å®ƒçš„èƒŒæ™¯ä¹Ÿä¸æ˜¯å¾ˆç†Ÿæ‚‰â€¦ å…¶å®çœ‹è¿™éƒ¨çš„æ—¶å€™è¿˜æ²¡å¬è¯´è¿‡ã€Šåœ†æœˆæ˜ èŠ±éƒ½ã€‹ã€Šå¾·å·å·´é»ã€‹ä¸€ä¼—ç”µå½±ï¼Œåªæ˜¯å®Œå…¨è¢«è¿™ç§å¤å¤çš„æƒ…è°ƒå†²å‡»ï¼Œä¹‹åå¼€å§‹æ…¢æ…¢è¡¥ä¸Šå…¶å®ƒçš„ï¼Œä½†æ˜¯é‚£ç§å†²å‡»çš„æ„Ÿè§‰ä¹Ÿå¾ˆå°‘å‡ºç°äº†\næ˜¥å¤©ä¸æ˜¯è¯»ä¹¦å¤© å¾ˆå–œæ¬¢è¿™ç§è‡ªç”±åˆçƒ­çƒˆçš„é’æ˜¥æ„Ÿè§‰ï¼Œå¯èƒ½æ˜¯å› ä¸ºè‡ªå·±ä»æ²¡æœ‰è¿™ä¹ˆè‡ªç”±çƒ­çƒˆè¿‡â€¦å½“ç„¶ä¹Ÿåªæ˜¯è‡ªå·±çš„åŸå› \n\u0026ldquo;Life moves pretty fast.If you don\u0026rsquo;t stop and look around once in a while, you could miss it\u0026rdquo;\nLet\u0026rsquo;s look aroundâœ¨\nè½æ°´ç‹— å•çº¯æ˜¯å–œæ¬¢è¿™ç§ç—›å¿«ä»¥åŠå¾ˆæœ‰è¶£çš„äººå¿ƒå˜æ¢\næ˜†æ±€çš„ç”µå½±éƒ½æŒºå–œæ¬¢çš„ï¼Œå°±ç®—æ˜¯é¥±å—è¯Ÿç—…çš„ã€Šå­å¼¹åˆ—è½¦ã€‹å…¶å®ä¹Ÿèƒ½çœ‹ä¸‹å»ï¼Œçœ‹ç”µå½±ä¸å°±çœ‹ä¸€ä¸ªæ„Ÿè§‰ä¹ˆï¼Ÿ\nåˆå¤œç‹‚å¥” åˆæ˜¯ä¸­å›½äººæ°‘çš„è€æœ‹å‹ç½—ä¼¯ç‰¹Â·å¾·å°¼ç½—ï¼ å¾ˆæç¬‘çš„ä¸€éƒ¨ï¼ŒèŠ‚å¥éå¸¸å¥½çš„å…¬è·¯ç‰‡ å¾·å°¼ç½—æ”¾ä¼šè®¡èµ°çš„æ—¶å€™ï¼Œä¼šè®¡è„¸ä¸Šçš„ç°å’Œæ†¨åšçš„ç¬‘å®åœ¨ä»¤äººå¿ä¿Šä¸ç¦ï¼ˆä»€ä¹ˆ\nå†¬å¤©çš„æ•…äº‹ æ¥è‡ªåˆä¸€ä½æ¯”è¾ƒå–œæ¬¢çš„å¯¼æ¼”â€”â€”ä¾¯éº¦ï¼Œåº”è¯¥æ˜¯æ˜¥å¤ç§‹å†¬å››éƒ¨æ›²ï¼Œä½†å®åœ¨æ¬£èµä¸æ¥å…¶å®ƒçš„æŸäº›æƒ…èŠ‚\nå……æ–¥ç€æœ‰ç‚¹ç©ºæ´åˆéå¸¸å¯çˆ±çš„å¯¹ç™½ï¼ŒèŠ‚å¥æ…¢æ…¢çš„ï¼Œå¥³ä¸»è§’çœ‹èµ·æ¥å¾ˆæœ‰çµæ°” åœ¨å¾ˆå˜ˆæ‚çš„ç¯å¢ƒä¸‹çœ‹å®Œï¼Œæ„Ÿè§‰æ ¼å¤–æ¸…çˆ½ï¼Œä¾¯éº¦çš„ç”µå½±äºæˆ‘è€Œè¨€éƒ½æ˜¯è¿™æ ·ï¼Œè™½ç„¶æ•…äº‹èƒŒæ™¯éƒ½æ˜¯å„ç§å…³ç³»çº ç¼ ï¼Œä½†æ˜¯å¾ˆéš¾æ³¨æ„åˆ°è¿™ç§æƒ…æ„Ÿä¸Šçš„æ··ä¹±\n","permalink":"https://Sattiluvcat.github.io/en/posts/hobbies/%E7%94%B5%E5%BD%B1top5/","summary":"å–œæ¬¢ç”µå½±ğŸ“º","title":"ä¸ªäººç”µå½±Top5"},{"content":"Â å‡†ç¡®æ¥è¯´æ˜¯åŸºäºKafkaä¸Redisçš„ç”¨æˆ·æ¨èç”µå½±åŠŸèƒ½è®¾è®¡\nä¸»è¦è€ƒè™‘å¦‚ä¸‹ï¼š\nç”¨æˆ·æµè§ˆç”µå½±çš„è¡Œä¸ºï¼ˆç”Ÿäº§ï¼‰ä¼ è¾“åˆ°Kafkaä¸­ï¼Œéœ€è¦åœ¨ä¸»é¡µæ˜¾ç¤ºæ¨èç”µå½±æ—¶ä»Kafkaæ‹‰å–æ•°æ®åˆ°Redisï¼ˆæ¶ˆè´¹ï¼‰ï¼Œé€šè¿‡ç®€å•çš„æ¨èç®—æ³•å¾—åˆ°åˆé€‚çš„20éƒ¨ç”µå½±åä»ä¸­éšæœºé€‰å‡º5éƒ¨æ”¾åˆ°é¦–é¡µ \u0026amp;\u0026amp; Redisä¸­çš„æ•°æ®å®šæ—¶åˆ·åˆ°MySQLä¸­å®ç°æŒä¹…åŒ–\næœ¬é¡¹ç›®ä¸»è¦è€ƒè™‘åº”ç”¨Kafkaç­‰æŠ€æœ¯å®ç°ä¸€äº›å°åŠŸèƒ½ï¼Œå› æ­¤ä¸è€ƒè™‘åº”å¯¹é«˜å¹¶å‘ã€é«˜æµé‡åœºæ™¯ï¼Œæ•´ä¸ªè®¾è®¡ç›¸å¯¹æ¯”è¾ƒç²—ç³™ã€‚ä¸»è¦è¿˜æ˜¯ä¸ºäº†æå‡ç†Ÿç»ƒåº¦\nKafkaé…ç½® pomé…ç½® å¼•å…¥Kafkaä¾èµ–ï¼ˆé»˜è®¤æœ€æ–°ï¼‰\n\u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.springframework.kafka\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;spring-kafka\u0026lt;/artifactId\u0026gt; \u0026lt;/dependency\u0026gt; æ–°ç‰ˆKafkaå†…ç½®Zookeeperï¼Œä¸éœ€è¦é¢å¤–ä¸‹è½½\napplicationé…ç½® é…ç½®æ–‡ä»¶ï¼š\nspring: kafka: bootstrap-servers: localhost:9092 properties: security.protocol: PLAINTEXT producer: key-serializer: org.apache.kafka.common.serialization.StringSerializer value-serializer: org.springframework.kafka.support.serializer.JsonSerializer acks: all retries: 3 consumer: group-id: movie-recommendation-group key-deserializer: org.apache.kafka.common.serialization.StringDeserializer # æ³¨æ„ä¸è¦å¼•å…¥å¦ä¸€ä¸ªååºåˆ—åŒ– value-deserializer: org.springframework.kafka.support.serializer.JsonDeserializer properties: spring.json.trusted.packages: \u0026#34;com.satti.*\u0026#34; # åŒ…å auto.offset.reset: earliest Kafkaé…ç½®ç±» åœ¨configä¸­åˆ›å»ºKafkaä¿¡æ¯é…ç½®ç±»\n@Configuration public class KafkaConfig { @Value(\u0026#34;${spring.kafka.bootstrap-servers}\u0026#34;) // applicationä¸­é…ç½® private String bootstrapServers; @Bean public ProducerFactory\u0026lt;String, UserBehaviorEvent\u0026gt; producerFactory(){ Map\u0026lt;String,Object\u0026gt; configProps=new HashMap\u0026lt;\u0026gt;(); configProps.put(ProducerConfig.BOOTSTRAP_SERVERS_CONFIG,bootstrapServers); configProps.put(ProducerConfig.KEY_SERIALIZER_CLASS_CONFIG, StringSerializer.class); configProps.put(ProducerConfig.VALUE_SERIALIZER_CLASS_CONFIG, JsonSerializer.class); return new DefaultKafkaProducerFactory\u0026lt;\u0026gt;(configProps); } // åˆ›å»ºKafkaæ¨¡ç‰ˆBeanï¼Œä¹‹åå¯åœ¨å…¶å®ƒç±»ä¸­è‡ªåŠ¨æ³¨å…¥ @Bean public KafkaTemplate\u0026lt;String, UserBehaviorEvent\u0026gt; kafkaTemplate(){ return new KafkaTemplate\u0026lt;\u0026gt;(producerFactory()); } } Kafkaç”Ÿäº§è€… ç”¨æˆ·è¡Œä¸ºç±» åˆ›å»ºéœ€è¦å‘é€åˆ°Kafkaä¸­çš„ä¿¡æ¯çš„ç±»\n@Data @Builder @NoArgsConstructor @AllArgsConstructor public class UserBehaviorEvent { private String contact; private BehaviorType behavior; private Integer movieId; private Double rating; private Long timestamp; // åæœŸå¯è¯†åˆ«è¡Œä¸ºç±»å‹ public enum BehaviorType { VIEW, RATE, WATCH_TOGETHER } } ç”Ÿäº§è€…ç±» æ³¨å…¥Kafkaæ¨¡ç‰ˆç±»ï¼Œå°†ç”¨æˆ·è¡Œä¸ºå‘é€åˆ°Kafkaä¸­\n@Service public class KafkaProducerServiceImpl implements KafkaProducerService { // Kafkaä¸»é¢˜ï¼Œé¦–æ¬¡å‘é€è‡ªåŠ¨åˆ›å»º private static final String USER_BEHAVIOR_TOPIC=\u0026#34;user-behavior-events\u0026#34;; @Autowired private KafkaTemplate\u0026lt;String,UserBehaviorEvent\u0026gt; kafkaTemplate; public void sendUserBehavior(UserBehaviorEvent event){ kafkaTemplate.send(USER_BEHAVIOR_TOPIC, event); } } Kafkaæ¶ˆè´¹è€… ä¸»æ–¹æ³• æ·»åŠ Kafkaç›‘å¬ï¼Œæ¶ˆè´¹å·²æœ‰æ¶ˆæ¯\n// ç›‘å¬ç”Ÿäº§è€…åˆ›å»ºçš„ä¸»é¢˜ @KafkaListener(topics = USER_BEHAVIOR_TOPIC,groupId = \u0026#34;movie-recommendation-group\u0026#34;) @Override public void consumeUserBehavior(UserBehaviorEvent event){ // å°†ä¸åŒç±»å‹çš„è¡Œä¸ºå‚¨å­˜åˆ°Redisä¸­ updateUserBehavior(event); // ç”Ÿæˆç”¨æˆ·æ¨è generateRecommendations(event.getContact()); } ç”Ÿæˆæ¨è ä»Redisä¸­åˆ†ç±»è·å–å½“å‰ç”¨æˆ·çš„viewedã€watch_togetherã€ratingsä¿¡æ¯ï¼š\nSet\u0026lt;String\u0026gt; viewedMovies=redisTemplate.opsForZSet().range(\u0026#34;user_profile:\u0026#34;+contact+\u0026#34;:views\u0026#34;,0,-1); Set\u0026lt;String\u0026gt; watchedMovies=redisTemplate.opsForZSet().range(\u0026#34;user_profile:\u0026#34;+contact+\u0026#34;:watch_together\u0026#34;,0,-1); // key: movieId, value: rating Map\u0026lt;Object,Object\u0026gt; ratedMovies=redisTemplate.opsForHash().entries(\u0026#34;user_profile:\u0026#34;+contact+\u0026#34;:ratings\u0026#34;); é€šè¿‡æ¨èç®—æ³•è®¡ç®—ç¬¦åˆè¦æ±‚çš„ç”µå½±ï¼š\nprivate List\u0026lt;String\u0026gt; calculateRecommendations(Set\u0026lt;String\u0026gt; viewedMovies, Set\u0026lt;String\u0026gt; watchedMovies,Map\u0026lt;Object, Object\u0026gt; ratedMovies) { Map\u0026lt;String,Double\u0026gt; userTagPreferences=new HashMap\u0026lt;\u0026gt;(); // è®¾ç½®ä¸åŒè¡Œä¸ºå¯¹åº”çš„æƒé‡ setWeightBySet(viewedMovies, userTagPreferences, VIEW_WEIGHT); setWeightBySet(watchedMovies, userTagPreferences, WATCH_WEIGHT); for(Map.Entry\u0026lt;Object,Object\u0026gt; entry:ratedMovies.entrySet()){ String movieId=(String)entry.getKey(); double rating=Double.parseDouble((String)entry.getValue()); String tagsStr=redisTemplate.opsForValue().get(\u0026#34;movie:tags\u0026#34;+movieId); if(tagsStr!=null){ double ratingWeight = rating/5.0 * RATE_WEIGHT; for(String tag:tagsStr.split(\u0026#34;,\u0026#34;)){ userTagPreferences.merge(tag,ratingWeight,Double::sum); } } } Map\u0026lt;String,Double\u0026gt; candidateMovies=new HashMap\u0026lt;\u0026gt;(); // æ ¹æ®æƒé‡é€‰å‡ºç”¨æˆ·æœ€å–œæ¬¢çš„20ä¸ªæ ‡ç­¾ List\u0026lt;String\u0026gt; topTags=userTagPreferences.entrySet().stream() .sorted(Map.Entry.\u0026lt;String,Double\u0026gt;comparingByValue().reversed()) .limit(20) .map(Map.Entry::getKey) .toList(); if(!topTags.isEmpty()){ List\u0026lt;String\u0026gt; tagKeys = topTags.stream() .map(tag -\u0026gt; \u0026#34;tag:\u0026#34; + tag) .collect(Collectors.toList()); // é€šè¿‡æ ‡ç­¾æ‰¾åˆ°å€™é€‰ç”µå½± Set\u0026lt;String\u0026gt; tagBasedMovies; if(tagKeys.size() == 1) { // å•ä¸ªæ ‡ç­¾ç›´æ¥è·å– tagBasedMovies = redisTemplate.opsForSet().members(tagKeys.get(0)); } else { // å¤šä¸ªæ ‡ç­¾è·å–å¹¶é›† tagBasedMovies = redisTemplate.opsForSet().union( tagKeys.get(0), tagKeys.subList(1, tagKeys.size()) ); } // å¯¹å€™é€‰ç”µå½± log.info(\u0026#34;Tag-based movie recommendation\u0026#34;); for(String movieId:tagBasedMovies){ // ç»Ÿè®¡ç´¯ç§¯å–œå¥½æ ‡ç­¾çš„æ•°é‡ï¼Œå¯¹å€™é€‰ç”µå½±è¿›è¡Œæ’åºï¼ˆå¹¶é›†ä¸­å‡ºç°è¶Šå¤šçš„ç”µå½±è¯„åˆ†è¶Šé«˜ï¼‰ if(!viewedMovies.contains(movieId)){ candidateMovies.merge(movieId,1.0,Double::sum); } } } // å†·å¯åŠ¨æ—¶ä»¥å…¨å±€æœ€çƒ­é—¨çš„ç”µå½±ä¸ºåŸºç¡€æ¨è if(candidateMovies.isEmpty()){ Set\u0026lt;String\u0026gt; popularMovies=redisTemplate.opsForZSet().reverseRange(\u0026#34;global:popular\u0026#34;,0,10); for(String movieId:popularMovies){ if(!viewedMovies.contains(movieId)){ candidateMovies.putIfAbsent(movieId,0.3); } } } return candidateMovies.entrySet().stream() .sorted(Map.Entry.\u0026lt;String,Double\u0026gt;comparingByValue().reversed()) .limit(20) // mapï¼šå°†æµä¸­çš„æ‰€æœ‰å…ƒç´ è½¬æ¢æˆå¦ä¸€å½¢å¼ï¼Œæ­¤å¤„è½¬æ¢æˆå…¶å¯¹åº”çš„value .map(Map.Entry::getKey) .collect(Collectors.toList()); } éšæœºé€‰æ‹©5éƒ¨ç”µå½±ä½œä¸ºå½“å‰ç”¨æˆ·çš„æ¨èç”µå½±å­˜å…¥Redisï¼š\nRandom random=new Random(); Collections.shuffle(recommendations,random); recommendations=recommendations.subList(0,5); redisTemplate.opsForValue().set(\u0026#34;recommendations:\u0026#34;+contact,String.join(\u0026#34;,\u0026#34;,recommendations)); ä¸»å®ç°æ–¹æ³•ç›´æ¥ä»Redisä¸­è·å–æ¨èç”µå½±ï¼š\nif (userInfo != null) { // ä»Redisè·å–æ¨èç»“æœ String recs = redisTemplate.opsForValue().get(\u0026#34;recommendations:\u0026#34; + userInfo.getContact()); if (recs != null \u0026amp;\u0026amp; !recs.isEmpty()) { String[] movieIds = recs.split(\u0026#34;,\u0026#34;); Integer[] ids= Arrays.stream(movieIds) .map(Integer::parseInt) .toArray(Integer[]::new); return getMovieSmallRows(new ArrayList\u0026lt;\u0026gt;(), Arrays.asList(ids)); } } // å¦‚æœæ²¡æœ‰ä¸ªæ€§åŒ–æ¨èï¼Œè¿”å›éšæœºæ¨è return getRandomRecommendations(); RedisæŒä¹…åŒ– è®¾ç½®æ¯15ç§’åˆ·æ–°åˆ°MySQL \u0026amp;\u0026amp; å…³é—­ç¨‹åºæ—¶å¼ºåˆ¶åˆ·æ–°\nè®¾ç½® åˆ·æ–°æ—¶æœºè®¾ç½®\n@PostConstruct public void init(){ scheduler.scheduleAtFixedRate(this::flushBufferToMySQL,5,15, java.util.concurrent.TimeUnit.SECONDS); } @PreDestroy public void onShutdown() { flushBufferToMySQL(); // å…³é—­æ—¶å¼ºåˆ¶åˆ·æ–° scheduler.shutdown(); } åˆ·æ–°æ–¹æ³•å®ç° ä¸ç”¨mybatisï¼Œé€šè¿‡JdbcTemplateå®ç°æ‰¹é‡åˆ·æ–°\nprivate void flushBufferToMySQL() { if (buffer.isEmpty()) return; List\u0026lt;UserBehaviorEvent\u0026gt; copy; synchronized (buffer) { System.out.println(\u0026#34;Flushing buffer to MySQL, size: \u0026#34; + buffer); copy = new ArrayList\u0026lt;\u0026gt;(buffer); buffer.clear(); } // å»é‡é€»è¾‘ï¼šæ ¹æ® contact, movieId, behavior ä»¥åŠæ—¶é—´æˆ³ï¼ˆç”±äºç¨‹åºå…¶ä»–éƒ¨åˆ†è®¾ç½®ï¼Œè®°å½•çš„äº‹ä»¶æœ‰é‡å¤ï¼Œæ­¤å¤„åšç»†å¾®è°ƒæ•´ï¼‰ Map\u0026lt;String, UserBehaviorEvent\u0026gt; latestEvents = copy.stream() .collect(Collectors.toMap( event -\u0026gt; event.getContact() + \u0026#34;|\u0026#34; + event.getMovieId() + \u0026#34;|\u0026#34; + event.getBehavior(), event -\u0026gt; event, (existing, replacement) -\u0026gt;existing.getTimestamp() \u0026gt; replacement.getTimestamp() ? existing : replacement )); List\u0026lt;UserBehaviorEvent\u0026gt; distinctEvents = new ArrayList\u0026lt;\u0026gt;(latestEvents.values()); String sql = \u0026#34;\u0026#34;\u0026#34; INSERT INTO user_behavior (contact, movie_id, behavior_type, timestamp) VALUES (?,?,?,?) ON DUPLICATE KEY UPDATE timestamp = VALUES(timestamp) \u0026#34;\u0026#34;\u0026#34;; jdbcTemplate.batchUpdate(sql, distinctEvents, distinctEvents.size(), (ps, event) -\u0026gt; { ps.setString(1, event.getContact()); ps.setInt(2, event.getMovieId()); ps.setString(3, event.getBehavior().name()); ps.setLong(4, event.getTimestamp()); }); log.info(\u0026#34;å†™å…¥/æ›´æ–° {} æ¡è¡Œä¸ºæ•°æ®åˆ°MySQL (å»é‡å: {})\u0026#34;, copy.size(), distinctEvents.size()); } é‡å¯åˆ·å› ç¨‹åºé‡å¯æ—¶ï¼Œå°†MySQLä¸­ç”¨æˆ·è¡Œä¸ºåˆ·å›åˆ°Redisä¸­ï¼Œä»¥æ¨èç”µå½±ï¼š\nprivate void preload(){ // æ¸…ç©ºRedisä¸­æ•°æ®ï¼Œä»¥ä¾¿é‡æ–°åŠ è½½ Set\u0026lt;String\u0026gt; keys = redisTemplate.keys(\u0026#34;user_profile:*\u0026#34;); if (keys != null) redisTemplate.delete(keys); String sql = \u0026#34;\u0026#34;\u0026#34; SELECT contact, movie_id, behavior_type, timestamp FROM ( SELECT *, ROW_NUMBER() OVER ( PARTITION BY contact ORDER BY timestamp DESC ) AS rn FROM user_behavior ) t WHERE rn \u0026lt;= 50 \u0026#34;\u0026#34;\u0026#34;; jdbcTemplate.query(sql, rs -\u0026gt; { String contact = rs.getString(\u0026#34;contact\u0026#34;); String movieId = rs.getString(\u0026#34;movie_id\u0026#34;); String behavior = rs.getString(\u0026#34;behavior_type\u0026#34;); long timestamp = rs.getLong(\u0026#34;timestamp\u0026#34;); // é‡å»ºRedisæ•°æ®ç»“æ„ String userKey = \u0026#34;user_profile:\u0026#34; + contact; if (\u0026#34;VIEW\u0026#34;.equals(behavior)) { redisTemplate.opsForZSet().add(userKey + \u0026#34;:views\u0026#34;, movieId, timestamp); } else if (\u0026#34;WATCH_TOGETHER\u0026#34;.equals(behavior)) { redisTemplate.opsForZSet().add(userKey + \u0026#34;:watch_together\u0026#34;, movieId, timestamp); } }); log.info(\u0026#34;ä»MySQLåŠ è½½ç”¨æˆ·è¡Œä¸ºæ•°æ®åˆ°Rediså®Œæˆ\u0026#34;); } ","permalink":"https://Sattiluvcat.github.io/en/posts/java/kafka%E5%BA%94%E7%94%A8/","summary":"Kafkaä¸Redisåœ¨MovieNightä¸­çš„å°å·§æ€","title":"Kafkaåº”ç”¨ä¹‹MovieNight"},{"content":"Â èåˆESçš„Movie Nightå°å·§æ€\nä¸»è¦è€ƒè™‘é€šè¿‡ESåšç”µå½±æ‹‰å–æ•°æ®çš„ç¼“å­˜ï¼Œé¿å…æ¯æ¬¡æ‰“å¼€ç”µå½±è¯¦æƒ…éƒ½è¦å‘è±†ç“£å‘ä¿¡æ¯ \u0026amp;\u0026amp; ä»¥ESè¿›è¡Œæ¨¡ç³Šæœç´¢ï¼ˆä¸»è¦æ˜¯ç®€ä»‹å†…å®¹ï¼‰\nä»¥ä¸‹ä¸»è¦å¯¹ESçš„é…ç½®å’Œåº”ç”¨åšä¸€ç‚¹ä»‹ç»ï¼ˆå®é™…é…ç½®æ—¶æ²¡ä»€ä¹ˆé—®é¢˜ï¼Œä¸»è¦æ˜¯åšè®°å½•ï¼‰\nå¼•å…¥ä¾èµ– ç»å…¸æ­¥éª¤ä¹‹åœ¨pom.xmlä¸­å¼•å…¥ESä¾èµ–ï¼š\n\u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.springframework.boot\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;spring-boot-starter-data-elasticsearch\u0026lt;/artifactId\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.springframework.data\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;spring-data-elasticsearch\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;5.4.0\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; æ³¨ï¼šESä¾èµ–é¡¹çš„ç‰ˆæœ¬ä¼šå½±å“æ„å»ºæŸ¥è¯¢çš„æ–¹æ³•åã€æ–¹æ³•ç”¨æ³•ç­‰ï¼Œå› æ­¤åœ¨æŠ„åˆ«äººçš„æŸ¥è¯¢æ–¹æ³•æ—¶éœ€è¦æ£€æŸ¥ç‰ˆæœ¬å¯¹åº”å…³ç³»\nåˆ›å»ºç¼“å­˜ç±» å°†éœ€è¦æŸ¥è¯¢çš„æ•°æ®ä¸ç´¢å¼•å­˜å…¥ESä¸­\nç¼“å­˜ç±»æ„å»ºå¦‚ä¸‹ï¼š\n@Data @Document(indexName = \u0026#34;movie_metadata\u0026#34;) // ESä¸­çš„ç´¢å¼•åç§° public class MovieMetaDoc { @Id private String id; @Field(type = FieldType.Integer) private Integer movieId; // éœ€è¦å¼•å…¥åˆ†è¯å™¨æŸ¥è¯¢çš„å­—æ®µ @Field(type = FieldType.Text, analyzer = \u0026#34;ik_max_word\u0026#34;, searchAnalyzer = \u0026#34;ik_max_word\u0026#34;) private String summary; @Field(type = FieldType.Keyword) private String officialRating; @Field(type = FieldType.Keyword) private String coverUrl; } ç¼“å­˜æ“ä½œæœåŠ¡ç±» å®šä¹‰å¯¹ç¼“å­˜çš„åŸºæœ¬æ“ä½œï¼ˆå­˜å‚¨ã€æŸ¥è¯¢ç­‰ï¼‰\n@Service public class CacheServiceImpl implements CacheService { private static final String INDEX_NAME = \u0026#34;movie_metadata\u0026#34;; // å¼•å…¥ESæ“ä½œç±»å®ä¾‹ private final ElasticsearchOperations esOperations; public CacheServiceImpl(ElasticsearchOperations esOperations) { this.esOperations = esOperations; } // ç¼“å­˜å­˜å…¥ES public void cacheMovieMeta(Integer movieId, String summary, String officialRating, String coverUrl){ MovieMetaDoc doc = new MovieMetaDoc(); doc.setMovieId(movieId); doc.setSummary(summary); doc.setCoverUrl(coverUrl); doc.setOfficialRating(officialRating); // æ ¹æ®å®ä¾‹æ„å»ºESå­˜å‚¨è¯­å¥ IndexQuery query=new IndexQueryBuilder() .withId(movieId.toString()) .withObject(doc) .build(); // å­˜å…¥ç´¢å¼• esOperations.index(query, IndexCoordinates.of(INDEX_NAME)); } // è·å–ç¼“å­˜ä¿¡æ¯ public MovieMetaDoc getCachedMovieMeta(Integer movieId){ return esOperations.get( movieId.toString(), MovieMetaDoc.class, IndexCoordinates.of(INDEX_NAME) ); } } ESæŸ¥è¯¢æ“ä½œæ–¹æ³• @Override public List\u0026lt;MovieBigRow\u0026gt; searchDescriptions(String keyword) { // æ ¹æ®å…³é”®è¯åœ¨ESä¸­æ¨¡ç³ŠæŸ¥è¯¢--\u0026gt;æ„å»ºæŸ¥è¯¢è¯­å¥ org.springframework.data.elasticsearch.core.query.Query query= NativeQuery.builder() .withQuery(q-\u0026gt;q .match(m-\u0026gt;m .field(\u0026#34;summary\u0026#34;) .query(keyword) .fuzziness(\u0026#34;AUTO\u0026#34;) ) ) .withPageable(PageRequest.of(0,100)) .build(); SearchHits\u0026lt;MovieMetaDoc\u0026gt; hits; try{ // ESå®æ–½æŸ¥è¯¢ï¼ˆéœ€è¦å¼•å…¥ESæ“ä½œç±»å®ä¾‹ï¼‰ hits=esOperations.search( query, MovieMetaDoc.class, IndexCoordinates.of(\u0026#34;movie_metadata\u0026#34;) ); }catch (Exception e){ log.error(\u0026#34;ElasticsearchæŸ¥è¯¢å¤±è´¥: {}\u0026#34;, e.getMessage()); return Collections.emptyList(); } return hits.stream().map(hit-\u0026gt;{ Integer movieId=Integer.parseInt(hit.getId()); MovieMetaDoc movieMetaDoc=hit.getContent(); //è®¾ç½®å…¶å®ƒå±æ€§å¹¶è¿”å› return new MovieBigRow(movieBigRow); }).collect(Collectors.toList()); } ","permalink":"https://Sattiluvcat.github.io/en/posts/java/elasticsearch%E8%BF%90%E7%94%A8/","summary":"å®šæ—¶æ‹‰å–ç”µå½±ç®€ä»‹ç¼“å­˜è‡³ESï¼Œä¹Ÿå¯é€šè¿‡ESè¿›è¡Œé•¿æ–‡æœ¬æœç´¢","title":"ElasticSearchè¿ç”¨ä¹‹Movie Night"},{"content":"Â åœ¨Movie Nighté¡¹ç›®ä¸­è‹¦äºæ²¡æœ‰è®°å½•ç”¨æˆ·ä¿¡æ¯ä¸æƒé™ï¼Œè€ƒè™‘åˆ°æŸå¤–å–é¡¹ç›®ä¸­ä¹Ÿç¼ºå¤±äº†ä¸€äº›Spring Securityçš„æŠ€æœ¯æ ˆï¼Œç‰¹æ„åœ¨åŸç”Ÿé¡¹ç›®ä¸­æ·»åŠ \nå…¶é—´æœ‰äº›æ›´æ–°çš„é…ç½®ï¼Œä¸ç½‘ä¸Šèµ„æºä¸å°½ç›¸åŒï¼Œç‰¹æ­¤è®°å½•\npom.xmlä¾èµ–å¼•å…¥ ä¸ºäº†åœ¨é¡¹ç›®ä¸­é€šè¿‡Spring Securityè¿™ä¸€å¼ºå¤§å·¥å…·è¿›è¡Œã€Œç®€å•ã€çš„å®‰å…¨è®¿é—®è®¾ç½®ï¼Œéœ€è¦å¼•å…¥ï¼š\n\u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.springframework.boot\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;spring-boot-starter-security\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;3.2.10\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; æ³¨ï¼šæœ¬é¡¹ç›®è®¾ç½®jdk17\nå®‰å…¨ç±»é…ç½® configåŒ…ä¸­æ·»åŠ å®‰å…¨ç±»ã€‚æœ¬é¡¹ç›®åªè¿›è¡Œäº†æœ€åŸºæœ¬çš„é…ç½®\nSpring SecurityåŠŸèƒ½é…ç½® å»ºç«‹SecurityConfigç±»ï¼Œåˆ›å»ºå„ç±»ç›¸å…³ Beanï¼ŒåæœŸç”±SpringBootå®ç°ä¾èµ–æ³¨å…¥ï¼š\nå®‰å…¨è¿‡æ»¤é“¾Bean\nSpring Security 6.1+ç‰ˆæœ¬åªèƒ½é€šè¿‡Lambdaè¡¨è¾¾å¼è¿›è¡Œé…ç½®\npublic SecurityFilterChain securityFilterChain(HttpSecurity http) throws Exception { // ä»¥ä¸‹é‡‡ç”¨spring security 6.1+ çš„é…ç½®æ–¹å¼ http // è·¨åŸŸè®¿é—®è®¾ç½®ï¼ˆå…è®¸ï¼‰ .cors(cors -\u0026gt; cors.configurationSource(corsConfigurationSource())) // ç¦ç”¨CSRFä¿æŠ¤ .csrf(AbstractHttpConfigurer::disable) .authorizeHttpRequests(auth-\u0026gt; auth // ä¸éœ€è¦æ‹¦æˆªçš„æ¥å£ .requestMatchers(\u0026#34;/user/movie/register\u0026#34;).permitAll() .requestMatchers(\u0026#34;/user/movie/login\u0026#34;).permitAll() .requestMatchers(\u0026#34;user/movie/hello\u0026#34;).permitAll() .anyRequest().authenticated() // å…¶ä»–è¯·æ±‚éœ€è¦è®¤è¯ ) // å¼‚å¸¸å¤„ç† .exceptionHandling(exception -\u0026gt; exception .accessDeniedHandler(accessDeniedHandler())) // é¡¹ç›®é‡‡ç”¨sessionè®°å½•ç”¨æˆ·ä¿¡æ¯ï¼Œæ•…é…ç½®æ­¤é¡¹ .sessionManagement(sessionManagementCustomizer -\u0026gt; sessionManagementCustomizer .sessionCreationPolicy(SessionCreationPolicy.IF_REQUIRED)) .logout(logout -\u0026gt; logout .logoutUrl(\u0026#34;/user/movie/logout\u0026#34;) // è®¾ç½®ç™»å‡ºURL .logoutSuccessUrl(\u0026#34;/user/movie/login\u0026#34;) // ç™»å‡ºæˆåŠŸåè·³è½¬çš„URLï¼ˆæœ¬é¡¹ç›®æ­¤éƒ¨åˆ†å®é™…ç”±å‰ç«¯æ§åˆ¶ï¼‰ .invalidateHttpSession(true) // ä½¿ä¼šè¯å¤±æ•ˆ ) // è®¤è¯é“¾ï¼Œå¯è®¾ç½®jwtè®¤è¯ï¼Œæ­¤å¤„ä»…é‡‡ç”¨ç”¨æˆ·åå¯†ç è®¤è¯ .addFilterBefore(sessionAuthFilter(), UsernamePasswordAuthenticationFilter.class) // ç¦ç”¨è¡¨å•ç™»å½• .formLogin(AbstractHttpConfigurer::disable); return http.build(); } è®¤è¯é“¾å…·ä½“ä¿¡æ¯å¯å‚è§ï¼šSpringSecurityä¸­å¯¹è¿‡æ»¤å™¨çš„é…ç½®ï¼šaddFilterBefore\nsession è¿‡æ»¤ Beanï¼š public SessionAuthFilter sessionAuthFilter() { return new SessionAuthFilter(); } è·¨åŸŸè®¿é—® Beanï¼š public CorsConfigurationSource corsConfigurationSource() { CorsConfiguration configuration = new CorsConfiguration(); // å‰ç«¯è®¿é—®åœ°å€ï¼ˆå…è®¸è®¿é—®ï¼‰ configuration.setAllowedOrigins(List.of(\u0026#34;http://localhost:8889\u0026#34;)); configuration.setAllowedMethods(Arrays.asList(\u0026#34;GET\u0026#34;, \u0026#34;POST\u0026#34;, \u0026#34;PUT\u0026#34;, \u0026#34;DELETE\u0026#34;, \u0026#34;OPTIONS\u0026#34;)); configuration.setAllowedHeaders(List.of(\u0026#34;*\u0026#34;)); configuration.setAllowCredentials(true); configuration.setMaxAge(3600L); UrlBasedCorsConfigurationSource source = new UrlBasedCorsConfigurationSource(); source.registerCorsConfiguration(\u0026#34;/**\u0026#34;, configuration); return source; } æ‹’ç»è®¿é—®å¤„ç† Beanï¼š public AccessDeniedHandler accessDeniedHandler() { return (request, response, accessDeniedException) -\u0026gt; { // è¿”å› JSON æ ¼å¼çš„é”™è¯¯å“åº” response.setContentType(\u0026#34;application/json;charset=UTF-8\u0026#34;); response.setStatus(HttpStatus.FORBIDDEN.value()); response.getWriter().write(\u0026#34;{\\\u0026#34;code\\\u0026#34;:403,\\\u0026#34;msg\\\u0026#34;:\\\u0026#34;æ— æƒé™è®¿é—®ï¼Œè¯·å…ˆç™»å½•\\\u0026#34;}\u0026#34;); }; } é…åˆå‰ç«¯è®¾ç½®403çŠ¶æ€ä¸‹çš„å¼¹çª—ä¿¡æ¯ã€é‡å®šå‘é¡µé¢ç­‰\nSessionè®¤è¯ç±» é…åˆSpring Securityåˆ›å»ºçš„ç±»\npublic class SessionAuthFilter extends OncePerRequestFilter { @Override protected void doFilterInternal(HttpServletRequest request, HttpServletResponse response, FilterChain filterChain) throws ServletException, IOException { HttpSession session = request.getSession(false); if(session!=null){ // ç”¨æˆ·ä¿¡æ¯å®ä½“ç±» UserInfo userInfo= (UserInfo) session.getAttribute(\u0026#34;userInfo\u0026#34;); if(userInfo!=null){ // æ„å»ºè®¤è¯å¯¹è±¡ UsernamePasswordAuthenticationToken auth= new UsernamePasswordAuthenticationToken( userInfo, null, // é»˜è®¤è®¾ç½® Collections.singleton(new SimpleGrantedAuthority(\u0026#34;ROLE_USER\u0026#34;)) ); SecurityContextHolder.getContext().setAuthentication(auth); } } filterChain.doFilter(request, response); } } å‰ç«¯æ‹¦æˆªé…ç½® ç¬”è€…ä¸ä¼šå‰ç«¯ï¼Œä»¥ä¸‹å†…å®¹éƒ½æ˜¯éµå¾ªdè€å¸ˆçš„æŒ‡å¯¼å®Œæˆï¼Œå¯èƒ½æœ‰é‡å¤é…ç½®ï¼Œä½†åŸºæœ¬åŠŸèƒ½å¯ä»¥å®ç°\næ³¨ï¼šé€‚ç”¨Vueé¡¹ç›®\næ€»ä½“æ„å»º åœ¨App.Vueä¸­ï¼Œè¿›è¡Œæ€»ä½“è®¾ç½®ï¼š\n\u0026lt;script\u0026gt; export default { mounted() { // ç›‘å¬æœªå¤„ç†çš„ Promise é”™è¯¯ window.addEventListener(\u0026#39;unhandledrejection\u0026#39;, event =\u0026gt; { if (event.reason.response \u0026amp;\u0026amp; event.reason.response.status === 403) { this.$router.push({ name: \u0026#39;Login\u0026#39; }); event.preventDefault(); // é˜»æ­¢é»˜è®¤è¡Œä¸º } }); } } \u0026lt;/script\u0026gt; å“åº”æ‹¦æˆªå™¨è®¾ç½® åœ¨api.jsä¸­ï¼Œåˆ›å»ºaxioså®ä¾‹ï¼š\nconst apiClient = axios.create({ baseURL: API_URL, withCredentials: true }); æ·»åŠ å“åº”æ‹¦æˆªå™¨ï¼š\nå¤„ç†é”™è¯¯çŠ¶æ€ç ï¼Œå¯å¼¹å‡ºé”™è¯¯ä¿¡æ¯ã€é‡å®šå‘é¡µé¢ç­‰\napiClient.interceptors.response.use( response =\u0026gt; { // æ­£å¸¸å“åº”ç›´æ¥è¿”å› return response; }, error =\u0026gt; { if (error.response) { switch (error.response.status) { case 403: // è·³è½¬åˆ°ç™»å½•é¡µé¢ alert(\u0026#39;æ²¡æœ‰æƒé™è®¿é—®è¯¥èµ„æºï¼Œè¯·ç™»å½•åé‡è¯•å™¢\u0026#39;); router.push({ name: \u0026#39;Login\u0026#39; }); break; case 401: // æ˜¾ç¤ºæœªæˆæƒæç¤º alert(\u0026#39;ç™»å½•å·²è¿‡æœŸï¼Œè¯·é‡æ–°ç™»å½•\u0026#39;); router.push({ name: \u0026#39;Login\u0026#39; }); break; default: console.error(\u0026#39;è¯·æ±‚é”™è¯¯:\u0026#39;, error); } } return Promise.reject(error); } ); å°†æ‰€æœ‰å‡½æ•°çš„è¿”å›å¯¹è±¡æ”¹ä¸ºå“åº”æ‹¦æˆªå™¨å¯¹è±¡ï¼Œä¾‹ï¼š\nexport const login = (contact, password) =\u0026gt; { // ä»¥ apiClient æ›¿ä»£åŸæœ‰çš„ api return apiClient.post(`${API_URL}/login`, { contact, password }); } è·¯ç”±è®¤è¯ åœ¨index.jsä¸­è®¾ç½®éœ€è®¤è¯çš„è·¯ç”±ï¼š\nrouter.beforeEach((to, from, next) =\u0026gt; { // æ£€æŸ¥éœ€è¦è®¤è¯çš„è·¯ç”± const protectedRoutes = [ \u0026#39;/movie-detail\u0026#39;, \u0026#39;/watch-together\u0026#39; // ä»¥ä¸‹çœç•¥ ]; // æ£€æŸ¥ç”¨æˆ·ç™»å½•ä¿¡æ¯ï¼ˆä» localStorage åˆ¤æ–­ï¼‰ const isAuthenticated = localStorage.getItem(\u0026#39;userInfo\u0026#39;) !== null; if (protectedRoutes.includes(to.path) \u0026amp;\u0026amp; !isAuthenticated) { // ä¿å­˜ç›®æ ‡è·¯ç”±ï¼Œç™»å½•åé‡å®šå‘ next({ name: \u0026#39;Login\u0026#39;, query: { redirect: to.fullPath } }); } else { next(); } }); ","permalink":"https://Sattiluvcat.github.io/en/posts/java/spring_security%E9%85%8D%E7%BD%AE/","summary":"Spring Security 6.1+ç‰ˆæœ¬åœ¨SpringBootä¸­çš„åŸºæœ¬é…ç½®","title":"Spring Securityé…ç½®ä¹‹Movie Night"},{"content":"Â åŸºæœ¬ Java8æ–°ç‰¹æ€§ï¼Œä½œä¸ºFutureçš„å¢å¼ºç‰ˆæœ¬ï¼Œæä¾›çµæ´»çš„å¼‚æ­¥ç¼–ç¨‹èƒ½åŠ›\næ ¸å¿ƒä»»åŠ¡ï¼šçº¿ç¨‹æ± å¼‚æ­¥æ‰§è¡Œä»»åŠ¡ \u0026ndash;\u0026gt; æ¯ä¸ªæ“ä½œç”Ÿæˆæ–°CFå¯¹è±¡ï¼Œå…±åŒç»„æˆä»»åŠ¡é“¾\nå…·ä½“æ“ä½œï¼šåº”ç”¨å›è°ƒå‡½æ•°BiConsumerï¼ˆandThen()æ–¹æ³•ï¼‰/Functionæ”¯æŒæ‰§è¡Œåç»­ä»»åŠ¡ \u0026amp; é€šè¿‡volatileå˜é‡ä¸CASè¿›è¡ŒçŠ¶æ€ç»´æŠ¤\nåº”ç”¨ åˆ›å»º åœ¨æŒ‡å®šçº¿ç¨‹æ± ä¸­åˆ›å»ºï¼š\nExecutorService executor = Executors.newFixedThreadPool(2); CompletableFuture.supplyAsync(() -\u0026gt; \u0026#34;Task\u0026#34;, executor); è‹¥ä¸æŒ‡å®šçº¿ç¨‹æ± ï¼Œä¼šåœ¨å…¶é»˜è®¤çº¿ç¨‹æ± ForkJoinPool.commonPool()ä¸­æ‰§è¡Œï¼Œä¸æ¨è\né“¾å¼å¤„ç† å¯¹ç»“æœçš„ä¸‰ç§å¤„ç†æ–¹å¼ï¼š\næ¶ˆè´¹ï¼šthenAccept()\nCompletableFuture.supplyAsync(() -\u0026gt; \u0026#34;Hello\u0026#34;).thenAccept(s -\u0026gt; System.out.println(s)); // è¾“å‡º \u0026#34;Hello\u0026#34; è½¬æ¢ï¼šthenApply()\nCompletableFuture\u0026lt;String\u0026gt; future = CompletableFuture.supplyAsync(() -\u0026gt; \u0026#34;Hello\u0026#34;).thenApply(s -\u0026gt; s + \u0026#34; World\u0026#34;); // è¾“å‡º \u0026#34;Hello World\u0026#34; ç»„åˆï¼šthenCompose()\nthenCompose()æ˜¯å°†ä»»åŠ¡Açš„æ‰§è¡Œç»“æœä½œä¸ºä»»åŠ¡Bçš„è¾“å…¥\nCompletableFuture\u0026lt;String\u0026gt; future = CompletableFuture.supplyAsync(() -\u0026gt; \u0026#34;Hello\u0026#34;).thenCompose(s -\u0026gt; CompletableFuture.supplyAsync(() -\u0026gt; s + \u0026#34; World\u0026#34;)); ç»„åˆå¤„ç† ä»»åŠ¡é—´ä¸ç›¸äº’ä¾èµ–\nåˆå¹¶ç»“æœï¼šthenCombine()\nthenCombine()æ˜¯ç­‰å¾…ä»»åŠ¡Aã€ä»»åŠ¡Bçš„ç»“æœå¹¶å…±åŒå¤„ç†\nCompletableFuture\u0026lt;String\u0026gt; cf1 = CompletableFuture.supplyAsync(() -\u0026gt; \u0026#34;Hello\u0026#34;); CompletableFuture\u0026lt;String\u0026gt; cf2 = CompletableFuture.supplyAsync(() -\u0026gt; \u0026#34;World\u0026#34;); cf1.thenCombine(cf2, (s1, s2) -\u0026gt; s1 + \u0026#34; \u0026#34; + s2); // \u0026#34;Hello World\u0026#34; ç­‰å¾…æ‰€æœ‰ä»»åŠ¡å®Œæˆï¼šallOf()\nCompletableFuture\u0026lt;Void\u0026gt; all = CompletableFuture.allOf(cf1, cf2); all.thenRun(() -\u0026gt; System.out.println(\u0026#34;All tasks done\u0026#34;)); ç­‰å¾…ä»»ä¸€ä»»åŠ¡å®Œæˆï¼šanyOf()\nCompletableFuture\u0026lt;Object\u0026gt; any = CompletableFuture.anyOf(cf1, cf2); any.thenAccept(result -\u0026gt; System.out.println(\u0026#34;First result: \u0026#34; + result)); å¼‚å¸¸å¤„ç† æ•è·å¼‚å¸¸å¹¶å¤„ç† CompletableFuture.supplyAsync(() -\u0026gt; { if (error) throw new RuntimeException(\u0026#34;Error\u0026#34;); return \u0026#34;OK\u0026#34;; }).exceptionally(ex -\u0026gt; \u0026#34;Fallback\u0026#34;); // è¿”å›é»˜è®¤å€¼ å¯ä»¥ç”¨completableFuture.get()æˆ–completableFuture.join()é˜»å¡å½“å‰çº¿ç¨‹ï¼ˆç­‰å¾…ï¼‰è·å–å¼‚æ­¥ä»»åŠ¡ç»“æœï¼ŒäºŒè€…åŒºåˆ«å¦‚ä¸‹ï¼š get()ï¼šæŠ›å‡ºå—æ£€å¼‚å¸¸ï¼ˆExecutionExceptionï¼Œéœ€æ˜¾å¼æ•è·ï¼Œå¦‚try-catchï¼‰ \u0026amp; ï¼ˆå¦‚è°ƒç”¨Thread.interrupt()æ—¶ï¼‰çº¿ç¨‹ä¸­æ–­ä¼šæŠ›å‡ºInterruptedException join()ï¼šæŠ›å‡ºéå—æ£€å¼‚å¸¸ï¼ˆCompletionExceptionå®Œæˆå¼‚å¸¸ï¼Œä»»åŠ¡è¿è¡Œæ—¶å‡ºç°çš„å¼‚å¸¸è¢«åŒ…è£…ä¸ºè¯¥ç±»ï¼‰ï¼Œé€‚ç”¨é“¾å¼è°ƒç”¨ \u0026amp; ä¸ä¼šå“åº”çº¿ç¨‹ä¸­æ–­ï¼ˆå½“å‰çº¿ç¨‹è¢«è®¾ç½®ä¸ºinterruptedçŠ¶æ€ä¹Ÿä¸ä¼šåœæ­¢é˜»å¡ï¼Œç›´åˆ°å¼‚æ­¥ä»»åŠ¡å®Œæˆï¼‰ è¶…æ—¶å¤„ç† Java 9åæ·»åŠ  ä½¿ç”¨orTimeoutä¸completeOnTimeoutè®¾å®šè¶…æ—¶æ—¶é—´å¹¶å¤„ç†\nCompletableFuture.supplyAsync(() -\u0026gt; \u0026#34;Task\u0026#34;) .orTimeout(1, TimeUnit.SECONDS) // è¶…æ—¶æŠ›å‡º TimeoutException .completeOnTimeout(\u0026#34;Default\u0026#34;, 1, TimeUnit.SECONDS); // è¶…æ—¶è¿”å›é»˜è®¤å€¼ å®ä¾‹ ä¸»é¡µä¸Šæ˜¾ç¤ºç”¨æˆ·æ•°æ®ä¸å•†å“æ’è¡Œæ¦œ\ncontrollerå±‚è®¾ç½® @RestController @RequestMapping(\u0026#34;/user\u0026#34;) public class HomeController { @Autowired private HomeService homeService; @GetMapping(\u0026#34;/main\u0026#34;) public CompletableFuture\u0026lt;ResponseEntity\u0026lt;HomeData\u0026gt;\u0026gt; getHomePage() { return homeService.loadHomeDataAsync() .thenApply(ResponseEntity::ok) // æˆåŠŸæ—¶è¿”å› 200 OK + HomeData .exceptionally(ex -\u0026gt; { return ResponseEntity.status(HttpStatus.INTERNAL_SERVER_ERROR).build(); }); } } ç”±Springç­‰å¾…CompletableFutureæ‰§è¡Œå®Œæˆå¹¶å¤„ç†ï¼Œè¿”å›åˆ°å‰ç«¯çš„å°±æ˜¯ResponseEntity\u0026lt;HomeData\u0026gt;å¯¹è±¡\ndataè®¾ç½® HomeDataåªè®¾ç½®ä¸¤ä¸ªä¿¡æ¯ï¼šç”¨æˆ·æ•°æ®ä¸æ’è¡Œæ¦œï¼Œå¯æŒ‰éœ€è®¾ç½®å…¶å®ƒæ•°æ®\n@Data // Lombok æ³¨è§£ï¼Œè‡ªåŠ¨ç”Ÿæˆ getter/setter public class HomeData { private Integer userCount; private List\u0026lt;ProductRanking\u0026gt; productRankings; // å…¶ä»–å­—æ®µâ€¦â€¦ } serviceå±‚å®ç° @Service public class HomeServiceImpl implements HomeService { @Autowired private UserMapper userMapper; // ç”¨æˆ·æ•°æ®åº“è®¿é—® @Autowired private ProductMapper productMapper; // å•†å“æ•°æ®åº“ @Override public CompletableFuture\u0026lt;HomeData\u0026gt; loadHomeDataAsync() { // è‡ªå®šä¹‰çº¿ç¨‹æ± --\u0026gt;å¯è®¾ç½®ä¸ºBeanç›´æ¥æ³¨å…¥ Executor asyncExecutor = Executors.newFixedThreadPool(4); // å¹¶è¡Œæ‰§è¡Œä¸¤ä¸ªå¼‚æ­¥ä»»åŠ¡ CompletableFuture\u0026lt;Integer\u0026gt; userCountFuture = CompletableFuture.supplyAsync( () -\u0026gt; userMapper.getUserCount(), // è·å–ç”¨æˆ·æ•°æ® asyncExecutor ); CompletableFuture\u0026lt;List\u0026lt;ProductRanking\u0026gt;\u0026gt; productRankingFuture = CompletableFuture.supplyAsync( () -\u0026gt; productMapper.getProductRankings(), // è·å–æ’è¡Œæ¦œ asyncExecutor ); // åˆå¹¶ç»“æœï¼Œè‹¥æœ‰å¤šä¸ªç»“æœéœ€è¦åˆå¹¶ï¼Œå¯ä»¥ä½¿ç”¨ allOf() return userCountFuture.thenCombine(productRankingFuture, (userCount, rankings) -\u0026gt; { HomeData homeData = new HomeData(); homeData.setUserCount(userCount); homeData.setProductRankings(rankings); return homeData; }).exceptionally(ex -\u0026gt; { // å¼‚å¸¸å¤„ç† log.error(\u0026#34;åŠ è½½é¦–é¡µæ•°æ®å¤±è´¥\u0026#34;, ex); return new HomeData(); // è¿”å›ç©ºå¯¹è±¡æˆ–é»˜è®¤å€¼ }); } } ","permalink":"https://Sattiluvcat.github.io/en/posts/java/completablefuture%E5%BA%94%E7%94%A8/","summary":"CompletableFutureç±»çš„ä½¿ç”¨æ–¹æ³•","title":"CompletableFutureåº”ç”¨"},{"content":"Â æ›´æ–°åˆ°hugo v0.146åŠä¹‹åï¼Œè¿è¡Œhugo -Dæˆ–hugo serveræ—¶æˆ–æœ¬åœ°ç”¨hugoä½ç‰ˆæœ¬ç¼–è¯‘ï¼ŒåŒæ­¥åˆ°Github Pagesæ—¶å¯èƒ½å‡ºç°æŠ¥é”™ï¼š\nERROR render of \u0026#34;/404\u0026#34; failed: \u0026#34;D:\\hugo\\layouts\\_default\\baseof.html:9:8\u0026#34;: execute of template failed: template: 404.html:9:8: executing \u0026#34;404.html\u0026#34; at \u0026lt;partial \u0026#34;head.html\u0026#34; .\u0026gt;: error calling partial: \u0026#34;D:\\hugo\\layouts\\partials\\head.html:13:15\u0026#34;: execute of template failed: template: _partials/templates/opengraph.html:13:15: executing \u0026#34;partials/templates/opengraph.html\u0026#34; at \u0026lt;partial \u0026#34;partials/templates/_funcs/get-page-images\u0026#34; .\u0026gt;: error calling partial: partial \u0026#34;partials/templates/_funcs/get-page-images\u0026#34; not found ç­‰ä¸€ç³»åˆ—æŠ¥é”™ä¿¡æ¯ï¼Œæ€ä¹ˆè§£å†³ï¼Ÿ\næ ¹æ®hugoå¼€å‘è€…åœ¨ç›¸å…³issueä¸­å›ç­”çš„å†…å®¹ï¼š\nç›´æ¥å°†æ‰€æœ‰æ¶‰åŠpartialçš„è°ƒç”¨è¿›è¡Œå¦‚ä¸‹æ”¹é€ ï¼š\ndiff --git a/layouts/partials/head.html b/layouts/partials/head.html index 25718d7..41515b5 100644 --- a/layouts/partials/head.html +++ b/layouts/partials/head.html @@ -8,7 +8,7 @@ {{- end }} \u0026lt;head\u0026gt; - {{ template \u0026#34;_internal/google_analytics.html\u0026#34; . }} + {{ partial \u0026#34;google_analytics.html\u0026#34; . }} \u0026lt;/head\u0026gt; @@ -154,8 +154,8 @@ {{- /* Misc */}} {{- if hugo.IsProduction | or (eq site.Params.env \u0026#34;production\u0026#34;) }} -{{- template \u0026#34;_internal/google_analytics.html\u0026#34; . }} -{{- template \u0026#34;partials/templates/opengraph.html\u0026#34; . }} -{{- template \u0026#34;partials/templates/twitter_cards.html\u0026#34; . }} -{{- template \u0026#34;partials/templates/schema_json.html\u0026#34; . }} +{{- partial \u0026#34;google_analytics.html\u0026#34; . }} +{{- partial \u0026#34;templates/opengraph.html\u0026#34; . }} +{{- partial \u0026#34;templates/twitter_cards.html\u0026#34; . }} +{{- partial \u0026#34;templates/schema_json.html\u0026#34; . }} {{- end -}} diff --git a/layouts/partials/templates/opengraph.html b/layouts/partials/templates/opengraph.html index 95f037c..28afa94 100644 --- a/layouts/partials/templates/opengraph.html +++ b/layouts/partials/templates/opengraph.html @@ -10,7 +10,7 @@ {{- end}} {{- else }} -{{- $images := partial \u0026#34;partials/templates/_funcs/get-page-images\u0026#34; . -}} +{{- $images := partial \u0026#34;templates/_funcs/get-page-images\u0026#34; . -}} {{- range first 6 $images }} \u0026lt;meta property=\u0026#34;og:image\u0026#34; content=\u0026#34;{{ .Permalink }}\u0026#34; /\u0026gt; {{ end -}} diff --git a/layouts/partials/templates/schema_json.html b/layouts/partials/templates/schema_json.html index ed4d689..2faa706 100644 --- a/layouts/partials/templates/schema_json.html +++ b/layouts/partials/templates/schema_json.html @@ -81,7 +81,7 @@ {{ (path.Join .RelPermalink .Params.cover.image ) | absURL }}, {{- end}} {{- else }} - {{- $images := partial \u0026#34;partials/templates/_funcs/get-page-images\u0026#34; . -}} + {{- $images := partial \u0026#34;templates/_funcs/get-page-images\u0026#34; . -}} {{- with index $images 0 -}} \u0026#34;image\u0026#34;: {{ .Permalink }}, {{- end }} diff --git a/layouts/partials/templates/twitter_cards.html b/layouts/partials/templates/twitter_cards.html index 46b0d04..f20c6ee 100644 --- a/layouts/partials/templates/twitter_cards.html +++ b/layouts/partials/templates/twitter_cards.html @@ -6,7 +6,7 @@ \u0026lt;meta name=\u0026#34;twitter:image\u0026#34; content=\u0026#34;{{ (path.Join .RelPermalink .Params.cover.image ) | absURL }}\u0026#34; /\u0026gt; {{- end}} {{- else }} -{{- $images := partial \u0026#34;partials/templates/_funcs/get-page-images\u0026#34; . -}} +{{- $images := partial \u0026#34;templates/_funcs/get-page-images\u0026#34; . -}} {{- with index $images 0 -}} \u0026lt;meta name=\u0026#34;twitter:card\u0026#34; content=\u0026#34;summary_large_image\u0026#34; /\u0026gt; \u0026lt;meta name=\u0026#34;twitter:image\u0026#34; content=\u0026#34;{{ .Permalink }}\u0026#34; /\u0026gt; diff --git a/public/en/404.html b/public/en/404.html index cb0c968..218ccc3 100644 --- a/public/en/404.html +++ b/public/en/404.html ä¸»è¦åŸå› åœ¨è¯¥issuesä¸­ä¹Ÿè¯´æ˜äº†ï¼šå¯¹æ¨¡æ¿å‡½æ•°çš„è°ƒç”¨åœ¨æŸäº›æƒ…å†µä¸‹ä¸å‘åå…¼å®¹\nå¯¹partialè¿›è¡Œä¿®æ”¹å³å¯è§£å†³\n","permalink":"https://Sattiluvcat.github.io/en/posts/else/hugo%E5%B0%8F%E9%97%AE%E9%A2%98/","summary":"hugoçš„bugä¸debug","title":"Hugoå°é—®é¢˜"},{"content":"Â ç½‘ç»œæ¨¡å‹ OSI \u0026amp; TCP/IP ç‰©ç†å±‚\u0026ndash;æ•°æ®é“¾è·¯å±‚\u0026ndash;ç½‘ç»œå±‚\u0026ndash;ä¼ è¾“å±‚\u0026ndash;ä¼šè¯å±‚\u0026ndash;è¡¨ç¤ºå±‚\u0026ndash;åº”ç”¨å±‚ ç½‘ç»œæ¥å£å±‚\u0026ndash;ç½‘ç»œå±‚ï¼ˆIPï¼‰\u0026ndash;ä¼ è¾“å±‚ï¼ˆTCPã€UDPï¼‰\u0026ndash;åº”ç”¨å±‚ åº”ç”¨å±‚ åŸºæœ¬æ¦‚å¿µ åº”ç”¨å±‚åè®®ä¸¾ä¾‹ HTTP/HTTPS/CDN/DNS/FTP HTTPæŠ¥æ–‡ç»„æˆ è¯·æ±‚æŠ¥æ–‡ï¼šè¯·æ±‚è¡Œï¼ˆè¯·æ±‚æ–¹æ³•ã€è¯·æ±‚ç›®æ ‡URL/URIã€HTTPåè®®ç‰ˆæœ¬ï¼‰+ è¯·æ±‚å¤´ï¼ˆé™„åŠ ä¿¡æ¯ï¼Œå¦‚User-Agentï¼‰+ ç©ºè¡Œ + è¯·æ±‚ä½“ï¼ˆå¯é€‰ï¼Œä¸€èˆ¬POSTä¼šç”¨ï¼‰ å“åº”æŠ¥æ–‡ï¼šçŠ¶æ€è¡Œï¼ˆåè®®ç‰ˆæœ¬ã€çŠ¶æ€ç ã€çŠ¶æ€ä¿¡æ¯ï¼‰+ å“åº”å¤´ + ç©ºè¡Œ+ å“åº”ä½“ å¸¸ç”¨çŠ¶æ€ç  1xxï¼šæç¤ºä¿¡æ¯ï¼Œåè®®å¤„ç†çš„ä¸­é—´æ€ 2xxï¼šæˆåŠŸ 3xxï¼šé‡å®šå‘ï¼ˆ301æ°¸ä¹…é‡å®šå‘ã€302ä¸´æ—¶é‡å®šå‘\u0026ndash;\u0026gt;å®¢æˆ·ç«¯è¯·æ±‚èµ„æºå‘ç”Ÿäº†å˜åŠ¨ï¼‰ 4xxï¼šå®¢æˆ·ç«¯é”™è¯¯ï¼ˆ404ï¼šæ— æ³•æ‰¾åˆ°æ­¤é¡µé¢ï¼›405ï¼šè¯·æ±‚çš„æ–¹æ³•ç±»å‹ä¸æ”¯æŒï¼‰ 400ï¼šå®¢æˆ·ç«¯è¯·æ±‚é”™è¯¯ 5xxï¼šæœåŠ¡å™¨é”™è¯¯ï¼ˆ500ï¼šæœåŠ¡å™¨å†…éƒ¨å‡ºé”™ï¼‰ 502ã€503ã€504ï¼šé”™çš„ç½‘å…³ã€æœåŠ¡å™¨æ— æ³•è·å¾—ã€ç½‘å…³è¶…æ—¶ 502ä¸504çš„åŒºåˆ« 502 Bad Gatewayï¼šç½‘å…³/ä»£ç†æœåŠ¡å™¨ï¼ˆå¦‚nginxï¼‰æ‰§è¡Œè¯·æ±‚æ—¶ï¼Œä»ä¸Šæ¸¸æ”¶åˆ°æ— æ•ˆå“åº”ï¼ˆå¦‚åç«¯æ‰§è¡ŒæŠ¥é”™ï¼‰ 504 Gateway Time-outï¼šç½‘å…³/ä»£ç†æœåŠ¡å™¨ï¼ˆå¦‚nginxï¼‰æ‰§è¡Œè¯·æ±‚æ—¶ï¼Œæœªèƒ½åŠæ—¶æ”¶åˆ°å“åº” HTTP \u0026amp; HTTPS HTTPè¯·æ±‚çš„ç±»å‹ GETï¼šç”¨äºè¯·æ±‚è·å–æŒ‡å®šèµ„æºï¼Œé€šå¸¸ç”¨äºè·å–æ•°æ® è¯·æ±‚å‚æ•°ä¸€èˆ¬å†™åœ¨URLé‡Œï¼ŒURLåªèƒ½æ”¯æŒASCII æŒ‰RFCè§„å®šçš„è¯­ä¹‰ï¼Œéµå®ˆå¹‚ç­‰æ€§ï¼ˆæ— è®ºè°ƒç”¨å¤šå°‘æ¬¡ï¼Œéƒ½ä¸ä¼šå¯¹äº§ç”Ÿæ”¹å˜ï¼‰ POSTï¼šç”¨äºå‘æœåŠ¡å™¨æäº¤æ•°æ®ï¼Œé€šå¸¸ç”¨äºæäº¤è¡¨å•æ•°æ®æˆ–è¿›è¡Œèµ„æºçš„åˆ›å»º PUTï¼šç”¨äºå‘æœåŠ¡å™¨æ›´æ–°æŒ‡å®šèµ„æºï¼Œé€šå¸¸ç”¨äºæ›´æ–°å·²å­˜åœ¨çš„èµ„æº DELETEï¼šç”¨äºè¯·æ±‚æœåŠ¡å™¨åˆ é™¤æŒ‡å®šèµ„æº HEADï¼šç±»ä¼¼äºGETè¯·æ±‚ï¼Œä½†åªè¿”å›èµ„æºçš„å¤´éƒ¨ä¿¡æ¯ï¼Œç”¨äºè·å–èµ„æºçš„å…ƒæ•°æ®è€Œä¸è·å–å®é™…å†…å®¹ HTTPé•¿è¿æ¥æ˜¯å•¥ å»ºç«‹TCPè¿æ¥åï¼Œå‘é€å’Œæ¥æ”¶å¤šä¸ª HTTP è¯·æ±‚/åº”ç­”ï¼Œé¿å…è¿æ¥å»ºç«‹ä¸é‡Šæ”¾çš„å¼€é”€ ç‰¹ç‚¹ï¼šä»»æ„ä¸€ç«¯æœªæ˜ç¡®æå‡ºæ–­å¼€è¿æ¥ï¼Œåˆ™ä¿æŒé•¿è¿æ¥ï¼ˆçŸ­è¿æ¥æ˜¯å‘é€æ¥æ”¶ä¸€æ¬¡å°±é‡Šæ”¾ï¼‰ HTTP1.1æ€ä¹ˆå¯¹è¯·æ±‚æ‹†åŒ… è¯·æ±‚å¤´ä¸­åŒ…å«\u0026quot;Content-Length\u0026quot;å­—æ®µï¼Œè¡¨ç¤ºæ­£æ–‡çš„å­—èŠ‚æ•°\u0026ndash;\u0026gt;æœåŠ¡å™¨è¯»å–ç›¸åº”æ•°é‡çš„å­—èŠ‚ HTTPæ–­ç‚¹é‡ä¼ æ˜¯ä»€ä¹ˆ å®¢æˆ·ç«¯è®°å½•ä¸‹å½“å‰çš„ä¸‹è½½è¿›åº¦ï¼Œéœ€è¦ç»­ä¼ æ—¶é€šçŸ¥æœåŠ¡ç«¯æœ¬æ¬¡éœ€è¦ä¸‹è½½çš„å†…å®¹ç‰‡æ®µ æ–­ç‚¹ç»­ä¼ ä¸­4ä¸ªHTTPå¤´ä¸å¯å°‘çš„ï¼Œåˆ†åˆ«æ˜¯Rangeå¤´ã€Content-Rangeå¤´ã€Accept-Rangeså¤´ã€Content-Lengthå¤´ Accept-Rangesï¼šæœåŠ¡ç«¯å‘é€ï¼Œè¡¨ç¤ºæ¥å—å¸¦Rangeçš„è¯·æ±‚ Rangeï¼šå®¢æˆ·ç«¯å‘ï¼Œéœ€è¦ç»­ä¼ çš„ç‰‡æ®µ Content-Rangeï¼šæœåŠ¡ç«¯å‘é€ï¼Œä¼ è¾“çš„ç‰‡æ®µèŒƒå›´ Content-Lengthï¼šæœåŠ¡ç«¯å‘é€ï¼Œä¼ è¾“ç‰‡æ®µçš„é•¿åº¦ HTTPä¸ºä»€ä¹ˆä¸å®‰å…¨ æ˜æ–‡ä¼ è¾“ï¼Œæœ‰çªƒå¬ã€ç¯¡æ”¹ã€å†’å……é£é™© HTTPå’ŒHTTPS çš„åŒºåˆ« HTTP æ˜¯è¶…æ–‡æœ¬ä¼ è¾“åè®®ï¼Œä¿¡æ¯æ˜¯æ˜æ–‡ä¼ è¾“ \u0026ndash;\u0026gt; HTTPSåœ¨TCPå’Œç½‘ç»œå±‚é—´åŠ å…¥SSL/TLSå®‰å…¨åè®® HTTPåªéœ€TCPä¸‰æ¬¡æ¡æ‰‹å³å¯ä¼ è¾“æŠ¥æ–‡ \u0026ndash;\u0026gt; HTTPSTCPæ¡æ‰‹åè¿˜éœ€è¦SSL/TLSæ¡æ‰‹ HTTP é»˜è®¤ç«¯å£å·æ˜¯ 80 \u0026ndash;\u0026gt; HTTPS é»˜è®¤ç«¯å£å·æ˜¯ 443 HTTPS åè®®éœ€è¦å‘ CAï¼ˆè¯ä¹¦æƒå¨æœºæ„ï¼‰ç”³è¯·æ•°å­—è¯ä¹¦ï¼Œä¿è¯æœåŠ¡å™¨èº«ä»½å¯ä¿¡ HTTPSæ¡æ‰‹è¿‡ç¨‹ åŠ å¯†ï¼ˆç”¨éå¯¹ç§°åŠ å¯†æ–¹å¼åå•†å‡ºå¯¹ç§°åŠ å¯†å¯†é’¥ï¼‰\u0026amp;èº«ä»½æ ¡éªŒé˜²èŒƒä¸­é—´äºº * ç¬¬ä¸€æ¬¡æ¡æ‰‹ï¼šå®¢æˆ·ç«¯å‘æœåŠ¡å™¨å‘èµ·åŠ å¯†é€šä¿¡è¯·æ±‚ï¼ˆå®¢æˆ·ç«¯æ”¯æŒçš„ TLS åè®®ç‰ˆæœ¬ã€äº§ç”Ÿçš„éšæœºæ•°ã€æ”¯æŒçš„å¯†ç å¥—ä»¶åˆ—è¡¨ * å¯†ç å¥—ä»¶åˆ—è¡¨=å¯¹ç§°åŠ å¯†ç®—æ³•ï¼ˆå‘é€ä¸æ¥æ”¶æ–¹æŒæœ‰ç›¸åŒå…¬é’¥ï¼‰+éå¯¹ç§°åŠ å¯†ç®—æ³•ï¼ˆæ¥æ”¶æ–¹æŒæœ‰ç§é’¥ï¼Œå‘é€æ–¹æŒæœ‰å…¬é’¥ï¼Œå…¬é’¥åŠ å¯†åªæœ‰ç§é’¥èƒ½è§£ï¼Œåä¹‹äº¦ç„¶ï¼‰+æ•°æ®æ‘˜è¦ç®—æ³•ï¼ˆå¦‚MD5ï¼Œç±»ä¼¼å“ˆå¸Œè¿‡ç¨‹ï¼‰ * ç¬¬äºŒæ¬¡æ¡æ‰‹ï¼šæœåŠ¡å™¨æ”¶åˆ°å®¢æˆ·ç«¯è¯·æ±‚åï¼Œå‘å®¢æˆ·ç«¯å‘å‡ºå“åº”ï¼ˆç¡®è®¤ TLS åè®®ç‰ˆæœ¬ã€æœåŠ¡å™¨ç”Ÿäº§çš„éšæœºæ•°ã€ç¡®è®¤çš„å¯†ç å¥—ä»¶åˆ—è¡¨ã€æœåŠ¡å™¨çš„æ•°å­—è¯ä¹¦ï¼‰ * éšæœºæ•°å’Œé¢„ä¸»å¯†é’¥å…±åŒç”Ÿæˆä¸»å¯†é’¥ * ç¬¬ä¸‰æ¬¡æ¡æ‰‹ï¼šå®¢æˆ·ç«¯æ”¶åˆ°æœåŠ¡å™¨çš„å›åº”ï¼Œé¦–å…ˆé€šè¿‡æµè§ˆå™¨æˆ–è€…æ“ä½œç³»ç»Ÿä¸­çš„ CA å…¬é’¥ï¼Œç¡®è®¤æœåŠ¡å™¨æ•°å­—è¯ä¹¦çš„æœ‰æ•ˆæ€§\u0026ndash;\u0026gt;å®¢æˆ·ç«¯ä»æ•°å­—è¯ä¹¦ä¸­å–å‡ºæœåŠ¡å™¨çš„å…¬é’¥ï¼Œç”¨å…¶åŠ å¯†æŠ¥æ–‡å¹¶å‘é€ï¼šä¸€ä¸ªéšæœºæ•°ï¼ˆé¢„ä¸»å¯†é’¥ï¼‰ã€åŠ å¯†é€šä¿¡ç®—æ³•æ”¹å˜é€šçŸ¥ã€å®¢æˆ·ç«¯æ¡æ‰‹ç»“æŸé€šçŸ¥ï¼ˆåŒæ—¶æŠŠä¹‹å‰æ‰€æœ‰å†…å®¹çš„å‘ç”Ÿçš„æ•°æ®åšæ‘˜è¦ï¼Œä¾›æœåŠ¡ç«¯æ ¡éªŒï¼‰ * ç¬¬å››æ¬¡æ¡æ‰‹ï¼šæœåŠ¡å™¨æ”¶åˆ°å®¢æˆ·ç«¯çš„ç¬¬ä¸‰ä¸ªéšæœºæ•°ï¼ˆpre-master keyé¢„ä¸»å¯†é’¥ï¼‰ä¹‹åï¼Œé€šè¿‡åå•†çš„åŠ å¯†ç®—æ³•ï¼Œï¼ˆé€šè¿‡ä¸‰ä¸ªéšæœºæ•°ï¼‰è®¡ç®—å‡ºæœ¬æ¬¡é€šä¿¡çš„ä¼šè¯å¯†é’¥ï¼Œå‘å®¢æˆ·ç«¯å‘é€åŠ å¯†é€šä¿¡ç®—æ³•æ”¹å˜é€šçŸ¥ã€æœåŠ¡å™¨æ¡æ‰‹ç»“æŸé€šçŸ¥ï¼ˆåŒæ—¶æŠŠä¹‹å‰æ‰€æœ‰å†…å®¹çš„å‘ç”Ÿçš„æ•°æ®åšæ‘˜è¦ï¼Œä¾›å®¢æˆ·ç«¯æ ¡éªŒï¼‰ * æ¡æ‰‹ç»“æŸï¼Œè¿›å…¥åŠ å¯†é€šä¿¡ï¼Œä½¿ç”¨HTTPåè®®ï¼Œä½†ç”¨ä¼šè¯å¯†é’¥åŠ å¯†å†…å®¹ Http1.1å’Œ2.0çš„åŒºåˆ« å¤´éƒ¨å‹ç¼©ï¼šåŒæ—¶å‘å‡ºå¤šä¸ªè¯·æ±‚ï¼Œä»–ä»¬çš„å¤´æ˜¯ä¸€æ ·çš„æˆ–æ˜¯ç›¸ä¼¼çš„ï¼Œåè®®ä¼šæ¶ˆé™¤é‡å¤çš„éƒ¨åˆ†â€”â€”å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨åŒæ—¶ç»´æŠ¤ä¸€å¼ å¤´ä¿¡æ¯è¡¨ï¼Œæ‰€æœ‰å­—æ®µéƒ½ä¼šå­˜å…¥è¿™ä¸ªè¡¨ï¼Œç”Ÿæˆä¸€ä¸ª ç´¢å¼•å· äºŒè¿›åˆ¶æ ¼å¼ï¼šå¤´ä¿¡æ¯å’Œæ•°æ®ä½“éƒ½æ˜¯äºŒè¿›åˆ¶ï¼Œç»Ÿç§°ä¸ºå¸§ å¹¶å‘ä¼ è¾“ï¼šå¼•å‡º Stream æ¦‚å¿µï¼Œå¤šä¸ª Stream å¤ç”¨åœ¨ä¸€æ¡ TCP è¿æ¥ HTTP2.0æœåŠ¡å™¨å¯ä»¥ä¸»åŠ¨å‘å®¢æˆ·ç«¯å‘é€èµ„æº TCPè¿æ¥åä»€ä¹ˆæ—¶å€™ä¸­æ–­ï¼ˆHTTPï¼‰ æœåŠ¡ç«¯æˆ–è€…å®¢æˆ·ç«¯æ‰§è¡Œ close ç³»ç»Ÿè°ƒç”¨ï¼Œä¼šå‘é€FINæŠ¥æ–‡ï¼Œä¹‹åå››æ¬¡æŒ¥æ‰‹ å‘é€æ–¹å‘é€äº†æ•°æ®ä¹‹åï¼Œæ¥æ”¶æ–¹è¶…è¿‡ä¸€æ®µæ—¶é—´æ²¡æœ‰å“åº”ACKæŠ¥æ–‡ï¼Œå‘é€æ–¹é‡ä¼ æ•°æ®è¾¾åˆ°æœ€å¤§æ¬¡æ•° HTTPé•¿æ—¶é—´æ²¡æœ‰è¿›è¡Œè¯·æ±‚å’Œå“åº” DNS Domain Name Systemï¼Œé»˜è®¤ç«¯å£53\nDNSè§£æçš„å·¥ä½œæµç¨‹ å®¢æˆ·ç«¯å‘å‡º DNS è¯·æ±‚ï¼ŒæŸ¥æ‰¾åŸŸåå¯¹åº”IPï¼Œå¹¶å‘ç»™æœ¬åœ° DNS æœåŠ¡å™¨ æœ¬åœ°åŸŸåæœåŠ¡å™¨åœ¨ç¼“å­˜ä¸­æ‰¾ï¼Œæ‰¾ä¸åˆ°å»é—®æ ¹åŸŸåæœåŠ¡å™¨ æ ¹åŸŸåè½¬å‘é¡¶çº§åŸŸåï¼ˆå¦‚.comï¼‰æœåŠ¡å™¨åœ°å€ç»™æœ¬åœ°DNS é¡¶çº§åŸŸåè½¬å‘æƒå¨åŸŸåï¼ˆå¦‚server.comï¼‰æœåŠ¡å™¨åœ°å€ç»™æœ¬åœ°DNS æƒå¨DNSæŸ¥è¯¢åå°†å¯¹åº”IPåœ°å€å‘ç»™æœ¬åœ°DNS æœ¬åœ° DNS å°† IP åœ°å€è¿”å›å®¢æˆ·ç«¯ åº•å±‚æ˜¯TCPè¿˜æ˜¯UDP UDP\u0026ndash;\u0026gt;ä½å»¶è¿Ÿï¼ˆæ— è¿æ¥ï¼‰ã€ç®€å•å¿«é€Ÿï¼ˆæ²¡æœ‰è¿æ¥ç®¡ç†ä¸æµé‡æ§åˆ¶æœºåˆ¶ï¼Œä¼ è¾“æ•ˆç‡é«˜ï¼‰ã€è½»é‡çº§ï¼ˆå¤´éƒ¨å°ï¼Œç½‘ç»œèµ„æºå ç”¨å°ï¼‰ Cookie HTTPæœ‰æ— çŠ¶æ€ æ— çŠ¶æ€==\u0026gt;æ¯ä¸ªè¯·æ±‚éƒ½ç‹¬ç«‹ï¼ŒæœåŠ¡å™¨ä¸ä¼šåœ¨å¤šä¸ªè¯·æ±‚ä¹‹é—´ä¿ç•™å…³äºå®¢æˆ·ç«¯çŠ¶æ€çš„ä¿¡æ¯ å¯ä»¥é€šè¿‡ä¸€äº›æœºåˆ¶å®ç°çŠ¶æ€ä¿æŒï¼Œå¦‚Cookieã€Session Cookieã€Sessionçš„åŒºåˆ« å­˜å‚¨ä½ç½®ï¼šCookieçš„æ•°æ®å­˜å‚¨åœ¨å®¢æˆ·ç«¯ï¼ˆé€šå¸¸æ˜¯æµè§ˆå™¨ï¼‰ï¼›Sessionçš„æ•°æ®å­˜å‚¨åœ¨æœåŠ¡å™¨ç«¯ï¼ˆæœåŠ¡å™¨åˆ†é…å”¯ä¸€IDï¼Œé€šè¿‡Cookieå‘ç»™å®¢æˆ·ç«¯ï¼Œå®¢æˆ·ç«¯ä¹‹åè¯·æ±‚å¸¦ä¸Šæ­¤IDï¼‰ æ•°æ®å®¹é‡ï¼šå•ä¸ªCookieçš„å¤§å°é™åˆ¶é€šå¸¸åœ¨4KBå·¦å³ï¼Œå¤§å¤šæµè§ˆå™¨é™åˆ¶æ¯ä¸ªåŸŸåçš„æ€»Cookieæ•°é‡ï¼›Sessionå¤§å°ç†è®ºä¸Šä¸é™åˆ¶ å®‰å…¨æ€§ï¼šCookieç›¸å¯¹ä¸å®‰å…¨ï¼Œå› ä¸ºæ•°æ®å­˜å‚¨åœ¨å®¢æˆ·ç«¯ï¼Œå®¹æ˜“å—åˆ°XSSï¼ˆè·¨ç«™è„šæœ¬æ”»å‡»ï¼‰çš„å¨èƒï¼›Sessionä¸€èˆ¬æ›´å®‰å…¨ï¼Œä½†éœ€è¦é˜²èŒƒSessionåŠ«æŒå’Œä¼šè¯å›ºå®šæ”»å‡» ç”Ÿå‘½å‘¨æœŸï¼šCookieå¯ä»¥è®¾ç½®è¿‡æœŸæ—¶é—´ï¼Œè¿‡æœŸåè‡ªåŠ¨åˆ é™¤ï¼Œä¹Ÿå¯ä»¥è®¾ç½®ä¸ºä¼šè¯Cookieï¼ˆæµè§ˆå™¨å…³é—­è‡ªåŠ¨åˆ é™¤ï¼‰ï¼›é»˜è®¤æƒ…å†µä¸‹ï¼Œå½“ç”¨æˆ·å…³é—­æµè§ˆå™¨æ—¶ï¼ŒSessionç»“æŸï¼ˆä¹Ÿå¯æœåŠ¡ç«¯è®¾ç½®è¿‡æœŸæ—¶é—´ï¼‰ tokenï¼Œsessionï¼Œcookieçš„åŒºåˆ« sessionå­˜å‚¨äºæœåŠ¡å™¨ï¼Œé€šå¸¸å­˜æ”¾äºcookieä¸­ã€‚æœåŠ¡å™¨æ”¶åˆ°cookieåè§£æå‡ºsessionIdï¼Œä¾èµ–äºcookie cookieç±»ä¼¼ä»¤ç‰Œï¼Œè£…æœ‰sessionIdï¼Œå­˜å‚¨åœ¨å®¢æˆ·ç«¯ï¼Œæµè§ˆå™¨é€šå¸¸ä¼šè‡ªåŠ¨æ·»åŠ  tokenç±»ä¼¼ä»¤ç‰Œï¼Œæ— çŠ¶æ€ï¼Œç”¨æˆ·ä¿¡æ¯éƒ½è¢«åŠ å¯†åˆ°tokenä¸­ï¼Œéœ€è¦æ‰‹åŠ¨æ·»åŠ  å®¢æˆ·ç«¯ç¦ç”¨cookieï¼Œsessionè¿˜èƒ½ç”¨ä¹ˆ ä¸å¯ã€‚æœåŠ¡å™¨å°†æ— æ³•æŠŠä¼šè¯ ID å‘é€ç»™å®¢æˆ·ç«¯ï¼Œå®¢æˆ·ç«¯ä¹Ÿæ— æ³•åœ¨åç»­è¯·æ±‚ä¸­æºå¸¦ç»˜ç”»IDè¿”å›ç»™æœåŠ¡å™¨ å¯ä»¥é€šè¿‡URLé‡å†™ï¼ˆURLä¸Šæ·»åŠ sessionIDï¼‰ ã€éšè—è¡¨å•å­—æ®µï¼ˆåœ¨æ¯ä¸ªéœ€è¦Sessionä¿¡æ¯çš„HTMLè¡¨å•ä¸­åŒ…å«ä¸€ä¸ªå­˜å‚¨Session IDçš„éšè—å­—æ®µï¼‰ LocalStorage å­˜åœ¨æµè§ˆå™¨ç«¯ï¼Œä¸ä¼šè‡ªåŠ¨å‘é€ç»™æœåŠ¡å™¨ JWTä»¤ç‰Œ JWT ä»¤ç‰Œå’Œä¼ ç»Ÿæ–¹å¼æœ‰ä»€ä¹ˆåŒºåˆ« æ— çŠ¶æ€æ€§ï¼šJWTæ˜¯æ— çŠ¶æ€çš„ä»¤ç‰Œï¼Œä¸éœ€è¦åœ¨æœåŠ¡å™¨ç«¯å­˜å‚¨ä¼šè¯ä¿¡æ¯ï¼Œä½†åŒ…æ‹¬å¿…è¦ä¿¡æ¯\u0026ndash;\u0026gt;é€‚åˆåˆ†å¸ƒå¼ç³»ç»Ÿ å®‰å…¨æ€§ï¼šJWTä½¿ç”¨å¯†é’¥å¯¹ä»¤ç‰Œè¿›è¡Œç­¾åï¼ŒæŒæœ‰æ­£ç¡®å¯†é’¥çš„æœåŠ¡å™¨æ‰èƒ½å¯¹å…¶éªŒè¯è§£æ è·¨åŸŸæ”¯æŒï¼šJWTä»¤ç‰Œå¯ä»¥åœ¨ä¸åŒåŸŸä¹‹é—´ä¼ é€’ï¼ˆè¯·æ±‚å¤´/å‚æ•°ä¸­æºå¸¦ä»¤ç‰Œï¼Œåˆ™æ— éœ€cookieä¹Ÿå¯è·¨åŸŸèº«ä»½éªŒè¯ï¼‰ JWTä»¤ç‰Œæœ‰å“ªäº›å­—æ®µ å¤´éƒ¨ï¼ˆHeaderï¼‰ã€è½½è·ï¼ˆPayloadï¼‰å’Œç­¾åï¼ˆSignatureï¼‰ å¤´éƒ¨å’Œè½½è·å‡ä¸ºJSONæ ¼å¼ï¼Œä½¿ç”¨Base64ç¼–ç è¿›è¡Œåºåˆ—åŒ–ï¼Œè€Œç­¾åéƒ¨åˆ†æ˜¯å¯¹å¤´éƒ¨ã€è½½è·å’Œå¯†é’¥è¿›è¡Œç­¾ååçš„ç»“æœ ç¼ºç‚¹ ä¸€æ—¦æ´¾å‘å‡ºå»ï¼Œåœ¨å¤±æ•ˆä¹‹å‰éƒ½æ˜¯æœ‰æ•ˆçš„ï¼Œæ— æ³•åŠæ—¶æ’¤é”€ å¯å¢åŠ é»‘åå•æœºåˆ¶ï¼ˆRedisï¼‰ æ³„éœ²äº†æ€ä¹ˆè§£å†³ åŠæ—¶å¤±æ•ˆ åˆ·æ–°â€”â€”è®¾å®šæœ‰æ•ˆæœŸ é»‘åå• å…¶å®ƒ HTTPé•¿è¿æ¥å’ŒWebSocketåŒºåˆ« TCP åè®®æœ¬èº«æ˜¯å…¨åŒå·¥ï¼Œä½† HTTP/1.1 æ˜¯åŠåŒå·¥ vs å…¨åŒå·¥çš„ WebSocket åº”ç”¨åœºæ™¯ï¼šHTTP/1.1 é‡Œï¼Œåªè¦å®¢æˆ·ç«¯ä¸é—®ï¼ŒæœåŠ¡ç«¯å°±ä¸ç­”\u0026ndash;\u0026gt;ç®€å•åœºæ™¯ï¼ˆå®šæ—¶è½®è¯¢/é•¿è½®è¯¢å®ç°æœåŠ¡å™¨æ¨é€æ•ˆæœï¼‰ vs å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯é¢‘ç¹äº¤äº’åœºæ™¯ç”¨WebSocket Nginxå“ªäº›è´Ÿè½½å‡è¡¡ç®—æ³• è½®è¯¢ï¼ˆæŒ‰é¡ºåºåˆ†é…è¯·æ±‚ï¼‰ã€IPå“ˆå¸Œï¼ˆç¡®å®šåç«¯æœåŠ¡å™¨ï¼‰ã€URLå“ˆå¸Œã€æœ€çŸ­å“åº”æ—¶é—´ï¼ˆåç«¯æœåŠ¡å™¨å“åº”æ—¶é—´ï¼‰ã€åŠ æƒè½®è¯¢ ä¼ è¾“å±‚ æ¡æ‰‹ tcpå¤´éƒ¨ åºåˆ—å·ï¼šå»ºç«‹è¿æ¥æ—¶ç”¨éšæœºæ•°ä½œä¸ºåˆå§‹å€¼ï¼Œï¼ˆSYNåŒ…ï¼‰å‘é€ä¸€æ¬¡ç´¯åŠ ä¸€æ¬¡æ•°æ®é•¿åº¦\u0026ndash;\u0026gt;è§£å†³ç½‘ç»œåŒ…ä¹±åºé—®é¢˜ ç¡®è®¤åº”ç­”å·ï¼šä¸‹æ¬¡æœŸæœ›æ”¶åˆ°çš„åºåˆ—å· == å¯¹æ–¹è®¤ä¸ºæ­¤åºå·å‰çš„æ•°æ®éƒ½è¢«æ­£å¸¸æ¥æ”¶\u0026ndash;\u0026gt;è§£å†³ä¸¢åŒ…é—®é¢˜ æ§åˆ¶ä½ï¼šACK\u0026ndash;\u0026gt;ä¸º1è¡¨ç¤ºç¡®è®¤åº”ç­”å­—æ®µæœ‰æ•ˆï¼›RST\u0026ndash;\u0026gt;ä¸º1è¡¨ç¤ºè¿æ¥å¼‚å¸¸éœ€æ–­å¼€ï¼›SYN\u0026ndash;\u0026gt;ä¸º1è¡¨ç¤ºå¸Œæœ›å»ºç«‹è¿æ¥ï¼Œå¹¶è®¾å®šåºåˆ—å·åˆå§‹å€¼ï¼›FIN\u0026ndash;\u0026gt;ä¸º1è¡¨ç¤ºå†æ— æ•°æ®å‘é€ï¼Œå¸Œæœ›æ–­å¼€ TCPä¸‰æ¬¡æ¡æ‰‹ beforeï¼šæœåŠ¡ç«¯ä¸»åŠ¨ç›‘å¬æŸä¸ªç«¯å£ï¼Œå¤„äº LISTEN çŠ¶æ€ ç¬¬ä¸€æ¬¡ï¼šå®¢æˆ·ç«¯éšæœºåˆå§‹åŒ–åºå·ï¼ˆclient_isnï¼‰ï¼ŒSYNç½®ä¸º1ï¼Œå‘é€ï¼Œè¿›å…¥syn_sentçŠ¶æ€ ç¬¬äºŒæ¬¡ï¼šæœåŠ¡ç«¯éšæœºåˆå§‹åŒ–åºå·ï¼ˆserver_isnï¼‰ï¼ŒSYNã€ACKç½®ä¸º1ï¼Œç¡®è®¤åº”ç­”å· client_isn + 1ï¼Œå‘é€ï¼Œè¿›å…¥syn_rcvdçŠ¶æ€ ç¬¬ä¸‰æ¬¡ï¼šå®¢æˆ·ç«¯ACKç½®ä¸º1ï¼Œç¡®è®¤åº”ç­”å· server_isn + 1ï¼Œå‘é€ï¼Œå¯å¸¦æ•°æ®ï¼Œè¿›å…¥establishedçŠ¶æ€ ä¸‰æ¬¡æ¡æ‰‹çš„åŸå›  é˜»æ­¢é‡å¤å†å²è¿æ¥çš„åˆå§‹åŒ–â€”â€”å»ºç«‹äº†å†å²è¿æ¥ï¼Œä¼šé€ æˆèµ„æºæµªè´¹ ä¸¤æ¬¡æ¡æ‰‹ï¼šå®¢æˆ·ç«¯å‘é€è¿æ¥Aï¼Œä¸­æ–­ï¼Œå‘é€è¿æ¥Bï¼ŒAè¢«æ¥æ”¶æœåŠ¡ç«¯å»ºç«‹è¿æ¥ï¼ŒæœåŠ¡ç«¯å‘é€æ•°æ®ä¸æ¡æ‰‹ï¼Œå®¢æˆ·ç«¯åˆ¤æ–­å…¶ä¸ºå†å²è¿æ¥ï¼Œå‘é€RSTå£°æ˜ã€‚==\u0026gt;èµ„æºæµªè´¹ åŒæ­¥åˆå§‹åºåˆ—å·â€”â€”å‘é€ä¸€ä¸ªåˆå§‹åºåˆ—å·ï¼Œéœ€è¦å¯¹æ–¹è¿”å›åº”ç­”æŠ¥æ–‡ï¼ˆç¡®è®¤å¯¹æ–¹æ¥æ”¶åˆ°ï¼‰ï¼Œä¸¤æ–¹åˆ™éœ€ä¸‰æ¬¡ æ¥æ”¶æ–¹å¯å»é™¤é‡å¤æ•°æ® \u0026amp; æ¥æ”¶æ–¹å¯ä»¥æ ¹æ®æ•°æ®åŒ…çš„åºåˆ—å·æŒ‰åºæ¥æ”¶ \u0026amp; æ ‡è¯†å‘é€å‡ºå»çš„æ•°æ®åŒ…ä¸­ï¼Œå“ªäº›å·²è¢«å¯¹æ–¹æ”¶åˆ° å››æ¬¡æ¡æ‰‹å¯ä»¥è¢«ä¼˜åŒ–ä¸ºä¸‰æ¬¡ï¼ˆå¯¹æ–¹çš„åˆå§‹åºåˆ—å·ä¸åº”ç­”æŠ¥æ–‡å¯ä»¥ä¸€æ¬¡å‘é€ï¼‰ é¿å…èµ„æºæµªè´¹â€”â€”æœåŠ¡ç«¯ä¼šå»ºç«‹å¤šä¸ªæ— æ•ˆè¿æ¥ï¼ˆå®¢æˆ·ç«¯æœªæ”¶åˆ°ACKï¼Œå‘é€äº†å¤šä¸ªSYNæŠ¥æ–‡ï¼‰ å®¢æˆ·ç«¯ç¬¬ä¸‰æ¬¡å‘é€çš„ç¡®è®¤åŒ…ä¸¢å¤±äº†ä¼šå‘ç”Ÿä»€ä¹ˆ ACKæŠ¥æ–‡ä¸ä¼šé‡ä¼ ï¼Œè‹¥ä¸¢å¤±åˆ™ç”±å¯¹æ–¹é‡ä¼ å¯¹åº”æŠ¥æ–‡ è¶…æ—¶é‡ä¼ ï¼Œä¸¤æ¬¡åºåˆ—å·ä¸€è‡´ï¼Œæ¯æ¬¡è¶…æ—¶æ—¶é—´æ˜¯ä¸Šæ¬¡çš„2å€ SYN+ACKæŠ¥æ–‡ä¸¢å¤±æ€ä¹ˆåŠ å®¢æˆ·ç«¯é‡ä¼ ï¼ŒæœåŠ¡ç«¯ä¹Ÿé‡ä¼  æ”¶åˆ°é‡å¤çš„SYNæŠ¥æ–‡ï¼ŒæœåŠ¡ç«¯æ€ä¹ˆåŠ å†æ¬¡å‘é€ç¬¬äºŒæ¬¡æ¡æ‰‹æŠ¥æ–‡ ç¬¬ä¸€æ¬¡æ¡æ‰‹ï¼Œå®¢æˆ·ç«¯å‘é€SYNæŠ¥åï¼ŒæœåŠ¡ç«¯å›å¤ACKæŠ¥ï¼ŒæœåŠ¡ç«¯å†…éƒ¨åšäº†ä»€ä¹ˆ æœåŠ¡ç«¯æ”¶åˆ°è¯·æ±‚\u0026ndash;\u0026gt;å†…æ ¸å°†è¿æ¥å­˜å‚¨åˆ°åŠè¿æ¥é˜Ÿåˆ—\u0026ndash;\u0026gt;æœåŠ¡ç«¯å“åº”SYN+ACK\u0026ndash;\u0026gt;æ”¶åˆ°ç¬¬ä¸‰æ¬¡æ¡æ‰‹çš„ACK\u0026ndash;\u0026gt;å†…æ ¸å°†è¿æ¥ä»åŠè¿æ¥é˜Ÿåˆ—ç§»é™¤ï¼Œåˆ›å»ºæ–°çš„å®Œå…¨é“¾æ¥å¹¶æ·»åŠ è‡³acceptå…¨è¿æ¥é˜Ÿåˆ—ï¼Œç­‰å¾…è¿›ç¨‹è°ƒç”¨acceptæ—¶å–å‡ºè¿æ¥ åŠè¿æ¥é˜Ÿåˆ—ã€å…¨è¿æ¥é˜Ÿåˆ—ï¼Œéƒ½æœ‰æœ€å¤§é•¿åº¦é™åˆ¶ï¼Œè¶…è¿‡é™åˆ¶æ—¶ï¼Œå†…æ ¸ä¼šç›´æ¥ä¸¢å¼ƒï¼Œæˆ–è¿”å› RST åŒ… æŒ¥æ‰‹ å››æ¬¡æŒ¥æ‰‹è¿‡ç¨‹ å®¢æˆ·ç«¯ä¸»åŠ¨è°ƒç”¨å…³é—­è¿æ¥çš„å‡½æ•°ï¼Œå‘é€FINæŠ¥æ–‡ï¼ˆä»£è¡¨ä¸å†å‘é€æ•°æ®ï¼‰ï¼Œè¿›å…¥ FIN_WAIT_1 çŠ¶æ€ æœåŠ¡ç«¯å›å¤ACKï¼Œè¿›å…¥ CLOSE_WAIT çŠ¶æ€ æœåŠ¡ç«¯æ”¶åˆ°FINæ—¶ï¼ŒTCPåè®®æ ˆåœ¨FINä¸­æ’å…¥EOFæ–‡ä»¶ç»“æŸç¬¦ï¼ŒEOFä¼šè¢«æ”¾åˆ°æ‰€æœ‰å·²æ”¶åˆ°çš„æ•°æ®å æœåŠ¡ç«¯readæ•°æ®ï¼Œè¯»åˆ°EOFï¼Œå‘é€éœ€è¦å‘é€æ•°æ®ï¼ˆè‹¥æ— åˆ™ä¸å‘é€ï¼‰åè°ƒç”¨å…³é—­è¿æ¥çš„å‡½æ•°\u0026ndash;\u0026gt;å‘FINåŒ…ï¼ˆè¡¨ç¤ºä¸å†å‘æ•°æ®ï¼‰ï¼ŒæœåŠ¡ç«¯è¿›å…¥ LAST_ACK çŠ¶æ€ å®¢æˆ·ç«¯æ¥æ”¶ FIN åŒ…ï¼Œå‘é€ ACKï¼Œå®¢æˆ·ç«¯è¿›å…¥ TIME_WAIT çŠ¶æ€ æœåŠ¡ç«¯æ”¶åˆ°ACKï¼Œè¿›å…¥æœ€åçš„CLOSEçŠ¶æ€ å®¢æˆ·ç«¯ç»è¿‡2MSLæ—¶é—´åè¿›å…¥CLOSEçŠ¶æ€ ç¬¬äºŒæ¬¡ã€ç¬¬ä¸‰æ¬¡æŒ¥æ‰‹å¯ä»¥åˆå¹¶å— å½“è¢«åŠ¨å…³é—­æ–¹ã€Œæ²¡æœ‰æ•°æ®è¦å‘é€ã€å¹¶ä¸”ã€Œå¼€å¯äº† TCP å»¶è¿Ÿç¡®è®¤æœºåˆ¶ã€ï¼Œä¼šåˆå¹¶ä¼ è¾“ TCP å»¶è¿Ÿç¡®è®¤ï¼šæ¥æ”¶æ–¹åœ¨æ”¶åˆ°æ•°æ®åï¼Œå¹¶ä¸ä¼šç«‹å³å›å¤ACKï¼Œè€Œæ˜¯å»¶è¿Ÿä¸€å®šæ—¶é—´ ç¬¬ä¸‰æ¬¡æŒ¥æ‰‹ä¸€ç›´æ²¡å‘ï¼Œä¼šæ€ä¹ˆæ · ä¸»åŠ¨æ–¹å‘é€é€šé“å·²å…³é—­ã€‚è‹¥ç”¨shutdownå…³é—­è¿æ¥ï¼Œå°†ä¸€ç›´å¤„äºFIN_WAIT2çŠ¶æ€ï¼ˆå¯èƒ½è¿˜å¯ä»¥å‘é€æˆ–æ¥æ”¶æ•°æ®ï¼‰ï¼›è‹¥ç”¨closeå…³é—­ï¼ˆæˆä¸ºå­¤å„¿è¿æ¥ï¼‰ï¼ŒçŠ¶æ€ä¸å¯æŒç»­ï¼Œtcp_fin_timeoutæ§åˆ¶æ—¶é•¿ä¸º60s shutdownå¯ä»¥é€‰æ‹©æ˜¯å¦å…³é—­å‘é€/æ¥å—èƒ½åŠ› å®¢æˆ·ç«¯FINåŒ…ä¸¢å¤±ï¼ŒçŠ¶æ€ä½•å¦‚ é‡ä¼ ï¼ˆ2å€æ—¶é—´ï¼‰ï¼Œè‹¥å…¨æ— å›åº”ï¼Œä¸å†å‘é€æŠ¥æ–‡ï¼Œç­‰å¾…ä¸€æ®µæ—¶é—´åï¼ˆä¸Šæ¬¡çš„2å€ï¼‰ç›´æ¥è¿›å…¥closeçŠ¶æ€ï¼ŒæœåŠ¡ç«¯è¿˜æ˜¯establishedçŠ¶æ€ ä¸ºä»€ä¹ˆè¿˜è¦ç­‰2msl MSL æ˜¯ Maximum Segment Lifetimeï¼ŒæŠ¥æ–‡æœ€å¤§ç”Ÿå­˜æ—¶é—´ï¼ˆåœ¨ç½‘ç»œä¸­ï¼‰ ç½‘ç»œä¸­å¯èƒ½å­˜åœ¨æ¥è‡ªå‘é€æ–¹çš„æ•°æ®åŒ…ï¼Œè¢«å¤„ç†åä¼˜æƒ å‘å¯¹æ–¹å‘é€å“åº”ï¼ˆä¸€æ¥ä¸€å›ï¼‰ã€‚eg.æœ€åçš„ACKä¸¢å¤±ï¼ŒFINä¼šè¶…æ—¶é‡ä¼ ï¼Œå†é‡å‘ACKï¼Œæ­£å¥½2MSL æœåŠ¡ç«¯å‡ºç°å¤§é‡timewaitçš„åŸå›  æ²¡å¼€é•¿è¿æ¥ï¼ˆä¸€èˆ¬webå®ç°ä¸­éƒ½æ˜¯ç”±æœåŠ¡ç«¯æ–­å¼€è¿æ¥ï¼Œä»»æ„ä¸€æ–¹è¯·æ±‚å¤´æœ‰Connection:closeéƒ½ä¼šå…³é—­é•¿è¿æ¥ï¼‰ é•¿è¿æ¥è¶…æ—¶ï¼ˆå¯èƒ½ç½‘ç»œé—®é¢˜ï¼ŒæœåŠ¡ç«¯å‘é€çš„å†…å®¹éƒ½ä¸¢å¤±ï¼‰ é•¿è¿æ¥è¯·æ±‚æ•°è¿‡å¤šï¼ˆå¦‚nginxç®¡ç†ï¼Œè®¾ç½®keepalive_requestsï¼‰ TCPä¸UDP åŒºåˆ« ä¸éœ€è¦è¿æ¥ï¼›é¢å‘è¿æ¥ æ”¯æŒä¸€å¯¹ä¸€ã€ä¸€å¯¹å¤šã€å¤šå¯¹ä¸€ã€å¤šå¯¹å¤šï¼›onlyä¸€å¯¹ä¸€ å°½æœ€å¤§åŠªåŠ›äº¤ä»˜ï¼Œä¸ä¿è¯å¯é ï¼ˆä½†å¯ä»¥å…¶ä¸ºåŸºç¡€å®ç°å¯é ä¼ è¾“åè®®QUICï¼‰ï¼›å¯é äº¤ä»˜ æ— æ‹¥å¡æ§åˆ¶ã€æµé‡æ§åˆ¶ï¼›æœ‰ é¦–éƒ¨å¼€é”€å°ï¼ˆ8ä¸ªå­—èŠ‚å›ºå®šï¼‰ï¼›æœ€å°‘20ä¸ª ä¸€ä¸ªåŒ…ä¸€ä¸ªåŒ…å‘é€ï¼Œæœ‰è¾¹ç•Œä½†å¯èƒ½ä¸¢åŒ…ä¹±åºï¼›æµå¼ä¼ è¾“ï¼Œæ²¡æœ‰è¾¹ç•Œï¼Œä½†ä¿è¯é¡ºåºå’Œå¯é  TCPä¸ºä»€ä¹ˆå¯é  è¿æ¥ç®¡ç†ï¼ˆä¸‰æ¬¡\u0026amp;å››æ¬¡ï¼‰ åºåˆ—å·ï¼šå¯¹æ¯ä¸ªå­—èŠ‚çš„æ•°æ®éƒ½è¿›è¡Œäº†ç¼–å· ç¡®è®¤åº”ç­” è¶…æ—¶é‡ä¼ ï¼šè¶…æ—¶/ç¡®è®¤åŒ…ä¸¢å¤±éƒ½ä¼šè§¦å‘ æµé‡ã€æ‹¥å¡æ§åˆ¶ï¼šæ ¹æ®æ¥æ”¶ç«¯çš„å¤„ç†èƒ½åŠ›ï¼Œå†³å®šå‘é€ç«¯çš„å‘é€é€Ÿåº¦ / å½“ç½‘ç»œæ‹¥å µä¸¥é‡æ—¶ï¼Œå‘é€ç«¯å‡å°‘æ•°æ®å‘é€ TCPç²˜åŒ…æ€ä¹ˆè§£å†³ é—®é¢˜ï¼šä¸çŸ¥é“ç”¨æˆ·æ¶ˆæ¯çš„è¾¹ç•Œï¼ŒäºŒuå‘æœ‰æ•ˆåˆ’åˆ†ç”¨æˆ·æ¶ˆæ¯ è§£å†³ï¼š å›ºå®šé•¿åº¦çš„æ¶ˆæ¯ ç‰¹æ®Šå­—ç¬¦è¾¹ç•Œ è‡ªå®šä¹‰æ¶ˆæ¯ç»“æ„ï¼šå¯ä»¥è‡ªå®šä¹‰æ¶ˆæ¯ç»“æ„ï¼Œç”±åŒ…å¤´å’Œæ•°æ®ç»„æˆï¼Œå…¶ä¸­åŒ…å¤´å›ºå®šå¤§å°ï¼Œæœ‰å­—æ®µè¯´æ˜æ•°æ®å¤§å° TCPæ‹¥å¡æ§åˆ¶ æ‹¥å¡çª—å£ cwndæ˜¯å‘é€æ–¹ç»´æŠ¤çš„çŠ¶æ€å˜é‡ï¼ˆç­‰äºå‘é€çª—å£ä¸æ¥æ”¶çª—å£çš„æœ€å°å€¼ï¼‰ï¼Œæ ¹æ®ç½‘ç»œæ‹¥å¡ç¨‹åº¦ï¼ˆæœªåŠæ—¶å›å¤ACKï¼Œå‘ç”Ÿè¶…æ—¶é‡ä¼ å³è®¤ä¸ºæ‹¥å¡ï¼‰åŠ¨æ€å˜åŒ– ç®—æ³•ï¼š æ…¢å¯åŠ¨ï¼šå‘é€æ–¹æ¯æ”¶åˆ°ä¸€ä¸ª ACKï¼Œæ‹¥å¡çª—å£ cwnd çš„å¤§å°å°±ä¼šåŠ  1ï¼Œç›´åˆ°æ…¢å¯åŠ¨é—¨é™ssthreshï¼ˆä¸€ä¸ªå˜é‡ï¼‰ï¼Œå¤§å°è¶…è¿‡é—¨é™é‡‡ç”¨æ‹¥å¡é¿å…ç®—æ³•ï¼ˆæŒ‡æ•°å¢é•¿ï¼‰ æ‹¥å¡é¿å…ï¼šæ¯å½“æ”¶åˆ°ä¸€ä¸ª ACK æ—¶ï¼Œcwnd å¢åŠ  1/cwndï¼ˆçº¿æ€§å¢é•¿ï¼‰ æ‹¥å¡å‘ç”Ÿï¼šï¼ˆè§¦å‘é‡ä¼ åï¼‰ï¼ˆè¶…æ—¶é‡ä¼ ï¼‰ssthreshè®¾ä¸ºcwnd/2ï¼Œcwndé‡ç½®ä¸ºåˆå§‹å€¼ å¿«é€Ÿé‡ä¼ ï¼šæ¥æ”¶æ–¹å‘ç°ä¸¢äº†ä¸­é—´åŒ…ï¼Œå‘é€ä¸‰æ¬¡å‰ä¸€ä¸ªåŒ…çš„ACKï¼Œå‘é€ç«¯å¯å¿«é€Ÿé‡ä¼  å¿«é€Ÿæ¢å¤ï¼šï¼ˆè§¦å‘é‡ä¼ åï¼‰ï¼ˆå¿«é€Ÿé‡ä¼ ï¼‰ssthresh = cwnd/2 ï¼Œcwnd = cwnd/2ï¼Œè¿›å…¥å¿«é€Ÿæ¢å¤ï¼ˆcwnd = ssthresh + 3ï¼Œæ”¶åˆ°äº†ä¸‰ä¸ªæ•°æ®åŒ…\u0026ndash;\u0026gt;é‡ä¼ ä¸¢å¤±åŒ…\u0026ndash;\u0026gt;æ”¶åˆ°é‡å¤ACKåˆ™cwndåŠ 1ï¼›æ”¶åˆ°æ–°ACKï¼Œcwnd è®¾ç½®ä¸º ssthreshçš„å€¼ï¼Œç›¸å½“äºè¿›å…¥æ‹¥å¡é¿å…çŠ¶æ€ åœºæ™¯ æ‰“å¼€ç½‘é¡µçš„ç½‘ç»œè¿‡ç¨‹ è§£æURLï¼šåˆ†æéœ€è¦çš„ä¼ è¾“åè®®å’Œè¯·æ±‚çš„èµ„æºè·¯å¾„ï¼ˆä¸åˆæ³•å°†å†…å®¹äº¤ç»™æœç´¢å¼•æ“ï¼‰ ç¼“å­˜åˆ¤æ–­ï¼šæµè§ˆå™¨ç¼“å­˜ â†’ ç³»ç»Ÿç¼“å­˜ï¼ˆhosts æ–‡ä»¶ï¼‰ â†’ è·¯ç”±å™¨ç¼“å­˜ â†’ ISP çš„ DNS ç¼“å­˜ DNSè§£æï¼šåƒæœ¬åœ°DNSæœåŠ¡å™¨å‘é€è¯·æ±‚â€¦ç›´åˆ°è·å¾—IPåœ°å€ è·å–MACåœ°å€ï¼šæ•°æ®é“¾è·¯å±‚éœ€è¦ã€‚å°†IPåœ°å€ä¸å­ç½‘æ©ç ç»“åˆåˆ¤æ–­æ˜¯å¦ä¸è¯·æ±‚ä¸»æœºåœ¨åŒä¸€å­ç½‘ï¼Œåœ¨åŒä¸€å­ç½‘å¯ä»¥ç”¨ARPåè®®è·å–åˆ°ç›®æ ‡ä¸»æœºçš„MACåœ°å€ï¼Œä¸åœ¨åŒä¸€å­ç½‘åˆ™è½¬å‘è‡³ç½‘å…³ç”±å…¶è½¬å‘ï¼ˆé€šè¿‡ ARP åè®®æ¥è·å–ç½‘å…³çš„ MAC åœ°å€ï¼Œæ­¤æ—¶ç›®çš„ä¸»æœºçš„ MAC åœ°å€åº”è¯¥ä¸ºç½‘å…³çš„åœ°å€ï¼‰ å»ºç«‹TCPè¿æ¥ï¼šè·¯ç”±å™¨è½¬å‘SYNåŒ… HTTPSçš„TLSå››æ¬¡æ¡æ‰‹ å‘é€HTTPè¯·æ±‚ æœåŠ¡å™¨å¤„ç†è¯·æ±‚å¹¶è¿”å›å“åº” ç½‘ç«™æ— æ³•æ˜¾ç¤ºæ€ä¹ˆåŠ ç¡®å®šæœåŠ¡ç«¯è¿˜æ˜¯å®¢æˆ·ç«¯é—®é¢˜\u0026ndash;\u0026gt;å®¢æˆ·ç«¯èƒ½å¦ä¸Šç½‘ æŠ“åŒ…ç¡®è®¤DNSæ˜¯å¦è§£æå‡ºIPåœ°å€\u0026ndash;\u0026gt;ç¡®è®¤æ˜¯å¦å»ºç«‹ä¸‰æ¬¡æ¡æ‰‹\u0026ndash;\u0026gt;æŸ¥çœ‹æœåŠ¡ç«¯å“åº”ç ï¼ˆè‹¥4xxåˆ™urlæœ‰é—®é¢˜ï¼Œ5xxåˆ™æœåŠ¡å™¨æœ‰é—®é¢˜ï¼Œ200åˆ™å¯èƒ½å‰ç«¯æœ‰é—®é¢˜ï¼‰ å®¢æˆ·ç«¯ç½‘ç»œæ­£å¸¸ä½†è®¿é—®æ…¢ï¼ŒæŸ¥çœ‹å®¢æˆ·ç«¯ç½‘å£æµé‡ï¼Œå¯èƒ½TCPä¸¢åŒ… æœåŠ¡ç«¯æ­£å¸¸å¯åŠ¨ï¼Œå®¢æˆ·ç«¯è¯·æ±‚ä¸åˆ°ä¸ºä»€ä¹ˆï¼Œæ€ä¹ˆæ’æŸ¥ æ£€æŸ¥IPåœ°å€ï¼šping ç«¯å£å·æ£€æŸ¥ï¼šåœ¨æœ¬æœºTelnetæ¥å£çš„IPå’Œç«¯å£å· æ£€æŸ¥æœåŠ¡å™¨é˜²ç«å¢™ æ£€æŸ¥æ˜¯å¦æœ‰ç½‘ç»œä»£ç† è‹¥æœ‰å“åº”ä½†çŠ¶æ€ç é”™è¯¯ï¼Œ502ã€503ã€504å¯èƒ½å› ä¸ºå¹¶å‘å‹æµ‹äº§ç”Ÿ pingä¸é€šä½†httpæˆåŠŸï¼Œwhy pingæ˜¯icmpåè®®ï¼Œhttpæ˜¯tcpåè®®ï¼Œå¯èƒ½æœåŠ¡å™¨çš„é˜²ç«å¢™ç¦æ­¢icmpåè®® å¦‚ä½•åˆ¤æ–­ä¸¤ä¸ªæœåŠ¡å™¨æ­£å¸¸è¿æ¥ tcpä¿æ´»æœºåˆ¶ï¼Œè¿ç»­å‡ æ¬¡ä¸å“åº”åˆ™è®¤ä¸ºå·²æ­» ç½‘ç»œæ”»å‡» ddosï¼šåˆ†å¸ƒå¼æ‹’ç»æœåŠ¡ sqlæ³¨å…¥ï¼šåº”ç”¨ç¨‹åºç›´æ¥ä½¿ç”¨ç”¨æˆ·æä¾›çš„è¾“å…¥ä½œä¸ºSQLæŸ¥è¯¢çš„ä¸€éƒ¨åˆ† è¾“å…¥éªŒè¯ä¸è½¬ä¹‰ å‚æ•°åŒ–æŸ¥è¯¢ï¼Œå¦‚#{} é™åˆ¶æ•°æ®åº“æƒé™ csrfæ”»å‡»ï¼šè·¨ç«™è¯·æ±‚ä¼ªé€  xssæ”»å‡»ï¼šè·¨ç«™è„šæœ¬æ”»å‡» dnsåŠ«æŒï¼šæ”»å‡»è€…åœ¨ç”¨æˆ·æŸ¥è¯¢DNSæœåŠ¡å™¨æ—¶ç¯¡æ”¹å“åº”ï¼Œå°†è¯·æ±‚åŸŸåæ˜ å°„åˆ°è™šå‡IPåœ°å€ ","permalink":"https://Sattiluvcat.github.io/en/posts/notes/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C--%E8%BF%9B%E5%8C%96%E7%89%88/","summary":"å…«è‚¡\u0026ndash;è®¡ç®—æœºç½‘ç»œ","title":"è®¡ç®—æœºç½‘ç»œ--è¿›åŒ–ç‰ˆ"},{"content":"Â æ•°æ®ç»“æ„ whyæ•°ç»„æŸ¥è¯¢å¤æ‚åº¦O(1) å†…å­˜ä¸­è¿ç»­ç©ºé—´ \u0026amp; å­˜å‚¨ç›¸åŒç±»å‹æ•°æ® = ä¸‹æ ‡å¯ç®— Javaå®ç°æ ˆ å†…ç½®Stackç±»ï¼Œç»§æ‰¿è‡ªVectorï¼Œå¹¶å‘åœºæ™¯å¯èƒ½ä¸å¤Ÿé«˜æ•ˆ æ•°ç»„/é“¾è¡¨å®ç° æ ˆå®ç°é˜Ÿåˆ— ä¸¤ä¸ªæ ˆï¼Œä¸€ä¸ªpushä¸€ä¸ªpopå³å¯ï¼ˆpopæ ˆç©ºæ—¶ï¼Œpushå†…çš„æ‰€æœ‰å…ƒç´ æ’å…¥popæ ˆåå¼¹å‡ºï¼‰ å¹³è¡¡äºŒå‰æ ‘AVL â­äºŒå‰æœç´¢æ ‘ç‰¹æ€§ï¼šä¸­åºéå†ä¼šå¾—åˆ°é€’å¢/å‡åºåˆ—\næ”¹è¿›çš„äºŒå‰æœç´¢æ ‘\u0026ndash;\u0026gt;ç»´æŒæ ‘çš„é«˜åº¦ï¼ˆå¹³è¡¡æ€§ï¼‰é™ä½æ“ä½œå¤æ‚åº¦ï¼ˆé¿å…é€€åŒ–ä¸ºé“¾è¡¨ï¼‰ ç‰¹æ€§ï¼šå·¦å³ä¸¤ä¸ªå­æ ‘é«˜åº¦å·®çš„ç»å¯¹å€¼ä¸è¶…è¿‡1 \u0026amp; å­æ ‘éƒ½æ˜¯å¹³è¡¡äºŒå‰æ ‘ çº¢é»‘æ ‘==\u0026gt;è‡ªå¹³è¡¡äºŒå‰æ ‘ ç‰¹ç‚¹ï¼šrootä¸ºé»‘ï¼Œå¶èŠ‚ç‚¹ä¸ºé»‘ï¼Œä¸€ä¸ªèŠ‚ç‚¹æ˜¯çº¢åˆ™å…¶å­èŠ‚ç‚¹å‡ä¸ºé»‘ï¼Œrootåˆ°å¶å­/nullçš„æ¯æ¡è·¯å¾„é»‘æ•°é‡ç›¸åŒï¼ˆæ’å…¥å…ƒç´ æœ€å¤šè½¬ä¸¤æ¬¡å³å¯å¹³è¡¡ï¼‰ ä¿è¯ï¼šæœ€é•¿è·¯å¾„ä¸è¶…æœ€çŸ­è·¯å¾„2å€ ç”¨é€”ï¼šepollç”¨å…¶ä¿å­˜ç›‘å¬çš„socket B+æ ‘ æ‰€æœ‰å¶å­èŠ‚ç‚¹åœ¨åŒä¸€å±‚ æ’å…¥æ“ä½œï¼šæ”¾åœ¨æœ€å°¾ï¼Œä¸Šæµ®ï¼›åˆ é™¤æ“ä½œï¼šä¸‹æ²‰ï¼ˆç±»ä¼¼å †ï¼‰ å‰ç¼€æ ‘ ç‰¹ç‚¹ï¼šrootæ— å­—ç¬¦ \u0026amp; æ¯ä¸ªèŠ‚ç‚¹çš„å­èŠ‚ç‚¹å­—ç¬¦å„ä¸åŒ \u0026amp; ä»æ ¹èŠ‚ç‚¹åˆ°æŸèŠ‚ç‚¹çš„å­—ç¬¦ä¸²è”å³ä¸ºå¯¹åº”çš„å­—ç¬¦ä¸² æ’åºç®—æ³• æ¦‚è§ˆ æ’å…¥æ’åºï¼šæ’æ’ï¼ˆæœªæ’åºçš„å…ƒç´ ä»å·²æ’åºå…ƒç´ åå‘å‰æ‰¾ä½ç½®æ’å…¥ï¼‰ \u0026amp; å¸Œå°”æ’åº é€‰æ‹©æ’åºï¼šé€‰æ‹©æ’åºï¼ˆä»æœªæ’åºå…ƒç´ ä¸­æ‰¾æœ€å€¼æ”¾åˆ°å·²æ’åºå…ƒç´ é¦–/å°¾ï¼‰\u0026amp; å †æ’ äº¤æ¢æ’åºï¼šå†’æ³¡ï¼ˆä»å‰å‘åç›¸é‚»å…ƒç´ æ¯”è¾ƒå¹¶äº¤æ¢ä½ç½®ï¼‰\u0026amp; å¿«æ’ å½’å¹¶ï¼ˆå°†æ•°ç»„ä¸æ–­åˆ†ä¸ºå°æ•°ç»„ï¼Œæœ€å°æ•°ç»„ä¸­æ¯”è¾ƒå¹¶äº¤æ¢ï¼Œæ”¾è¿›æ›´å¤§æ•°ç»„æ¯”è¾ƒå¹¶äº¤æ¢ï¼‰ åŸºæ•°æ’åºï¼ˆä»ä½ä½åˆ°é«˜ä½ï¼ŒæŒ‰ä½ä¸Šçš„æ•°å­—å¤§å°æŠŠå…ƒç´ æ”¾åˆ°ä¸åŒæ¡¶ä¸­\u0026ndash;\u0026gt;å–å‡ºåæŒ‰é«˜ä¸€ä½çš„å¤§å°å†æ”¾å…¥ï¼‰ å¤æ‚åº¦ï¼š æ’åºç¨³å®šæ€§æ˜¯ä»€ä¹ˆ å¤šä¸ªå…·æœ‰ç›¸åŒå…³é”®å­—çš„å…ƒç´ å†æ’åºå‰åç›¸å¯¹é¡ºåºä¸å˜ å¿«æ’æ—¶é—´å¤æ‚åº¦æœ€å·®æ˜¯ O(n^2)ï¼Œæ¯æ¬¡åŸºå‡†å…ƒç´ éƒ½æ˜¯æœ€å€¼å…ƒç´ ï¼Œæ•°ç»„æ— æ³•å‡åŒ€åœ°å˜æˆä¸¤éƒ¨åˆ†\u0026ndash;\u0026gt;ä¸€èˆ¬æ˜¯å‡åŒ€æœ‰åºæƒ…å†µ æœ‰å¿«æ’ä¸ºä»€ä¹ˆè¿˜è¦å†’æ³¡ é€‚åˆåŸºæœ¬æ’åºçš„æ•°ç»„ \u0026amp; ç¨³å®š \u0026amp; åŸåœ°æ’åº top-Ké—®é¢˜ Kå¾ˆå°==\u0026gt;æœ€å°/å¤§å †ï¼Œç»´æŠ¤å¤§å°ä¸ºKçš„å †ï¼ˆå°äºKæ—¶å»ºå †ï¼Œä¹‹åå‘æ•°ç»„åéå†æŸ¥çœ‹æ˜¯å¦éœ€è¦è°ƒæ•´å †ï¼‰ Kå¾ˆå¤§==\u0026gt;å¿«é€Ÿé€‰æ‹©ï¼Œå¿«æ’çš„å˜ç§ï¼ˆåŸºå‡†å…ƒç´ å®šä½åï¼ŒæŸ¥çœ‹å…¶ä¸Kçš„å¤§å°å…³ç³»ï¼‰ æ’åº å¾ˆå¤§çš„æ•°æ®é›†ï¼Œæ— æ³•ä¸€æ¬¡æ€§åœ¨å†…å­˜ä¸­æ’åºï¼Œæ€ä¹ˆåŠ éƒ¨åˆ†æ’åºï¼šåˆ’åˆ†ä¸ºä¸åŒéƒ¨åˆ†ï¼Œæ¯ä¸€éƒ¨åˆ†å¯ä»¥ç”¨å¿«æ’ å½’å¹¶ï¼šï¼ˆä¸ºäº†å‡å°‘IOï¼‰è´¥è€…æ ‘è§£å†³å¤šè·¯å¤–éƒ¨å½’å¹¶é—®é¢˜ è´¥è€…æ ‘ï¼šæ–°çš„é€‰æ‰‹éœ€è¦å’Œçˆ¶èŠ‚ç‚¹é‡Œçš„é€‰æ‰‹æ¯”èµ›ï¼Œè´¥è€…è¢«å­˜å…¥çˆ¶èŠ‚ç‚¹ï¼Œè€Œèƒœè€…ä¸ä¸Šä¸€çº§çˆ¶èŠ‚ç‚¹ï¼ˆèƒœè€…/è´¥è€…çš„çˆ¶èŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹ï¼‰é‡Œçš„é€‰æ‰‹ç»§ç»­æ¯”èµ›==\u0026gt;åˆå§‹å»ºå®Œæ ‘åï¼Œæ¯æ¬¡æ‰¾åˆ°å† å†›çš„æ—¶é—´å¤æ‚åº¦ä¸º O(logN) ","permalink":"https://Sattiluvcat.github.io/en/posts/notes/%E5%85%AB%E8%82%A1--%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/","summary":"æ•°æ®ç»“æ„ã€ç®—æ³•çš„çŸ¥è¯†æ€§å†…å®¹","title":"å…«è‚¡--æ•°æ®ç»“æ„"},{"content":"Â æ–‡å­—å†…å®¹æ€»ç»“è‡ªJavaGuide å‰æ docker éœ€è¦linuxç³»ç»Ÿè¿è¡Œï¼Œé‡‡ç”¨ubuntu24.04\nå®‰è£…åç›´æ¥åœ¨ç»ˆç«¯é€šè¿‡docker pull:balba versionæ‹‰å–è½¯ä»¶ï¼Œé€šè¿‡docker run -d --name åå­— -p ç«¯å£ balbal åå­—:ç‰ˆæœ¬ ç›¸äº’é€šä¿¡ï¼šåˆ›å»ºç½‘ç»œdocker network create åå­— Nacos è¿›å…¥binæ–‡ä»¶å¤¹ï¼Œcmdè¾“å…¥startup.cmd -m standaloneè¿è¡Œ\næ³¨å†Œä¸­å¿ƒï¼šmysqlè¡¨æ³¨å†Œnacosåå¯åŠ¨\u0026ndash;\u0026gt;é¡¹ç›®ä¸­å¼•å…¥Nacoså®ä¾‹\u0026amp;é…ç½®Nacosåœ°å€\u0026ndash;\u0026gt;åœ¨é…ç½®æ–‡ä»¶ä¸­é…ç½®ç«¯å£åå³å¯å¯ç”¨ä¸åŒç«¯å£å¯¹åº”çš„å¾®æœåŠ¡ç»„ä»¶ ElasticSearch å­˜å‚¨ã€æœç´¢æ•°æ®ï¼Œä¸»è¦è§£å†³æ¨¡ç³Šæœç´¢çš„æ€§èƒ½é—®é¢˜ï¼ŒKibana\u0026ndash;\u0026gt;å¯è§†åŒ–å¹³å°ï¼Œå¯ä»¥å‘ESå‘è¯·æ±‚ åŸºäºLuceneå¼€å‘\u0026ndash;\u0026gt;å¤æ‚\u0026amp;æ— åˆ†å¸ƒå¼ã€é«˜å¯ç”¨\nåè¯ä¸è§£é‡Š åè¯ï¼š indexç´¢å¼•==\u0026gt;æ–‡æ¡£çš„é›†åˆ==\u0026gt;Table in SQL replicaå‰¯æœ¬==\u0026gt;indexå‰¯æœ¬ï¼Œæ¯ä¸ªindexæœ‰ä¸€ä¸ª/å¤šä¸ªå‰¯æœ¬ documentæ–‡æ¡£==\u0026gt;æ¯æ¡æ•°æ®==\u0026gt;Row in SQL ä¼˜åŠ¿ï¼šè‡ªç”±åº¦é«˜ï¼ˆå¯å¢åˆ å­—æ®µï¼Œå¤šä¸ªæ–‡æ¡£ä¸è¦æ±‚å­—æ®µä¸€è‡´ï¼‰\u0026amp; JSONå­˜å‚¨ï¼ˆéƒ¨åˆ†ç»“æ„åŒ–ï¼‰æ›´å¥½æ”¯æŒå¤æ‚æŸ¥è¯¢ \u0026amp; å±‚æ¬¡åŒ–ç»“æ„ï¼ˆå¯åµŒå¥—å­æ–‡æ¡£ï¼‰ typeå­—æ®µç±»å‹==\u0026gt;åˆ— in SQLï¼ˆ8.0åè¢«ç§»é™¤ï¼‰ Mappingæ˜ å°„==\u0026gt;æ–‡æ¡£çš„çº¦æŸ==\u0026gt;è¡¨ç»“æ„Schema in SQL DSL==\u0026gt;JSONé£æ ¼çš„è¯·æ±‚è¯­å¥==\u0026gt;SQL in SQL è¯æ¡==\u0026gt;æ–‡æ¡£æŒ‰è¯­ä¹‰åˆ†æˆçš„è¯è¯­ NodeèŠ‚ç‚¹==\u0026gt;å®ä¾‹ï¼Œå¤šä¸ªèŠ‚ç‚¹æ„æˆé›†ç¾¤Cluster ä¸ºä»€ä¹ˆESï¼Œä¸ç”¨Mysql åŠ£åŠ¿ï¼šæ¨¡ç³ŠåŒ¹é…å¯èƒ½å…¨è¡¨æ‰«æ \u0026amp; MySQLå…¨æ–‡ç´¢å¼•åªæ”¯æŒCHARã€VARCHARã€TEXTï¼Œä¸æ”¯æŒåˆ†è¯å™¨ ä¼˜åŠ¿ï¼šå¤šç§æ•°æ®ç±»å‹å…¼å®¹ \u0026amp; RESTful APIï¼Œå…¼å®¹å¤šè¯­è¨€å¼€å‘ \u0026amp; åˆ†è¯å™¨ \u0026amp; è¿‘å®æ—¶æŸ¥è¯¢ \u0026amp; æ”¯æŒç›¸å…³æ€§æœç´¢ï¼Œå¯æ ¹æ®æ¡ä»¶å¯¹ç»“æœæ‰“åˆ† å€’æ’ç´¢å¼• å€’æ’ç´¢å¼•ï¼šæ–‡æ¡£å†…å®¹åˆ†è¯\u0026ndash;\u0026gt;ï¼ˆè¯è¯­å’Œæ–‡æ¡£å»ºç«‹å…³è”ï¼‰å¯¹è¯æ¡åˆ›å»ºç´¢å¼•å¹¶è®°å½•æ–‡æ¡£id\u0026ndash;\u0026gt;æŸ¥è¯¢æ—¶æ ¹æ®è¯æ¡æŸ¥idï¼Œåæ ¹æ®idæŸ¥æ–‡æ¡£ ç©ºé—´æ¶ˆè€—è¾ƒå¤§ å¯ä»¥é’ˆå¯¹æŸäº›å­—æ®µä¸åšç´¢å¼• å€’æ’ç´¢å¼•åˆ›å»ºæµç¨‹ å»ºç«‹æ–‡æ¡£åˆ—è¡¨ï¼Œæœ‰å”¯ä¸€çš„æ–‡æ¡£ID\u0026ndash;\u0026gt;åˆ†è¯ï¼Œç”Ÿæˆç±»ä¼¼\u0026lt;è¯è¯­ï¼Œæ–‡æ¡£ID\u0026gt;çš„æ•°æ®\u0026ndash;\u0026gt;è¯è¯­ä½œä¸ºç´¢å¼•å…³é”®å­— Luceneç´¢å¼•å®ç°ç»†èŠ‚ï¼š å€’æ’ç´¢å¼•çš„ç»„æˆ å•è¯å­—å…¸\u0026ndash;\u0026gt;å­˜å‚¨å•è¯åˆ—è¡¨ï¼Œä¸€èˆ¬B+æ ‘/Hashæ‹‰é“¾æ³• å€’æ’åˆ—è¡¨\u0026ndash;\u0026gt;æ–‡æ¡£é›†åˆã€‚åŒ…æ‹¬DocID \u0026amp; TFï¼ˆè¯é¢‘ï¼‰ \u0026amp; Positionï¼ˆå•è¯åœ¨æ–‡æ¡£ä¸­å‡ºç°ä½ç½®ï¼‰ \u0026amp; Offsetï¼ˆåç§»é‡ï¼Œå•è¯å¼€å§‹ç»“æŸä½ç½®ï¼‰ æ­£æ’ä¸å€’æ’çš„åŒºåˆ«ï¼š æ­£æ’ç´¢å¼•æ˜¯å°†æ–‡æ¡£IDä¸åˆ†è¯å»ºç«‹å…³è”ï¼ˆæ–‡æ¡£æŒ‡å‘è¯è¯­åˆ—è¡¨ï¼‰\næ­£æ’ï¼šç»´æŠ¤æˆæœ¬ä½ï¼ˆæ–°å¢æ•°æ®åªéœ€æœ«å°¾å¢åŠ IDï¼‰but æŸ¥è¯¢æ•ˆç‡ä½ å€’æ’ï¼šæŸ¥è¯¢æ•ˆç‡é«˜ but å»ºç«‹ç´¢å¼•æˆæœ¬é«˜ï¼Œç»´æŠ¤éº»çƒ¦ åˆ†è¯å™¨ åˆ†ç±» éä¸­æ–‡ï¼šstandard Analyzerè‹±æ–‡è½¬å°å†™ï¼Œä¸­æ–‡å•å­—åˆ‡åˆ† \u0026amp; ç®€å•åˆ†è¯å™¨ï¼ˆéå­—æ¯å­—ç¬¦åˆ†å‰²é—®åˆ«äººä½ ï¼Œéè‹±æ–‡ä¸åˆ†è¯ï¼‰ ä¸­æ–‡ï¼šIK Analyzer==\u0026gt;ç»†ç²’åº¦åˆ‡åˆ†ä¸æ™ºèƒ½æ¨¡å¼ï¼ˆæœ€ç²—ç²’åº¦ï¼Œå·²åˆ†è¯è¯­ä¸ä¼šè¢«å…¶å®ƒè¯è¯­å æœ‰ï¼‰ elseï¼šæ‹¼éŸ³åˆ†è¯å™¨ï¼Œæ”¯æŒæŒ‰æ‹¼éŸ³æœç´¢ ç»„æˆ Character Filters å¤„ç†åŸå§‹æ–‡æœ¬ï¼ˆeg.é™¤htmlæ ‡ç­¾ï¼‰ Tokenizer æŒ‰åˆ†è¯å™¨è§„åˆ™åˆ‡åˆ†å•è¯ Token Filters å•è¯å†åŠ å·¥ æ•°æ®ç±»å‹ å¸¸è§ å…³é”®è¯ï¼škeyword / constant_keyword / wildcard æ•°å€¼å‹ï¼šlong / integer / short / byte \u0026hellip; å¸ƒå°”å‹ï¼šboolean \u0026amp; æ—¥æœŸå‹ï¼šdate / date_nanos \u0026amp; äºŒè¿›åˆ¶ï¼šbinary ç»“æ„åŒ–æ•°æ®ç±»å‹ èŒƒå›´å‹ï¼šinteger_range / float_range\u0026hellip; ipåœ°å€ï¼šip è½¯ä»¶ç‰ˆæœ¬ï¼šversion æ–‡å­—æœç´¢ç±»å‹ éç»“æ„åŒ–æ–‡æœ¬ï¼štext â€¦ å¯¹è±¡å’Œå…³ç³»ç±»å‹ï¼ˆnestedã€joinï¼‰ã€ç©ºé—´ç±»å‹ keywordå’Œtextæœ‰ä»€ä¹ˆåŒºåˆ« keywordä¸èµ°åˆ†è¯å™¨ï¼ŒæŸ¥è¯¢æ•ˆç‡æ›´é«˜ æ•°ç»„ç±»å‹ï¼Ÿ æ— æ•°ç»„ç±»å‹ï¼Œä»»ä½•å­—æ®µå¯ä»¥åŒ…æ‹¬0ä¸ªã€å¤šä¸ªå€¼ Nestedæ˜¯ä»€ä¹ˆ æ€ä¹ˆç”¨ é¿å…æ•°ç»„è¢«æ‰å¹³åŒ–å¤„ç†\u0026ndash;\u0026gt;å¤šä¸ªæ•°ç»„å­—æ®µä¼šåšç¬›å¡å°”ç§¯ï¼Œä¼šæŸ¥è¯¢å‡ºä¸å­˜åœ¨çš„æ•°æ® eg.å­˜first:Alice \u0026amp; last:White å­˜first:Jonh last:Smithï¼ŒæŸ¥Alice Smithä¼šè¿”å›ä»¥ä¸Šä¸¤ä¸ªç»“æœï¼ˆç”¨nestedå³å¯è§£å†³ï¼‰ åˆå¹¶å­—æ®µå€¼ copy_toï¼Œå°†å¤šä¸ªå­—æ®µå€¼copyåˆ°ä¸€ä¸ªå­—æ®µä¸­ Mapping ä¸èƒ½å†mappingä¸­ç›´æ¥ä¿®æ”¹å­—æ®µç±»å‹ï¼ˆåªèƒ½å¢åŠ ï¼‰\nMappingå±æ€§ type==\u0026gt;å­—æ®µæ•°æ®ç±»å‹ å­—ç¬¦ä¸²textï¼ˆå¯åˆ†è¯ï¼‰ \u0026amp; keywordï¼ˆç²¾ç¡®å€¼ï¼‰ æ•°å€¼ç±»å‹\u0026amp;boolean == Javaç±»å‹ æ—¥æœŸdate å¯¹è±¡object index==\u0026gt;æ˜¯å¦åˆ›å»ºç´¢å¼•ï¼Œé»˜è®¤ä¸ºtrue analyzer==\u0026gt;ä½¿ç”¨ä»€ä¹ˆåˆ†è¯å™¨ï¼ˆonly for textï¼‰ properties==\u0026gt;å­å­—æ®µ åˆ†ç±»ï¼šåŠ¨æ€mapping \u0026amp; æ˜¾å¼mappingï¼ˆæ‰‹åŠ¨å®šä¹‰ï¼‰ æ’å…¥æ•°æ®æ— éœ€æŒ‡å®šï¼Œè‹¥ç´¢å¼•ä¸å­˜åœ¨ï¼ŒESè‡ªåŠ¨æ ¹æ®æ•°æ®ç±»å‹æ¨æ–­mappingä¿¡æ¯ è‡ªå®šä¹‰mapping åˆ›å»ºä¸´æ—¶indexï¼Œæ’å…¥ä¸´æ—¶æ•°æ® è®¿é—®mapping apiï¼Œè·å–mappingå®šä¹‰ ä¿®æ”¹ï¼Œå¯æ·»åŠ keywordã€nestedç­‰ åˆ é™¤ä¸´æ—¶index åŠ¨æ€mappingæœ‰å‡ ç§å±æ€§é…ç½®ï¼ˆå…³äºæ–°å­—æ®µï¼‰ trueï¼ˆé»˜è®¤ï¼‰æ–°å­—æ®µæ·»åŠ åˆ°æ˜ å°„ä¸­ runtime ä½œä¸ºè¿è¡Œæ—¶å­—æ®µæ·»åŠ ï¼Œæœªç¼–å…¥ç´¢å¼• false æ–°å­—æ®µè¢«å¿½ç•¥ strict æ£€æµ‹åˆ°æ–°å­—æ®µåˆ™æ–­æŠ›å‡ºå¼‚å¸¸å¹¶æ‹’ç»æ–‡æ¡£ï¼Œå¿…é¡»è¢«æ˜¾å¼æ·»åŠ  åŠ¨æ€mappingå¦‚ä½•é˜²æ­¢å­—æ®µæ— é™åˆ¶å¢åŠ  å¤ªå¤šå­—æ®µä¼šå¯¼è‡´æ˜ å°„çˆ†ç‚¸\u0026ndash;\u0026gt;æ˜ å°„é™åˆ¶è®¾ç½®ï¼ˆé™åˆ¶å­—æ®µæœ€å¤§æ•°é‡ã€æ·±åº¦ç­‰ï¼‰ æ€ä¹ˆè®©å­—æ®µä¸è¢«ç´¢å¼• è®¾ç½®index=falseï¼Œç»“æœè¿˜ä¼šåŒ…å«è¯¥å­—æ®µ æ§åˆ¶å€’æ’ç´¢å¼•è®°å½•å†…å®¹ï¼šindex_optionsï¼ˆè®¾ç½®åˆ°ä¸Šå±‚åˆ™åŒ…æ‹¬ä¸‹å±‚ï¼Œå¦‚è®¾ç½®docsåªåŒ…æ‹¬docIDï¼Œè®¾ç½®offsetsåˆ™éƒ½åŒ…å«ï¼‰ æŸ¥è¯¢ æŸ¥è¯¢æ–¹æ³• è¯·æ±‚ä½“DSLï¼šGET /ç´¢å¼•â€¦/_searchï¼ŒåŒ…æ‹¬å¶å­æŸ¥è¯¢ï¼ˆæŒ‡å®šæ¡ä»¶ã€å­—æ®µï¼‰ä¸å¤åˆæŸ¥è¯¢ è¯·æ±‚URIï¼šGET /users/\\search?q=\\*\u0026amp;sort=age:asc\u0026amp;pretty ç±»ä¼¼SQLæ£€ç´¢ termæŸ¥è¯¢ä¸å…¨æ–‡æ£€ç´¢çš„åŒºåˆ« termæŸ¥è¯¢ï¼šä¸åšåˆ†è¯å¤„ç†ï¼Œç²¾ç¡®åŒ¹é…æ‰æœåˆ°ï¼Œç”¨äºéæ–‡æœ¬å­—æ®µæŸ¥è¯¢ å…¨æ–‡æ£€ç´¢ï¼šç”¨äºæ–‡æœ¬æŸ¥è¯¢ï¼Œè°ƒç”¨åˆ†è¯å™¨ï¼ˆé€ä¸ªæŸ¥è¯¢åˆ†è¯é¡¹\u0026ndash;\u0026gt;æ±‡æ€»å¾—åˆ†ï¼‰ èŒƒå›´æŸ¥è¯¢ rangeï¼Œgt/lt==\u0026gt;å¤§äºã€å°äº match\u0026amp;match_phraseçš„åŒºåˆ« matché»˜è®¤å¤šæ£€ç´¢è¯ä¹‹é—´ä¸ºorå…³ç³»ï¼Œå¯ç”¨operatoræ”¹ä¸ºand match_phraseé»˜è®¤ä¸ºandå…³ç³» multi_matchæœ‰å“ªå‡ ç§åŒ¹é…ç­–ç•¥ å•æ¡ä»¶å¤šå­—æ®µæŸ¥è¯¢\nbest_fieldsé»˜è®¤ï¼Œç»“æœåŒ…å«ä»»ä¸€æŸ¥è¯¢æ¡ä»¶ï¼Œæœ€ç»ˆå¾—åˆ†ä¸ºæœ€ä½³åŒ¹é…å­—æ®µå¾—åˆ† most_fieldsç»“æœåŒ…å«ä»»ä¸€æŸ¥è¯¢æ¡ä»¶ï¼Œæœ€ç»ˆå¾—åˆ†ä¸ºåˆå¹¶æ‰€æœ‰åŒ¹é…å­—æ®µå¾—åˆ†ï¼Œé»˜è®¤orè¿æ¥ cross_fieldsä¸ºandè¿æ¥ï¼Œæ•´åˆå¤šå­—æ®µä¸ºä¸€ä¸ªå­—æ®µ boolæŸ¥è¯¢æœ‰å‡ ç§æŸ¥è¯¢å­å¥ mustå¿…é¡»åŒ¹é…/shouldåŒ¹é…å…¶å­å¥æŸ¥è¯¢çš„ä¸€ä¸ªæˆ–å¤šä¸ª/must_notå¿…ä¸åŒ¹é…/filterå¿…åŒ¹é…è¿‡æ»¤æ¡ä»¶ï¼Œä½†ä¸ç®—å¾—åˆ† å¦‚ä½•åˆ†é¡µ from+sizeèµ·å§‹åç§»é‡+æ¯é¡µè®°å½•æ•°==\u0026gt;limit+offset in SQL ä¸é€‚åˆæ·±åº¦åˆ†é¡µ scrollï¼Œå¤„ç†å¤§é‡æ•°æ®ï¼Œåˆ†é¡µä¸­ä¿æŒæ•°æ®ä¸€è‡´æ€§ï¼Œé€‚åˆéå†å¤§é‡æ•°æ®åœºæ™¯ ä¸é€‚åˆå®æ—¶åˆ†é¡µ\u0026ndash;\u0026gt;ç›¸å½“äºåˆ›å»ºå¿«ç…§ï¼ˆæ— æ³•æ›´æ–°ï¼‰ \u0026amp; åœ¨æœåŠ¡å™¨ç»´æŒæŸ¥è¯¢ä¸Šä¸‹æ–‡ï¼Œå¹¶å‘è¯·æ±‚å ç”¨èµ„æº sort+search_sfterï¼ˆæ¨èï¼‰æ’åºï¼ˆå»ºè®®å¢åŠ å”¯ä¸€æ ‡è¯†ç¬¦_idï¼‰+å®šä½ä¸‹ä¸€é¡µ é¿å…æ·±åº¦åˆ†é¡µæ€§èƒ½é—®é¢˜\u0026ndash;\u0026gt;ä¸éœ€å­˜å‚¨ä¸­é—´ç»“æœ èµ„æºå ç”¨å°‘\u0026ndash;\u0026gt;åªè®°å½•ä¸Šä¸€é¡µæœ€åæ•°æ®çš„æ’åºå€¼ ç¨³å®šç»“æœ\u0026ndash;\u0026gt;åŸºäºæ’åºå€¼å®šä½ä¸‹ä¸€é¡µæ•°æ®ï¼Œæ›´æ–°ååˆ†é¡µç»“æœé¡ºåºä¹Ÿç¨³å®š åŒæ­¥ç­–ç•¥ ES \u0026amp; MySQL å…¨é‡åŒæ­¥ï¼šå»ºå¥½ESç´¢å¼•åå¯¼å…¥MySQLæ•°æ®\u0026ndash;\u0026gt;æ’ä»¶å¦‚go-mysql-elasticsearch å¢é‡åŒæ­¥ åŒæ­¥åŒå†™ï¼šä¿®æ”¹æ—¶åŒæ­¥åˆ°ESï¼Œæ€§èƒ½å·®ï¼Œä¸¢æ•°æ®é£é™©å¤§ å¼‚æ­¥åŒå†™ï¼šMQå¼‚æ­¥å†™å…¥ å®šæ—¶å™¨ï¼šå®šæ—¶åŒæ­¥æ•°æ®ï¼Œæ—¶æ•ˆæ€§å·® binlogåŒæ­¥ç»„ä»¶ï¼šCanalï¼ˆä¼ªè£…ä¸ºMySQLä»èŠ‚ç‚¹ï¼‰æ¥æ”¶MySQLï¼ˆä¸»èŠ‚ç‚¹ï¼‰çš„binlogæ—¥å¿—ï¼ˆè§£æåï¼‰è¿›è¡ŒåŒæ­¥ é›†ç¾¤ ä»€ä¹ˆæ˜¯ESé›†ç¾¤ å¤šä¸ªESèŠ‚ç‚¹çš„é›†åˆï¼Œä¿è¯é«˜å¯ç”¨æ€§ï¼Œæ¨ªå‘æ‰©å±•æ–¹ä¾¿ï¼ˆèŠ‚ç‚¹å¢åˆ æ—¶ä¼šé‡æ–°å¹³å‡åˆ†å¸ƒæ‰€æœ‰æ•°æ®ï¼‰ ESé›†ç¾¤ä¸­çš„èŠ‚ç‚¹è§’è‰² ES7.9ï¼ŒèŠ‚ç‚¹ç±»å‹å‡çº§ä¸ºèŠ‚ç‚¹è§’è‰²ï¼Œä¸€ä¸ªèŠ‚ç‚¹å¯ä»¥æœ‰å¤šä¸ªè§’è‰² è§’è‰²ï¼š ä¸»èŠ‚ç‚¹ï¼šé›†ç¾¤ç®¡ç†ï¼ˆå¢åˆ ç´¢å¼•ã€è·Ÿè¸ªèŠ‚ç‚¹â€¦ï¼‰ã€‚åŒ…æ‹¬ä¸“ç”¨å¤‡é€‰ä¸»èŠ‚ç‚¹ \u0026amp; ä»…æŠ•ç¥¨ä¸»èŠ‚ç‚¹ æ•°æ®èŠ‚ç‚¹ï¼šæ•°æ®å­˜å‚¨ä¸å¤„ç† é¢„å¤„ç†èŠ‚ç‚¹ï¼šå¤„ç†ç”±é¢„å¤„ç†ç®¡é“ç»„æˆçš„é¢„å¤„ç†ä»»åŠ¡ ä»…åè°ƒèŠ‚ç‚¹ï¼šè·¯ç”±åˆ†å‘è¯·æ±‚ã€èšé›†æœç´¢ç­‰ â€¦â€¦ åˆ†ç‰‡ ç´¢å¼•è¢«åˆ†ä¸ºå¤šä¸ªæ–‡æ¡£ç¢ç‰‡å­˜å‚¨åœ¨åˆ†ç‰‡ä¸­ï¼Œåˆ†ç‰‡è¢«åˆ†é…åˆ°é›†ç¾¤çš„å„ä¸ªèŠ‚ç‚¹ é›†ç¾¤æ ¸å¿ƒ==\u0026gt;å¯¹åˆ†ç‰‡æ‰§è¡Œåˆ†å¸ƒå­˜å‚¨ã€ç´¢å¼•ã€è´Ÿè½½ã€è·¯ç”±å·¥ä½œ å‰¯æœ¬åˆ†ç‰‡ä¸ä¸»åˆ†ç‰‡==\u0026gt;è¯»å†™åˆ†ç¦»ï¼ˆåªèƒ½å†™åœ¨ä¸»åˆ†ç‰‡ï¼Œä¹‹ååŒæ­¥ \u0026amp; ä¸»èŠ‚ç‚¹æœ‰é—®é¢˜ï¼Œå‰¯æœ¬åˆ†ç‰‡å‡çº§ä¸ºä¸»èŠ‚ç‚¹ï¼‰ æ€ä¹ˆæ‰¾åˆ°å¯¹åº”åˆ†ç‰‡ ä»…åè°ƒèŠ‚ç‚¹æ ¹æ®è·¯ç”±å…¬å¼ï¼ˆhashåå–æ¨¡ï¼‰æ‰¾åˆ°åˆ†ç‰‡ é»˜è®¤åˆ†ç‰‡ 7.xä¹‹å‰ä¸»åˆ†ç‰‡5ä¸ªï¼Œæ¯ä¸ªæœ‰ä¸€ä¸ªå‰¯æœ¬åˆ†ç‰‡ï¼›ä¹‹åä¸»åˆ†ç‰‡1ä¸ªï¼Œå‰¯æœ¬åˆ†ç‰‡1ä¸ª æ ¹æ®å®é™…è¯»å†™æƒ…å†µå®šä¹‰åˆ†ç‰‡æ•°é‡ è‡ªå®šä¹‰è·¯ç”±è§„åˆ™ é»˜è®¤è§„åˆ™ä¿è¯æ•°æ®å‡åŒ€åœ°åˆ†ä¸åˆ°æ¯ä¸ªåˆ†ç‰‡==\u0026gt;æ¯æ¬¡æŸ¥è¯¢ç´¢å¼•ç»“æœéœ€è¦å‘å¤šä¸ªåˆ†ç‰‡å‘é€è¯·æ±‚åèåˆç»“æœ å¯ä»¥é€šè¿‡routingå®šä¹‰æ˜ å°„è§„åˆ™ æŸ¥çœ‹ESé›†ç¾¤å¥åº·çŠ¶æ€ GET /_cluster/healthï¼Œè¿”å›å€¼ä¸­æœ‰statusï¼ˆgreenå¥åº·/yellowé¢„è­¦ï¼Œå­˜åœ¨å‰¯æœ¬åˆ†ç‰‡ä¸å¯ç”¨/redå­˜åœ¨ä¸å¯ç”¨ä¸»åˆ†ç‰‡ å¦‚ä½•åˆ†æé›†ç¾¤å¼‚å¸¸é—®é¢˜ å®šä½å¼‚å¸¸ç´¢å¼•ï¼šGET /_cat/indeices?v\u0026amp;health=yellowç­‰ æŸ¥çœ‹è¯¦ç»†ä¿¡æ¯ï¼šGET /_cluster/allocation/explain æ€§èƒ½ä¼˜åŒ– ç´¢å¼•ä¼˜åŒ–ç­–ç•¥ æ‰¹é‡æ“ä½œï¼Œè¯·æ±‚ä¸è¦å¤ªå¤§ï¼ˆå†…å­˜ä½¿ç”¨å¤§ï¼‰ å»¶è¿Ÿå†™å…¥ï¼šå…ˆå†™å†…å­˜ï¼Œåå°†segmentåˆ·æ–°åˆ°ç£ç›˜ï¼ˆé»˜è®¤1såï¼‰ï¼Œæ‰èƒ½æœç´¢åˆ° åŠ å¤§Flushï¼ˆä½œç”¨æ˜¯æŒä¹…åŒ–ï¼‰ï¼šåŠ å¤§æŒä¹…åŒ–åˆ°ç£ç›˜çš„ç¼“å­˜æ•°æ®é‡/æ—¶é—´é˜ˆå€¼ åˆç†é…ç½®indexï¼Œæ§åˆ¶åˆ†è¯/ä¸åˆ†è¯ åŠ å¤§æ´»è·ƒåˆ†ç‰‡å…±äº«çš„å†…å­˜åŒºindex_buffer_size æŸ¥è¯¢ä¼˜åŒ–ç­–ç•¥ å»ºç«‹å†·çƒ­ç´¢å¼•åº“ï¼šçƒ­è£¤æ•°æ®æå‰é¢„çƒ­åŠ è½½åˆ°å†…å­˜ è‡ªå®šä¹‰è·¯ç”±è§„åˆ™ ä½¿ç”¨keywordä¸èµ°åˆ†è¯å™¨ å¼€å¯æ…¢æŸ¥è¯¢é…ç½® é¿å…åˆ†é¡µè¿‡æ·± å¢åŠ å‰¯æœ¬åˆ†ç‰‡æé«˜æŸ¥è¯¢ååé‡ï¼Œé¿å…ä½¿ç”¨é€šé…ç¬¦ æ“ä½œ ç‰¹ç‚¹ï¼šæ‰€æœ‰APIéƒ½æ˜¯Restfulæ¥å£ï¼Œéµå¾ªå…¶è§„èŒƒ è¯·æ±‚æ–¹å¼ï¼šæŸ¥GETï¼Œ æ–°å¢POSTï¼Œ ä¿®æ”¹PUTï¼Œ åˆ é™¤DELETE è·¯å¾„ï¼š/userï¼Œ /user/{id} Kafka Sentinel æ¦‚å¿µ é›ªå´©ï¼šå¾®æœåŠ¡è°ƒç”¨é“¾è·¯ä¸­æŸæœåŠ¡å‡ºç°æ•…éšœå¯¼è‡´æ‰€æœ‰å¾®æœåŠ¡éƒ½ä¸å¯ç”¨ è§£å†³æ–¹æ¡ˆï¼š è¶…æ—¶å¤„ç†ï¼šè¶…è¿‡æ—¶é—´æ²¡æœ‰å“åº”åˆ™è¿”å›é”™è¯¯ä¿¡æ¯\u0026ndash;\u0026gt;åªèƒ½ç¼“è§£ï¼Œå“åº”è·Ÿä¸ä¸Šå¾…å¤„ç†çš„é€Ÿåº¦ èˆ±å£æ¨¡å¼ï¼šé™å®šæ¯ä¸ªä¸šåŠ¡èƒ½ä½¿ç”¨çš„çº¿ç¨‹æ•°ï¼Œé¿å…è€—å°½tomcatèµ„æº==\u0026gt;çº¿ç¨‹éš”ç¦» å¼‚å¸¸æœåŠ¡å¯¹åº”çš„çº¿ç¨‹è¢«é˜»å¡ï¼Œä½†æ–°æ¥çš„ä¸šåŠ¡è¿˜æ˜¯ä¼šè®¿é—®å¼‚å¸¸æœåŠ¡ ç†”æ–­é™çº§ï¼šæ–­è·¯å™¨ç»Ÿè®¡ä¸šåŠ¡æ‰§è¡Œçš„å¼‚å¸¸æ¯”ä¾‹ï¼Œè¶…å‡ºé˜ˆå€¼åˆ™ç†”æ–­ä¸šåŠ¡ï¼Œæ‹¦æˆªè®¿é—®å…¶çš„æ‰€æœ‰è¯·æ±‚ï¼ŒæœåŠ¡æ¢å¤åæ”¾è¡Œ æµé‡æ§åˆ¶ï¼šé™åˆ¶QPSï¼Œé¿å…å› æµé‡çš„çªå¢é€ æˆæ•…éšœ\u0026ndash;\u0026gt;é¢„é˜²æ•…éšœ æœåŠ¡ä¿æŠ¤æŠ€æœ¯ï¼šSentinel \u0026amp; Hystrix éš”ç¦»ç­–ç•¥ï¼šä¿¡å·é‡éš”ç¦» vs çº¿ç¨‹æ± ï¼ˆé»˜è®¤ï¼‰/ä¿¡å·é‡éš”ç¦» ç†”æ–­é™çº§ï¼šåŸºäºæ…¢è°ƒç”¨æ¯”ä¾‹/å¼‚å¸¸æ¯”ä¾‹ vs åŸºäºå¤±è´¥æ¯”ç‡ é™æµï¼šåŸºäºQPS/è°ƒç”¨å…³ç³»çš„é™æµ vs æœ‰é™æ”¯æŒ æµé‡æ•´å½¢ï¼šæ”¯æŒæ…¢å¯åŠ¨ã€åŒ€é€Ÿæ’é˜Ÿæ¨¡å¼ vs ä¸æ”¯æŒ æ§åˆ¶å°ï¼šæœ‰ï¼Œå¯é…ç½®è§„åˆ™ã€æŸ¥çœ‹ç§’çº§ç›‘æ§ vs ä¸å®Œå–„ å®æ“ cmdè¿è¡ŒjaråŒ…\u0026ndash;\u0026gt;æ§åˆ¶å°æ‰“å¼€ï¼šlocalhost:8080\né™æµ ç°‡ç‚¹é“¾è·¯ï¼šå³é¡¹ç›®å†…çš„è°ƒç”¨é“¾è·¯ï¼ˆå¦‚controller\u0026ndash;service\u0026ndash;mapperï¼‰ï¼Œå…¶ä¸­æ¯ä¸ªè¢«æ£€æ§çš„æ¥å£å³ä¸ºèµ„æºï¼ˆé»˜è®¤æƒ…å†µä¸‹sentinelç›‘æ§SpringMVCçš„æ¯ä¸ªç«¯ç‚¹ï¼‰ æµæ§æ¨¡å¼ï¼šç›´æ¥ / å…³è”ï¼ˆèµ„æºAçš„è®¿é—®åˆ°è¾¾é˜ˆå€¼ï¼Œé™åˆ¶å¯¹Bçš„è¯·æ±‚ï¼Œå¦‚updateä¸queryï¼‰ / é“¾è·¯ï¼ˆé’ˆå¯¹ä»æŒ‡å®šé“¾è·¯è®¿é—®åˆ°æœ¬èµ„æºçš„è¯·æ±‚ï¼‰ æµæ§æ•ˆæœï¼š å¿«é€Ÿå¤±è´¥ï¼ˆç›´æ¥æ‹’ç»è¯·æ±‚å¹¶æŠ›å¼‚å¸¸ï¼ŒçŠ¶æ€ç 429ï¼Œè¢«Sentinelä¸­æ–­ï¼‰ Warm Upï¼ˆé¢„çƒ­\u0026ndash;åº”å¯¹æœåŠ¡å†·å¯åŠ¨ï¼Œæ‹’ç»å¹¶æŠ›å¼‚å¸¸ï¼Œä½†é˜ˆå€¼åŠ¨æ€å˜åŒ–ï¼‰ é»˜è®¤å¼€å§‹é˜ˆå€¼ä¸ºthreshold/3ï¼Œåœ¨é¢„çƒ­æ—¶é—´å†…é€æ¸å¢å¤§ä¸ºthreshold æ’é˜Ÿç­‰å¾…ï¼šæ‰€æœ‰è¯·æ±‚æ’é˜Ÿæ‰§è¡Œï¼Œä½†è¯·æ±‚é—´éš”ä¸èƒ½å°äºæŒ‡å®šæ—¶é•¿ï¼Œé¢„æœŸç­‰å¾…æ—¶é—´è¶…è¿‡æœ€å¤§ç­‰å¾…æ—¶é•¿åˆ™æ‹’ç»å¹¶æŠ›å¼‚å¸¸ çƒ­ç‚¹å‚æ•°è¯·æ±‚ï¼šç»Ÿè®¡å‚æ•°å€¼ç›¸åŒçš„è¯·æ±‚ï¼ˆå¦‚{id}ï¼Œå¯ä»¥ç»™ç‰¹æ®Šidè®¾ç½®ä¸åŒé˜ˆå€¼ï¼‰ å¯¹é»˜è®¤çš„SpringMVCèµ„æºæ— æ•ˆ\u0026ndash;\u0026gt;éœ€è¦åœ¨controlleræ·»åŠ æ³¨è§£@SentinelResource(\u0026quot;balabal\u0026quot;) é…ç½®å‚æ•°ç´¢å¼•ï¼šæŠŠä¼ æ¥çš„ç¬¬å‡ ä¸ªå‚æ•°ä½œä¸ºçƒ­ç‚¹ï¼ˆä»0å¼€å§‹ï¼‰ éš”ç¦»ä¸é™çº§ é€šè¿‡Feignå®ç°å¾®æœåŠ¡è°ƒç”¨ï¼Œå› æ­¤éœ€è¦æ•´åˆFeignä¸Sentinelä¿æŠ¤å®¢æˆ·ç«¯\nSentinelæ”¯æŒçº¿ç¨‹éš”ç¦» \u0026amp; é™çº§ç†”æ–­ Feignä¸Sentinelç»“åˆï¼šè¡¥å……è°ƒç”¨å¤±è´¥çš„é™çº§é€»è¾‘ï¼ˆè¿”å›å®¢æˆ·ç«¯ï¼‰\u0026ndash;\u0026gt;FallbackFactoryå¤„ç†è¿œç¨‹è°ƒç”¨çš„å¼‚å¸¸ çº¿ç¨‹éš”ç¦»å®ç°ï¼šé˜ˆå€¼ç±»å‹é€‰æ‹©çº¿ç¨‹æ•°å³å¯ çº¿ç¨‹æ± éš”ç¦»ï¼šæ ¹æ®ä¸åŒæœåŠ¡åˆ›å»ºä¸åŒçº¿ç¨‹æ± ï¼Œæ¯æ¬¡è¯·æ±‚åœ¨å¯¹åº”æœåŠ¡çš„çº¿ç¨‹æ± ä¸­åˆ›å»ºç‹¬ç«‹çº¿ç¨‹\u0026ndash;\u0026gt;æ”¯æŒä¸»åŠ¨è¶…å¸‚\u0026amp;å¼‚æ­¥è°ƒç”¨ but çº¿ç¨‹é¢å¤–å¼€é”€å¤§ ä¿¡å·é‡éš”ç¦»ï¼ˆé»˜è®¤ï¼‰ï¼šåŒä¸ªçº¿ç¨‹æ± ï¼Œç»Ÿè®¡ä¿¡å·é‡ï¼ˆè¯·æ±‚çš„è®¡æ•°å™¨ï¼‰\u0026ndash;\u0026gt;è½»é‡çº§ but ä¸æ”¯æŒä¸»åŠ¨è°ƒç”¨ï¼ˆç»Ÿè®¡ä¿¡å·é‡åæ”¾èµ°ï¼‰ï¼Œé€‚åˆé«˜é¢‘è°ƒç”¨é«˜æ‰‡å‡º ç†”æ–­é™çº§å®ç°ï¼š æ–­è·¯å™¨ä¸‰ç§çŠ¶æ€ï¼šClosed\u0026ndash;Open\u0026ndash;Half-Open æ­£å¸¸æ”¾è¡Œï¼ˆClosedï¼‰ç»Ÿè®¡å¤±è´¥è¾¾åˆ°é˜ˆå€¼è¿›å…¥ç†”æ–­çŠ¶æ€ï¼ˆOpenï¼‰ï¼Œç†”æ–­æ—¶é—´ç»“æŸè¿›å…¥Half-Openï¼Œæ”¾è¡Œä¸€æ¬¡è¯·æ±‚ï¼Œè‹¥å¤±è´¥åˆ™å›åˆ°Openï¼ŒæˆåŠŸåˆ™å›åˆ°Closed ç†”æ–­ç­–ç•¥ï¼šæ…¢è°ƒç”¨æ¯”ä¾‹ / å¼‚å¸¸æ¯”ä¾‹ / å¼‚å¸¸æ•° è®¾ç½®æœ€å°è¯·æ±‚æ•°ï¼Œè¡¨ç¤ºç»Ÿè®¡æ—¶é•¿å†…è¯·æ±‚æ•°å¤§äºè¯¥æ•°æ—¶ï¼Œå¯åŠ¨ç†”æ–­åˆ¤æ–­ æˆæƒè§„åˆ™ è¿‡ç¨‹ï¼šgatewayä¸æµè§ˆå™¨å‘æ¥çš„è¯·æ±‚é»˜è®¤éƒ½ä¸ºdefaultï¼Œè®¾ç½®ç½‘å…³å‘æ¥çš„è¯·æ±‚æ·»åŠ è¯·æ±‚å¤´\u0026ndash;\u0026gt;åŒºåˆ†äºŒè€…ï¼ˆæµè§ˆå™¨å‘æ¥çš„ä¿¡æ¯åšé»‘åå•ç™½åå•å¤„ç†ï¼Œç½‘å…³ä¸éœ€è¦ï¼Œå› ä¸ºä»¥åˆ¤æ–­ï¼‰ è‡ªå®šä¹‰å¼‚å¸¸è¿”å›ç»“æœï¼šå®ç°BlockExceptionHandleræ¥å£ï¼Œå…¶ä¸­é€šè¿‡åˆ¤æ–­instance ofåˆ¤æ–­å¼‚å¸¸ç±»å‹ï¼Œè¿”å›æŒ‡å®šçš„ä¿¡æ¯ è§„åˆ™æŒä¹…åŒ– é»˜è®¤è§„åˆ™ä¿å­˜åœ¨å†…å­˜ä¸­ï¼Œåˆ™é‡å¯å¤±æ•ˆ\næ¨¡å¼ï¼šåŸå§‹ / pullæ¨¡å¼ / pushæ¨¡å¼ pullï¼šæ§åˆ¶å°å°†è§„åˆ™æ¨é€åˆ°Sentinelå®¢æˆ·ç«¯ï¼Œå®¢æˆ·ç«¯å°†è§„åˆ™ä¿å­˜åˆ°æœ¬åœ°æ–‡ä»¶/æ•°æ®åº“ä¸­ï¼Œä¹‹åå®šæ—¶å»æœ¬åœ°æ–‡ä»¶/æ•°æ®åº“æŸ¥è¯¢ï¼Œæ›´æ–°æœ¬åœ°è§„åˆ™\u0026ndash;\u0026gt;å­˜åœ¨ä¸€è‡´æ€§é—®é¢˜ pushï¼šæ§åˆ¶å°å°†é…ç½®è§„åˆ™æ¨é€åˆ°è¿œç¨‹é…ç½®ä¸­å¿ƒï¼ˆNacosç­‰ï¼‰ï¼ŒSentinelç›‘å¬Nacosè·å–é…ç½®å˜æ›´çš„æ¨é€æ¶ˆæ¯ï¼Œå®Œæˆæœ¬åœ°é…ç½®æ›´æ–° pushï¼šéœ€ä¿®æ”¹sentinelæ§åˆ¶å°æºç  æºç  sentinelä¸gatewayé™æµçš„å·®åˆ« é™æµç®—æ³•ï¼š è®¡æ•°å™¨ï¼ˆå›ºå®šçª—å£/æ»‘åŠ¨çª—å£ï¼‰ï¼šï¼ˆåªæœ‰ä¸€æ ¼çš„æ»‘åŠ¨çª—å£å³ä¸ºå›ºå®šçª—å£ï¼‰å°†çª—å£åˆ†ä¸ºå‡ æ ¼ï¼Œæ¯æ¬¡ä»¥æ ¼ä¸ºå•ä½å‘å³ç§»åŠ¨çª—å£ï¼Œé™åˆ¶æ¯æ ¼ä¸­çš„è¯·æ±‚é‡ï¼ˆå¯ä»¥é¿å…å›ºå®šçª—å£ä¸­åœ¨æœ¬çª—å£å°¾ä¸ä¸‹ä¸ªçª—å£é¦–æ”¶åˆ°å¤§é‡è¯·æ±‚æ— æ³•ä¾¦æµ‹çš„é—®é¢˜ï¼‰ ä»¤ç‰Œæ¡¶token bucketï¼šå›ºå®šé€Ÿç‡ç”Ÿæˆä»¤ç‰Œç›´åˆ°ä»¤ç‰Œæ¡¶æ»¡ï¼Œè¯·æ±‚æ‹¿åˆ°ä»¤ç‰Œæ‰å¯è¢«å¤„ç†ï¼Œæ— ä»¤ç‰Œæ—¶è¯·æ±‚ç­‰å¾…/ä¸¢å¼ƒï¼ˆå®ç°ï¼šå­˜ä¸Šä¸€è¯·æ±‚åˆ°è¾¾çš„æ—¶é—´\u0026amp;ä»¤ç‰Œæ•°é‡ï¼‰\u0026ndash;\u0026gt;é—®é¢˜ï¼šå‰ä¸€æ—¶é—´æ®µæ— è¯·æ±‚ï¼Œä¸‹ä¸€æ—¶é—´æ®µåŒå€æ¡¶å¤§å°çš„è¯·æ±‚ æ¼æ¡¶leaky bucketï¼šå­˜è¯·æ±‚ï¼Œä»¥å›ºå®šé€Ÿç‡å‘å¤–æ¼å‡ºè¯·æ±‚ï¼ˆæ‰§è¡Œï¼‰ï¼Œæ¡¶ç©ºååœæ­¢æ¼ï¼Œæ¼æ¡¶æ»¡åä¸¢å¼ƒè¯·æ±‚ï¼ˆé˜Ÿåˆ—å®ç°ï¼‰==\u0026gt;æ’é˜Ÿç­‰å¾… in Sentinel å·®åˆ«ï¼š Sentinelï¼šé»˜è®¤é™æµæ¨¡å¼==æ»‘åŠ¨æ—¶é—´çª—å£ \u0026amp; æ’é˜Ÿç­‰å¾… ==æ¼æ¡¶ \u0026amp; çƒ­ç‚¹å‚æ•°é™æµ==ä»¤ç‰Œæ¡¶ Gatewayï¼šåŸºäºRediså®ç°çš„ä»¤ç‰Œæ¡¶ RocketMQ æ¶ˆæ¯é˜Ÿåˆ— å‘æ¶ˆæ¯\u0026ndash;å­˜æ¶ˆæ¯\u0026ndash;æ¶ˆè´¹æ¶ˆæ¯\næ¶ˆæ¯é˜Ÿåˆ—æ€ä¹ˆé€‰å‹ï¼Ÿ ä½¿ç”¨åœºæ™¯ è§£è€¦ï¼šå¤šä¸ªç³»ç»Ÿé—´é€šè¿‡ç½‘ç»œè°ƒç”¨æ”¹ä¸ºMQå¼‚æ­¥é€šè®¯ å¼‚æ­¥ å‰Šå³°ï¼šå‰§å¢çš„è®¿é—®æ”¾åˆ°MQä¸­ï¼ŒæŒ‰æœ€å¤§æ¶ˆè´¹èƒ½åŠ›å–ç”¨ é‡å¤æ¶ˆè´¹æ€ä¹ˆåŠ ç”Ÿäº§ç«¯å¯ä»¥ä¿è¯ã€‚ä¸šåŠ¡ç«¯æ§åˆ¶\u0026ndash;\u0026gt;Redis/æœ¬åœ°æ•°æ®åº“ç¼“å­˜æ¶ˆè´¹æˆåŠŸçš„ä¸šåŠ¡æ ‡è¯†ï¼Œå¤„ç†å‰å…ˆè¿›è¡Œæ ¡éªŒä¿è¯å¹‚ç­‰ æ¶ˆæ¯ä¸¢å¤±æ€ä¹ˆåŠ ç”Ÿäº§é˜¶æ®µï¼šå–å†³äºç”Ÿäº§è€…å¯¹å¼‚å¸¸æƒ…å†µçš„å¤„ç†ã€‚èƒ½æ”¶åˆ°ä¸­é—´ä»¶çš„ACKå“åº”å³è¡¨ç¤ºå‘é€æˆåŠŸï¼Œè¿”å›å¼‚å¸¸åˆ™æ¶ˆæ¯é‡å‘ï¼Œå¯ä¿è¯ä¸ä¸¢å¤± å­˜å‚¨é˜¶æ®µï¼šï¼ˆKafkaï¼‰ä½¿ç”¨é›†ç¾¤ï¼ŒæŠŠæ¶ˆæ¯å†™åœ¨å¤šä¸ªèŠ‚ç‚¹ä¸Š æ¶ˆè´¹é˜¶æ®µï¼šæ¥æ”¶\u0026amp;å¤„ç†åå†å›å¤ACKã€‚è‹¥æ¥æ”¶å°±å›å¤ï¼Œå¯èƒ½å¤„ç†è¿‡ç¨‹ä¸­ä¸¢å¤± MQå…¶ä»–çš„é—®é¢˜ä¸è§£å†³ å¯é æ€§ æŒä¹…åŒ–ï¼šç³»ç»Ÿå´©æºƒç­‰æƒ…å†µä¸‹ä¸èƒ½ä¸¢å¤±æœªå¤„ç†çš„æ¶ˆæ¯ æ¶ˆæ¯ç¡®è®¤ï¼šå¤„ç†å®Œæˆåå‘é€acknowledgmentï¼Œæ”¶åˆ°ç¡®è®¤åMQå°†æ¶ˆæ¯ç§»é™¤ã€‚è‹¥æœªæ”¶åˆ°ç¡®è®¤ï¼ŒMQå¯èƒ½é‡å‘ç»™è¯¥æ¶ˆè´¹è€…/å…¶ä»–æ¶ˆè´¹è€… æ¶ˆæ¯é‡è¯•ï¼šå¤„ç†æ¶ˆæ¯å¤±è´¥å¯ä»¥é‡è¯•ï¼Œé‡è¯•å¤šæ¬¡ä¾ç„¶å¤±è´¥å¯ä»¥å‘é€åˆ°æ­»ä¿¡é˜Ÿåˆ— é¡ºåºæ€§ åœºæ™¯è¯†åˆ«ï¼šåˆ¤æ–­å“ªäº›åœºæ™¯éœ€è¦ä¿è¯æœ‰åºæ€§ MQä¿è¯é¡ºåºï¼šï¼ˆKafkaï¼‰ä¿è¯åˆ†åŒºå†…æ¶ˆæ¯æœ‰åº æ¶ˆè´¹è€…é¡ºåºï¼šå¯é€šè¿‡å•çº¿ç¨‹/çº¿ç¨‹æ± \u0026amp;ä¸²è¡ŒåŒ–é¡ºåºæ¶ˆæ¯ä¿è¯é¡ºåº æ€ä¹ˆä¿è¯å¹‚ç­‰æ€§ åŒä¸€æ“ä½œçš„å¤šæ¬¡æ‰§è¡Œå¯¹ç³»ç»ŸçŠ¶æ€çš„å½±å“ä¸ä¸€æ¬¡æ‰§è¡Œç»“æœä¸€è‡´ï¼ˆå¦‚æ”¯ä»˜ï¼‰\nå”¯ä¸€æ ‡è¯†ï¼šä¸ºæ¯ä¸ªè¯·æ±‚ç”Ÿæˆå…¨å±€å”¯ä¸€IDï¼ŒæœåŠ¡ç«¯æ ¡éªŒæ˜¯å¦å·²å¤„ç† æ•°æ®åº“äº‹åŠ¡\u0026amp;ä¹è§‚é”ï¼šé€šè¿‡ç‰ˆæœ¬å·æˆ–çŠ¶æ€å­—æ®µæ§åˆ¶å¹¶å‘æ›´æ–°ï¼Œç¡®ä¿å¤šæ¬¡æ›´æ–°ç­‰åŒäºå•æ¬¡æ“ä½œ\u0026ndash;\u0026gt;ä½™é¢æ‰£å‡ æ•°æ®åº“å”¯ä¸€çº¦æŸ åˆ†å¸ƒå¼é” æ¶ˆæ¯å»é‡ï¼šä¸ºæ¯ä¸ªæ¶ˆæ¯ç”Ÿæˆå”¯ä¸€ID MQçš„æ¶ˆæ¯ç§¯å‹é—®é¢˜ ä¿è¯æ•°æ®ä¸€è‡´æ€§ äº‹åŠ¡æ¶ˆæ¯ã€‚ç”Ÿäº§è€…å‘é€åŠäº‹åŠ¡æ¶ˆæ¯åˆ°MQæœåŠ¡å™¨\u0026ndash;\u0026gt;MQæ”¶åˆ°åå°†æ¶ˆæ¯æŒä¹…åŒ–ï¼Œæ¶ˆæ¯çŠ¶æ€ä¸ºç‰ˆå‘é€\u0026ndash;\u0026gt;MQè¿”å›ACKåˆ°ç”Ÿäº§è€…\u0026ndash;\u0026gt;ç”Ÿäº§è€…æ‰§è¡Œæœ¬åœ°äº‹åŠ¡ï¼Œæ‰§è¡ŒæˆåŠŸåˆ™è¿”å›commitåˆ°MQï¼Œå¤±è´¥åˆ™è¿”å›rollback\u0026ndash;\u0026gt;MQæ”¶åˆ°commitåˆ™å°†æ¶ˆæ¯æ›´æ–°ä¸ºå¯å‘é€çŠ¶æ€ï¼ˆå¹¶pushåˆ°æ¶ˆè´¹è€…ï¼‰ï¼Œrollbackåˆ™åˆ é™¤æ¶ˆæ¯\u0026ndash;\u0026gt;è‹¥MQé•¿æ—¶é—´æœªæ”¶åˆ°ç”Ÿäº§è€…åé¦ˆï¼Œåˆ™åæŸ¥ç”Ÿäº§è€… MQå‚è€ƒçš„æ˜¯ä»€ä¹ˆè®¾è®¡æ¨¡å¼ è§‚å¯Ÿè€…æ¨¡å¼ï¼šä¸€ä¸ªä¸»é¢˜vså¤šä¸ªæ¶ˆè´¹è€…ï¼Œä¸»é¢˜å‘å¸ƒæ¶ˆæ¯æ—¶é€šçŸ¥æ‰€æœ‰è§‚å¯Ÿè€… å‘å¸ƒè®¢é˜…æ¨¡å¼ï¼šå‘å¸ƒè€…ä¸è®¢é˜…è€…è§£è€¦ï¼Œå‘å¸ƒè€…æ¶ˆæ¯å‘åˆ°å‘å¸ƒè®¢é˜…ä¸­å¿ƒï¼Œå‘å¸ƒè®¢é˜…ä¸­å¿ƒé€šçŸ¥æ‰€æœ‰è®¢é˜…è€… RocketMQ broker==æ¶ˆæ¯å­˜å‚¨è½¬å‘çš„æ ¸å¿ƒç»„ä»¶ï¼›topic==æ¶ˆæ¯æ ‡ç­¾ï¼Œå®šä¹‰æ¶ˆæ¯åˆ†ç±»ï¼Œæ¯ä¸ªtopicå¯èƒ½å¯¹åº”å¤šä¸ªæ¶ˆæ¯é˜Ÿåˆ—ï¼›parttion==ç‰©ç†åˆ†åŒºï¼Œå³ä¸€ä¸ªæ¶ˆæ¯é˜Ÿåˆ—ï¼Œä¸€ä¸ªbrokerå†…å¯ä»¥æœ‰å¤šä¸ªpartiton\nä¸ºä»€ä¹ˆé€‰ç”¨ javaè¯­è¨€å¼€å‘ \u0026amp; ç‰¹æ€§ä¸°å¯Œï¼ˆé¡ºåºæ¶ˆæ¯ã€äº‹åŠ¡æ¶ˆæ¯ã€æ¶ˆæ¯è¿‡æ»¤ã€å®šæ—¶æ¶ˆæ¯â€¦ï¼‰ \u0026amp; ç¤¾åŒºæ´»è·ƒ ä¸Kafkaæ¯”è¾ƒ Kafkaï¼šé«˜ååé‡ã€é›†ç¾¤éƒ¨ç½² but å¯èƒ½æ•°æ®ä¸¢å¤±ï¼ˆæ”¶åˆ°æ¶ˆæ¯å…ˆå†™å…¥ç£ç›˜ç¼“å†²åŒºè€Œéç‰©ç†ç£ç›˜ï¼‰ã€åŠŸèƒ½è¾ƒä¸ºå•ä¸€ RMQï¼šåŠŸèƒ½å¤šã€å•æœºååé‡é«˜ã€æ”¯æŒé›†ç¾¤ but æ€§èƒ½ç•¥å¼± å»¶æ—¶æ¶ˆæ¯ brokerå°†å»¶æ—¶æ¶ˆæ¯å­˜å…¥å»¶æ—¶topicï¼ŒScheduleMessageServiceæ£€æŸ¥æ˜¯å¦åˆ°æœŸï¼Œåˆ°æœŸåˆ™å°†å…¶è½¬å‘åˆ°æ¶ˆæ¯çš„åŸå§‹topic åˆ†å¸ƒå¼äº‹åŠ¡ ä¿è¯æœ€ç»ˆä¸€è‡´æ€§ã€‚å…·ä½“å¤„ç†è§ä¸ŠèŠ‚ æ¶ˆæ¯é¡ºåºä¿è¯ æ¶ˆè´¹é¡ºåºä¸å‘é€é¡ºåºè¦ä¿æŒä¸€è‡´ã€‚RMQé‡‡ç”¨å±€éƒ¨ä¸€è‡´æ€§ï¼Œä¿è¯å•ä¸ªé˜Ÿåˆ—åœ°æ¶ˆæ¯æœ‰åº åŸç†ï¼šç”Ÿäº§è€…æŒ‰é¡ºåºå‘é€æ¶ˆæ¯ï¼Œbrokeré€šè¿‡å¯¹MQåŠ é”ä¿è¯åŒä¸ªMQåªèƒ½è¢«åŒä¸ªæ¶ˆè´¹è€…æ¶ˆè´¹ ä¸é‡å¤æ¶ˆè´¹ å®ç°å¹‚ç­‰æ€§ï¼Œç¡®ä¿å³ä½¿é‡å¤æ¶ˆè´¹ä¹Ÿä¸ä¼šå½±å“ä¸šåŠ¡çŠ¶æ€ã€‚ æ¶ˆæ¯ç§¯å‹ æ‰©å®¹æ¶ˆè´¹ç«¯å®ä¾‹æ•°\u0026ndash;\u0026gt;æå‡æ€»ä½“æ¶ˆè´¹èƒ½åŠ› or ç³»ç»Ÿé™çº§ ","permalink":"https://Sattiluvcat.github.io/en/posts/java/%E5%BE%AE%E6%9C%8D%E5%8A%A1/","summary":"ElasticSearch/Kafka/Sentinel","title":"å¾®æœåŠ¡"},{"content":"Â Stringæ— æŸ¥è¯¢ Stringæ—æŸ¥è¯¢ä¸€å¾‹ï¼šsb.charAt(i) é•¿åº¦ï¼šsb.length() åŸºæœ¬æ“ä½œ åˆ é™¤ åˆ é™¤æŒ‡å®šä½ï¼šsb.deleteCharAt(i) åˆ é™¤æŒ‡å®šåŒºåŸŸï¼šsb.delete(i,j)ï¼Œè¡¨ç¤ºåˆ é™¤ä»index=iåˆ°index\u0026lt;jçš„æ‰€æœ‰å…ƒç´  æ¸…ç©ºï¼šsb.delete(0,sb.length())æˆ–sb.setLength(0) æ’å…¥ æ’å…¥æŒ‡å®šä½ï¼šsb.insert(offset,str)ï¼Œå…¶ä¸­offsetè¡¨ç¤ºåç§»é‡ï¼Œå³æ’å…¥ä½ç½®çš„index æ’å…¥æœ«ä½ï¼šsb.append(str) ä¿®æ”¹ ä¿®æ”¹å…ƒç´ ï¼šsb.replace(i,j,str)ï¼Œè¡¨ç¤ºå°†åŸæ¥çš„index=iåˆ°index\u0026lt;jçš„éƒ¨åˆ†æ”¹ä¸ºstr æå–å­ä¸²ï¼šsb.substring(i,j)ï¼Œæå–index=iåˆ°index\u0026lt;jçš„éƒ¨åˆ† åŸºæœ¬æ“ä½œæ¼”ç¤º StringBuilder sb=new StringBuilder(\u0026#34;01234567\u0026#34;); // åˆ é™¤ç¬¬ 2 ä½ sb.deleteCharAt(1); // sb: \u0026#34;0234567\u0026#34; // ç¬¬ 4 ä½æ’å…¥â€œ2â€ sb.insert(3,2); // sb: \u0026#34;02324567\u0026#34; // åˆ é™¤ç¬¬ 2-3 ä½ sb.delete(1,3); // sb: \u0026#34;04567\u0026#34; // æ›¿æ¢ç¬¬ 1-4 ä½ sb.replace(2,5,\u0026#34;abc\u0026#34;); // sb: \u0026#34;02abc7\u0026#34; sb.repeat(\u0026#39;a\u0026#39;,2); // sb: \u0026#34;02abc7aa\u0026#34; ç‰¹æ®Š é‡å¤ï¼š sb.repeat(charSequence,count)ï¼Œè¡¨ç¤ºå°†å­—ç¬¦åºåˆ—é‡å¤countæ¬¡ï¼Œå¹¶è¿½åŠ åˆ°sbæœ«å°¾ å­—ç¬¦åºåˆ—å®é™…æ˜¯ä¸€ä¸ªæ¥å£ï¼ŒStringæ—ä¸CharBufferéƒ½æ˜¯å…¶å®ç°ç±» sb.repeat(codePoint,count)ï¼Œè¡¨ç¤ºå°†Unicodeç ç‚¹ï¼ˆå¦‚ï¼š01xF600ä»£è¡¨ğŸ˜€ï¼Œå¯ç”¨'c'ä»£æ›¿è¾“å…¥ï¼‰é‡å¤countæ¬¡ï¼Œå¹¶è¿½åŠ åˆ°sbæœ«å°¾ åè½¬ï¼šsb.reverse() æŸ¥æ‰¾ï¼šsb.indexOf(str) \u0026amp;\u0026amp; æŸ¥æ‰¾æœ€åä¸€æ¬¡å‡ºç°çš„èµ·å§‹ä½ç½®sb.lastIndexOf(str) è¿”å›ç¬¬ä¸€ä¸ªæ‰¾åˆ°çš„ç»“æœçš„èµ·å§‹ä½ç½®ï¼Œä»å‰å‘åéå†æŸ¥æ‰¾strç¬¬ä¸€ä½ä½ç½®ï¼Œæ‰¾åˆ°ç¬¬ä¸€ä½åæ¯”å¯¹å…¶ä½™ä½æ˜¯å¦ç›¸åŒï¼Œæ— ç‰¹æ®Šæ–¹æ³•ã€‚æºç ğŸ‘‡ for (int i = fromIndex; i \u0026lt;= max; i++) { // Look for first character. if (value[i] != first) { while (++i \u0026lt;= max \u0026amp;\u0026amp; value[i] != first); } // Found first character, now look at the rest of value if (i \u0026lt;= max) { int j = i + 1; int end = j + strCount - 1; for (int k = 1; j \u0026lt; end \u0026amp;\u0026amp; value[j] == str[k]; j++, k++); if (j == end) { // Found whole string. return i; } } } æ¯”è¾ƒï¼šs1.equals(s2)\u0026ndash;\u0026gt;ä¸èƒ½ç”¨==æ¯”è¾ƒå­—ç¬¦ä¸²ï¼Œå› ä¸ºå­—ç¬¦ä¸²æ˜¯å¼•ç”¨ç±»å‹ï¼Œç­‰å·æ¯”è¾ƒçš„æ˜¯æŒ‡å‘çš„åœ°å€ï¼Œè€Œéå­—ç¬¦ä¸²å±æ€§ è‹¥éœ€æ¯”è¾ƒå­—ç¬¦ä¸²s1ä¸­æ˜¯å¦åŒ…å«s2ï¼Œå¯ç”¨ï¼šs1.startWith(s2,offset)æˆ–s1.substring(i,j).equals(s2)\u0026ndash;\u0026gt;ç»¼åˆæ¥çœ‹ï¼Œé€‰æ‹©ç¬¬ä¸€ç§æ–¹æ³•æ›´å¥½ æ’åºï¼šæŒ‰å­—ç¬¦é¡ºåºæ’åºï¼Œå…ˆè½¬æ¢ä¸ºå­—ç¬¦æ•°ç»„ï¼šchar[] ch=str.toCharArray();ï¼›åæ’åºï¼šArrays.sort(ch); æ•°ç»„è½¬Stringæ–¹æ³•ï¼šString str=String.valueOf(arr)ï¼ˆå¸¸ç”¨ï¼‰æˆ–String str=new String(arr) æ‹†åˆ†ï¼šString[] strs=str.split(\u0026quot;,\u0026quot;)\u0026ndash;\u0026gt;æŒ‰,æ‹†åˆ† å­—ç¬¦|/./*éœ€è¦è½¬ä¹‰\u0026ndash;\u0026gt;\\\\| å¯ä»¥ä½¿ç”¨limitå‚æ•°è¡¨ç¤ºæœ€å¤šæ‹†åˆ†ä¸ºå‡ æ®µï¼Œè®¾å®šä¸º-1è¡¨ç¤ºä¿ç•™æ‰€æœ‰ç©ºå€¼ è½¬æ¢ï¼šä»Stringè½¬Integerï¼ˆintï¼‰\u0026ndash;\u0026gt;Integer.parseInt(str) å…¶å®ƒåŒ…è£…ç±»åŒç†ï¼ŒCharacterç­‰ List æŸ¥è¯¢ æŸ¥è¯¢æŒ‡å®šä½ï¼šlist.get(index) æŸ¥è¯¢æŸå…ƒç´ é¦–æ¬¡å‡ºç°çš„åæ ‡ï¼šlist.indexOf(num) æœ€åå‡ºç°çš„åæ ‡ï¼šlist.lastIndexOf(num) æŸ¥è¯¢æ˜¯å¦å­˜åœ¨ï¼šlist.contains(num) æŸ¥è¯¢é•¿åº¦ï¼šlist.size() å¢åˆ  åœ¨æŒ‡å®šä½æ’å…¥å•ä¸ªå…ƒç´ ï¼šlist.add(index,num) åœ¨é¦–æˆ–å°¾æ’å…¥å•ä¸ªå…ƒç´ ï¼šlist.addFirst(num) or list.addLast(num) åœ¨æŒ‡å®šä½æ’å…¥é›†åˆï¼šlist.addAll(index,list1) ä¸åŠ indexå³è¿½åŠ åˆ°æœ«å°¾ åˆ é™¤æŒ‡å®šä½ï¼šlist.remove(index) åˆ é™¤é¦–å°¾å…ƒç´ ï¼šlist.removeFirst()æˆ–list.removeLast() æ¸…ç©ºï¼šlist.clear() ä¿®æ”¹ ä¿®æ”¹æŒ‡å®šä½ï¼šlist.set(index,numNow) ç‰¹æ®Š é¢ å€’é¡ºåºï¼šCollections.reverse(list) æ¯”è¾ƒä¸¤ä¸ªåˆ—è¡¨æ˜¯å¦ç›¸ç­‰ï¼šlist1.equals(list2) equalsè¢«é‡å†™äº†ï¼Œåªæ¯”è¾ƒå€¼ï¼Œä¸æ¯”è¾ƒåœ°å€ æ’åºï¼šArrays.sort(list) éƒ¨åˆ†æ’åºï¼šArrays.sort(list,start_index,end_index+1) Queue PriorityQueue è‡ªåŠ¨å¯¹å…ƒç´ æŒ‰å‡åºæ’åºï¼Œç­‰åŒäºå †ï¼ˆæ’åºï¼‰\nåˆ›å»ºï¼šPriorityQueue\u0026lt;Integer\u0026gt; queue = new PriorityQueue\u0026lt;\u0026gt;(); æ’å…¥ï¼šqueue.offer()ï¼Œé»˜è®¤ä»å°¾æ’å…¥ åˆ é™¤ï¼šqueue.poll()ï¼Œé»˜è®¤ä»å¤´åˆ é™¤ ä»ä¼˜å…ˆé˜Ÿåˆ—å–å‡ºå…ƒç´ ==å †æ’çš„ç»“æœï¼Œé˜Ÿåˆ—å†…éƒ¨ä¼šåšè°ƒæ•´ï¼Œå †æ’æ›´ä¸¥æ ¼ï¼ˆæ•´ä¸ªæ•°ç»„å®Œå…¨æ’åºï¼‰ï¼Œé˜Ÿåˆ—åªæ»¡è¶³çˆ¶èŠ‚ç‚¹å°äºå­èŠ‚ç‚¹çš„è¦æ±‚ Set æ’å…¥ï¼šset.add(num)\u0026ndash;\u0026gt;ä¸€ä¸ªbooleanç±»å‹ï¼Œå¯ä»¥åˆ¤æ–­æ˜¯å¦å­˜åœ¨è¯¥å…ƒç´  Hash åˆå¹¶ï¼šmap.merge(key,offset,Integer::sum)ï¼Œå°†keyå¯¹åº”çš„valueåŠ offset éå†ï¼š åŒæ—¶éœ€è¦é”®å’Œå€¼ï¼š for(Map.Entry\u0026lt;Integer,Integer\u0026gt; entry:map.entrySet()){ int key=entry.getKey(); int val=entry.getValue(); } åªéœ€è¦é”®/å€¼ï¼š for(Integer key:map.keySet()){ // æ‰§è¡Œé”®æ“ä½œ } for(Integer value:map.values()){ // æ‰§è¡Œå€¼æ“ä½œ } è¿­ä»£å™¨ï¼Œå¯è¿›è¡Œåˆ é™¤ // å¸¦æ³›å‹çš„è¿­ä»£å™¨ Iterator\u0026lt;Map.Entry\u0026lt;Integer, Integer\u0026gt;\u0026gt; entries = map.entrySet().iterator(); while(entries.hasNext()){ Map.Entry\u0026lt;Integer, Integer\u0026gt; entry = entries.next(); } æˆ– // ä¸å¸¦æ³›å‹çš„è¿­ä»£å™¨ Iterator entries = map.entrySet().iterator(); while(entries.hasNext()){ Map.Entry entry = (Map.Entry) entries.next(); } ","permalink":"https://Sattiluvcat.github.io/en/posts/java/string%E6%97%8F%E4%B8%8E%E9%9B%86%E5%90%88%E7%9A%84%E5%B8%B8%E7%94%A8%E6%96%B9%E6%B3%95/","summary":"Stringæ—ä¸é›†åˆçš„å¸¸ç”¨æ–¹æ³•","title":"Stringä¸é›†åˆçš„å¸¸ç”¨æ–¹æ³•"},{"content":"Â åŸºæœ¬è¯­æ³• æ¨¡ç³ŠåŒ¹é…ï¼š_è¡¨ç¤ºä¸€ä¸ªå­—ç¬¦ï¼Œ%è¡¨ç¤ºnä¸ªå­—ç¬¦ æ¡ä»¶åˆ¤æ–­ï¼šif(a\u0026gt;b,0,1)\u0026ndash;\u0026gt;a\u0026gt;bæˆç«‹åˆ™å–0ï¼Œå¦åˆ™å–1 inå­å¥ï¼šwhere (åˆ«ç§°,åˆ«ç§°,...) in (æ¡ä»¶å­å¥) å…¶ä¸­åˆ«ç§°æ˜¯å­å¥å¾—åˆ°çš„å­—æ®µå¯¹åº”çš„åˆ«ç§° è¿æ¥ä¸åˆå¹¶ é»˜è®¤æƒ…å†µä¸‹ï¼Œé‡‡ç”¨ç¬›å¡å°”ç§¯ï¼ˆcross joinï¼‰ å¦‚ï¼šfrom students,classesï¼Œä¼šå¾—åˆ°ç¬›å¡å°”ç§¯ç»“æœ ä½¿ç”¨joinçš„é»˜è®¤æ¡ä»¶ä¸‹æ˜¯ï¼šinner join\u0026ndash;\u0026gt;ä¸¤è¡¨å…¬å…±éƒ¨åˆ† è¿æ¥çš„æ¡ä»¶ç”±**on**æŒ‡å®š join ... on left join vs right join å·¦è¡¨å…¨éƒ¨\u0026amp;å³è¡¨ä¸­ç¬¦åˆæ¡ä»¶çš„éƒ¨åˆ†ï¼ˆrightåä¹‹ï¼‰ å°†æŸ¥è¯¢çš„ç»“æœåˆå¹¶ï¼ˆå‚ç›´è¿½åŠ ç»“æœé›†ï¼‰ï¼šunionï¼ˆä¸åŒ…æ‹¬é‡å¤å€¼ï¼‰ã€union allï¼ˆåŒ…æ‹¬é‡å¤ï¼‰ è¦æ±‚ï¼šåˆå¹¶çš„ç»“æœå¿…æœ‰ç›¸åŒæ•°é‡çš„åˆ—ï¼Œåˆ—æ‹¥æœ‰ç›¸ä¼¼æ•°æ®ç±»å‹ï¼Œä»¥ç›¸åŒé¡ºåºæ’åˆ— æ³¨æ„ï¼æ‰€æœ‰æ´¾ç”Ÿè¡¨ï¼ˆå¦‚selectå­æŸ¥è¯¢ï¼‰éƒ½è¦æœ‰è‡ªå·±çš„åˆ«å å¸¸ç”¨å‡½æ•° Select round(num,n)\u0026ndash;\u0026gt;numå››èˆäº”å…¥ä¿ç•™nä½å°æ•° datediff(day1,day2)\u0026ndash;\u0026gt;day1æ¯”day2å¤šçš„å¤©æ•° ä¹Ÿå¯ä»¥ç”¨between ... and ...æ¯”è¾ƒæ—¥æœŸæ˜¯å¦åœ¨æŸèŒƒå›´å†… countç»Ÿè®¡éNULLå€¼==\u0026gt;ä¸è®ºå…·ä½“æ˜¯å¤šå°‘\u0026ndash;\u0026gt;å¯ä»¥ç”¨count(æ¡ä»¶ or null)æŸ¥æ‰¾ï¼Œä¸ç¬¦åˆçš„èµ‹å€¼ä¸ºnullï¼Œå¯ä»¥ä¸è®¡å…¥ sumç»Ÿè®¡å…·ä½“å€¼\u0026ndash;\u0026gt;ä¹Ÿå¯ä»¥æ¥æ¡ä»¶ char_length(ch)ç»Ÿè®¡chçš„å­—ç¬¦æ•° vs length(ch)ç»Ÿè®¡å­—èŠ‚æ•° ä¿®æ”¹æ—¥æœŸæ ¼å¼ï¼šdate_format(originDate,'%Y-%m')==\u0026gt;2021-08 Y==\u0026gt;2021/y==\u0026gt;21 M==\u0026gt;January/m==\u0026gt;01 D==\u0026gt;1st/d==\u0026gt;01 é€‰å–ç‹¬ç‰¹å€¼ï¼šdistinct å­—æ®µ å¢åˆ æ”¹ åŸæœ‰è¡¨åŸºç¡€ä¸Šå¢åŠ å­—æ®µï¼šAlter Table è¡¨å Add Column å­—æ®µ å­—æ®µç±»å‹ Comment 'åˆ«å' After å·²æœ‰å­—æ®µ ç”¨Change æ—§å æ–°åå³ä¸ºæ”¹å­—æ®µ åˆ é™¤å­—æ®µï¼šAlter Table è¡¨å Drop å­—æ®µå ","permalink":"https://Sattiluvcat.github.io/en/posts/java/sql%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9/","summary":"å†™SQLæŸ¥è¯¢æ—¶çš„ä¸€äº›æ³¨æ„äº‹é¡¹ä¸è¸©ğŸ•³","title":"MySqlè¯­æ³•æ³¨æ„äº‹é¡¹"},{"content":"Â å¼€å§‹ä¸ç»“æŸ åœ¨linuxä¸­åˆ›å»ºshellè„šæœ¬å¹¶è¿è¡Œï¼š ç»ˆç«¯ä¸­åˆ›å»ºæ–‡æœ¬æ–‡ä»¶ï¼Œå¦‚ï¼švim script.sh æ–‡æœ¬æ–‡ä»¶ä¸­è¾“å…¥aå¼€å§‹ç¼–è¾‘ï¼Œé¦–è¡Œä¸º#!/bin/bash\u0026ndash;\u0026gt;æŒ‡æ˜è¿è¡Œè„šæœ¬çš„è§£é‡Šå™¨ æ­£å¼ä»£ç ï¼Œå‰ç½®#è¡¨ç¤ºæ³¨é‡Š é€€å‡ºå¹¶ä¿å­˜ï¼šEsc\u0026ndash;\u0026gt;:wq æ·»åŠ è„šæœ¬çš„æ‰§è¡Œæƒé™ï¼šchmod -x script.sh è¿è¡Œè„šæœ¬ï¼š./script.sh\u0026ndash;\u0026gt;æ·»åŠ .çœç•¥æŒ‡å®šæ–‡ä»¶ä½ç½® åŸºæœ¬è¯­æ³• è¾“å…¥è¾“å‡ºï¼š è¾“å…¥ï¼šread -p \u0026quot;balabal\u0026quot; num\u0026ndash;\u0026gt;numå³è®°å½•ç”¨æˆ·è¾“å…¥çš„å†…å®¹ è¾“å‡ºï¼šecho \u0026quot;balabala$num\u0026ndash;\u0026gt;$numè¡¨ç¤ºè„šæœ¬ä¸­çš„å˜é‡ æ•°å­¦è®¡ç®—ï¼š å¦‚ï¼šsum=$((n*(n+1)))\u0026ndash;\u0026gt;æ•°å­¦å¼å¤–æœ‰åŒå±‚æ‹¬å·ä¸$ æ¯”è¾ƒè¿ç®—ç¬¦ï¼š -le\u0026ndash;\u0026gt;å°äºç­‰äºï¼›-lt\u0026ndash;\u0026gt;å°äº -ge\u0026ndash;\u0026gt;å¤§äºç­‰äºï¼›-gt\u0026ndash;\u0026gt;å°äº -eq\u0026ndash;\u0026gt;ç­‰äºï¼›-ne\u0026ndash;\u0026gt;ä¸ç­‰äº è‡ªå¢è‡ªå‡ å¾ªç¯å†™æ³•ï¼š å¦‚ï¼š â€µ``shell while [ $i -le $n ] # []è¡¨ç¤ºtestï¼ˆæ¡ä»¶æ˜¯å¦æˆç«‹ï¼‰ do sum=$((sum + i)) # ç´¯åŠ  i=$((i + 1)) # i è‡ªå¢ done ","permalink":"https://Sattiluvcat.github.io/en/posts/notes/shell%E4%BD%BF%E7%94%A8%E5%B0%8Ftrick/","summary":"Shellçš„åŸºæœ¬ä½¿ç”¨æ–¹æ³•","title":"shellç®€å•ä½¿ç”¨"},{"content":"Â åŸºç¡€ æ¦‚å¿µ Javaç‰¹ç‚¹ï¼š å¹³å°æ— å…³æ€§â€”â€”ç¼–è¯‘å™¨å°†æºä»£ç ç¿»è¯‘ä¸ºå­—èŠ‚ç ï¼Œå­—èŠ‚ç å¯åœ¨ä»»ä½•å®‰è£…äº†JVMï¼ˆjavaè™šæ‹Ÿæœºï¼‰çš„ç³»ç»Ÿä¸Šè¿è¡Œ é¢å‘å¯¹è±¡â€”â€”strictly OOPï¼Œæ˜“äºç»´æŠ¤ä¸é‡ç”¨ï¼ˆç±»ã€å¯¹è±¡ã€ç»§æ‰¿ã€å¤šæ€ã€æŠ½è±¡ä¸å°è£…ï¼‰ å†…å­˜ç®¡ç†â€”â€”æœ‰è‡ªå·±çš„åƒåœ¾å›æ”¶æœºåˆ¶ï¼Œè‡ªåŠ¨ç®¡ç†å†…å­˜å’Œå›æ”¶ä¸å†ä½¿ç”¨çš„å¯¹è±¡ ä¸ºä»€ä¹ˆJavaæ˜¯è·¨å¹³å°çš„ï¼Ÿ Javaç¨‹åºç»è¿‡ç¼–è¯‘åå½¢æˆå­—èŠ‚ç ï¼ˆ.classï¼‰æ–‡ä»¶ï¼Œä¸åŒå¹³å°é€šè¿‡ä¸åŒç‰ˆæœ¬çš„JVMå°†å­—èŠ‚ç æ–‡ä»¶ç¿»è¯‘ä¸ºæœºå™¨ç åè¿è¡Œ JVM/JDK/JREå…³ç³» JVM-javaè™šæ‹Ÿæœºï¼Œå°†å­—èŠ‚ç è§£é‡Š/ç¼–è¯‘ä¸ºæœºå™¨ç å¹¶æ‰§è¡Œã€‚æä¾›å†…å­˜ç®¡ç†ã€åƒåœ¾å›æ”¶ã€å®‰å…¨æ€§ç­‰åŠŸèƒ½ JRE-javaè¿è¡Œçš„ç¯å¢ƒï¼ˆéœ€è¦çš„æœ€å°ç¯å¢ƒï¼‰ï¼ŒåŒ…å«JVMä¸ä¸€ç»„Javaç±»åº“ã€‚ä¸åŒ…å«å¼€å‘å·¥å…· JDK-javaå¼€å‘å·¥å…·åŒ…ï¼ŒåŒ…å«JVMã€**ç¼–è¯‘å™¨ï¼ˆjavacï¼‰ã€è°ƒè¯•å™¨ï¼ˆjdbï¼‰**ç­‰å¼€å‘å·¥å…·ä¸ç±»åº“ã€‚æä¾›å¼€å‘ã€ç¼–è¯‘ã€è°ƒè¯•ä¸è¿è¡Œçš„å…¨éƒ¨å·¥å…·ä¸ç¯å¢ƒ ç¼–è¯‘ä¸è§£é‡Šå…±å­˜ï¼Ÿ ç¼–è¯‘å‹ï¼šJava æºä»£ç é€šè¿‡ javac ç¼–è¯‘å™¨ç¼–è¯‘æˆå­—èŠ‚ç ï¼Œè€Œéæœºå™¨ç  \u0026ndash;\u0026gt; å¹³å°æ— å…³æ€§ è§£é‡Šå‹ï¼šJVM é€šè¿‡è§£é‡Šå™¨å°†å­—èŠ‚ç é€è¡Œç¿»è¯‘æˆæœºå™¨ç å¹¶æ‰§è¡Œ \u0026ndash;\u0026gt; å³æ—¶ç¼–è¯‘JIT JITï¼šå°†çƒ­ç‚¹ä»£ç ï¼ˆæ–¹æ³•è°ƒç”¨è®¡æ•°å™¨è®¡æ•°ç¡®å®šï¼‰ç›´æ¥ç¼–è¯‘ä¸ºæœºå™¨ç ï¼Œåç»­æ‰§è¡Œæ—¶æ— éœ€å†æ¬¡è§£é‡Š ç¼–è¯‘å’Œè§£é‡Šå‹çš„åŒºåˆ«ï¼Ÿ ç¼–è¯‘å‹ï¼šç¨‹åºæ‰§è¡Œå‰ï¼Œæ•´ä¸ªæºä»£ç è¢«ç¼–è¯‘ä¸ºæœºå™¨ç /å­—èŠ‚ç ï¼Œç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶ \u0026ndash;\u0026gt; é€Ÿåº¦å¿« but è·¨å¹³å°æ€§å·® è§£é‡Šå‹ï¼šç¨‹åºæ‰§è¡Œæ—¶ï¼Œé€è¡Œè§£é‡Šæ‰§è¡Œæºä»£ç ï¼ˆè§£é‡Šå™¨åŠ¨æ€è§£é‡Šï¼‰ï¼Œä¸ç”Ÿæˆç‹¬ç«‹çš„å¯æ‰§è¡Œæ–‡ä»¶ \u0026ndash;\u0026gt; é€Ÿåº¦æ…¢ but å¯è·¨å¹³å° æ•°æ®ç±»å‹ åŸºæœ¬æ•°æ®ç±»å‹ï¼š 1å­—èŠ‚ï¼›byte, boolean | 2å­—èŠ‚ï¼šshort, char | 4å­—èŠ‚ï¼šint, float | 8å­—èŠ‚ï¼šdouble, long åŒ…è£…ç±»ï¼šCharacter \u0026amp; Integer \u0026amp; é¦–å­—æ¯å¤§å†™ charæ— ç¬¦å·ï¼Œä¸å¯ä¸ºè´Ÿï¼Œæ•…ä»0å¼€å§‹ ç±»å‹è½¬æ¢ï¼š éšå¼è½¬æ¢ï¼ˆè‡ªåŠ¨ï¼‰ æ˜¾å¼è½¬æ¢ï¼ˆå¼ºåˆ¶ï¼‰ å­—ç¬¦ä¸²è½¬æ¢ï¼šå¦‚å­—ç¬¦ä¸²è½¬ä¸º int ï¼Œå¯ç”¨ Integer.parseInt() æ•°å€¼é—´è½¬æ¢ï¼šæ•´å‹ \u0026lt;==\u0026gt; å­—ç¬¦å‹ï¼Œå¯ç”¨åŒ…è£…ç±»çš„å·¥å…·æ–¹æ³•å®ç°ï¼ˆå¦‚Characterç±»ã€Integerç±»ï¼‰ ç±»å‹è½¬æ¢çš„é—®é¢˜ï¼š æ•°æ®ä¸¢å¤±ï¼šèŒƒå›´å¤§ç±»å‹åˆ°èŒƒå›´å°ç±»å‹ã€‚å¦‚ long åˆ° intï¼Œä¼šæˆªæ–­ä¿ç•™ä½ä½ æ•°æ®æº¢å‡ºï¼šèŒƒå›´å°ç±»å‹åˆ°èŒƒå›´å¤§ç±»å‹ã€‚ä¼šå¡«å……é«˜ä½ï¼ŒåŸæ•°æ®ä¸å˜ ç²¾åº¦æŸå¤±ï¼šæµ®ç‚¹æ•°ç±»å‹çš„è½¬æ¢ \u0026ndash;\u0026gt; è¡¨ç¤ºæ–¹å¼ä¸åŒï¼Œdoubleï¼ˆé«˜ç²¾åº¦ï¼‰ è½¬ float å¯èƒ½æŸå¤±ç²¾åº¦ ç±»å‹ä¸åŒ¹é… BigDecimal vs double doubleä¼šç²¾åº¦ä¸¢å¤± \u0026ndash;\u0026gt; äºŒè¿›åˆ¶æµ®ç‚¹è¿ç®—ï¼Œæœ‰æ—¶ä¸èƒ½å‡†ç¡®è¡¨ç¤ºå°æ•°ï¼ˆå¦‚0.1ï¼‰ BigDecimalç²¾ç¡®è®¡ç®—ï¼Œæ³¨æ„ç”¨å­—ç¬¦ä¸²åˆ›å»ºæ–°å¯¹è±¡ï¼Œä¸ç”¨æµ®ç‚¹ \u0026ndash;\u0026gt; BigDecimal num1 = new BigDecimal(\u0026quot;0.1\u0026quot;); è£…ç®±ã€æ‹†ç®± è‡ªåŠ¨è£…ç®±happens whenï¼š èµ‹å€¼ï¼ˆJava1.5åè‡ªåŠ¨ï¼‰ï¼š // before Java1.5 Integer iObject=Integer.valueof(3); int i=iObject.intValue(); // after Java1.5 Integer iObject=3; int i=iObject; æ–¹æ³•è°ƒç”¨ï¼šå®è´¨ä¹Ÿæ˜¯èµ‹å€¼ï¼Œå°†intä¸Integeré¢ å€’ä½¿ç”¨ è‡ªåŠ¨è£…ç®±å¼Šç«¯ï¼šå¾ªç¯ä¸­è‡ªåŠ¨è£…ç®±ï¼ˆé¢ å€’ä½¿ç”¨æ—¶ï¼‰ï¼Œä¼šåˆ›å»ºå¤§é‡æ— ç”¨å¯¹è±¡ \u0026amp; åƒåœ¾å›æ”¶å·¥ä½œé‡å¤§ Why Java has Integer? å‰æï¼šIntegeræ˜¯intç±»å‹çš„åŒ…è£…ç±»ï¼ŒæŠŠintç±»å‹åŒ…è£…æˆObjectå¯¹è±¡ï¼Œå³å¯¹è±¡å°è£… ä½œç”¨ï¼š æ³›å‹ï¼šJavaä¸­ï¼Œæ³›å‹åªèƒ½ä½¿ç”¨å¼•ç”¨ç±»å‹ï¼Œè€Œä¸èƒ½ä½¿ç”¨åŸºæœ¬ç±»å‹ã€‚å¦‚åˆ—è¡¨åªèƒ½ç”¨List\u0026lt;Integer\u0026gt; æ³›å‹å…è®¸åœ¨å®šä¹‰ç±»ã€æ¥å£æˆ–æ–¹æ³•æ—¶ä½¿ç”¨ç±»å‹å‚æ•°ï¼ˆå¦‚Box\u0026lt;T\u0026gt;ï¼‰ï¼Œä½¿ç”¨æ—¶å†æŒ‡å®šå…·ä½“ç±»å‹ è½¬æ¢ï¼šJavaä¸­ï¼ŒåŸºæœ¬ç±»å‹å’Œå¼•ç”¨ç±»å‹ä¸èƒ½ç›´æ¥è¿›è¡Œè½¬æ¢ï¼Œå¿…ç”¨åŒ…è£…ç±»ã€‚å¦‚intè½¬Stringï¼ˆè½¬ä¸ºIntegerå.toString()ï¼‰ é›†åˆï¼šJavaé›†åˆåªèƒ½å­˜å‚¨å¯¹è±¡ Integerç›¸æ¯”intä¼˜ç‚¹ï¼ˆåŒºåˆ«ï¼‰ï¼Ÿ åŸºæœ¬ç±»å‹ vs å¼•ç”¨ç±»å‹ï¼šåŸºæœ¬ç±»å‹ä¸éœ€å®ä¾‹åŒ–å³å¯ä½¿ç”¨ ==\u0026gt; intå­˜å‚¨ä¸€ä¸ªæ•´æ•°ä¸éœ€é¢å¤–çš„å†…å­˜åˆ†é…ï¼ˆæ€§èƒ½æ›´å¿«ï¼‰ï¼ŒIntegerè¦ä¸ºå¯¹è±¡åˆ†é…å†…å­˜ å¼•ç”¨ç±»å‹ï¼Œå¯¹è±¡çš„å¼•ç”¨å’Œå¯¹è±¡æœ¬èº«åˆ†å¼€å­˜å‚¨ï¼›åŸºæœ¬ç±»å‹ï¼Œå˜é‡å¯¹åº”çš„å†…å­˜å—å­˜å‚¨æ•°æ®è‡ªèº« Soï¼šåŸºæœ¬ç±»å‹è¯»å†™æ•ˆç‡ã€å†…å­˜æ•ˆç‡æ›´é«˜ è‡ªåŠ¨æ‹†è£…ç®± ç©ºæŒ‡é’ˆå¼‚å¸¸ï¼šIntegerå˜é‡å¿…é¡»é€šè¿‡å®ä¾‹åŒ–å¯¹è±¡æ¥èµ‹å€¼ï¼Œè‹¥å…¶æœªç»åˆå§‹åŒ–ä¼šå‡ºç°ç©ºæŒ‡é’ˆå¼‚å¸¸ï¼ˆinté»˜è®¤èµ‹0ï¼‰ Integerçš„ç¼“å­˜ å®ç°é™æ€ç¼“å­˜æ± ï¼ˆé»˜è®¤å­˜å‚¨-128~127ï¼‰ï¼Œé€šè¿‡Integer.valueOf(int)æ–¹æ³•åˆ›å»ºè¯¥èŒƒå›´å†…çš„å¯¹è±¡æ—¶ï¼Œä¼šå¤ç”¨ç¼“å­˜ä¸­çš„ç°æœ‰å¯¹è±¡ï¼ˆfromå†…å­˜ï¼‰ é¢å‘å¯¹è±¡ é¢å‘å¯¹è±¡æ˜¯ä»€ä¹ˆï¼Ÿä¸ç‰¹æ€§ OOPï¼šç¼–ç¨‹èŒƒå¼ï¼Œå°†ç°å®ä¸–ç•Œä¸­çš„äº‹ç‰©æŠ½è±¡ä¸ºå¯¹è±¡ï¼Œå¯¹è±¡å…·æœ‰å­—æ®µï¼ˆå±æ€§ï¼‰ä¸æ–¹æ³•ï¼ˆè¡Œä¸ºï¼‰ã€‚å…·æœ‰çµæ´»æ€§ä¸å¯æ‹“å±•æ€§ ç‰¹æ€§ï¼š å°è£…ï¼šå°†å¯¹è±¡çš„å±æ€§ï¼ˆæ•°æ®ï¼‰å’Œè¡Œä¸ºï¼ˆæ–¹æ³•ï¼‰ç»“åˆï¼Œä»…ç”¨æ¥å£ä¸å¤–ç•Œäº¤äº’ã€‚\u0026ndash;\u0026gt;å¢å¼ºå®‰å…¨æ€§å’Œç®€åŒ–ç¼–ç¨‹ï¼Œä½¿å¯¹è±¡æ›´ç‹¬ç«‹ ç»§æ‰¿ï¼šä½¿å­ç±»å¯è‡ªåŠ¨å…±äº«çˆ¶ç±»æ•°æ®ç»“æ„å’Œæ–¹æ³•ï¼Œä»£ç å¤ç”¨ã€‚\u0026ndash;\u0026gt;å»ºç«‹ç±»ä¸ç±»é—´çš„å±‚æ¬¡å…³ç³»ï¼Œç»“æ„æ›´æ¸…æ™° å¤šæ€ï¼šå…è®¸ä¸åŒç±»çš„å¯¹è±¡å¯¹åŒä¸€æ¶ˆæ¯ä½œå‡ºå“åº”ï¼Œå³åŒä¸€ä¸ªæ¥å£ï¼Œä½¿ç”¨ä¸åŒå®ä¾‹è€Œæ‰§è¡Œä¸åŒæ“ä½œã€‚ç¼–è¯‘æ—¶å¤šæ€ï¼ˆé‡è½½ï¼‰å’Œè¿è¡Œæ—¶å¤šæ€ï¼ˆé‡å†™ï¼‰\u0026ndash;\u0026gt;çµæ´»æ€§ä¸æ‹“å±•æ€§ å¤šæ€ä½“ç°ï¼Ÿ æ–¹æ³•é‡è½½ï¼šåŒä¸€ç±»ä¸­å¯ä»¥æœ‰å¤šä¸ªåŒåæ–¹æ³•ï¼Œä½†å‚æ•°åˆ—è¡¨ä¸åŒã€‚ç¼–è¯‘å™¨ç¡®å®šè°ƒç”¨å“ªä¸ªæ–¹æ³• æ–¹æ³•é‡å†™ï¼šå­ç±»èƒ½å¤Ÿæä¾›å¯¹çˆ¶ç±»ä¸­åŒåæ–¹æ³•çš„å…·ä½“å®ç°ï¼ˆä¸åŒå­ç±»å¯ä»¥å®ç°ä¸åŒï¼Œä½†å‚æ•°ä¸å˜ï¼‰ã€‚JVMåœ¨è¿è¡Œæ—¶æ ¹æ®å¯¹è±¡å®é™…ç±»å‹ç¡®å®šè°ƒç”¨å“ªä¸ªæ–¹æ³• æ¥å£ä¸å®ç°ï¼šå¤šä¸ªç±»å¯ä»¥å®ç°åŒä¸€ä¸ªæ¥å£ï¼Œå¹¶ç”¨æ¥å£ç±»å‹çš„å¼•ç”¨æ¥è°ƒç”¨è¿™äº›ç±»çš„æ–¹æ³• å¦‚Dogæ˜¯Animalçš„å®ç°ç±»ï¼Œåˆ›å»ºå®ä¾‹æ—¶ç”¨ï¼šAnimal dog=new Dog();ï¼ˆdogæ˜¯Dogç±»çš„å®ä¾‹ï¼ŒAnimalæ˜¯dogçš„æ¥å£ç±»å‹ï¼‰ å‘ä¸Š/ä¸‹è½¬å‹ï¼šå­ç±»çˆ¶ç±»å…±æœ‰æ–¹æ³•å¯ç”¨å‘ä¸Šè½¬å‹è°ƒç”¨ï¼Œå­ç±»ç‰¹æœ‰æ–¹æ³•éœ€è¦çˆ¶ç±»å¯¹è±¡å‘ä¸‹è½¬å‹åè°ƒç”¨ ï¼ˆå‘ä¸Šè½¬å‹ï¼‰å­ç±»å¯¹è±¡è½¬æ¢ä¸ºçˆ¶ç±»å¯¹è±¡ï¼Œè‡ªåŠ¨è¿›è¡Œï¼ˆå¦‚Animal dog=new Dog();ï¼‰ ï¼ˆå‘ä¸‹è½¬å‹ï¼‰çˆ¶ç±»å¯¹è±¡è½¬æ¢ä¸ºå­ç±»å¯¹è±¡ï¼Œæ‰§è¡Œå‰éœ€ç¡®è®¤å¼•ç”¨å®é™…æŒ‡å‘çš„å¯¹è±¡ï¼Œé¿å…ClassCastException å¤šæ€ä½œç”¨ meaningï¼šå­ç±»å¯ä»¥æ›¿æ¢çˆ¶ç±»ï¼Œåœ¨å®é™…çš„ä»£ç è¿è¡Œè¿‡ç¨‹ä¸­ï¼Œè°ƒç”¨å­ç±»çš„æ–¹æ³•å®ç°ã€‚éœ€è¦ç»§æ‰¿ã€æ¥å£ç±»ç­‰è¯­æ³•æœºåˆ¶ ä½œç”¨ï¼šæé«˜ä»£ç çš„æ‰©å±•æ€§å’Œå¤ç”¨æ€§ã€‚ OOPçš„è®¾è®¡åŸåˆ™ å•ä¸€èŒè´£åŸåˆ™SRPï¼šä¸€ä¸ªç±»åº”è¯¥åªè´Ÿè´£ä¸€é¡¹èŒè´£ å¼€æ”¾å°é—­åŸåˆ™OCPï¼šè½¯ä»¶å®ä½“åº”è¯¥å¯¹æ‰©å±•ï¼ˆentendsï¼Œå­ç±»ï¼‰å¼€æ”¾ï¼Œå¯¹ä¿®æ”¹å°é—­ã€‚ï¼ˆå³å¯ä»¥ç»§æ‰¿è¿™ä¸ªç±»ï¼Œä½†ä¸èƒ½ä¿®æ”¹ç±»æœ¬èº«ï¼‰ é‡Œæ°æ›¿æ¢åŸåˆ™LSPï¼šå­ç±»å¯¹è±¡åº”è¯¥èƒ½å¤Ÿæ›¿æ¢æ‰æ‰€æœ‰çˆ¶ç±»å¯¹è±¡ã€‚ï¼ˆä¸æ”¹å˜çˆ¶ç±»é¢„æœŸè¡Œä¸ºç­‰ï¼‰ æ¥å£éš”ç¦»åŸåˆ™ISPï¼šå®¢æˆ·ç«¯ä¸åº”è¯¥ä¾èµ–é‚£äº›å®ƒä¸éœ€è¦çš„æ¥å£ ä¾èµ–å€’ç½®åŸåˆ™DIPï¼šé«˜å±‚æ¨¡å—ä¸åº”è¯¥ä¾èµ–ä½å±‚æ¨¡å—ï¼ŒäºŒè€…éƒ½åº”è¯¥ä¾èµ–äºæŠ½è±¡ æœ€å°‘çŸ¥è¯†åŸåˆ™ï¼šä¸€ä¸ªå¯¹è±¡åº”å½“å¯¹å…¶ä»–å¯¹è±¡æœ‰æœ€å°‘çš„äº†è§£ æŠ½è±¡ç±»ä¸æ™®é€šç±»åŒºåˆ« å®ä¾‹åŒ–ï¼šæŠ½è±¡ç±»ä¸èƒ½è¢«å®ä¾‹åŒ–ï¼Œåªèƒ½è¢«ç»§æ‰¿ æ–¹æ³•å®ç°ï¼šæŠ½è±¡ç±»ä¸­çš„æ–¹æ³•å¯ä»¥æœ‰å®ç°ä¹Ÿå¯ä»¥æ²¡æœ‰å®ç° ç»§æ‰¿ï¼šä¸€ä¸ªç±»åªèƒ½ç»§æ‰¿ä¸€ä¸ªç±»ï¼ˆanyï¼‰ï¼Œä½†å¯ç»§æ‰¿ï¼ˆæ™®é€šç±»ï¼‰/å®ç°ï¼ˆæŠ½è±¡ç±»ï¼‰å¤šä¸ªæ¥å£ é™åˆ¶ï¼šæ™®é€šç±»å¯ä»¥è¢«å…¶ä»–ç±»ç»§æ‰¿\u0026amp;ä½¿ç”¨ï¼ŒæŠ½è±¡ç±»ä¸€èˆ¬ç”¨ä½œåŸºç±» æŠ½è±¡ç±» vs æ¥å£ äºŒè€…ç‰¹ç‚¹ï¼š æŠ½è±¡ç±»ï¼šå¯ä»¥æœ‰æˆå‘˜å˜é‡ã€æ„é€ æ–¹æ³•å’Œå…·ä½“æ–¹æ³•\u0026ndash;\u0026gt;é€‚ç”¨ç»§æ‰¿å…³ç³» æ¥å£ï¼šå¯ä»¥å¤šå®ç°ï¼Œåªèƒ½æœ‰å¸¸é‡å’ŒæŠ½è±¡æ–¹æ³•ï¼ˆæ— æ„é€ æ–¹æ³•ï¼‰ï¼ˆJava8åå¯ä»¥æœ‰é»˜è®¤æ–¹æ³•ä¸é™æ€æ–¹æ³•\u0026ndash;\u0026gt;å®šä¹‰è¡Œä¸ºè§„èŒƒä¸ç±»çš„åŠŸèƒ½ åŒºåˆ«ï¼š å®ç°ï¼šæ¥å£ç”¨implementsï¼ŒæŠ½è±¡ç±»ç”¨extendsï¼Œä¸€ä¸ªç±»å¤šæ¥å£å•æŠ½è±¡ç±» æ–¹æ³•ï¼šæ¥å£ä¸èƒ½æœ‰æ–¹æ³•çš„å®ç°ï¼Œjava8ä¸­å¯å®šä¹‰defaultæ–¹æ³•ä½“ã€‚æŠ½è±¡ç±»æ— é™åˆ¶ è®¿é—®ä¿®é¥°ç¬¦ï¼š æ¥å£æˆå‘˜å˜é‡é»˜è®¤public static finalï¼Œå¿…é¡»èµ‹åˆå€¼ä¸èƒ½è¢«ä¿®æ”¹ï¼ˆfinalç‰¹æ€§ï¼‰ï¼Œæ‰€æœ‰æˆå‘˜æ–¹æ³•éƒ½æ˜¯publicã€abstractçš„ æŠ½è±¡ç±»ä¸­æˆå‘˜å˜é‡é»˜è®¤defaultï¼Œå¯è¢«å­ç±»é‡æ–°å®šä¹‰orèµ‹å€¼ï¼ŒæŠ½è±¡æ–¹æ³•è¢«abstractä¿®é¥°ï¼Œä¸èƒ½è¢«privateã€staticã€synchronizedå’Œnativeç­‰ä¿®é¥°ï¼Œå¿…é¡»ä»¥åˆ†å·ç»“å°¾ï¼Œä¸å¸¦èŠ±æ‹¬å· å˜é‡ï¼šæ¥å£åªèƒ½åŒ…å«ï¼ˆé™æ€ï¼‰å¸¸é‡ï¼›æŠ½è±¡ç±»å¯åŒ…å«å®ä¾‹å˜é‡ä¸é™æ€å¸¸é‡ æŠ½è±¡ç±»å¯åŠ finalå—ï¼Ÿ noã€‚æŠ½è±¡ç±»æ˜¯è¢«ç»§æ‰¿çš„ï¼Œfinalç¦æ­¢ç±»çš„ç»§æ‰¿ or æ–¹æ³•é‡å†™ æ¥å£å¯ä»¥å®šä¹‰ä»€ä¹ˆæ–¹æ³•ï¼Ÿ æŠ½è±¡æ–¹æ³•ï¼šæ ¸å¿ƒï¼Œæ‰€æœ‰å®ç°æ¥å£çš„ç±»å¿…é¡»å®ç°è¿™äº›æ–¹æ³• é»˜è®¤æ–¹æ³•ï¼šå…è®¸æ¥å£æä¾›å…·ä½“å®ç°ã€‚å®ç°ç±»å¯ä»¥é‡å†™é»˜è®¤æ–¹æ³• é™æ€æ–¹æ³•ï¼šå±äºæ¥å£æœ¬èº«ï¼Œå¯ä»¥é€šè¿‡æ¥å£åç›´æ¥è°ƒç”¨ï¼Œä¸éœ€å®ç°ç±»çš„å¯¹è±¡ ç§æœ‰æ–¹æ³•ï¼šJava9å¼•å…¥ã€‚ä¸ºé»˜è®¤/ç§æœ‰æ–¹æ³•æä¾›è¾…åŠ©åŠŸèƒ½ æŠ½è±¡ç±»å¯ä»¥è¢«å®ä¾‹åŒ–å—ï¼Ÿ è‡ªèº«ä¸èƒ½è¢«å®ä¾‹åŒ–\u0026ndash;\u0026gt;ä¸èƒ½ç›´æ¥newä¸€ä¸ªå¯¹è±¡ã€‚ä½†å¯ä»¥æœ‰æ„é€ å™¨ï¼Œåˆ›å»ºå­ç±»å®ä¾‹æ—¶é—´æ¥ä½¿ç”¨ï¼ˆä¸éœ€æŒ‡å®šsuperï¼Œå…ˆè°ƒç”¨çˆ¶ç±»æ„é€ å™¨ï¼Œåè°ƒç”¨å­ç±»æ„é€ å™¨ï¼‰ é™æ€å˜é‡ä¸é™æ€æ–¹æ³• é™æ€å˜é‡ï¼šå±äºç±»è€Œéå…·ä½“çš„å¯¹è±¡ å…±äº«æ€§ï¼šæ‰€æœ‰è¯¥ç±»çš„å®ä¾‹å…±äº«åŒä¸€ä¸ªé™æ€å˜é‡ã€‚ä¸€ä¸ªå®ä¾‹ä¿®æ”¹ï¼Œå…¶å®ƒå®ä¾‹å‡çŸ¥æ™“ åˆå§‹åŒ–ï¼šåœ¨ç±»è¢«åŠ è½½æ—¶åˆå§‹åŒ–ï¼Œåªåˆ†é…ä¸€æ¬¡å†…å­˜ è®¿é—®æ–¹å¼ï¼šå¯ä»¥ç›´æ¥é€šè¿‡ç±»åè®¿é—®ï¼Œä¹Ÿå¯ä»¥é€šè¿‡å®ä¾‹è®¿é—®ï¼ˆå»ºè®®ç±»åï¼‰ é™æ€æ–¹æ³•ï¼š æ— å®ä¾‹ä¾èµ–ï¼šå¯åœ¨æ²¡æœ‰åˆ›å»ºç±»å®ä¾‹çš„æƒ…å†µä¸‹è°ƒç”¨ï¼Œä¸èƒ½ç›´æ¥è®¿é—®éé™æ€çš„æˆå‘˜å˜é‡ or æ–¹æ³•ï¼ˆå› ä¸ºæ— ä¸Šä¸‹æ–‡çš„å®ä¾‹ï¼‰ ç›´æ¥è®¿é—®é™æ€æˆå‘˜ å¤šæ€æ€§ï¼šä¸æ”¯æŒé‡å†™ï¼Œå¯ä»¥è¢«Hide ä½¿ç”¨åœºæ™¯ï¼š é™æ€å˜é‡ï¼šéœ€è¦åœ¨æ‰€æœ‰å¯¹è±¡é—´å…±äº«çš„æ•°æ®ï¼Œå¦‚è®¡æ•°å™¨ã€å¸¸é‡ç­‰ é™æ€æ–¹æ³•ï¼šå¸¸ç”¨äºåŠ©æ‰‹æ–¹æ³•ï¼ˆutility methodsï¼‰è·å–ç±»çº§åˆ«çš„ä¿¡æ¯æˆ–è€…æ˜¯æ²¡æœ‰ä¾èµ–äºå®ä¾‹çš„æ•°æ®å¤„ç† éé™æ€å†…éƒ¨ç±»ä¸é™æ€å†…éƒ¨ç±»åŒºåˆ«ï¼ˆä»¥ä¸‹åªåˆ—å‡ºéé™æ€ç‰¹ç‚¹ï¼‰ å¤–éƒ¨ç±»å®ä¾‹çš„ä¾èµ– è®¿é—®å¤–éƒ¨ç±»çš„å˜é‡ã€æ–¹æ³• ä¸èƒ½å®šä¹‰é™æ€æˆå‘˜ ä¸èƒ½ç‹¬ç«‹å®ä¾‹åŒ– å¯ä»¥è®¿é—®å¤–éƒ¨ç±»çš„ç§æœ‰æˆå‘˜ éé™æ€å†…éƒ¨ç±»æ€ä¹ˆç›´æ¥è®¿é—®å¤–éƒ¨æ–¹æ³• ç¼–è¯‘å™¨åœ¨ç”Ÿæˆå­—èŠ‚ç æ—¶ä¼šä¸ºéé™æ€å†…éƒ¨ç±»ç»´æŠ¤ä¸€ä¸ªæŒ‡å‘å¤–éƒ¨ç±»å®ä¾‹çš„å¼•ç”¨ã€‚ç”Ÿæˆéé™æ€å†…éƒ¨ç±»çš„æ„é€ æ–¹æ³•æ—¶ï¼Œå°†å¤–éƒ¨ç±»å®ä¾‹ä½œä¸ºå‚æ•°ä¼ å…¥ çˆ¶ç±»ã€å­ç±»çš„é™æ€æ–¹æ³•ï¼Œåœ¨newå­ç±»å¯¹è±¡æ—¶çš„åŠ è½½é¡ºåº çˆ¶ç±»é™æ€\u0026ndash;\u0026gt;å­ç±»é™æ€\u0026ndash;\u0026gt;çˆ¶ç±»æ„é€ å™¨\u0026ndash;\u0026gt;å­ç±»æ„é€ å™¨ æ‹·è´ æ·±æµ…æ‹·è´ï¼š æµ…æ‹·è´ï¼šåªå¤åˆ¶å¯¹è±¡æœ¬èº«å’Œå…¶å†…éƒ¨çš„å€¼ç±»å‹å­—æ®µï¼Œä¸å¤åˆ¶å¯¹è±¡å†…éƒ¨çš„å¼•ç”¨ç±»å‹å­—æ®µ\u0026ndash;\u0026gt;å…±äº«å¼•ç”¨ æ·±æ‹·è´ï¼šå°†å¯¹è±¡å†…éƒ¨çš„æ‰€æœ‰å¼•ç”¨ç±»å‹å­—æ®µçš„å†…å®¹ä¹Ÿå¤åˆ¶ï¼ˆå®Œå…¨ç‹¬ç«‹ï¼‰ å®ç°æ·±æ‹·è´çš„æ–¹æ³•ï¼š å®ç° Cloneable æ¥å£å¹¶é‡å†™ clone() æ–¹æ³•ï¼šè¦æ±‚å¯¹è±¡åŠå…¶æ‰€æœ‰å¼•ç”¨ç±»å‹å­—æ®µéƒ½å®ç°æ¥å£å¹¶é‡å†™æ–¹æ³•ï¼ˆclone()é€šè¿‡é€’å½’å…‹éš†å®ç°æ·±æ‹·è´ï¼‰ åºåˆ—åŒ–ä¸ååºåˆ—åŒ–ï¼šå¯¹è±¡åºåˆ—åŒ–ä¸ºå­—èŠ‚æµï¼Œå†ä»å­—èŠ‚æµååºåˆ—åŒ–ä¸ºå¯¹è±¡\u0026ndash;\u0026gt;è¦æ±‚å¯¹è±¡ä¸å¼•ç”¨ç±»å‹éƒ½å®ç° Serializable æ¥å£ æ‰‹åŠ¨é€’å½’å¤åˆ¶ï¼šå¯¹è±¡åŠå¼•ç”¨ç±»å‹å­—æ®µ å¦‚Listé‡Œnew AyyayList\u0026lt;\u0026gt;(list) ç‰¹æ€§ æ³›å‹ ä»€ä¹ˆæ˜¯æ³›å‹ å…è®¸ç±»ã€æ¥å£å’Œæ–¹æ³•åœ¨å®šä¹‰æ—¶ä½¿ç”¨ä¸€ä¸ªæˆ–å¤šä¸ªç±»å‹å‚æ•°ï¼Œä½¿ç”¨æ—¶ç±»å‹å‚æ•°å¯ä»¥è¢«æŒ‡å®šä¸ºå…·ä½“çš„ç±»å‹ why need æ³›å‹ é€‚ç”¨äºå¤šç§æ•°æ®ç±»å‹æ‰§è¡Œç›¸åŒçš„ä»£ç \u0026ndash;\u0026gt;ä»£ç å¤ç”¨ æ³›å‹ä¸­çš„ç±»å‹åœ¨ä½¿ç”¨æ—¶æŒ‡å®šï¼Œä¸éœ€è¦å¼ºåˆ¶ç±»å‹è½¬æ¢ï¼ˆå¦‚ï¼šä¸æŒ‡å®šæ—¶ï¼Œå–å‡ºæ—¶éœ€è½¬æ¢ï¼‰\u0026ndash;\u0026gt;ä¿è¯ç±»å‹å®‰å…¨ï¼Œç¼–è¯‘å™¨æ¥æ£€æŸ¥ åå°„ éœ€è¦å¼€å‘è€…è°ƒç”¨æŸäº›æ–¹æ³•å®ç°ï¼ŒSpringåº•å±‚å¤§é‡ä½¿ç”¨åå°„ï¼ˆæœ‰æ¶‰åŠåå°„çš„ç›¸å…³ä»£ç ï¼‰\nä»€ä¹ˆæ˜¯åå°„ è¿è¡Œæ—¶ï¼Œå¯¹äºä»»æ„ä¸€ä¸ªç±»ï¼Œéƒ½èƒ½å¤ŸçŸ¥é“è¿™ä¸ªç±»ä¸­çš„æ‰€æœ‰å±æ€§å’Œæ–¹æ³•ï¼Œå¯¹äºä»»æ„ä¸€ä¸ªå¯¹è±¡ï¼Œéƒ½èƒ½å¤Ÿè°ƒç”¨å®ƒçš„ä»»æ„ä¸€ä¸ªæ–¹æ³•å’Œå±æ€§ã€‚åŠ¨æ€è·å–çš„ä¿¡æ¯ä»¥åŠåŠ¨æ€è°ƒç”¨å¯¹è±¡çš„æ–¹æ³•çš„åŠŸèƒ½==\u0026gt;åå°„æœºåˆ¶ ç‰¹æ€§ è¿è¡Œæ—¶ç±»ä¿¡æ¯è®¿é—®â€”â€”å®Œæ•´ä¿¡æ¯ï¼Œçˆ¶ç±»ã€æ¥å£ã€åŒ…åã€æ„é€ å‡½æ•°ã€æ–¹æ³•ã€å­—æ®µ åŠ¨æ€å¯¹è±¡åˆ›å»ºâ€”â€”åå°„APIåŠ¨æ€åœ°åˆ›å»ºå¯¹è±¡å®ä¾‹ï¼Œå³ä½¿åœ¨ç¼–è¯‘æ—¶ä¸çŸ¥é“å…·ä½“çš„ç±»åï¼ˆnewInstance()ï¼‰ åŠ¨æ€æ–¹æ³•è°ƒç”¨â€”â€”è¿è¡Œæ—¶åŠ¨æ€åœ°è°ƒç”¨å¯¹è±¡çš„æ–¹æ³•ï¼ŒåŒ…æ‹¬ç§æœ‰æ–¹æ³•ï¼ˆMethodç±»åœ°invoke()æ–¹æ³•ï¼‰ è®¿é—®ä¸ä¿®æ”¹å­—æ®µå€¼â€”â€”å…è®¸ç¨‹åºåœ¨è¿è¡Œæ—¶è®¿é—®å’Œä¿®æ”¹å¯¹è±¡çš„å­—æ®µå€¼ï¼Œå³ä½¿æ˜¯ç§æœ‰çš„ï¼ˆFieldç±»çš„get()/set()æ–¹æ³•ï¼‰ åº”ç”¨åœºæ™¯ åŠ è½½æ•°æ®åº“é©±åŠ¨ é…ç½®æ–‡ä»¶åŠ è½½â€”â€”IOCåŠ è½½Bean å°†æ‰€æœ‰XMLæˆ–propertiesé…ç½®æ–‡ä»¶å¤¹è½½å…¥å†…å­˜\u0026ndash;\u0026gt;è§£æå…¶å†…å®¹ï¼Œå¾—åˆ°å¯¹åº”å®ä½“ç±»çš„ å­—èŠ‚ç å­—ç¬¦ä¸² ç­‰\u0026ndash;\u0026gt;åˆ©ç”¨åå°„ï¼Œæ ¹æ®å­—ç¬¦ä¸²å¾—åˆ°ç±»çš„å®ä¾‹\u0026ndash;\u0026gt;åŠ¨æ€é…ç½®å®ä¾‹å±æ€§ æ³¨è§£ æ³¨è§£åŸç† æœ¬è´¨æ˜¯ä¸€ä¸ªç»§æ‰¿äº†Annotationæ¥å£çš„æ¥å£ï¼Œå®ç°ç±»æ˜¯Javaè¿è¡Œæ—¶ç”Ÿæˆçš„åŠ¨æ€ä»£ç†ç±»ï¼ˆç”¨è¿™ä¸ªç±»å­˜å‚¨æ³¨è§£ä¸­çš„å±æ€§ç­‰ï¼Œè°ƒç”¨æ³¨è§£æ–¹æ³•æ—¶ï¼Œä»£ç†ç±»è¿”å›å­˜å‚¨çš„å€¼ï¼‰ æ³¨è§£ä½œç”¨åŸŸScope ç±»çº§åˆ«ã€æ–¹æ³•çº§åˆ«ã€å­—æ®µçº§åˆ«ã€ï¼ˆæ„é€ å‡½æ•°ä½œç”¨åŸŸã€å±€éƒ¨å˜é‡ä½œç”¨åŸŸï¼‰ å¯ä»¥æŒ‡å®šå±æ€§ï¼Œå¦‚è®¿é—®çº§åˆ«ã€æ³¨é‡Šç­‰ å¯¹è±¡ åˆ›å»ºå¯¹è±¡çš„æ–¹å¼ new Classæˆ–Constructorç±»çš„newInstance()æ–¹æ³•ï¼ˆå³åå°„æœºåˆ¶ï¼‰ clone() \u0026amp; ååºåˆ—åŒ–ï¼ˆå³æ·±æ‹·è´ï¼‰ clone()è¦å®ç°Cloneableæ¥å£ï¼Œååºåˆ—åŒ–ï¼ˆç±»ï¼‰è¦å®ç°Serializableæ¥å£ newçš„å¯¹è±¡ä»€ä¹ˆæ—¶å€™å›æ”¶ åƒåœ¾å›æ”¶å™¨å›æ”¶ï¼Œå›æ”¶æ—¶æœºå–å†³äºï¼š å¼•ç”¨è®¡æ•°æ³•ï¼šæŸå¯¹è±¡çš„å¼•ç”¨è®¡æ•°ä¸º0æ—¶==\u0026gt;ä¸å†è¢«å¼•ç”¨ å¯è¾¾æ€§åˆ†æç®—æ³•ï¼šä»æ ¹å¯¹è±¡å‡ºå‘ï¼Œé€šè¿‡å¯¹è±¡çš„å¼•ç”¨é“¾éå†ï¼Œæ‹–ä¸å­˜åœ¨åˆ°è¾¾æŸå¯¹è±¡çš„å¼•ç”¨é“¾\u0026ndash;\u0026gt;å›æ”¶ ç»ˆç»“å™¨ï¼šé‡å†™finalize()æ–¹æ³•çš„å¯¹è±¡ï¼Œå›æ”¶å¯¹è±¡å‰ä¼šè°ƒç”¨è¯¥æ–¹æ³• å¼‚å¸¸ å“ªäº›å¼‚å¸¸ åŸºäºThrowableåŠå…¶å­ç±»ï¼Œå­ç±»åŒ…æ‹¬Errorä¸Exception Errorï¼šè¡¨ç¤ºè¿è¡Œæ—¶ç¯å¢ƒçš„é”™è¯¯ï¼Œç¨‹åºæ— æ³•å¤„ç†ã€‚å¦‚StackOverFlowError Exceptionï¼š éè¿è¡Œæ—¶å¼‚å¸¸ï¼šå¿…é¡»ç¼–è¯‘æ—¶æ•è·æˆ–æŠ›å‡ºï¼Œä¸€èˆ¬ä¸ºå¤–éƒ¨é”™è¯¯ã€‚å¦‚FileNotFoundExceptionï¼Œé™¤RuntimeExceptionåŠå…¶å­ç±»çš„å¼‚å¸¸ å—ç¼–è¯‘å™¨æ£€æŸ¥ï¼ˆcodeæ—¶å°±æ£€æŸ¥ï¼‰ è¿è¡Œæ—¶å¼‚å¸¸ï¼šç¨‹åºé”™è¯¯å¯¼è‡´ã€‚å¦‚NullPointerExceptionã€ArrayIndexOutOfBoundException ä¸å—ç¼–è¯‘å™¨æ£€æŸ¥ï¼ˆè¿è¡Œæ—¶æ‰èƒ½å‘ç°ï¼‰ å¼‚å¸¸å¤„ç† try-catch-finallyï¼š try{} catch (Exception1 e1){ // å¤„ç†ç¬¬ä¸€ç±»å¼‚å¸¸çš„é€»è¾‘ï¼Œæ¯”å¦‚ğŸ‘‡ throw new Exception1(\u0026#34;Exception Happend!\u0026#34;); } catch (Exception2 e2){} finally { // å¯é€‰ï¼Œå®šä¹‰æ— è®ºæœ‰å¦å¼‚å¸¸éƒ½è¦æ‰§è¡Œçš„ä»£ç å— // ä¸€èˆ¬ç”¨äºèµ„æºé‡Šæ”¾ } throwsï¼šæ–¹æ³•ä¸­å£°æ˜å¯èƒ½æŠ›å‡ºçš„å¼‚å¸¸ç±»å‹ï¼Œå°†å¼‚å¸¸ä¼ é€’ç»™è°ƒç”¨è€…å¤„ç† tryä¸finallyï¼Œreturnå“ªä¸€ä¸ª è¿”å›finallyä¸­çš„returnå€¼\u0026ndash;\u0026gt;tryä¸­çš„è¿”å›å€¼æš‚å­˜ï¼Œæ‰§è¡Œfinallyï¼Œæœ€ç»ˆtryçš„ç»“æœè¢«è¦†ç›– Java1.8æ–°ç‰¹æ€§â€”â€”Stream \u0026amp; completableFuture Javaçš„stream API æä¾›é«˜æ•ˆä¸”æ˜“äºä½¿ç”¨çš„æ•°æ®å¤„ç†æ–¹å¼ï¼Œç‰¹åˆ«é€‚åˆé›†åˆå¯¹è±¡çš„æ“ä½œï¼Œå¦‚è¿‡æ»¤ã€æ˜ å°„ã€æ’åºç­‰ã€‚ æé«˜ä»£ç çš„å¯è¯»æ€§å’Œç®€æ´æ€§ï¼Œè¿˜èƒ½åˆ©ç”¨å¤šæ ¸å¤„ç†å™¨çš„ä¼˜åŠ¿è¿›è¡Œå¹¶è¡Œå¤„ç† stream APIæ¡ˆä¾‹ è¿‡æ»¤ List\u0026lt;String\u0026gt; ans=list.stream() .filter(s -\u0026gt; s.length()\u0026gt;3) .collect(Collectors.toList()); æ±‚å’Œ streamæµçš„å¹¶è¡ŒAPIæ˜¯ä»€ä¹ˆ ParallelStreamã€‚å°†æºæ•°æ®forkä¸ºå¤šä¸ªå­æµè¿›è¡Œå¤šçº¿ç¨‹æ“ä½œï¼Œå¤„ç†ç»“æœjoinä¸ºä¸€ä¸ªæµå¯¹è±¡\u0026ndash;\u0026gt;åº•å±‚ä¸ºé€šç”¨çš„fork/joinæ±  åºåˆ—åŒ– æ€ä¹ˆæŠŠä¸€ä¸ªå¯¹è±¡ä»ä¸€ä¸ªjvmè½¬ç§»åˆ°å…¶å®ƒjvm åºåˆ—åŒ–ä¸ååºåˆ—åŒ–ï¼šå­—èŠ‚æµ æ¶ˆæ¯ä¼ é€’æœºåˆ¶ï¼šæ¶ˆæ¯é˜Ÿåˆ—/ç½‘ç»œå¥—æ¥å­—é€šä¿¡ï¼Œéœ€è‡ªå®šåè®®æ¥åºåˆ—åŒ–å¯¹è±¡ è¿œç¨‹æ–¹æ³•è°ƒç”¨ï¼ˆRPCï¼‰ å…±äº«æ•°æ®åº“æˆ–ç¼“å­˜ Javaé»˜è®¤åºåˆ—åŒ–çš„ç¼ºç‚¹ ä¸»æµåºåˆ—åŒ–æ¡†æ¶ï¼šProtobufã€FastJson\næ— æ³•è·¨è¯­è¨€ï¼šåºåˆ—åŒ–æ¡†æ¶ä¸åè®®å…¶ä»–è¯­è¨€æ²¡æœ‰å®ç° æ˜“è¢«æ”»å‡»ï¼šååºåˆ—åŒ–é€šè¿‡ObjectInputStreamä¸Šè°ƒç”¨readObject()è¿›è¡Œï¼Œå¯ä»¥å°†ç±»è·¯å¾„ä¸Šå‡ ä¹æ‰€æœ‰å®ç°äº† Serializable æ¥å£çš„å¯¹è±¡éƒ½å®ä¾‹åŒ–\u0026ndash;\u0026gt;å¯æ‰§è¡Œä»»æ„ç±»å‹çš„ä»£ç  åºåˆ—åŒ–åæµå¤ªå¤§ï¼šäºŒè¿›åˆ¶æ•°ç»„è¶Šå¤§ï¼Œå ç”¨ç©ºé—´è¶Šå¤š å…·ä½“æ€ä¹ˆè½¬å¯¹è±¡ä¸ºäºŒè¿›åˆ¶å­—èŠ‚æµ åºåˆ—åŒ–ç”¨ObjectOutPutStreamçš„writeObjectï¼Œè·å–è¾“å‡ºæµï¼Œå¯å†™å…¥äºŒè¿›åˆ¶æ–‡ä»¶ä¸­ï¼Œåˆ›å»ºè¾“å…¥æµå¹¶è¯»å–å¯¹è±¡è¿›è¡Œååºåˆ—åŒ– éœ€è¦ç¡®ä¿ç±»å®ç°äº†Serializableæ¥å£ï¼Œå¹¶ä¸”æ‰€æœ‰æˆå‘˜å˜é‡éƒ½æ˜¯Serializableçš„ï¼ˆåŸç”Ÿç±»å‹å¦‚intè‡ªåŠ¨æ”¯æŒï¼Œå…¶å®ƒå¼•ç”¨ç±»å‹éœ€è¦å®ç°è¯¥æ¥å£ï¼‰ è®¾è®¡æ¨¡å¼ ä»£ç†æ¨¡å¼å’Œé€‚é…å™¨æ¨¡å¼çš„åŒºåˆ« ç›®çš„ï¼šä»£ç†æ¨¡å¼å…³æ³¨æ§åˆ¶å¯¹å¯¹è±¡çš„è®¿é—®ï¼Œé€‚é…å™¨ç”¨äºæ¥å£è½¬æ¢ï¼Œä½¿ä¸å…¼å®¹çš„ç±»èƒ½ä¸€èµ·å·¥ä½œ ç»“æ„ï¼šä»£ç†ä¸€èˆ¬åŒ…å«æŠ½è±¡ä¸»é¢˜ã€çœŸæ˜¯ä¸»é¢˜å’Œä»£ç†ä¸‰ä¸ªè§’è‰²ï¼Œé€‚é…å™¨æ¨¡å¼åŒ…å«ç›®æ ‡æ¥å£ã€é€‚é…å™¨å’Œè¢«é€‚é…è€…ä¸‰ä¸ªè§’è‰² åº”ç”¨åœºæ™¯ï¼šä»£ç†æ¨¡å¼å¸¸ç”¨äºæ·»åŠ é¢å¤–åŠŸèƒ½æˆ–æ§åˆ¶å¯¹å¯¹è±¡çš„è®¿é—®ï¼Œé€‚é…å™¨æ¨¡å¼å¸¸ç”¨äºè®©ä¸å…¼å®¹çš„æ¥å£ååŒå·¥ä½œ I/O Javaæ€ä¹ˆå®ç°ç½‘ç»œIOé«˜å¹¶å‘ç¼–ç¨‹ Java NIO\u0026ndash;\u0026gt;åŒæ­¥éé˜»å¡IOæ¨¡å‹ï¼ŒåŸºäºIOå¤šè·¯å¤ç”¨å®ç° NIOã€BIOã€AIO BIOï¼šblocking IOï¼ŒåŸºäºæµæ¨¡å‹ï¼ŒåŒæ­¥é˜»å¡äº¤äº’\u0026ndash;\u0026gt;ä¸€ä¸ªçº¿ç¨‹å¤„ç†ä¸€ä¸ªIO NIOï¼šnon-blocking IOï¼ŒJava1.4å¼•å…¥ï¼Œå¤šè·¯å¤ç”¨ï¼ŒåŒæ­¥éé˜»å¡ AIOï¼šasynchronous IOï¼ŒJava1.7å¼•å…¥ï¼Œå¼‚æ­¥éé˜»å¡ NIOå®ç° ç”¨åˆ°NIOçš„æ¡†æ¶\u0026ndash;\u0026gt;Netty\nåŒæ­¥æ ¸å¿ƒä¸ºSelectorï¼Œä»£æ›¿çº¿ç¨‹æœ¬èº«çš„è½®è¯¢IOäº‹ä»¶ ç‰¹æ®Š ==ä¸equalsçš„åŒºåˆ« é‡å†™äº†equalsçš„ç±»ï¼š==æ¯”è¾ƒå†…å­˜çš„é¦–åœ°å€ï¼ˆå³æ˜¯å¦æŒ‡å‘åŒä¸ªå¯¹è±¡ï¼‰ï¼Œequalsæ¯”è¾ƒå†…å®¹ å¦‚Stringã€åŒ…è£…ç±»ä¸Listã€Seté›†åˆç±» ä½¿ç”¨Object.equals()çš„ç±»ï¼šéƒ½æ¯”è¾ƒå†…å­˜é¦–åœ°å€ nativeæ–¹æ³• å…è®¸Javaè°ƒç”¨å¤–éƒ¨çš„æœ¬åœ°ä»£ç ï¼Œå¦‚Cppä»£ç ã€‚nativeæ˜¯ä¸€ç§å£°æ˜ï¼Œæ ‡è®°æ–¹æ³•çš„å®ç°åœ¨å¤–éƒ¨å®šä¹‰ å®ç°nativeæ–¹æ³•éœ€è¦ï¼šJNIå¤´æ–‡ä»¶ç”Ÿæˆï¼ˆC/Cppçš„å¤´æ–‡ä»¶ï¼‰\u0026ndash;\u0026gt;æœ¬åœ°ä»£ç å®ç°\u0026ndash;\u0026gt;ç¼–è¯‘æœ¬åœ°ä»£ç ï¼ˆåŠ¨æ€é“¾æ¥åº“on Winæˆ–å…±äº«åº“ on Linuxï¼‰\u0026ndash;\u0026gt;åŠ è½½æœ¬åœ°åº“ï¼ŒJVMè°ƒç”¨nativeæ–¹æ³•çš„å®ç° æ’åº å®ç°Comparableæ¥å£ï¼Œé‡å†™compareToæ–¹æ³• public class Students implements Comparable\u0026lt;Student\u0026gt;{ private int id; private int score; // ç•¥ @Override public int compareTo(Student other){ if(this.score!=other.score) return Integer.compare(other.score,this.score); // é™åº else return Integer.compare(this.id,other.id); // å‡åº } } é›†åˆ æ€»ä½“æ¦‚å¿µ æ•°ç»„ä¸é›†åˆçš„åŒºåˆ« æ•°ç»„å®šé•¿ï¼Œé›†åˆåŠ¨æ€é•¿åº¦ æ•°ç»„å¯ä»¥åŒ…å«åŸºæœ¬ç±»å‹ä¸å¯¹è±¡ï¼ˆå¼•ç”¨ç±»å‹ï¼‰ï¼Œé›†åˆä»…å¯¹è±¡ æ•°ç»„å¯ä»¥ç›´æ¥è®¿é—®å…ƒç´ ï¼Œé›†åˆéœ€è¦è¿­ä»£å™¨ç­‰æ–¹æ³•è®¿é—® å“ªäº›é›†åˆ Listâ€”â€”æœ‰åºCollectionï¼Œå¸¸ç”¨å®ç°ç±»æœ‰LinkedListã€ArrayListã€Vectorã€Stack ArrayListï¼šçº¿ç¨‹ä¸å®‰å…¨ï¼Œåº•å±‚ä½¿ç”¨æ•°ç»„ï¼ˆæ‰©å®¹æ—¶åˆ›å»ºæ›´å¤§æ•°ç»„åå¤åˆ¶ï¼‰ã€‚æ”¯æŒå¿«é€Ÿéšæœºè®¿é—®å…ƒç´ ï¼Œæ’å…¥åˆ é™¤æ…¢ LinkedListï¼šåº•å±‚åŒå‘é“¾è¡¨ï¼Œæ’å…¥åˆ é™¤å¿«ï¼Œè®¿é—®æ…¢ Mapâ€”â€”é”®å€¼å¯¹é›†åˆï¼Œæ²¡ç»§æ‰¿Collectionæ¥å£ã€‚ä¸»è¦å®ç°TreeMapã€HashMapã€HashTableã€LinkedHashMapã€ConcurrentHashMap HashMap å“ˆå¸ŒåŸæœ¬çš„å­˜å‚¨ç»“æ„å³æ•°ç»„ã€‚è§£å†³å“ˆå¸Œå†²çªçš„æ–¹æ³•\u0026ndash;\u0026gt;æ”¾çš„åœ°æ–¹å˜å¤šã€å¼€æ”¾åœ°å€ï¼ˆçº¿æ€§æ¢æµ‹ï¼Œå‘åæ”¾ä¸€ä½ï¼Œæ³¨æ„å–æ¨¡ \u0026amp; äºŒæ¬¡æ¢æµ‹ï¼Œå‘å‰åèµ°i^2ä½ï¼‰ã€å»ºç«‹æº¢å‡ºåŒºã€‘/ç®—çš„æ–¹æ³•å˜å¤šï¼ˆå¤šä¸ªå“ˆå¸Œå‡½æ•°è®¡ç®—ç›´åˆ°ä¸å†²çªï¼‰ LinkedHashMapï¼šç»§æ‰¿HashMapï¼Œåœ¨å…¶åŸºç¡€ä¸Šå¢åŠ äº†åŒå‘é“¾è¡¨ï¼Œä¿æŒæ’å…¥é¡ºåº HashTableï¼šæ•°ç»„+é“¾è¡¨ï¼Œçº¿ç¨‹å®‰å…¨\u0026ndash;\u0026gt;æ¯ä¸ªæ–¹æ³•åŠ synchronized TreeMapï¼šçº¢é»‘æ ‘ ConcurrentHashMapï¼šæ•°ç»„+é“¾è¡¨+çº¢é»‘æ ‘ï¼Œçº¿ç¨‹å®‰å…¨ Setâ€”â€”å…ƒç´ ä¸é‡å¤ã€æ— åºï¼Œå¸¸ç”¨å®ç°HashSetã€LinkedHashSetã€TreeSet HashSetï¼šé€šè¿‡HashMapå®ç°ã€‚keyå­˜å…ƒç´ ï¼Œvalueç»Ÿä¸€==\u0026gt;ä¸æœ‰åº\u0026amp;çº¿ç¨‹ä¸å®‰å…¨ï¼ˆHashMapï¼‰ LinkedHashSetï¼šHashSetå­ç±»ï¼Œé€šè¿‡LinkedHashMapå®ç°ï¼ŒåŒå‘é“¾è¡¨ç»´æŠ¤å…ƒç´ æ’å…¥é¡ºåº TreeSetï¼šTreeMapå®ç°ã€‚æ·»åŠ å…ƒç´ æ—¶æŒ‰æ¯”è¾ƒè§„åˆ™æ’å…¥åˆ°åˆé€‚çš„ä½ç½®ï¼Œä¿è¯é›†åˆæœ‰åº çº¿ç¨‹å®‰å…¨çš„é›†åˆï¼Ÿ çº¿ç¨‹å®‰å…¨çš„ç±»ï¼š Vector\u0026ndash;\u0026gt;å†…éƒ¨æ–¹æ³•åŸºæœ¬éƒ½åŠ synchronized HashTable\u0026ndash;\u0026gt;æ¯ä¸ªå…¬å…±æ–¹æ³•åŠ synchronizedï¼ˆä»…å•çº¿ç¨‹æ“ä½œï¼‰ï¼Œä¸æ”¯æŒnullé”®å’Œå€¼==\u0026gt;ä¸å»ºè®®ç”¨ å¹¶å‘Mapï¼ˆjava.util.concurrentï¼‰ï¼š ConcurrentHashMapã€‚JDK1.8å–æ¶ˆsegmentï¼Œå¯¹æ¯ä¸€è¡ŒåŠ é” ConcurrentSkipListMapï¼šåŸºäºè·³è¡¨ å¹¶å‘Setï¼ˆåŒ…åŒä¸Šï¼‰ï¼š ConcurrentSkipListSetï¼šæœ‰åºé›†åˆï¼Œåº•å±‚ConcurrentSkipListMap CopyOnWriteArraySetï¼šæ— åºé›†åˆ==\u0026gt;çº¿ç¨‹å®‰å…¨çš„HashSet å¹¶å‘Listï¼ˆåŒä¸Šï¼‰ï¼š CopyOnWriteArrayListï¼šå†™æ—¶å¤åˆ¶ï¼ˆå†™çš„æ—¶å€™åŠ Locké”ï¼Œå¤åˆ¶æ•°ç»„ï¼ŒæœŸé—´å…¶å®ƒçº¿ç¨‹è¯»æ—§æ•°ç»„ï¼Œå†™å®ŒæŒ‡å‘æ–°æ•°ç»„ï¼‰ å¹¶å‘Queueï¼š ConcurrentLinkedQueueï¼šé€‚ç”¨é«˜å¹¶å‘ï¼Œä½¿ç”¨CAS BlockingQueueï¼šç®€åŒ–æ•°æ®å…±äº«\u0026ndash;\u0026gt;è¯»å†™é˜»å¡ç­‰å¾…ï¼ˆæ²¡æ•°æ®äº†è¿˜è¦è¯»ï¼Œè¯¥çº¿ç¨‹å°±ä¸€ç›´ç­‰å¾…ï¼‰ å¹¶å‘Dequeï¼š LinkedBlockingDequeï¼šæ¯ä¸ªèŠ‚ç‚¹ç»´æŠ¤å‰é©±å’Œåé©±èŠ‚ç‚¹ï¼Œæ²¡æœ‰è¯»å†™é”åˆ†ç¦»ï¼ŒåŒä¸€æ—¶é—´å…è®¸ä¸€ä¸ªçº¿ç¨‹æ“ä½œ ConcurrentLinkedDequeï¼š Collectionså’ŒCollectionçš„åŒºåˆ« Collectionæ˜¯æ‰€æœ‰é›†åˆç±»çš„åŸºç¡€æ¥å£ Collectionsæ˜¯å·¥å…·ç±»ï¼Œæä¾›é™æ€æ–¹æ³• éå†é›†åˆçš„æ–¹æ³•ï¼š for / for-eachï¼ˆå¢å¼ºforå¾ªç¯ï¼‰ Iteratorè¿­ä»£å™¨ / ListIteratoråˆ—è¡¨è¿­ä»£å™¨ï¼ˆè¿­ä»£å™¨çš„å­ç±»ï¼‰ forEachï¼šlist.forEach(element -\u0026gt; System.out.println(element)); Stream APIï¼šlist.stream().forEach(element -\u0026gt; System.out.println(element)); å¯èƒ½äº§ç”ŸConcurrentModificationExceptionçš„æƒ…å†µ æ£€æµ‹åˆ°é›†åˆå†…éƒ¨ç»“æ„åœ¨éå†æ—¶è¢«ä¿®æ”¹ï¼Œç«‹åˆ»æŠ›å‡º å¦‚ï¼šè¿­ä»£å™¨ä¸­ï¼ˆåŒ…æ‹¬Iteratorå’Œå¢å¼ºfor\u0026ndash;\u0026gt;åº•å±‚ä¸ºè¿­ä»£å™¨ï¼‰è°ƒç”¨é›†åˆæ–¹æ³•remove/set\u0026ndash;\u0026gt;åº”ç”¨è¿­ä»£å™¨çš„remove/set å»ºè®®ç”¨çº¿ç¨‹å®‰å…¨çš„å®ç°ç±» List å¸¸è§å®ç°ä¸ä¸åŒ Vectorã€ArrayListã€LinkedListï¼ˆCopyOnWriteArrayListÂ·Â·Â·ï¼‰ Vector ä¸ ArrayList ä¸ºåŠ¨æ€æ•°ç»„ï¼ŒVectorçº¿ç¨‹å®‰å…¨ï¼Œéƒ½é€‚åˆéšæœºè¯»å– LinkedListé€‚åˆå¢åˆ  åˆ é™¤æŒ‡å®šå…ƒç´ çš„æ—¶é—´å¤æ‚åº¦ ArrayList\u0026ndash;\u0026gt;O(n)ï¼Œè¯¥å…ƒç´ åé¢çš„æ‰€æœ‰å…ƒç´ éƒ½è¦æŒªåŠ¨==\u0026gt;æœ€åä¸€ä½å¯ä»¥ç›´æ¥åˆ  LinkedList\u0026ndash;\u0026gt;O(n)ï¼Œè¦é¡ºåºå®šä½ï¼Œé¦–å°¾ä¸ç”¨ CopyOnWriteArrayList\u0026ndash;\u0026gt;å†™æ—¶å¯ä»¥è¯»ï¼Œå¹¶å‘æ€§èƒ½å¥½ ArrayListå˜æˆçº¿ç¨‹å®‰å…¨çš„æ–¹æ³• ç”¨Collectionsç±»çš„synchronizedListæ–¹æ³•åŒ…è£…ArrayList List\u0026lt;String\u0026gt; sycList=Collections.synchronizedList(list); ç”¨Vectoræˆ–CopyOnWriteArrayListä»£æ›¿ ä¸ºä»€ä¹ˆArrayListçº¿ç¨‹ä¸å®‰å…¨ é—®é¢˜ï¼šéƒ¨åˆ†å€¼ä¸ºnull \u0026amp; ç´¢å¼•è¶Šç•Œ \u0026amp; sizeä¸addæ•°é‡ä¸ç¬¦ åº•å±‚ï¼šä»¥addä¸ºä¾‹ public boolean add(E e){ ensureCapacityIntenal(size+1); // åˆ¤æ–­æ•°ç»„å¤§å°æ˜¯å¦è¶³å¤Ÿï¼Œä¸å¤Ÿå°±æ‰©å®¹ elementData[size++]=e; // ï¼ˆå®é™…å¤§å°å·²ç»è‡³å°‘æ˜¯size+1äº†ï¼‰sizeä½èµ‹ä¸ºeï¼Œsize+1ï¼ˆä»…è®°å½•æ•°ç»„é•¿åº¦ï¼Œä¸å®é™…é•¿åº¦ä¸åŒæ—¶å˜ï¼‰ return true; } åˆ†æï¼šçº¿ç¨‹1å‘ç°sizeä¸º9ï¼Œå®¹é‡ä¸º10ï¼ˆä¸ç”¨æ‰©ï¼‰ï¼Œçº¿ç¨‹2å‘ç°sizeä¸º9ï¼Œå®¹é‡ä¸º10ï¼ˆä¸ç”¨æ‰©ï¼‰ 1è®¾ç½®indexä¸º9çš„ä½ï¼Œ2è®¾ç½®indexä¸º9çš„ä½ï¼Œ1ä»¤size++ï¼Œ2ä»¤size++==\u0026gt;indexä¸º10çš„ä½ä¸ºnull 1è®¾ç½®indexä¸º9çš„ä½ï¼Œ1ä»¤size++ï¼Œ2è®¾ç½®indexä¸º10ï¼ˆæ­¤æ—¶çš„sizeï¼‰çš„ä½==\u0026gt;ç´¢å¼•è¶Šç•Œ ==\u0026gt;sizeä¸addçš„æ•°é‡ä¸ç¬¦ ArrayListçš„æ‰©å®¹æœºåˆ¶ è®¡ç®—æ–°å®¹é‡==\u0026gt;ä¸€èˆ¬ä¸º1.5å€ï¼ˆå› ä¸ºç”¨ç§»ä½ç®—ï¼Œé€Ÿåº¦å¿«ï¼ŒnewSize=oldSize+(oldSize\u0026gt;\u0026gt;1)ï¼‰ åˆ›å»ºæ–°æ•°ç»„\u0026ndash;\u0026gt;å¤åˆ¶å…ƒç´ \u0026ndash;\u0026gt;æ›´æ–°å¼•ç”¨\u0026ndash;\u0026gt;å®Œæˆæ‰©å®¹ CopyOnWriteArrayListå¦‚ä½•ä¿è¯çº¿ç¨‹å®‰å…¨ åº•å±‚æ˜¯ç”¨volatileä¿®é¥°çš„æ•°ç»„ï¼šprivate transient volatile Object[] array; å†™å…¥æ—¶åŠ äº’æ–¥é”ReentrantLock\u0026ndash;\u0026gt;æ‹·è´åˆ°é•¿åº¦åŠ 1çš„æ–°æ•°ç»„\u0026ndash;\u0026gt;æ–°æ•°ç»„æ”¾å…¥æ–°å€¼\u0026ndash;\u0026gt;æ›¿æ¢å¼•ç”¨\u0026ndash;\u0026gt;finallyé‡Šæ”¾é” Map Mapéå†æ–¹æ³• entrysetï¼š // ä¹Ÿå¯ä»¥ç”¨ keySet()ï¼Œåªå¾—åˆ° key çš„é›† for(Map.Entry\u0026lt;Integer,Integer\u0026gt; entry:map.entrySet()){ int key=entry.getKey(),val=entry.getValue(); } è¿­ä»£å™¨\u0026ndash;\u0026gt;é€‚åˆè¿­ä»£åˆ é™¤ Iterator\u0026lt;Entry\u0026lt;Integer,Integer\u0026gt;\u0026gt; iterator=map.entrySet().iterator(); while(iterator.hasNext()){ Entry\u0026lt;Integer,Integer\u0026gt; entry=iterator.next(); } lambdaè¡¨è¾¾å¼+forEachæ–¹æ³•==\u0026gt;map.forEach((key,value)-\u0026gt;key=key+1) stream API HashMapåº•å±‚åŸç† JDK1.7å‰ä¸ºæ•°ç»„+é“¾è¡¨ï¼ˆè§£å†³hashå†²çªï¼‰\u0026ndash;\u0026gt;JDK1.8é“¾è¡¨é•¿åº¦è¶…è¿‡8ä¸”æ•°ç»„é•¿åº¦å¤§äº64è½¬ç”¨çº¢é»‘æ ‘ï¼ˆn\u0026ndash;\u0026gt;log(n)ï¼‰ HashMapçº¿ç¨‹å®‰å…¨å— å¦ã€‚é—®é¢˜æœ‰ï¼šJDK1.7å‰æ•°ç»„æ‰©å®¹æ—¶å¯èƒ½Entryé“¾æ­»å¾ªç¯/æ•°æ®ä¸¢å¤±\u0026ndash;\u0026gt;JDK1.8 putæ—¶æ•°æ®è¦†ç›– æ­»å¾ªç¯ï¼šå¤´æ’æ³•ï¼Œæ‰©å®¹æ—¶æ—§é“¾è¡¨èŠ‚ç‚¹è¢«é€†åºè½¬ç§»åˆ°æ–°é“¾è¡¨ï¼ˆæ—§é“¾è¡¨æŒ‰é¡ºåºè¯»å–èŠ‚ç‚¹ï¼Œç»§ç»­å¤´æ’æ³•æ’å…¥æ–°é“¾è¡¨ï¼‰\u0026ndash;\u0026gt;å½“çº¿ç¨‹Bå®Œæˆå¤åˆ¶æ—¶ï¼Œçº¿ç¨‹Aå†å¼€å§‹å¤åˆ¶ è§£å†³æ–¹æ¡ˆï¼š(Collections.synchronizedMapåŒæ­¥åŠ é”)/HashTable/ConcurrentHashMap putçš„è¿‡ç¨‹ è®¡ç®—ç´¢å¼•\u0026ndash;\u0026gt;æ£€æŸ¥ç©ºå¦\u0026ndash;\u0026gt;ï¼ˆéç©ºï¼‰æ£€æŸ¥keyæ˜¯å¦ç›¸åŒï¼ˆhashCodeåŒ\u0026amp;\u0026amp;equalsï¼‰ï¼ˆåŒåˆ™ç›´æ¥æ›´æ–°ï¼‰\u0026ndash;\u0026gt;ï¼ˆä¸åŒï¼‰é“¾è¡¨/çº¢é»‘æ ‘æŸ¥æ‰¾ï¼Œæ‰¾ä¸åˆ°åˆ™åŠ å…¥\u0026ndash;\u0026gt;æ£€æŸ¥é“¾è¡¨é•¿åº¦\u0026ndash;\u0026gt;æ£€æŸ¥è´Ÿè½½å› å­0.75ï¼ˆé”®å€¼å¯¹æ•°é‡ä¸æ•°ç»„å¤§å°çš„æ¯”å€¼ï¼‰\u0026ndash;\u0026gt;æ‰©å®¹ï¼Œæ–°å»ºä¸¤å€å¤§çš„æ•°ç»„ï¼Œé‡æ–°è®¡ç®—å“ˆå¸Œç å¹¶æ’å…¥ HashMapçš„getæ–¹æ³•å®‰å…¨å— ç©ºæŒ‡é’ˆå¼‚å¸¸ï¼Œbutåˆå§‹åŒ–åå¯ä»¥ç”¨nullä½œä¸ºé”® å¤šçº¿ç¨‹ç¯å¢ƒ HashMapä¸€èˆ¬ç”¨ä»€ä¹ˆåškey Stringã€‚ä¸å¯å˜ï¼Œç¨³å®šï¼ˆhashCodeä¸equalsæ–¹æ³•çš„æ­£ç¡®æ€§ï¼‰ ä¸ºä»€ä¹ˆç”¨çº¢é»‘æ ‘è€Œéå¹³è¡¡äºŒå‰æ ‘ å®Œå…¨å¹³è¡¡è¦æ±‚ä»»ä½•ç»“ç‚¹çš„å·¦å³å­æ ‘çš„é«˜åº¦å·®ä¸è¶… 1\u0026ndash;\u0026gt;é¢‘ç¹çš„å·¦å³æ—‹ çº¢é»‘æ ‘åªè¦æ±‚æ•´ä¸ªæ ‘æœ€é•¿è·¯å¾„ä¸è¶…æœ€çŸ­çš„ä¸¤å€\u0026ndash;\u0026gt;ä¸ç”¨é¢‘ç¹è°ƒæ•´ é‡å†™equalså’ŒhashCodeçš„æ³¨æ„äº‹é¡¹ åŒæ—¶é‡å†™ï¼ \u0026amp;\u0026amp; o1.equals(o2)==\u0026gt;o1.hashCode() == o2.hashCode()ï¼ˆåä¹‹ä¸ç„¶ï¼‰ HashMapæ‰©å®¹æœºåˆ¶ æ³¨æ„ï¼šHashMapåˆå§‹å®¹é‡ä¸º16 å®¹é‡ä¸€èˆ¬å¢ä¸ºä¸¤å€ï¼Œå“ˆå¸Œç ä¸æ–°å®¹é‡åšæŒ‰ä½ä¸ï¼Œè‹¥å¾—1åˆ™æ–°ç´¢å¼•ä¸ºåŸç´¢å¼•+åŸå®¹é‡ï¼ˆé«˜ä½èµ‹1ï¼Œå³è‹¥æ–°å®¹é‡ä¸º16ï¼Œåˆ™xxx\u0026ndash;\u0026gt;1xxxï¼‰ï¼›è‹¥å¾—0åˆ™ä¸å˜ æ‰€ä»¥ä¸ç”¨é‡æ–°ç®—hashï¼Œä¸”å¯ä»¥è®¤ä¸ºå‡åŒ€åœ°åˆ†æ•£èŠ‚ç‚¹ï¼ˆ0/1éšæœºï¼‰ è´Ÿè½½å› å­ é»˜è®¤0.75ï¼Œå…ƒç´ ä¸ªæ•°è¶…è¿‡å®¹é‡çš„75%å°±æ‰©å®¹\u0026ndash;\u0026gt;å¤ªä½ä¼šæœ‰å¤§é‡ç©ºæ¡¶ï¼ˆç©ºé—´æµªè´¹ï¼‰ï¼Œå¤ªé«˜ä¼šæœ‰å¤§é‡ç¢°æ’ï¼ˆæ€§èƒ½ä¸å¥½ï¼‰ ConcurrentHashMapæ€ä¹ˆå®ç° JDK1.7.æ•°ç»„+é“¾è¡¨ã€‚å¤§æ•°ç»„Segmentï¼ˆå³å¯é‡å…¥é”ReentrantLockï¼‰ï¼Œå°æ•°ç»„HashEntryå­˜å‚¨é”®å€¼å¯¹\u0026ndash;\u0026gt;ä¸€æ®µæ•°æ®ä¸€ä¸ªé”ï¼Œå…¶å®ƒæ®µæ•°æ®å¯è¢«è®¿é—®ï¼Œå½“å‰æ®µå¯è¢«è¯» JDK1.8.æ•°ç»„+é“¾è¡¨/çº¢é»‘æ ‘ã€‚ï¼ˆè®¡ç®—å“ˆå¸Œå€¼æ—¶ï¼Œé€šè¿‡æ‰°åŠ¨å‡½æ•°ä¼˜åŒ–å“ˆå¸Œåˆ†å¸ƒï¼‰volatile+CAS/synchronized\u0026ndash;\u0026gt;æ·»åŠ å…ƒç´ æ—¶è‹¥å®¹å™¨ï¼ˆmapï¼‰ä¸ºç©ºåˆ™volatile+CASåˆå§‹åŒ–ï¼Œè‹¥å®¹å™¨ä¸ä¸ºç©ºä½†ä½ç½®ï¼ˆæ•°ç»„ä¸­çš„ä½ç½®ï¼‰ç©ºç”¨volatile+CASåˆå§‹åŒ–ï¼Œè‹¥ä½ç½®ä¸ä¸ºç©ºï¼ˆå‘ç”Ÿäº†å“ˆå¸Œå†²çªï¼‰ç”¨synchronizedï¼Œéå†æ•°æ®å¹¶æ›¿æ¢/æ–°å¢èŠ‚ç‚¹åˆ°æ¡¶å¹¶åˆ¤æ–­æ˜¯å¦éœ€è½¬æ¢ å¯¹å¤´ç»“ç‚¹åŠ ï¼ˆæ‚²è§‚ï¼‰é”ä¿è¯çº¿ç¨‹å®‰å…¨ï¼ˆç±»ä¼¼ä¸€è¡Œæ•°æ®ï¼‰ \u0026amp; CASä¸ºä¹è§‚é”ï¼Œsynchronizedä¸ºæ‚²è§‚é”\u0026ndash;\u0026gt;å‘ç”Ÿå“ˆå¸Œç¢°æ’æ—¶è¯æ˜çº¿ç¨‹ç«äº‰æ¯”è¾ƒæ¿€çƒˆï¼Œæ‚²è§‚é”æ•ˆç‡æ›´é«˜ CASï¼šæ¯”è¾ƒå¹¶äº¤æ¢ï¼Œæ¯”è¾ƒå½“å‰è¦ä¿®æ”¹çš„å€¼ä¸çº¿ç¨‹çš„é¢„æœŸå€¼æ˜¯å¦ç›¸ç­‰ï¼Œæ˜¯åˆ™ä¿®æ”¹ï¼Œå¦åˆ™é‡æ–°è¯»å€¼ Node.val å’Œ Node.next å£°æ˜ä¸º volatileï¼Œç¡®ä¿è¯»æ“ä½œæ— éœ€åŠ é” Set Setä¸ºä»€ä¹ˆæ— é‡å¤ æ ¹æ®hashCodeç¡®å®šå­˜å‚¨ä½ç½®ï¼Œæ ¹æ®equalsåˆ¤æ–­æ˜¯å¦æœ‰ç›¸åŒå…ƒç´  æœ‰åºSetæ˜¯ï¼Ÿè®°å½•æ’å…¥é¡ºåºçš„é›†åˆæ˜¯ï¼Ÿ TreeSetï¼ˆçº¢é»‘æ ‘ï¼‰ \u0026amp; LinkedHashSetï¼ˆåŒå‘é“¾è¡¨ï¼‰æœ‰åº TreeSetéœ€è¦é‡å†™compareTo()å‡½æ•°/Comparatoræ¯”è¾ƒå™¨ï¼Œæ’å…¥æˆ–åˆ é™¤æ—¶é€šè¿‡è¯¥å‡½æ•°è¿›è¡Œæ¯”è¾ƒ è®°å½•æ’å…¥é¡ºåºçš„é›†åˆé€šå¸¸æŒ‡çš„æ˜¯LinkedHashSetï¼ˆæ”¾å…¥é“¾è¡¨å°¾ï¼‰ å¹¶å‘ å¤šçº¿ç¨‹ Javaçº¿ç¨‹ä¸OSçº¿ç¨‹ä¸€æ ·ä¹ˆ æœ¬è´¨ä¸Šç›¸åŒï¼Œ1v1çº¿ç¨‹æ¨¡å‹ï¼ŒJavaåº•å±‚ç”¨pthread_createåˆ›å»ºçº¿ç¨‹ ä½¿ç”¨å¤šçº¿ç¨‹æ³¨æ„ä»€ä¹ˆ é¿å…æ•°æ®æ··ä¹±\nåŸå­æ€§ï¼šæä¾›äº’æ–¥è®¿é—®ï¼Œä½†åŒä¸€æ—¶åˆ»åªèƒ½æœ‰ä¸€ä¸ªçº¿ç¨‹æ“ä½œæ•°æ®\u0026ndash;\u0026gt;atomicåŒ… \u0026amp; synchronizedå…³é”®å­— å¯è§æ€§ï¼šå¯¹ä¸»å†…å­˜çš„ä¿®æ”¹å¯è¢«å…¶å®ƒçº¿ç¨‹çœ‹è§\u0026ndash;\u0026gt;synchronizedå…³é”®å­— \u0026amp; volatileå…³é”®å­— æœ‰åºæ€§ï¼šæŒ‡ä»¤é‡æ’åºå¯¼è‡´çº¿ç¨‹Aè§‚å¯Ÿå…¶å®ƒçº¿ç¨‹çš„æŒ‡ä»¤æ‰§è¡Œé¡ºåºæ‚ä¹±æ— åº\u0026ndash;\u0026gt;happens-beforeåŸåˆ™ä¿è¯ æŒ‡ä»¤é‡æ’åºï¼šç¼–è¯‘å™¨/CPU/JVMä¸ºæé«˜å¤„ç†é€Ÿåº¦å¯¹æŒ‡ä»¤é‡æ’ ä¿è¯æ•°æ®ä¸€è‡´æ€§çš„æ–¹æ¡ˆ äº‹åŠ¡ç®¡ç† é”ï¼šå…±äº«èµ„æºçš„äº’æ–¥è®¿é—® ç‰ˆæœ¬æ§åˆ¶ï¼šä¹è§‚é”ï¼Œæ›´æ–°æ—¶è®°å½•ç‰ˆæœ¬ä¿¡æ¯ï¼Œé¿å…åŒæ—¶ä¿®æ”¹åŒä¸€æ•°æ® åˆ›å»ºçº¿ç¨‹çš„æ–¹å¼æœ‰å“ªäº› ç»§æ‰¿Threadç±»ï¼šé‡å†™run()æ–¹æ³•ï¼Œç”¨start()å¯åŠ¨çº¿ç¨‹\u0026ndash;\u0026gt;å¯ç”¨thisè®¿é—®å½“å‰çº¿ç¨‹ å®ç°Runnableæ¥å£ï¼šé‡å†™run()æ–¹æ³•ï¼Œç”¨new Thread(new å®ç°ç±»())åˆ›å»ºå®ä¾‹\u0026ndash;\u0026gt;éœ€ç”¨Thread.currentThread()è®¿é—®å½“å‰çº¿ç¨‹ å®ç°Callableæ¥å£ï¼šç±»ä¼¼ğŸ‘†ï¼Œä½†å…¶call()æ–¹æ³•å¯ä»¥ç”¨è¿”å›å€¼ä¸”å¯æŠ›å‡ºå¼‚å¸¸ï¼Œéœ€å°†å…¶åŒ…è£…è¿›FutureTaskï¼ˆThreadæ„é€ å™¨åªæ¥å—Runnableå‚æ•°ï¼ŒFutureTaskå®ç°äº†Runnableï¼‰ MyCallable callable=new MyCallable(); FutureTask\u0026lt;Integer\u0026gt; futureTask=new FutureTask\u0026lt;\u0026gt;(callable); Thread t=new Thread(futureTask); t.start(); çº¿ç¨‹æ± ï¼ˆExecutoræ¡†æ¶ï¼‰ï¼šåˆ›å»º\u0026ndash;æäº¤ä»»åŠ¡åˆ°çº¿ç¨‹æ± \u0026ndash;å…³é—­ å¢åŠ ç¨‹åºå¤æ‚åº¦ï¼Œé”™è¯¯é…ç½®å¯èƒ½å¯¼è‡´æ­»é” but å¯ä»¥é‡ç”¨é¢„å…ˆåˆ›å»ºçš„çº¿ç¨‹ï¼Œé¿å…çº¿ç¨‹åˆ›å»ºé”€æ¯å¼€é”€ï¼Œæé«˜ç¨‹åºæ€§èƒ½ æ€ä¹ˆåœæ­¢çº¿ç¨‹è¿è¡Œ å¼‚å¸¸æ³•ï¼šçº¿ç¨‹è°ƒç”¨interrupt()æ–¹æ³•åï¼Œåœ¨çº¿ç¨‹çš„runæ–¹æ³•ä¸­åˆ¤æ–­å½“å‰å¯¹è±¡çš„interrupted()çŠ¶æ€ï¼Œæ˜¯ä¸­æ–­åˆ™æŠ›å‡ºå¼‚å¸¸ æ²‰ç¡åœæ­¢ï¼šçº¿ç¨‹sleepï¼Œç”¨interruptæ ‡è®°ä¸­æ–­ï¼Œä¹‹åæŠ›å‡ºä¸­æ–­å¼‚å¸¸ stop()ï¼šå·²å¼ƒç”¨ returnï¼šinterruptæ ‡è®°ä¸­æ–­ï¼Œrunåˆ¤æ–­çŠ¶æ€ï¼Œæ˜¯ä¸­æ–­åˆ™return interruptæ€ä¹ˆè®©çº¿ç¨‹æŠ›å‡ºå¼‚å¸¸ æ¯ä¸ªçº¿ç¨‹éƒ½ä¸€ä¸ªä¸ä¹‹å…³è”çš„å¸ƒå°”å±æ€§æ¥è¡¨ç¤ºå…¶ä¸­æ–­çŠ¶æ€ï¼Œè‹¥è¢«å…¶å®ƒçº¿ç¨‹è°ƒç”¨interrupt()ï¼š æ‰§è¡Œä½çº§åˆ«å¯ä¸­æ–­æ–¹æ³•ï¼ˆå¦‚sleep()/Thread.join()/Object.wait()ï¼Œè§£é™¤é˜»å¡å¹¶æŠ›å‡ºå¼‚å¸¸ elseï¼šè®¾ç½®ä¸­æ–­çŠ¶æ€ï¼Œä¹‹åè½®è¯¢åˆ¤æ–­æ˜¯å¦åœæ­¢ Javaçº¿ç¨‹çš„çŠ¶æ€æœ‰å“ªäº› å¯é€šè¿‡getStatus()æŸ¥çœ‹ çº¿ç¨‹çŠ¶æ€ å¯¹åº” NEW å°šæœªå¯åŠ¨ï¼Œæœªè°ƒç”¨start RUNNABLE å°±ç»ª+æ­£åœ¨è¿è¡Œï¼Œè°ƒç”¨äº†startç­‰å¾…è°ƒåº¦ BLOCKED ç­‰å¾…ç›‘è§†å™¨é”ï¼Œé™·å…¥é˜»å¡ WAITING ç­‰å¾…å¦ä¸€çº¿ç¨‹æ‰§è¡Œç‰¹å®šæ“ä½œï¼Œeg.notify() TIMED_WAITING å…·æœ‰æŒ‡å®šç­‰å¾…æ—¶é—´çš„ç­‰å¾…çŠ¶æ€ TERMINATED å®Œæˆæ‰§è¡Œï¼Œç»ˆæ­¢ sleepå’Œwaitçš„åŒºåˆ« åˆ†ç±»ï¼šsleep æ˜¯ Thread ç±»çš„é™æ€æ–¹æ³•ï¼›wait æ˜¯ Object ç±»çš„å®ä¾‹æ–¹æ³•ï¼ˆä¾èµ–å®ä¾‹ï¼‰ é”é‡Šæ”¾ï¼šsleepåçº¿ç¨‹ä¼šæš‚åœæ‰§è¡ŒæŒ‡å®šçš„æ—¶é—´ï¼Œä½†ä¸ä¼šé‡Šæ”¾æŒæœ‰çš„å¯¹è±¡é”ï¼›waité‡Šæ”¾é”ï¼Œè¿›å…¥ç­‰å¾…ç›´åˆ°å…¶ä»–çº¿ç¨‹è°ƒç”¨ç›¸åŒå¯¹è±¡çš„ notify() æˆ– notifyAll()å”¤é†’ ä¼šé‡Šæ”¾CPU ä½¿ç”¨æ¡ä»¶ï¼šsleepå¯åœ¨ä»»æ„ä½ç½®è°ƒç”¨ï¼›waité¡»åœ¨åŒæ­¥å—/åŒæ­¥æ–¹æ³•ä¸­è°ƒç”¨ï¼ˆéœ€å…ˆæŒæœ‰è¯¥å¯¹è±¡çš„é”ï¼‰ï¼Œå¦åˆ™æŠ›IllegalMonitorStateException å”¤é†’ï¼šsleepä¼‘çœ æ—¶é—´ç»“æŸè‡ªåŠ¨æ¢å¤åˆ°å°±ç»ªçŠ¶æ€ï¼›waitéœ€notify blockedå’Œwaitingæœ‰å•¥åŒºåˆ« è§¦å‘æ¡ä»¶ï¼šblockedé€šå¸¸å› ä¸ºè¯•å›¾è·å¾—è¢«å…¶å®ƒçº¿ç¨‹æŒæœ‰çš„é”ï¼Œè¢«é˜»å¡åˆ°é”å¯ç”¨ï¼›waitingç­‰å¾…å…¶å®ƒçº¿ç¨‹æ‰§è¡ŒæŸäº›æ“ä½œï¼Œä¸æ¶ˆè€—CPUèµ„æºï¼Œä¸å‚ä¸é”ç«äº‰ å”¤é†’æœºåˆ¶ï¼šç­‰é”é‡Šæ”¾ï¼Œè·å¾—åˆ™è¿›å…¥RUNNABLEï¼›æ˜¾å¼å”¤é†’ notify å’Œ notifyAll çš„åŒºåˆ« å…±åŒç‚¹ï¼šæœ€å¤šä¸€ä¸ªçº¿ç¨‹èƒ½è·å¾—é”ï¼›ä¸èƒ½æ§åˆ¶è°å¾—åˆ°é” åŒºåˆ«ï¼š notifyå”¤é†’ä¸€ä¸ªçº¿ç¨‹ï¼Œå…¶ä»–çº¿ç¨‹ä¾ç„¶å¤„äºwaitï¼Œè‹¥è¯¥çº¿ç¨‹ç»“æŸæœªå”¤é†’å…¶å®ƒçº¿ç¨‹ï¼Œåˆ™å…¶å®ƒçº¿ç¨‹æ°¸è¿œç­‰å¾… æºç æ ‡æ³¨å”¤é†’ä»»æ„çº¿ç¨‹ï¼Œä½†ä¾èµ–äºå…·ä½“jvmå®ç°ï¼Œhotspotå”¤é†’å…ˆè¿›å…ˆå‡º notifyAllæ‰€æœ‰çº¿ç¨‹ç«äº‰é”ï¼ŒæˆåŠŸçš„æ‰§è¡Œï¼Œæ‰§è¡Œåå‰©ä¸‹çš„çº¿ç¨‹ç»§ç»­ç«äº‰ çº¿ç¨‹é—´æ€ä¹ˆé€šä¿¡ å…±äº«æ•°æ®ï¼Œvolatileå…³é”®å­—ç­‰ waitã€notifyã€notifyAll locksåŒ…é‡Œçš„Conditionæ¥å£çš„awaitã€signalã€signalAllï¼ŒLockæ¥å£æä¾›æ›´çµæ´»çš„é”ï¼ˆå¦‚å¯é‡å…¥é”ï¼‰ é€šä¿¡æ–¹å¼æœ‰å“ªäº› Object ç±»çš„ wait()ã€notify() å’Œ notifyAll() æ–¹æ³•\u0026ndash;\u0026gt;åŸºäºå¯¹è±¡çš„ç›‘è§†å™¨ï¼ˆé”ï¼‰æœºåˆ¶ Lock å’Œ Condition æ¥å£ volatileå…³é”®å­— CountDownLatchï¼ŒåŒæ­¥å·¥å…·ç±»ï¼Œå…è®¸çº¿ç¨‹ç­‰å¾…å…¶å®ƒçº¿ç¨‹å®Œæˆæ“ä½œåç»§ç»­æ‰§è¡Œ CountDownLatch(int count) æŒ‡å®šéœ€è¦ç­‰å¾…çš„çº¿ç¨‹æ•° countDown() å‡å°‘è®¡æ•°å™¨çš„å€¼ await() å½“å‰çº¿ç¨‹ç­‰å¾…åˆ°è®¡æ•°å™¨ä¸º0\u0026ndash;\u0026gt;åˆ°0åæ‰€æœ‰ç­‰å¾…çš„çº¿ç¨‹è¢«å”¤é†’ CyclicBarrierï¼ŒåŒæ­¥è¾…åŠ©ç±»ï¼Œå…è®¸ä¸€ç»„çº¿ç¨‹ç›¸äº’ç­‰å¾…åˆ°æ‰€æœ‰çº¿ç¨‹åˆ°è¾¾æŸå…¬å…±å±éšœç‚¹ CyclicBarrier(int parties,Runnable barrierAction)ï¼ŒæŒ‡å®šå‚ä¸çº¿ç¨‹æ•°é‡ä¸åˆ°è¾¾åçš„æ“ä½œ awaitï¼Œå½“å‰çº¿ç¨‹ç­‰å¾… Semaphoreï¼Œè®¡æ•°ä¿¡å·é‡ï¼Œæ§åˆ¶åŒæ—¶è®¿é—®ç‰¹å®šèµ„æºçš„çº¿ç¨‹æ•° acquireã€releaseã€æ„é€ å‡½æ•°æŒ‡å®šåˆå§‹è®¸å¯æ•°é‡ æ€ä¹ˆåœæ­¢çº¿ç¨‹ é€šè¿‡åä½œå¼é€»è¾‘æ§åˆ¶ç»ˆæ­¢ï¼Œé¿å…Thread.stop()æš´åŠ›æˆ–Thread.suspend()/resume()æ˜“æ­»é”\nå…±äº«æ ‡å¿—ä½ä¸»åŠ¨ç»ˆæ­¢ï¼šå®šä¹‰å¯è§çš„çŠ¶æ€å˜é‡ï¼Œå·¥ä½œçº¿ç¨‹å¾ªç¯æ£€æµ‹ é€‚ç”¨ç®€å•æ— é˜»å¡é€»è¾‘ï¼Œéœ€ç¡®ä¿å¯è§æ€§ çº¿ç¨‹ä¸­æ–­æœºåˆ¶ï¼šThread.interrupt()è®¾ç½®ä¸­æ–­æ ‡å¿—ä½ é€‚ç”¨å¯ä¸­æ–­é˜»å¡æ“ä½œ Futureå–æ¶ˆä»»åŠ¡ï¼šä½¿ç”¨çº¿ç¨‹æ± æäº¤ä»»åŠ¡ï¼Œå¹¶é€šè¿‡ Future.cancel() åœæ­¢çº¿ç¨‹ é€‚ç”¨çº¿ç¨‹æ± ç®¡ç†ä»»åŠ¡ æŸäº› I/O æˆ–åŒæ­¥æ“ä½œæ— æ³•é€šè¿‡ä¸­æ–­ç›´æ¥å“åº”ï¼ˆSocket.accept()ï¼ŒLOck.lock()ï¼‰ï¼Œéœ€ç»“åˆèµ„æºå…³é—­æ“ä½œï¼ˆè°ƒç”¨stop()ï¼‰ é€‚ç”¨ä¸å¯ä¸­æ–­çš„é˜»å¡æ“ä½œï¼›æ³¨æ„æ˜¾å¼å…³é—­èµ„æºè§¦å‘å¼‚å¸¸ï¼Œéœ€ç»“åˆä¸­æ–­çŠ¶æ€åˆ¤æ–­å›æ»š å¹¶å‘å®‰å…¨ jucåŒ…ä¸­å¸¸ç”¨çš„ç±» çº¿ç¨‹æ± ï¼šThreadPoolExecutoråˆ›å»ºç®¡ç†çº¿ç¨‹æ± ï¼ˆæ ¸å¿ƒã€æœ€å¤§çº¿ç¨‹æ•°ã€ä»»åŠ¡é˜Ÿåˆ—ï¼‰ \u0026amp; Executorsçº¿ç¨‹æ± å·¥å‚ç±» å¹¶å‘é›†åˆï¼šConcurrentHashMap \u0026amp; CopyOnWriteArrayList åŒæ­¥å·¥å…·ï¼šCountDownLatch \u0026amp; CyclicBarrier \u0026amp; Semaphore åŸå­ç±»ï¼šAtomicIntegerç¡¬ä»¶çº§åˆ«çš„åŸå­æŒ‡ä»¤ \u0026amp; AtomicReferenceç”¨äºå¯¹å¯¹è±¡å¼•ç”¨çš„åŸå­æ“ä½œ æ€ä¹ˆä¿è¯å¤šçº¿ç¨‹å®‰å…¨ synchronizedï¼šåŒä¸€æ—¶åˆ»åªæœ‰ä¸€ä¸ªçº¿ç¨‹å¯ä»¥è®¿é—®è¯¥ä»£ç ï¼ˆåº”ç”¨ï¼šå¯¹è±¡é”ï¼‰==\u0026gt;æ‹¿åˆ°é” volatileï¼šç”¨äºå˜é‡ï¼Œä¿è¯å¯è§æ€§ Lock \u0026amp; ReentrantLockï¼šæ›´çµæ´»ï¼Œå¯é‡å…¥é” åŸå­ç±» çº¿ç¨‹å±€éƒ¨å˜é‡ï¼šThreadLocalç±»ä½æ¯ä¸ªçº¿ç¨‹æä¾›ç‹¬ç«‹çš„å˜é‡å‰¯æœ¬==\u0026gt;ä¸å†ç«äº‰ å¹¶å‘é›†åˆ JUCå·¥å…·ç±» javaä¸­æœ‰å“ªäº›å¸¸ç”¨çš„é” å†…ç½®é”synchronizedï¼šåŒ…æ‹¬æ— é”ã€åå‘é”ã€è½»é‡çº§é”ã€é‡é‡çº§é”çº§åˆ« ReentrantLockï¼š æ˜¾å¼é”ç±»ï¼Œç”¨lock()å’Œunlock()è·å–å’Œé‡Šæ”¾é”ã€‚æä¾›å¯ä¸­æ–­çš„é”ç­‰å¾…ã€å®šæ—¶é”ã€å…¬å¹³é”ï¼ˆæŒ‰çº¿ç¨‹è¯·æ±‚é¡ºåºåˆ†é…é”ï¼‰ç­‰é€‰é¡¹ è¯»å†™é”ReadWriteLockï¼šå…è®¸å¤šä¸ªè¯»å•ä¸ªå†™ ä¹è§‚é”\u0026amp;æ‚²è§‚é”ï¼šæ‚²è§‚ï¼ˆReentrantlock \u0026amp; Synchronizedï¼‰ï¼Œä¹è§‚åªåœ¨æ›´æ–°æ•°æ®æ—¶æ£€æŸ¥æ˜¯å¦å·²è¢«å…¶å®ƒçº¿ç¨‹ä¿®æ”¹ï¼ˆç‰ˆæœ¬å·/æ—¶é—´æˆ³å®ç°ï¼‰ è‡ªæ—‹é”ï¼šç­‰å¾…æ˜¯å¾ªç¯æ£€æŸ¥é”æ˜¯å¦å¯ç”¨ï¼Œè€Œéæ”¾å¼ƒCPUå¹¶é˜»å¡ Synchronizedåº•å±‚ é€‚ç”¨ç®€å•åŒæ­¥æƒ…å†µ/ä»£ç å—åŒæ­¥/å¯¹è±¡ä½œä¸ºé”\nï¼ˆåŸºäºJVMå®ç°ï¼‰ç¼–è¯‘ååœ¨åŒæ­¥çš„ä»£ç å—å‰ååŠ monitorenterå’Œmonitorexitå­—èŠ‚ç æŒ‡ä»¤\u0026ndash;\u0026gt;enteræ—¶å°è¯•è·å–å¯¹è±¡é”ï¼Œé”çš„è®¡æ•°å™¨åŠ 1ï¼›exitæ—¶å‡1ï¼›ä¸º0æ—¶é”é‡Šæ”¾ï¼Œç­‰å¾…é˜Ÿåˆ—çš„çº¿ç¨‹ç»§ç»­ç«äº‰é” æ’å®ƒé”\u0026ndash;\u0026gt;çº¿ç¨‹è¢«é˜»å¡/å”¤é†’ä¼šä»ç”¨æˆ·æ€åˆ‡æ¢åˆ°å†…æ ¸æ€ å†…å­˜ï¼šåŠ é”çš„è¿‡ç¨‹ä¼šæ¸…é™¤å·¥ä½œå†…å­˜ä¸­çš„å…±äº«å˜é‡ï¼Œå†ä»ä¸»å†…å­˜è¯»å–ï¼›é‡Šæ”¾æ—¶æŠŠå·¥ä½œå†…å­˜ä¸­çš„å…±äº«å˜é‡å†™å›ä¸»å†…å­˜ reentrantlockåº•å±‚ é«˜çº§é”åŠŸèƒ½/æ€§èƒ½ä¼˜åŒ–/å¤æ‚åŒæ­¥ç»“æ„\nåŸºäº AbstractQueuedSynchronizerï¼ˆAQSï¼‰æŠ½è±¡ç±»ï¼Œé€šè¿‡å†…éƒ¨ç±»Syncå®ç°å…·ä½“é”æ“ä½œâ€”â€”éœ€æ‰‹åŠ¨è·å–\u0026amp;é‡Šæ”¾é” å¯ä¸­æ–­æ€§ï¼šçº¿ç¨‹åœ¨ç­‰å¾…é”æ—¶ï¼Œå¯ä»¥è¢«å…¶ä»–çº¿ç¨‹ä¸­æ–­è€Œæå‰ç»“æŸç­‰å¾…\u0026ndash;\u0026gt;LockSupport.park() å’Œ LockSupport.unpark() è¶…æ—¶æ—¶é—´ï¼šä¸€æ®µæ—¶é—´åè¿˜æœªè·å¾—é”åˆ™æ”¾å¼ƒ\u0026ndash;\u0026gt;tryAcquireNanos æ–¹æ³• å…¬å¹³ä¸éå…¬å¹³ï¼šé»˜è®¤éå…¬å¹³ï¼ˆåŒä¸€æ—¶åˆ»ç«äº‰é”ï¼‰ å…¬å¹³é”ä¸­çº¿ç¨‹ä¼šåœ¨è¿è¡Œã€ä¼‘çœ ä¸­åˆ‡æ¢ï¼ˆç”¨æˆ·æ€è½¬å†…æ ¸æ€ï¼‰ï¼Œç›¸å¯¹éå…¬å¹³é”æ‰§è¡Œé€Ÿåº¦æ›´æ…¢\u0026ndash;\u0026gt;éå…¬å¹³é”ï¼Œçº¿ç¨‹ä¼šå…ˆç”¨CASå°è¯•ï¼Œè·å–å¤±è´¥æ‰è¿›å…¥ç­‰å¾…é˜Ÿåˆ— å¯é‡å…¥æ€§ï¼šåŒä¸€ä¸ªçº¿ç¨‹å¯ä»¥å¤šæ¬¡è·å¾—åŒä¸€æŠŠé”ï¼Œè€Œä¸ä¼šæ­»é”\u0026ndash;\u0026gt;å†…éƒ¨holdCountæŠ€æœ¯å®ç°ï¼ˆä¸º0æ—¶å…¶å®ƒçº¿ç¨‹æ‰èƒ½è·å¾—é”ï¼‰ synchronizedæ”¯æŒé‡å…¥å— æ”¯æŒã€‚åŸºäºåŸå­æ€§çš„å†…éƒ¨é”æœºåˆ¶ï¼ˆå¯é‡å…¥ï¼‰\u0026ndash;\u0026gt;è°ƒç”¨synchronizedæ–¹æ³•çš„å†…éƒ¨è°ƒç”¨è¯¥å¯¹è±¡çš„å¦ä¸€ä¸ªsynchronizedæ–¹æ³•æ˜¯å…è®¸çš„ï¼ˆé‡å¤è¯·æ±‚åŒä¸€ä¸ªå¯¹è±¡çš„é”ï¼‰ synchronizedé”çš„å‡çº§è¿‡ç¨‹ æ— é”ï¼šæ²¡å¼€åå‘é”çš„çŠ¶æ€ï¼ˆJDK1.6åé»˜è®¤å¼€å¯ï¼Œä½†æœ‰JVMå¯åŠ¨åçš„å»¶è¿Ÿï¼‰ åå‘é”ï¼šå½“ä¸€ä¸ªçº¿ç¨‹æ‹¿åˆ°åå‘é”æ—¶ï¼Œä¸‹æ¬¡æƒ³è¦ç«äº‰é”åªéœ€è¦æ‹¿çº¿ç¨‹IDè·ŸMarkWordå½“ä¸­å­˜å‚¨çš„çº¿ç¨‹IDä½œæ¯”è¾ƒ==\u0026gt;ç›¸åŒåˆ™ç›´æ¥è·å– è½»é‡çº§é”ï¼šï¼ˆä¸»è¦é€šè¿‡CASå®ç°ï¼‰ç”¨CASå°†è¯¥å¯¹è±¡çš„MarkWordæ‹·è´åˆ°çº¿ç¨‹çš„é”è®°å½•Lock Recordä¸­ï¼Œåå°†MarkWordä¸­ï¼ˆåº”å½“ï¼‰æŒ‡å‘é”è®°å½•çš„æŒ‡é’ˆæŒ‡å‘çº¿ç¨‹Açš„é”ç©ºé—´ é‡é‡çº§é”ï¼šï¼ˆä¸¤ä¸ªä»¥ä¸Šçš„çº¿ç¨‹è·å–é”ï¼‰è‹¥CASæœªæˆåŠŸåˆ™å§‹ç»ˆè‡ªæ—‹ï¼Œæ¶ˆè€—CPU\u0026ndash;\u0026gt;é‡é‡çº§é”ä¼šæŠŠçº¿ç¨‹é€šè¿‡OSè°ƒåº¦åæŒ‚èµ·ï¼ˆèŠ‚çœCPUèµ„æºï¼‰ JVMå¯¹Synchronizedçš„ä¼˜åŒ– é”è†¨èƒ€ é”æ¶ˆé™¤ï¼šè‹¥JVMæ£€æµ‹ä¸åˆ°æŸä»£ç è¢«å…±äº«/ç«äº‰çš„å¯èƒ½ï¼Œåˆ™æ¶ˆé™¤åŒæ­¥é” é”ç²—åŒ–ï¼šå°†å¤šä¸ªè¿ç»­çš„åŠ é”ã€è§£é”æ“ä½œè¿æ¥åœ¨ä¸€èµ·ï¼Œæ‰©å±•æˆä¸€ä¸ªèŒƒå›´æ›´å¤§çš„é” è‡ªé€‚åº”è‡ªæ—‹é”ï¼šé€šè¿‡è‡ªèº«å¾ªç¯å°è¯•è·å–é”ï¼Œé¿å…çº¿ç¨‹çš„æŒ‚èµ·\u0026amp;æ¢å¤æ“ä½œ\u0026ndash;\u0026gt;æŒ‚èµ·çº¿ç¨‹å’Œæ¢å¤çº¿ç¨‹éƒ½éœ€è¦ä»ç”¨æˆ·æ€è½¬å…¥å†…æ ¸æ€ï¼ˆæ“ä½œæ…¢ï¼‰ AQSä»‹ç» åº•å±‚ï¼šç”¨ä¸€ä¸ªVolatileçš„intç±»å‹çš„æˆå‘˜å˜é‡æ¥è¡¨ç¤ºåŒæ­¥çŠ¶æ€Stateï¼Œé€šè¿‡å†…ç½®çš„FIFOé˜Ÿåˆ—ï¼ˆåŒå‘é“¾è¡¨ï¼‰æ¥å®Œæˆèµ„æºè·å–çš„æ’é˜Ÿï¼Œé€šè¿‡CASå®Œæˆå¯¹Stateå€¼çš„ä¿®æ”¹ è·å–/é‡Šæ”¾é”çš„æ–¹æ³•ç”±åä½œç±»è‡ªå·±å®ç°ï¼Œæ¯ä¸ªå®ç°ç±»éƒ½è¦å®ç°tryAcquireã€tryReleaseç­‰æ–¹æ³• ThreadLocalä½œç”¨ã€åŸç†ã€â€¦ ä½œç”¨ï¼š çº¿ç¨‹éš”ç¦»â€”â€”æ¯ä¸ªæ‹¥æœ‰ç‹¬ç«‹çš„å˜é‡å‰¯æœ¬ é™ä½è€¦åˆåº¦â€”â€”å¯ä»¥å‡å°‘å‚æ•°çš„ä¼ é€’ï¼ˆåŒä¸€çº¿ç¨‹çš„å¤šä¸ªå‡½æ•°é—´ï¼‰ æ€§èƒ½ä¼˜åŠ¿â€”â€”é¿å…çº¿ç¨‹é—´çš„åŒæ­¥å¼€é”€ åŸç†ï¼šThreadç±»ä¸­çš„ThreadLocalMapå­—æ®µï¼ˆkeyæ˜¯ThreadLocalæœ¬èº«ï¼Œvalueæ˜¯ThreadLocalçš„æ³›å‹å¯¹è±¡å€¼ï¼‰ é—®é¢˜ï¼šçº¿ç¨‹ç»“æŸæ—¶ï¼Œå…¶ThreadLocalMapä¹Ÿä¼šéšä¹‹é”€æ¯ï¼Œä½†æ˜¯ThreadLocalå¯¹è±¡æœ¬èº«ä¸ä¼šç«‹å³è¢«å›æ”¶\u0026ndash;\u0026gt;ç›´åˆ°æ²¡æœ‰å…¶ä»–å¼•ç”¨æŒ‡å‘å®ƒ==\u0026gt;è‹¥æœªæ˜¾å¼è°ƒç”¨remove()æ–¹æ³•ï¼Œå¯èƒ½å†…å­˜æ³„æ¼ å®ç°ä¹è§‚é”çš„æ–¹å¼ CASæ“ä½œï¼šåŸå­å˜é‡ç±»ï¼Œéƒ½ä½¿ç”¨çš„CAS ç‰ˆæœ¬å·æ§åˆ¶ï¼šæ›´æ–°æ—¶æ¯”è¾ƒç‰ˆæœ¬å· æ—¶é—´æˆ³ï¼šæ›´æ–°æ—¶æ¯”è¾ƒæ—¶é—´æˆ³ CASçš„ç¼ºç‚¹ ABAé—®é¢˜ å¯ä»¥å¢åŠ ç‰ˆæœ¬å·stampæˆ–æ ‡è®° å¾ªç¯æ—¶é—´é•¿å¼€é”€å¤§ï¼šè‡ªæ—‹CASï¼Œç»™CPUå¸¦æ¥å¤§å¼€é”€ åªèƒ½ä¿è¯ä¸€ä¸ªå…±äº«å˜é‡çš„åŸå­æ“ä½œï¼šå¤šä¸ªå˜é‡å¯ä»¥ç”¨AtomicReferenceæˆ–è€…synchronized volatileå…³é”®å­—æœ‰ä»€ä¹ˆç”¨ è½»é‡çº§çš„åŒæ­¥æœºåˆ¶\nä¿è¯å˜é‡å¯¹æ‰€æœ‰çº¿ç¨‹å¯è§ ç¦æ­¢æŒ‡ä»¤é‡æ’åºä¼˜åŒ–\u0026ndash;\u0026gt;å†…å­˜å±éšœå®ç° å†™-å†™å±éšœï¼šå†™æ“ä½œå‰æ‰€æœ‰å…¶å®ƒå†™æ“ä½œéƒ½å·²å®Œæˆ è¯»-å†™å±éšœï¼šè¯»æ“ä½œåçš„æ™®é€šå†™æ“ä½œä¸ä¼šé‡æ’åºåˆ°è¯»ä¹‹å‰ å†™-è¯»å±éšœï¼šå†™æ“ä½œåçš„æ™®é€šè¯»æ“ä½œä¸ä¼šé‡æ’åºåˆ°å†™ä¹‹å‰ï¼Œå¹¶å¼ºåˆ¶åˆ·æ–°ç¼“å­˜ï¼Œä¿è¯å¯è§æ€§ æŒ‡ä»¤é‡æ’åºçš„åŸç† ä¸ºæé«˜æ€§èƒ½ï¼Œè¿›è¡Œé‡æ’åºï¼Œä½†è¦éµå®ˆï¼š å•çº¿ç¨‹ç¯å¢ƒä¸‹ä¸æ”¹å˜ç¨‹åºè¿è¡Œçš„ç»“æœ å­˜åœ¨æ•°æ®ä¾èµ–å…³ç³»çš„ä¸å…è®¸é‡æ’åºï¼ˆeg.area=width*heightï¼Œareaèµ‹å€¼ä¸ä¼šåœ¨å®½ã€é«˜ä¹‹å‰ï¼‰ volatileå¯ä»¥ä¿è¯çº¿ç¨‹å®‰å…¨å— å¦ã€‚ä¸ä¿è¯åŸå­æ€§ï¼Œå¦‚éåŸå­æ“ä½œi++ ä»€ä¹ˆæƒ…å†µäº§ç”Ÿæ­»é”\u0026amp;å¦‚ä½•è§£å†³ åŒæ—¶æ»¡è¶³ä»¥ä¸‹æ¡ä»¶å‘ç”Ÿï¼š äº’æ–¥ï¼ˆå¤šä¸ªçº¿ç¨‹ä¸èƒ½åŒæ—¶ä½¿ç”¨åŒä¸€èµ„æºï¼‰ æŒæœ‰å¹¶ç­‰å¾…ï¼šçº¿ç¨‹AæŒæœ‰èµ„æº1ï¼Œç­‰å¾…èµ„æº2ï¼ˆè¢«é˜»å¡ï¼‰ï¼Œä½†ä¸ä¼šé‡Šæ”¾èµ„æº1 ä¸å¯å‰¥å¤ºï¼šç›´åˆ°ä½¿ç”¨å®Œèµ„æº1å‰ä¸å¯é‡Šæ”¾ ç¯è·¯ç­‰å¾…ï¼šä¸¤çº¿ç¨‹è·å–èµ„æºçš„é¡ºåºæ„æˆç¯å½¢é“¾ ç ´åä»»ä¸€ï¼Œå¸¸è§æ–¹æ³•æ˜¯ç”¨èµ„æºæœ‰åºåˆ†é…æ³•ï¼ˆä»¥ç›¸åŒé¡ºåºç”³è¯·èµ„æºï¼‰ç ´åç¯è·¯ç­‰å¾… çº¿ç¨‹æ±  å·¥ä½œåŸç† å‡å°‘é¢‘ç¹çš„åˆ›å»ºã€é”€æ¯çº¿ç¨‹å¸¦æ¥çš„æ€§èƒ½æŸè€— çº¿ç¨‹æ± çš„å‚æ•°æœ‰ï¼Ÿ corePoolSizeï¼ˆçº¿ç¨‹æ± æ ¸å¿ƒçº¿ç¨‹æ•°é‡ï¼‰ï¼šé»˜è®¤æƒ…å†µä¸‹ï¼Œçº¿ç¨‹æ•°é‡å°äºç­‰äºå…¶æ—¶ï¼Œå³ä½¿ç©ºé—²ä¹Ÿä¸ä¼šè¢«é”€æ¯ å¯ä¸º0 maximumPoolSizeï¼šï¼ˆæœ€å¤šå¯å®¹çº³çš„çº¿ç¨‹æ•°é‡ï¼‰ keepAliveTimeï¼šçº¿ç¨‹æ± ä¸­çº¿ç¨‹çš„æ•°é‡å¤§äºcorePoolSizeï¼Œä¸”ç©ºé—²æ—¶é—´å¤§äºæ­¤æ—¶é—´ï¼Œåˆ™è¢«é”€æ¯ workQueueï¼šå·¥ä½œé˜Ÿåˆ— handlerï¼šæ‹’ç»ç­–ç•¥ æ‹’ç»ç­–ç•¥æœ‰å“ªäº› CallerRunsPolicyï¼šä½¿ç”¨çº¿ç¨‹æ± çš„è°ƒç”¨è€…æ‰€åœ¨çš„çº¿ç¨‹å»æ‰§è¡Œè¢«æ‹’ç»çš„ä»»åŠ¡ï¼ˆé™¤éçº¿ç¨‹æ± è¢«åœæ­¢/ä»»åŠ¡é˜Ÿåˆ—æœ‰ç©ºç¼ºï¼‰ AbortPolicyï¼šæŠ›å‡ºâ€œä»»åŠ¡è¢«çº¿ç¨‹æ± æ‹’ç»â€å¼‚å¸¸ DiscardPolicyï¼šé™é»˜æ‹’ç»æäº¤ï¼ˆä¸å¤„ç†ï¼‰ DiscardOldestPolicyï¼šæŠ›å¼ƒæœ€è€çš„ä»»åŠ¡ï¼Œæ‰§è¡Œå½“å‰ä»»åŠ¡ è‡ªå®šä¹‰ï¼šå®ç°RejectedExecutionHandleræ¥å£ çº¿ç¨‹æ± å‚æ•°è®¾ç½®ï¼š æ ¸å¿ƒçº¿ç¨‹æ•°ï¼šCPUå¯†é›†å‹è®¾ç½®ä¸ºCPUæ•°+1ï¼ŒIOå¯†é›†å‹è®¾ç½®ä¸ºCPU*2 åœºæ™¯ï¼š ï¼ˆç”µå•†ï¼‰SynchronousQueue\u0026ndash;\u0026gt;ä¸ç¼“å­˜ä»»åŠ¡ï¼Œç›´æ¥æ‰©å®¹çº¿ç¨‹ \u0026amp; ç›´æ¥æ‹’ç»ç­–ç•¥ï¼ˆé¿å…è¿‡è½½ï¼‰ \u0026amp; æœ€å¤§è®¾ç½®ä¸º32ï¼ˆçªå‘æµé‡æ‰©å®¹ï¼‰ ï¼ˆåå°ï¼‰æœ€å¤§ç¦æ­¢æ‰©å®¹ \u0026amp; ä¸å›æ”¶çº¿ç¨‹ \u0026amp; æœ‰ç•Œé˜»å¡é˜Ÿåˆ—å®¹é‡1000 \u0026amp; CallerRunsPolicy ï¼ˆå¾®æœåŠ¡ï¼‰60så›æ”¶ \u0026amp; æœ‰ç•Œé˜»å¡é˜Ÿåˆ—å®¹é‡200 \u0026amp; æœ€å¤§64ï¼ˆåº”å¯¹æ…¢ä¸‹æ¸¸ï¼‰ çº¿ç¨‹æ± ç§ç±»æœ‰å“ªäº› ScheduledThreadPoolï¼šè®¾ç½®å®šæœŸçš„æ‰§è¡Œä»»åŠ¡ï¼Œæ”¯æŒå®šæ—¶/å‘¨æœŸæ€§æ‰§è¡Œä»»åŠ¡ FixedThreadPoolï¼šæ ¸å¿ƒçº¿ç¨‹æ•°å’Œæœ€å¤§çº¿ç¨‹æ•°ä¸€æ · CachedThreadPoolï¼šå¯ç¼“å­˜çº¿ç¨‹æ± ï¼Œçº¿ç¨‹æ•°å‡ ä¹å¯ä»¥æ— é™å¢åŠ ï¼Œé—²ç½®æ—¶å›æ”¶ çº¿ç¨‹æ± ä¸­shutdown()ï¼ŒshutdownNow()è¿™ä¸¤ä¸ªæ–¹æ³•æœ‰ä»€ä¹ˆä½œç”¨ shutdown()ï¼šç½®çŠ¶æ€ä¸ºSHUTDOWNï¼Œæ­£åœ¨æ‰§è¡Œçš„ä»»åŠ¡ç»§ç»­æ‰§è¡Œï¼Œæ²¡æœ‰æ‰§è¡Œçš„ä¸­æ–­ï¼Œä¸èƒ½æ·»åŠ ä»»ä½•ä»»åŠ¡ï¼Œå¦åˆ™æŠ›å‡º RejectedExecutionException å¼‚å¸¸ shutdownNow()ï¼šä¸ºSTOPï¼Œè¯•å›¾åœæ­¢æ‰€æœ‰æ­£åœ¨æ‰§è¡Œçš„çº¿ç¨‹ï¼Œä¸å†å¤„ç†è¿˜åœ¨æ± é˜Ÿåˆ—ä¸­ç­‰å¾…çš„ä»»åŠ¡ã€‚\u0026ndash;\u0026gt;è°ƒç”¨Thread.interrupt() æ–¹æ³•\u0026ndash;\u0026gt;å¦‚æœçº¿ç¨‹ä¸­æ²¡æœ‰sleep ã€waitã€Conditionã€å®šæ—¶é”ç­‰åº”ç”¨ï¼Œè¯¥æ–¹æ³•å¤±æ•ˆ æäº¤çš„ä»»åŠ¡å¯ä»¥æ’¤å›å— å¯ã€‚å‘çº¿ç¨‹æ± æäº¤ä»»åŠ¡æ—¶ï¼Œä¼šå¾—åˆ°Futureå¯¹è±¡ï¼Œæä¾›æ–¹æ³•ç®¡ç†ä»»åŠ¡æ‰§è¡Œ cancel(boolean mayInterruptIfRunning)æ–¹æ³•ï¼Œå°è¯•å–æ¶ˆæ‰§è¡Œçš„ä»»åŠ¡ï¼ŒmayInterruptIfRunningæŒ‡ç¤ºæ˜¯å¦å…è®¸ä¸­æ–­æ­£åœ¨æ‰§è¡Œçš„ä»»åŠ¡ï¼ˆtrueåˆ™å…è®¸ï¼‰ åœºæ™¯ å•ä¾‹æ¨¡å‹æ—¢ç„¶å·²ç»ç”¨äº†synchronizedï¼Œä¸ºä»€ä¹ˆè¿˜è¦åœ¨åŠ volatile åˆ›å»ºä¸€ä¸ªæ—¢çº¿ç¨‹å®‰å…¨åˆèƒ½æ­£ç¡®åˆå§‹åŒ–çš„å•ä¾‹æ¨¡å¼ é€šè¿‡ synchronized ä¿è¯äº†åˆ›å»ºè¿‡ç¨‹çš„çº¿ç¨‹å®‰å…¨æ€§ï¼Œé¿å…åˆ›å»ºå¤šä¸ªå•ä¾‹å¯¹è±¡ volatileç¡®ä¿å¯¹è±¡å¼•ç”¨çš„å¯è§æ€§å’Œåˆ›å»ºè¿‡ç¨‹çš„æœ‰åºæ€§ï¼ˆé¿å…é‡æ’åºï¼‰ è™šæ‹Ÿæœº å†…å­˜æ¨¡å‹ JVMçš„å†…å­˜æ¨¡å‹ ç¨‹åºè®¡æ•°å™¨ï¼šå¯ä»¥çœ‹ä½œå½“å‰çº¿ç¨‹æ‰€æ‰§è¡Œçš„å­—èŠ‚ç çš„è¡Œå·æŒ‡ç¤ºå™¨ï¼Œå­˜å‚¨å½“å‰çº¿ç¨‹æ­£åœ¨æ‰§è¡Œçš„javaæ–¹æ³•çš„JVMæŒ‡ä»¤åœ°å€ï¼ˆè‹¥æ‰§è¡ŒNativeæ–¹æ³•åˆ™ä¸ºnullï¼‰ã€‚ç”Ÿå‘½å‘¨æœŸä¸çº¿ç¨‹ç›¸åŒ è™šæ‹Ÿæœºæ ˆï¼šæ¯ä¸ªçº¿ç¨‹æœ‰ç‹¬ç«‹çš„ Java è™šæ‹Ÿæœºæ ˆï¼Œç”Ÿå‘½å‘¨æœŸä¸çº¿ç¨‹ç›¸åŒã€‚æ¯ä¸ªæ–¹æ³•æ‰§è¡Œæ—¶åˆ›å»ºä¸€ä¸ªæ ˆå¸§ï¼ˆå­˜å‚¨å±€éƒ¨å˜é‡è¡¨ã€æ“ä½œæ•°æ ˆã€åŠ¨æ€é“¾æ¥ã€æ–¹æ³•å‡ºå£ç­‰ä¿¡æ¯ï¼‰\u0026ndash;\u0026gt;å¯èƒ½æŠ› StackOverflowError å’Œ OutOfMemoryError å¼‚å¸¸ æœ¬åœ°æ–¹æ³•æ ˆï¼šä¸è™šæ‹Ÿæœºæ ˆç±»ä¼¼ï¼ˆhotspotä¸­äºŒè€…åˆä¸€ï¼‰ï¼Œä¸»è¦ä¸ºè™šæ‹Ÿæœºä½¿ç”¨åˆ°çš„ Native æ–¹æ³•æœåŠ¡ã€‚æ‰§è¡Œæ—¶åˆ›å»ºæ ˆå¸§\u0026ndash;\u0026gt;å¯èƒ½æŠ› StackOverflowError å’Œ OutOfMemoryError å¼‚å¸¸ å †ï¼šJVMä¸­æœ€å¤§çš„å†…å­˜åŒºåŸŸï¼Œè¢«æ‰€æœ‰çº¿ç¨‹å…±äº«ï¼ŒJVMå¯åŠ¨æ—¶åˆ›å»ºï¼Œå­˜æ”¾å¯¹è±¡å®ä¾‹\u0026ndash;\u0026gt;å¯èƒ½æŠ› OutOfMemoryError å¼‚å¸¸ å…ƒç©ºé—´ï¼ˆjdk1.8åï¼‰ï¼šjdk1.8åå–ä»£æ–¹æ³•åŒºï¼Œä½¿ç”¨æœ¬åœ°å†…å­˜ã€‚å­˜å‚¨å·²è¢«JVMåŠ è½½çš„ç±»ä¿¡æ¯ã€å¸¸é‡ã€é™æ€å˜é‡ç­‰\u0026ndash;\u0026gt;å¯èƒ½æŠ› OutOfMemoryError å¼‚å¸¸ï¼ˆå†…å­˜ä¸è¶³æ—¶ï¼‰ ï¼ˆè¿è¡Œæ—¶å¸¸é‡æ± ï¼‰ï¼šæ–¹æ³•åŒºï¼ˆå…ƒç©ºé—´ï¼‰çš„ä¸€éƒ¨åˆ†ï¼Œå­˜æ”¾ç¼–è¯‘æ—¶ç”Ÿæˆçš„å­—é¢é‡ã€ç¬¦å·å¼•ç”¨ç­‰ï¼Œæœ‰åŠ¨æ€æ€§ï¼Œè¿è¡Œæ—¶çš„æ–°å¸¸é‡ä¹Ÿå¯æ”¾å…¥ã€‚\u0026ndash;\u0026gt;å¯èƒ½æŠ› OutOfMemoryError å¼‚å¸¸ ç›´æ¥å†…å­˜ï¼šä¸å±äºJVMè¿è¡Œæ—¶æ•°æ®åŒºçš„ä¸€éƒ¨åˆ†ï¼Œé€šè¿‡NIOç±»å¼•å…¥ï¼Œæ˜¯å †å¤–å†…å­˜ï¼Œå¯ä»¥æ˜¾è‘—æé«˜I/Oæ€§èƒ½\u0026ndash;\u0026gt;å¯èƒ½æŠ› OutOfMemoryError å¼‚å¸¸ JVMå†…å­˜æ¨¡å‹ä¸­å †å’Œæ ˆçš„åŒºåˆ« ç”¨é€”ï¼šæ ˆä¸»è¦ç”¨äºå­˜å‚¨å±€éƒ¨å˜é‡ã€æ–¹æ³•è°ƒç”¨çš„å‚æ•°ã€æ–¹æ³•è¿”å›åœ°å€ä»¥åŠä¸€äº›ä¸´æ—¶æ•°æ® vs å †ç”¨äºå­˜å‚¨å¯¹è±¡çš„å®ä¾‹ï¼ˆåŒ…æ‹¬ç±»çš„å®ä¾‹å’Œæ•°ç»„ï¼‰ ç”Ÿå‘½å‘¨æœŸï¼šæ ˆä¸­æ•°æ®ç”Ÿå‘½å‘¨æœŸæ˜ç¡®ï¼ˆä¸€ä¸ªæ–¹æ³•è°ƒç”¨ç»“æŸï¼Œå¯¹åº”çš„æ ˆå¸§å³è¢«é”€æ¯ï¼Œå…¶ä¸­çš„å±€éƒ¨å˜é‡å³è¢«ç§»é™¤ï¼‰ vs ç”Ÿå‘½å‘¨æœŸä¸æ˜ç¡®ï¼ˆå¯¹è±¡åœ¨åƒåœ¾å›æ”¶æœºåˆ¶ï¼ˆGCï¼‰æ£€æµ‹ä¸åˆ°å¼•ç”¨æ—¶è¢«å›æ”¶ï¼‰ å­˜å–é€Ÿåº¦ï¼šæ ˆé€šå¸¸æ›´å¿«ï¼ˆå…ˆè¿›åå‡ºï¼Œæ“ä½œç®€å•ï¼‰ vs å¯¹è±¡çš„åˆ†é…ä¸å›æ”¶è€—æ—¶ï¼ŒGCè¿è¡Œä¹Ÿå½±å“æ€§èƒ½ å­˜å‚¨ç©ºé—´ï¼šæ ˆçš„ç©ºé—´ç›¸å¯¹è¾ƒå°ï¼Œä¸”å›ºå®šï¼Œç”±æ“ä½œç³»ç»Ÿç®¡ç†ï¼Œæ ˆæº¢å‡ºé€šå¸¸å› ä¸ºé€’å½’è¿‡æ·±æˆ–å±€éƒ¨å˜é‡è¿‡å¤§ vs å †çš„ç©ºé—´è¾ƒå¤§ï¼ŒåŠ¨æ€æ‰©å±•ï¼Œç”±JVMç®¡ç†ï¼Œå †æº¢å‡ºé€šå¸¸å› ä¸ºåˆ›å»ºäº†å¤ªå¤šå¤§å¯¹è±¡æˆ–æœªå›æ”¶ä¸å†ä½¿ç”¨çš„å¯¹è±¡ å¯è§æ€§ï¼šæ ˆä¸­æ•°æ®å¯¹çº¿ç¨‹ç§æœ‰ vs é˜Ÿä¸­æ•°æ®å…±äº« æ ˆä¸­å­˜å‚¨å¯¹è±¡è¿˜æ˜¯æŒ‡é’ˆ æ ˆä¸­å­˜å‚¨åŸºæœ¬ç±»å‹çš„æ•°æ®å’Œå¯¹è±¡çš„å¼•ç”¨ï¼ˆå †å­˜å‚¨å¯¹è±¡å®ä¾‹ï¼‰ å †åˆ†ä¸ºå“ªå‡ éƒ¨åˆ† æ–°ç”Ÿä»£ï¼š Eden Spaceï¼šå¤§å¤šæ–°åˆ›å»ºçš„å¯¹è±¡å­˜æ”¾æ­¤å¤„ï¼Œæ»¡æ—¶è§¦å‘Minor GCï¼ˆæ–°ç”Ÿä»£åƒåœ¾å›æ”¶ï¼‰ Survivior Spaceï¼šS0\u0026amp;S1ï¼Œæ¯æ¬¡Minor GCåï¼Œå­˜æ´»ä¸‹æ¥çš„å¯¹è±¡ä¼šè¢«ç§»åŠ¨åˆ°å…¶ä¸­ä¸€ä¸ªSurvivorç©ºé—´ä»¥ç»§ç»­å…¶ç”Ÿå‘½å‘¨æœŸï¼ˆè½®æµå……å½“å¯¹è±¡çš„ä¸­è½¬ç«™ï¼ŒåŒºåˆ†çŸ­æš‚ä¸é•¿æœŸå­˜æ´»çš„å¯¹è±¡ï¼‰ è€å¹´ä»£ï¼šä¸€æ¬¡æˆ–å¤šæ¬¡Minor GCä»å­˜æ´»çš„å¯¹è±¡è¢«ç§»åŠ¨åˆ°è€å¹´ä»£ã€‚å…¶ä¸­å¯¹è±¡ç”Ÿå‘½å‘¨æœŸè¾ƒé•¿ï¼ŒMajor GCï¼ˆFull GCï¼Œè®¾è®¡è€å¹´ä»£çš„åƒåœ¾å›æ”¶ï¼‰å‘ç”Ÿçš„é¢‘ç‡æ›´ä½ï¼Œä½†æ‰§è¡Œæ—¶é—´é€šå¸¸æ›´é•¿ã€‚è€å¹´ä»£ç©ºé—´é€šå¸¸æ¯”æ–°ç”Ÿä»£å¤§ å…ƒç©ºé—´ï¼šJava 8å¼€å§‹ï¼Œæ°¸ä¹…ä»£ï¼ˆPermanent Generationï¼‰è¢«å…ƒç©ºé—´å–ä»£ï¼Œå­˜å‚¨ç±»çš„å…ƒæ•°æ®ä¿¡æ¯ï¼Œå¦‚ç±»çš„å­—æ®µã€æ–¹æ³•ç­‰ã€‚ä½¿ç”¨æœ¬åœ°å†…å­˜ï¼Œä¸åœ¨å †ä¸­ å¤§å¯¹è±¡åŒºï¼šæŸäº›JVMå®ç°ä¸­åˆ†é…ï¼ŒæŒ‡éœ€è¦å¤§é‡è¿ç»­å†…å­˜ç©ºé—´çš„å¯¹è±¡ï¼Œç›´æ¥åˆ†é…åœ¨è€å¹´ä»£ï¼Œé¿å…å†…å­˜ç¢ç‰‡åŒ–\u0026amp;é¢‘ç¹ç§»åŠ¨çš„æ€§èƒ½å¼€é”€ ç¨‹åºè®¡æ•°å™¨çš„ä½œç”¨\u0026amp;ä¸ºä»€ä¹ˆç§æœ‰ å¤šçº¿ç¨‹è¿è¡Œï¼Œçº¿ç¨‹åˆ‡æ¢æ—¶å¯ä»¥é€šè¿‡ç¨‹åºè®¡æ•°å™¨å®šä½ä¸‹ä¸€æ¡æŒ‡ä»¤ï¼Œä¸åŒçº¿ç¨‹æ‰§è¡Œçš„ä»£ç çš„æŒ‡ä»¤åœ°å€ä¸åŒï¼Œæ•…ç§æœ‰ æ–¹æ³•åŒºä¸­æ–¹æ³•çš„æ‰§è¡Œè¿‡ç¨‹ è§£ææ–¹æ³•è°ƒç”¨ï¼ˆè‹¥ä¹‹å‰æœªè§£æè¿‡ï¼ŒJVMæ ¹æ®æ–¹æ³•ç¬¦å·å¼•ç”¨æ‰¾åˆ°å®é™…æ–¹æ³•åœ°å€ï¼‰ æ ˆå¸§åˆ›å»º æ‰§è¡Œæ–¹æ³•ï¼ˆå­—èŠ‚ç æŒ‡ä»¤æ‰§è¡Œï¼‰ è¿”å›å¤„ç†ï¼šè¿”å›ç»“æœï¼Œæ¸…ç†å½“å‰æ ˆå¸§ï¼Œæ¢å¤è°ƒç”¨è€…çš„æ‰§è¡Œç¯å¢ƒ æ–¹æ³•åŒºä¸­æœ‰ä»€ä¹ˆ ç±»ä¿¡æ¯ å¸¸é‡æ± ï¼šå­˜å‚¨ç±»å’Œæ¥å£ä¸­çš„å¸¸é‡ é™æ€å˜é‡ï¼šç±»åˆå§‹åŒ–æ—¶èµ‹å€¼ å³æ—¶ç¼–è¯‘å™¨ç¼–è¯‘åçš„ä»£ç ç¼“å­˜ String s = new Stringï¼ˆâ€œabcâ€ï¼‰æ‰§è¡Œè¿‡ç¨‹å¯¹åº”å“ªäº›å†…å­˜åŒºåŸŸ newå¯¹è±¡==\u0026gt;å †å†…å­˜å­˜å‚¨å­—ç¬¦ä¸²å¯¹è±¡ abcå­—ç¬¦ä¸²å®é™…è¢«finalä¿®é¥°ï¼Œä¸€ä¸ªå­—ç¬¦ä¸²å¸¸é‡ï¼Œè‹¥å­—ç¬¦ä¸²å¸¸é‡æ± ä¸­å­˜åœ¨ï¼Œåˆ™åœ¨å †ä¸­åˆ›å»ºå¯¹è±¡å¹¶ä¿å­˜å…¶å¼•ç”¨åˆ°å¸¸é‡æ± ï¼›ä¸å­˜åœ¨åˆ™åœ¨å¸¸é‡æ± ä¸­åˆ›å»º å¼•ç”¨ç±»å‹æœ‰å“ªäº› å¼ºï¼šä»£ç ä¸­æ™®éå­˜åœ¨çš„èµ‹å€¼æ–¹å¼ï¼Œæ¯”å¦‚A a = new A()\u0026ndash;\u0026gt;å¼ºå¼•ç”¨å…³è”çš„å¯¹è±¡æ°¸è¿œä¸ä¼šè¢«GCå›æ”¶ è½¯ï¼šå¯ä»¥ç”¨SoftReferenceæè¿°ï¼ŒæŒ‡æœ‰ç”¨ä½†ä¸å¿…é¡»çš„å¯¹è±¡\u0026ndash;\u0026gt;å†…å­˜æº¢å‡ºæ—¶ä¼šå›æ”¶æ­¤ç±»å¼•ç”¨çš„å¯¹è±¡ å¼±ï¼šWeakReference\u0026ndash;\u0026gt;ä¸‹ä¸€æ¬¡GCæ—¶å›æ”¶ï¼Œä¸ç®¡å†…å­˜æ˜¯å¦è¶³å¤Ÿ è™šï¼šaliaså¹»å½±å¼•ç”¨ï¼ŒPhantomReferenceï¼Œå¿…é¡»å’ŒReferenceQueueä¸€èµ·ä½¿ç”¨\u0026ndash;\u0026gt;å‘ç”ŸGCæ—¶å›æ”¶ï¼Œå¯ä»¥ç”¨æ¥ç®¡ç†å †å¤–å†…å­˜ å¼±å¼•ç”¨çš„åº”ç”¨ å¼±å¼•ç”¨é€šè¿‡Java.lang.ref.WeakReferenceç±»å®ç°ï¼Œä¸»è¦ç”¨é€”æ˜¯åˆ›å»ºéå¼ºåˆ¶æ€§çš„å¯¹è±¡å¼•ç”¨ï¼Œå†…å­˜å‹åŠ›å¤§æ—¶è¢«GCæ¸…ç†ï¼Œé¿å…å†…å­˜æ³„æ¼ åº”ç”¨åœºæ™¯ï¼š ç¼“å­˜ç³»ç»Ÿï¼šå¸Œæœ›ç¼“å­˜é¡¹èƒ½å¤Ÿåœ¨å†…å­˜å‹åŠ›ä¸‹è‡ªåŠ¨é‡Šæ”¾ å¯¹è±¡æ± ï¼šç®¡ç†æš‚æ—¶ä¸ä½¿ç”¨çš„å¯¹è±¡ é¿å…å†…å­˜æ³„æ¼ï¼šä¸€ä¸ªä¸è¯¥è¢«é•¿æœŸå¼•ç”¨çš„å¯¹è±¡ï¼Œå¯é¿å…æ„å¤–ä¿ç•™ å†…å­˜æ³„æ¼å’Œå†…å­˜æº¢å‡º æ³„éœ²ï¼šç¨‹åºåœ¨è¿è¡Œè¿‡ç¨‹ä¸­ä¸å†ä½¿ç”¨çš„å¯¹è±¡ä»ç„¶è¢«å¼•ç”¨ï¼ŒGCæ— æ³•å›æ”¶ï¼Œå¯ç”¨å†…å­˜é€æ¸å‡å°‘ å¸¸è§åŸå› ï¼šé™æ€é›†åˆï¼ˆHashMap/ArrayListç­‰ï¼‰å­˜å‚¨å¯¹è±¡ä¸”ä»æœªæ¸…ç†ï¼›äº‹ä»¶ç›‘å¬ï¼ˆæœªå–æ¶ˆå¯¹äº‹ä»¶æºçš„ç›‘å¬ï¼‰ï¼›çº¿ç¨‹ï¼ˆæœªåœæ­¢çš„çº¿ç¨‹å¯èƒ½æŒæœ‰å¯¹è±¡å¼•ç”¨ï¼‰ æº¢å‡ºï¼šJVMæ— æ³•æ‰¾åˆ°è¶³å¤Ÿçš„å†…å­˜ï¼Œå¼•å‘OutOfMemoryError å¸¸è§åŸå› ï¼šå¤§é‡å¯¹è±¡åˆ›å»ºï¼ˆè¶…è¿‡å †çš„é™åˆ¶ï¼‰ï¼›æŒä¹…å¼•ç”¨ï¼ˆå¤§å‹æ•°æ®ç»“æ„ï¼Œå¦‚ç¼“å­˜ã€é›†åˆç­‰é•¿æ—¶é—´æŒæœ‰å¼•ç”¨ï¼‰ï¼›é€’å½’ å…·ä½“çš„å†…å­˜æ³„æ¼ä¸æº¢å‡ºçš„ä¾‹å­\u0026amp;è§£å†³æ–¹æ¡ˆ é™æ€å±æ€§å¯¼è‡´å†…å­˜æ³„æ¼ï¼šstaticå˜é‡ï¼Œå¦‚æœé›†åˆ/å¤§é‡å¯¹è±¡è¢«æŒ‡å®šä¸ºstaticï¼Œä¼šåœ¨æ•´ä¸ªç”Ÿå‘½å‘¨æœŸä¸­å ç”¨å†…å­˜ è§£å†³ï¼šå‡å°‘é™æ€å˜é‡ / è‹¥ä½¿ç”¨å•ä¾‹ï¼Œå°½é‡é‡‡ç”¨æ‡’åŠ è½½ï¼ˆçœŸæ­£éœ€è¦æ—¶æ‰è¢«åˆ›å»ºï¼Œç±»ä¼¼ç½‘ç«™é¡µé¢çš„å›¾ç‰‡ï¼‰ æœªå…³é—­èµ„æºå¯¼è‡´å†…å­˜æº¢å‡ºï¼šå¿˜è®°å…³é—­è¿™äº›èµ„æºä¼šé˜»å¡å†…å­˜ï¼Œä»è€ŒGCæ— æ³•æ¸…ç† è§£å†³ï¼šfinallyå…³é—­ / å…³é—­è¿æ¥éƒ¨åˆ†çš„ä»£ç ä¸å‡ºå¼‚å¸¸ / Java7ä»¥ä¸Šç‰ˆæœ¬å¯ä½¿ç”¨try-with-resourcesä»£ç æ–¹å¼ ThreadLocalå†…å­˜æ³„æ¼ï¼šThreadLocalMapä½¿ç”¨ThreadLocalçš„å¼±å¼•ç”¨ä½œä¸ºkeyï¼Œè‹¥æ— å¤–éƒ¨å¼ºå¼•ç”¨å¼•ç”¨å®ƒï¼ŒGCæ—¶ThreadLocalä¸€å®šä¼šè¢«å›æ”¶==\u0026gt;ThreadLocalMapä¸­å‡ºç°keyä¸ºnullçš„Entryï¼Œåˆ™æ— æ³•è®¿é—®å¯¹åº”çš„value\u0026ndash;\u0026gt;è‹¥çº¿ç¨‹ä¸ç»“æŸï¼Œvalueæ°¸è¿œæ— æ³•å›æ”¶ è§£å†³ï¼šä½¿ç”¨ThreadLocalçš„remove()æ–¹æ³•ç§»é™¤å½“å‰çº¿ç¨‹çš„value / ä¸ç”¨ThreadLocal.set(null) çš„æ–¹å¼æ¸…é™¤valueï¼ˆå¹¶æœªæ¸…é™¤ï¼‰ / æœ€å¥½å°†ThreadLocalè§†ä¸ºéœ€è¦åœ¨finallyå—ä¸­å…³é—­çš„èµ„æº ç±»åˆå§‹åŒ–ä¸ç±»åŠ è½½ å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸï¼šåˆ›å»º\u0026ndash;\u0026gt;ä½¿ç”¨\u0026ndash;\u0026gt;é”€æ¯\nåˆ›å»ºå¯¹è±¡çš„è¿‡ç¨‹ ç±»åŠ è½½æ£€æŸ¥ï¼šJVMé‡åˆ°newæ—¶ï¼Œæ£€æŸ¥è¯¥æŒ‡ä»¤çš„å‚æ•°èƒ½å¦åœ¨å¸¸é‡æ± å®šä½åˆ°ä¸€ä¸ªç±»çš„ç¬¦å·å¼•ç”¨ï¼Œå¹¶æ£€æŸ¥å…¶ä»£è¡¨çš„ç±»æ˜¯å¦å·²è¢«åŠ è½½ã€è§£æä¸åˆå§‹åŒ–è¿‡ï¼Œè‹¥æ— åˆ™æ‰§è¡Œç±»åŠ è½½è¿‡ç¨‹ åˆ†é…å†…å­˜ï¼šå¯¹è±¡æ‰€éœ€çš„å†…å­˜å¤§å°åœ¨ç±»åŠ è½½å®Œæˆåç¡®å®šï¼ŒJVMåªéœ€ä» Java å †ä¸­åˆ’åˆ†ä¸€å—ç¡®å®šå¤§å°çš„å†…å­˜ åˆå§‹åŒ–é›¶å€¼ï¼šJVMå°†åˆ†é…åˆ°çš„å†…å­˜ç©ºé—´éƒ½åˆå§‹åŒ–ä¸ºé›¶å€¼ï¼ˆä¸åŒ…æ‹¬å¯¹è±¡å¤´ï¼‰ è¿›è¡Œå¿…è¦è®¾ç½®ï¼ˆå¦‚å¯¹è±¡å¤´ï¼‰ï¼šå¦‚å¯¹è±¡æ˜¯å“ªä¸ªç±»çš„å®ä¾‹ã€å¦‚ä½•æ‰èƒ½æ‰¾åˆ°ç±»çš„å…ƒæ•°æ®ä¿¡æ¯ã€å¯¹è±¡çš„å“ˆå¸Œç ã€å¯¹è±¡çš„ GC åˆ†ä»£å¹´é¾„ã€æ˜¯å¦å¯ç”¨åå‘é”ç­‰ä¿¡æ¯ æ‰§è¡Œinitæ–¹æ³•ï¼šå¯¹è±¡éœ€è¦çš„å…¶ä»–èµ„æºå’ŒçŠ¶æ€ä¿¡æ¯è¿˜æœªè®¾ç½®ï¼Œäºæ˜¯å¼€å§‹æ‰§è¡Œæ„é€ æ–¹æ³•ç­‰ ç±»åŠ è½½å™¨æœ‰å“ªäº› å¯åŠ¨ç±»åŠ è½½å™¨ï¼šæœ€é¡¶å±‚ï¼Œè´Ÿè´£åŠ è½½Javaæ ¸å¿ƒåº“ï¼ˆå¦‚ä½äºjre/lib/rt.jarä¸­çš„ç±»ï¼‰ï¼Œcppç¼–å†™ï¼Œå±äºJVMçš„ä¸€éƒ¨åˆ†ã€‚æ— æ³•è¢«javaç¨‹åºç›´æ¥å¼•ç”¨ æ‰©å±•ç±»åŠ è½½å™¨ï¼šjavaå®ç°ï¼Œç»§æ‰¿è‡ªClassLoaderç±»ï¼ŒåŠ è½½javaæ‰©å±•ç›®å½•ä¸‹çš„jaråŒ…ä¸ç±»åº“ï¼ˆå¦‚jre/lib/extæˆ–ç”±ç³»ç»Ÿå˜é‡Java.ext.dirsæŒ‡å®šçš„ç›®å½•ï¼‰ï¼Œæœ‰å¯åŠ¨ç±»åŠ è½½å™¨åŠ è½½ ç³»ç»Ÿç±»/åº”ç”¨ç¨‹åºç±»åŠ è½½å™¨ï¼šjavaå®ç°ï¼Œè´Ÿè´£åŠ è½½ç”¨æˆ·ç±»è·¯å¾„ï¼ˆClassPathï¼‰ä¸Šçš„æŒ‡å®šç±»åº“ï¼Œé»˜è®¤ä½¿ç”¨ã€‚çˆ¶åŠ è½½å™¨æ˜¯æ‰©å±•ç±»åŠ è½½å™¨ è‡ªå®šä¹‰ç±»åŠ è½½å™¨ï¼šå¼€å‘è€…æ ¹æ®éœ€æ±‚å®šåˆ¶ï¼ŒjavaåŠ¨æ€æ€§çš„é‡è¦ä½“ç° åŒäº²å§”æ´¾æ¨¡å‹ï¼šæ”¶åˆ°ç±»åŠ è½½è¯·æ±‚æ—¶ï¼Œç±»åŠ è½½å™¨æŠŠå®ƒå§”æ´¾åˆ°çˆ¶ç±»åŠ è½½å™¨ä¸­ï¼ˆç›´åˆ°é¡¶å±‚çš„å¯åŠ¨ç±»åŠ è½½å™¨ï¼‰ï¼Œåªæœ‰å½“çˆ¶ç±»åé¦ˆæ— æ³•å®Œæˆè¯·æ±‚æ—¶ï¼ˆå®ƒçš„æœç´¢èŒƒå›´ä¸­æ²¡æœ‰æ‰¾åˆ°æ‰€éœ€çš„ç±»ï¼‰ï¼Œå­åŠ è½½å™¨æ‰å°è¯•è‡ªå·±åŠ è½½ åŒäº²å§”æ´¾æ¨¡å‹çš„ä½œç”¨ ä¿è¯ç±»çš„å”¯ä¸€æ€§ï¼šé¿å…ä¸åŒç±»åŠ è½½å™¨åŠ è½½ç›¸åŒç±»çš„æƒ…å†µ ä¿è¯å®‰å…¨æ€§ï¼šJavaæ ¸å¿ƒåº“è¢«å¯åŠ¨ç±»åŠ è½½å™¨åŠ è½½ï¼Œå¯åŠ¨ç±»åŠ è½½å™¨åªåŠ è½½ä¿¡ä»»çš„ç±»è·¯å¾„ä¸­çš„ç±»\u0026ndash;\u0026gt;é˜²æ­¢å†’å……æ ¸å¿ƒç±» æ”¯æŒéš”ç¦»ä¸å±‚æ¬¡åˆ’åˆ†ï¼šæ”¯æŒä¸åŒå±‚æ¬¡çš„ç±»åŠ è½½å™¨æœåŠ¡äºä¸åŒçš„ç±»åŠ è½½éœ€æ±‚ï¼Œæœ‰åŠ©äºå®ç°æ²™ç®±å®‰å…¨æœºåˆ¶ï¼Œä¿è¯å„å±‚çº§åŠ è½½å™¨çš„èŒè´£æ¸…æ™°ï¼Œä¾¿äºç»´æŠ¤æ‰©å±• ç®€åŒ–åŠ è½½æµç¨‹ï¼šå‡å°‘æ¯ä¸ªåŠ è½½ç±»éœ€è¦å¤„ç†çš„ç±»çš„æ•°é‡ ç±»åŠ è½½çš„è¿‡ç¨‹ åŠ è½½ï¼šé€šè¿‡ç±»çš„å…¨é™å®šåï¼ˆåŒ…å + ç±»åï¼‰ï¼Œè·å–åˆ°å¯¹åº”çš„.classæ–‡ä»¶çš„äºŒè¿›åˆ¶å­—èŠ‚æµï¼Œå°†å­—èŠ‚æµä»£è¡¨çš„é™æ€å­˜å‚¨ç»“æ„è½¬åŒ–ä¸ºæ–¹æ³•å»è¿è¡Œæ—¶çš„æ•°æ®ç»“æ„ï¼Œåœ¨å†…å­˜ä¸­ç”Ÿæˆä»£è¡¨è¯¥ç±»çš„Java.lang.Classå¯¹è±¡ï¼Œä½œä¸ºæ–¹æ³•åŒºè¯¥ç±»çš„è®¿é—®å…¥å£ è¿æ¥ï¼š éªŒè¯ï¼šç¡®ä¿å­—èŠ‚æµä¿¡æ¯ç¬¦åˆJVMè¦æ±‚ï¼Œä¿è¯å…¶ä¸ä¼šå±å®³JVMå®‰å…¨ï¼ˆæ–‡ä»¶æ ¼å¼æ ¡éªŒã€å…ƒæ•°æ®ã€å­—èŠ‚ç ã€ç¬¦å·å¼•ç”¨éªŒè¯ï¼‰ å‡†å¤‡ï¼šä¸ºé™æ€å­—æ®µåˆ†é…å†…å­˜å¹¶è®¾ç½®åˆå€¼ï¼ˆfinalä¸è®¾ç½®ï¼‰ è§£æï¼šå°†å¸¸é‡æ± çš„ç¬¦å·å¼•ç”¨ï¼ˆæè¿°ç›®æ ‡çš„ä¸€ç»„ç¬¦å·ï¼Œåªè¦èƒ½æ— æ­§ä¹‰å®šä½ç›®æ ‡å³å¯ï¼‰æ›¿æ¢ä¸ºç›´æ¥å¼•ç”¨ï¼ˆæŒ‡å‘ç›®æ ‡çš„æŒ‡é’ˆã€åç§»é‡ç­‰ï¼‰ åˆå§‹åŒ–ï¼šæ‰§è¡Œï¼ˆç¼–è¯‘å™¨ç”Ÿæˆçš„ï¼‰æ„é€ å™¨æ–¹æ³•ï¼ˆå¦‚é™æ€å­—æ®µèµ‹å€¼ã€æ‰§è¡Œé™æ€åˆå§‹åŒ–å—ä»£ç ï¼‰ï¼Œéå¼€å‘è€…ç¼–å†™ ä½¿ç”¨ï¼šä½¿ç”¨ç±»/åˆ›å»ºå¯¹è±¡ å¸è½½ï¼šè¯¥ç±»æ‰€æœ‰å®ä¾‹è¢«å›æ”¶ / åŠ è½½è¯¥ç±»çš„ClassLoaderå·²è¢«å›æ”¶ / ç±»å¯¹åº”çš„Java.lang.Classå¯¹è±¡ä¸å†è¢«å¼•ç”¨ï¼ˆæ— æ³•é€šè¿‡åå°„è®¿é—®ï¼‰ æ—¶å¸è½½ç±» åƒåœ¾å›æ”¶ ä»€ä¹ˆæ˜¯åƒåœ¾å›æ”¶\u0026amp;å¦‚ä½•è§¦å‘ è‡ªåŠ¨ç®¡ç†å†…å­˜ï¼Œæ£€æµ‹ä¸ç®¡ç†å¯¹è±¡ï¼Œå›æ”¶ä¸å†è¢«å¼•ç”¨çš„å¯¹è±¡å ç”¨çš„å†…å­˜ï¼Œå‡å°‘å†…å­˜æ³„æ¼ä¸å†…å­˜ç®¡ç†é”™è¯¯çš„å¯èƒ½æ€§\nå†…å­˜ä¸è¶³ï¼šJVMæ£€æµ‹åˆ°å †å†…å­˜ä¸è¶³ï¼Œæ— æ³•ä¸ºæ–°å¯¹è±¡åˆ†é…å†…å­˜æ—¶ æ‰‹åŠ¨è¯·æ±‚ï¼šå¯è°ƒç”¨System.gc()æˆ–Runtime.getRuntime().gc()å›æ”¶ï¼Œä¸ä¿è¯ç«‹å³æ‰§è¡Œ JVMå‚æ•°ï¼šå¯åŠ¨æ—¶é€šè¿‡JVMè°ƒæ•´ï¼Œå¯è®¾å®šæœ€å¤§å †å¤§å°ã€åˆå§‹å †å¤§å°ç­‰ å¯¹è±¡æ•°é‡/å†…å­˜è¾¾åˆ°é˜ˆå€¼ï¼šåƒåœ¾å›æ”¶å™¨å†…ç›‘æ§ åˆ¤æ–­åƒåœ¾çš„æ–¹æ³• å¼•ç”¨è®¡æ•°æ³•ï¼šä¸ºæ¯ä¸ªå¯¹è±¡åˆ†é…ä¸€ä¸ªå¼•ç”¨è®¡æ•°å™¨ï¼Œæ¯å½“æœ‰ä¸€ä¸ªåœ°æ–¹å¼•ç”¨å®ƒæ—¶ï¼Œè®¡æ•°å™¨åŠ 1ï¼Œå¼•ç”¨å¤±æ•ˆæ—¶è®¡æ•°å™¨å‡1ã€‚ä¸º0æ—¶å¯å›æ”¶ ç¼ºç‚¹ï¼šå¾ªç¯å¼•ç”¨ï¼Œæ°¸ä¸ä¸º0 å¯è¾¾æ€§åˆ†æï¼ˆä¸»è¦é‡‡ç”¨ï¼‰ï¼šä»ä¸€ç»„ç§°ä¸ºGC Rootsï¼ˆåƒåœ¾æ”¶é›†æ ¹ï¼‰çš„å¯¹è±¡å‡ºå‘ï¼Œå‘ä¸‹è¿½æº¯å®ƒä»¬å¼•ç”¨çš„å¯¹è±¡ä¸å¼•ç”¨å¯¹è±¡çš„å¼•ç”¨å¯¹è±¡ã€‚è‹¥ä¸å¯è¾¾æŸå¯¹è±¡ï¼Œåˆ™è¯¥å¯¹è±¡å›æ”¶ GC RootsåŒ…æ‹¬ï¼šè™šæ‹Ÿæœºæ ˆæ ˆå¸§ä¸­çš„æœ¬åœ°å˜é‡è¡¨å¼•ç”¨çš„å¯¹è±¡ã€æ–¹æ³•å»ä¸­ç±»é™æ€å±æ€§å¼•ç”¨çš„å¯¹è±¡ã€æœ¬åœ°æ–¹æ³•æ ˆä¸­JNIï¼ˆJava Native Interfaceï¼‰å¼•ç”¨çš„å¯¹è±¡ã€æ´»è·ƒçº¿ç¨‹çš„å¼•ç”¨ç­‰ åƒåœ¾å›æ”¶ç®—æ³•æœ‰å“ªäº› æ ‡è®°-æ¸…é™¤ï¼šå¯è¾¾æ€§åˆ†ææ ‡è®°éœ€å›æ”¶å¯¹è±¡ï¼Œä¹‹åç»Ÿä¸€å›æ”¶ ç¼ºç‚¹ï¼šæ•ˆç‡ä½ \u0026amp; æ¸…é™¤ç»“æŸåä¼šé€ æˆå¤§é‡ç¢ç‰‡ç©ºé—´ å¤åˆ¶ï¼šï¼ˆè§£å†³ç¢ç‰‡é—®é¢˜ï¼‰å°†å†…å­˜åˆ†ä¸ºä¸¤å—ï¼Œæ¯æ¬¡ç”³è¯·åªä½¿ç”¨å…¶ä¸­ä¸€å—ï¼Œå†…å­˜ä¸å¤Ÿæ—¶å°†å­˜æ´»çš„å¤åˆ¶åˆ°å¦ä¸€å—ä¸Šï¼Œå†å°†å·²ä½¿ç”¨çš„å†…å­˜æ•´ä¸ªæ¸…ç†æ‰ ç¼ºç‚¹ï¼šå†…å­˜åˆ©ç”¨ç‡å¤ªä½ æ ‡è®°-æ•´ç†ï¼šæ ‡è®°åå°†æ‰€æœ‰å­˜æ´»å¯¹è±¡ç§»åŠ¨åˆ°å†…å­˜ä¸€ç«¯ï¼Œä¹‹åæ¸…ç†å‰©ä½™éƒ¨åˆ† åˆ†ä»£å›æ”¶ï¼šåˆ†ä¸ºæ–°ç”Ÿä»£ä¸è€å¹´ä»£ï¼Œç»å†ä¸€æ¬¡GCå¹´é¾„åŠ ä¸€ï¼Œè¶…è¿‡ï¼ˆé»˜è®¤15ï¼‰åè¿›å…¥è€å¹´ä»£ åƒåœ¾å›æ”¶å™¨æœ‰å“ªäº› ä½¿ç”¨å¤åˆ¶ç®—æ³• Serialï¼šæ–°ç”Ÿä»£å•çº¿ç¨‹æ”¶é›†å™¨ï¼Œæ ‡è®°å’Œæ¸…ç†éƒ½æ˜¯å•çº¿ç¨‹ ParNewï¼šï¼ˆæ–°ç”Ÿä»£onlyï¼‰Serialæ”¶é›†å™¨çš„å¤šçº¿ç¨‹ç‰ˆæœ¬ Parallel Scavengeï¼šï¼ˆæ–°ç”Ÿä»£onlyï¼‰è¿½æ±‚é«˜ååé‡ï¼ˆç”¨æˆ·çº¿ç¨‹æ—¶é—´/(ç”¨æˆ·çº¿ç¨‹æ—¶é—´+GCçº¿ç¨‹æ—¶é—´)ï¼‰ï¼Œé«˜æ•ˆåˆ©ç”¨ CPU ä½¿ç”¨æ ‡è®°æ•´ç†ï¼š Serial Oldï¼šè€å¹´ä»£å•çº¿ç¨‹æ”¶é›†å™¨ï¼ŒSerialæ”¶é›†å™¨çš„è€å¹´ä»£ç‰ˆæœ¬ Parallel Oldï¼šParallel Scavengeæ”¶é›†å™¨çš„è€å¹´ä»£ç‰ˆæœ¬ G1ï¼ˆGabage Firstï¼‰ï¼š Javaå †å¹¶è¡Œæ”¶é›†å™¨ï¼Œå›æ”¶èŒƒå›´ä¸ºæ•´ä¸ªå † å¼•å…¥åˆ†åŒºæ€è·¯ï¼Œå¼±åŒ–åˆ†ä»£æ¦‚å¿µ \u0026amp; åˆç†åˆ©ç”¨GCå„å‘¨æœŸçš„èµ„æº åœé¡¿æ—¶é—´å¯æ§ï¼ˆå¯è®¾ç½®é¢„æœŸåœé¡¿æ—¶é—´é¿å…é›ªå´©ï¼‰ \u0026amp; æ›´å……åˆ†åˆ©ç”¨ç¡¬ä»¶ä¼˜åŠ¿ç¼©çŸ­STWåœé¡¿æ—¶é—´ï¼ˆè¾ƒCMSï¼‰ ä½¿ç”¨æ ‡è®°æ¸…é™¤ï¼š CMS(Concurrent Mark Sweep) ï¼šè€å¹´ä»£å¹¶è¡Œæ”¶é›†å™¨ï¼Œè¿½æ±‚æœ€çŸ­GCå›æ”¶åœé¡¿æ—¶é—´ï¼ˆç”¨æˆ·çº¿ç¨‹åœé¡¿çš„å¹³å‡æ—¶é—´ï¼‰ ä¼šäº§ç”Ÿæµ®åŠ¨åƒåœ¾ï¼ˆå¹¶å‘æ ‡è®°ä¸ºå­˜æ´»ï¼Œåæ¥æ­»äº¡ï¼Œä½†æ˜¯å†æ ‡è®°æ— æ³•çŸ¥æ™“ï¼‰ï¼Œæµ®åŠ¨åƒåœ¾è¿‡å¤šä¼šé€€åŒ–ä¸ºserial old åƒåœ¾å›æ”¶ç®—æ³•å“ªäº›é˜¶æ®µä¼šstop the worldï¼ˆSTWï¼‰ ä»¥æ ‡è®°-å¤åˆ¶ç®—æ³•ï¼ˆåº”ç”¨äºCMSæ–°ç”Ÿä»£ParNewã€G1åƒåœ¾å›æ”¶å™¨ç­‰ï¼‰ä¸ºä¾‹ï¼Œä»¥G1çš„æ··åˆå›æ”¶çš„æ ‡è®°-å¤åˆ¶ä¸ºä¾‹\næ ‡è®°ï¼š åˆå§‹æ ‡è®°ï¼šä»GC Rootså‡ºå‘æ ‡è®°å…¨éƒ¨ç›´æ¥å­èŠ‚ç‚¹\u0026ndash;\u0026gt;è€—æ—¶çŸ­ï¼ŒSTW å¹¶å‘æ ‡è®°ï¼šä»GC Rootså¼€å§‹å¯¹å †ä¸­å¯¹è±¡è¿›è¡Œå¯è¾¾æ€§åˆ†æï¼Œæ‰¾å‡ºå­˜æ´»å¯¹è±¡ï¼ˆåªçŸ¥å­˜æ´»ï¼Œä¸çŸ¥æ­»äº¡ï¼‰\u0026ndash;\u0026gt;å¹¶å‘ï¼Œåº”ç”¨çº¿ç¨‹ä¸GCçº¿ç¨‹å¯ä»¥åŒæ—¶æ´»åŠ¨ï¼ŒéSTW å†æ ‡è®°ï¼šé€šè¿‡å¯è¾¾æ€§åˆ†æé‡æ–°æ ‡è®°åœ¨å¹¶å‘æ ‡è®°é˜¶æ®µå‘ç”Ÿå˜åŒ–çš„å¯¹è±¡ï¼ˆonlyå°†ä¹‹å‰ä¸çŸ¥å­˜æ´»çš„æ ‡è®°ä¸ºå­˜æ´»ï¼‰\u0026ndash;\u0026gt;STW G1ä¼šé€šè¿‡SATBæ¥è®°å½•å¼€å§‹æ—¶çš„æ‰€æœ‰å­˜æ´»å¯¹è±¡ï¼Œæœ€ç»ˆæ ‡è®°é˜¶æ®µä¼šé€šè¿‡SATBä¸Remembered markæ‰¾åˆ°å¹¶å‘æ ‡è®°é˜¶æ®µä¸å†è¢«å¼•ç”¨çš„å¯¹è±¡ï¼Œä»¥æ­¤é¿å…æµ®åŠ¨åƒåœ¾ï¼›CMSæ— æ³•æ‰¾åˆ°ä¸å†è¢«å¼•ç”¨çš„å¯¹è±¡ï¼ˆå› æ­¤ä¼šäº§ç”Ÿæµ®åŠ¨åƒåœ¾ï¼‰ï¼Œåªèƒ½å¢åŠ è¢«å¼•ç”¨çš„å¯¹è±¡\næ¸…ç†ï¼šæ¸…ç‚¹æœ‰å­˜æ´»å¯¹è±¡ä¸æ— å­˜æ´»å¯¹è±¡çš„åˆ†åŒºï¼Œä¸æ¸…ç†åƒåœ¾å¯¹è±¡ï¼Œä¹Ÿä¸å¤åˆ¶\u0026ndash;\u0026gt;STW å¤åˆ¶ï¼šå¤åˆ¶ç®—æ³•ä¸­çš„è½¬ç§»é˜¶æ®µéœ€è¦åˆ†é…æ–°å†…å­˜å’Œå¤åˆ¶å¯¹è±¡çš„æˆå‘˜å˜é‡\u0026ndash;\u0026gt;STWï¼ˆä¸»è¦æ—¶é—´ç“¶é¢ˆï¼‰ minorGCã€majorGCã€fullGCçš„åŒºåˆ«ï¼Œä»€ä¹ˆåœºæ™¯è§¦å‘full GC Minor GC (Young GC)ï¼šåªé’ˆå¯¹å¹´è½»ä»£\u0026mdash;EdenåŒºç©ºé—´ä¸è¶³æ—¶è§¦å‘ï¼Œå°†Edenä¸ä¸€ä¸ªSurvivorä¸­çš„å­˜æ´»å¯¹è±¡è½¬ç§»åˆ°å¦ä¸€ä¸ªSurvivor/è€å¹´ä»£\u0026mdash;é¢‘ç¹ Major GC (Old GC)ï¼šä¸»è¦é’ˆå¯¹è€å¹´ä»£è¿›è¡Œå›æ”¶ï¼Œä½†ä¸ä¸€å®š\u0026mdash;è€å¹´ä»£ç©ºé—´ä¸è¶³/å¹´è½»ä»£æ™‹å‡åˆ°è€å¹´ä»£é€Ÿåº¦è¿‡å¿«å¯èƒ½è§¦å‘\u0026mdash;é¢‘ç‡ç›¸å¯¹Minoræ›´ä½ï¼Œä½†æ—¶é—´æ›´é•¿ Full GCï¼šæ•´ä¸ªå †ï¼ˆå¹´è½»ä»£ã€è€å¹´ä»£ä»¥åŠæ°¸ä¹…ä»£/å…ƒç©ºé—´ï¼‰å›æ”¶\u0026mdash;ç›´æ¥è°ƒç”¨ / Minor GCæ—¶å­˜æ´»å¯¹è±¡æ— æ³•å…¨éƒ¨æ”¾å…¥è€å¹´ä»£æˆ–è€å¹´ä»£ç©ºé—´ä¸è¶³ / æ°¸ä¹…ä»£ï¼ˆJava8ä¹‹å‰ï¼‰æˆ–å…ƒç©ºé—´ï¼ˆä¹‹åï¼‰ç©ºé—´ä¸è¶³æ—¶\u0026mdash;STWï¼Œéå†æ•´ä¸ªå † ä»€ä¹ˆæ—¶å€™ç”¨CMSï¼Œä»€ä¹ˆæ—¶å€™ç”¨G1 CMSé€‚ç”¨ï¼šä½å»¶è¿Ÿï¼ˆåœé¡¿æ—¶é—´ï¼‰ / è€å¹´ä»£ / ç¢ç‰‡åŒ–ç®¡ç†ï¼ˆå®¹æ˜“å‡ºç°å†…å­˜ç¢ç‰‡ï¼Œå¯èƒ½éœ€è¦å®šæœŸFull GCï¼‰ G1é€‚ç”¨ï¼šå¤§å †å†…å­˜ / å¯¹å†…å­˜ç¢ç‰‡æ•æ„Ÿ / è¾ƒå¹³è¡¡çš„æ€§èƒ½ï¼ˆåœé¡¿æ—¶é—´\u0026amp;ååé‡ï¼‰ GCçš„åªæœ‰å †å— å †å’Œæ–¹æ³•åŒºï¼ˆå­˜å‚¨ç±»ä¿¡æ¯ã€å¸¸é‡ã€é™æ€å˜é‡ç­‰ï¼‰ ","permalink":"https://Sattiluvcat.github.io/en/posts/java/%E5%85%AB%E8%82%A1--java/","summary":"JavaåŸºç¡€-é›†åˆ-å¹¶å‘-è™šæ‹Ÿæœºï¼ˆç®€ç•¥ï¼‰çŸ¥è¯†æ€»ç»“ï¼Œæ¥è‡ªå°æ—coding","title":"å…«è‚¡â€”â€”Java"},{"content":"Â Spring æ¦‚è¿° Springæ¡†æ¶æ ¸å¿ƒç‰¹æ€§ï¼š IOCï¼ˆæ§åˆ¶åè½¬ Inversion of Controlï¼‰å®¹å™¨ï¼šå®ç°äº†å¯¹è±¡çš„åˆ›å»ºå’Œå¯¹è±¡é—´çš„ä¾èµ–å…³ç³»ç®¡ç† AOPï¼ˆé¢å‘åˆ‡é¢ç¼–ç¨‹ Aspect-Oriented Programmingï¼‰ï¼šå…è®¸å¼€å‘è€…å®šä¹‰æ¨ªåˆ‡å…³æ³¨ç‚¹ï¼Œç‹¬ç«‹äºä¸šåŠ¡é€»è¾‘ä»£ç  äº‹åŠ¡ç®¡ç†ï¼šæä¾›äº†ä¸€è‡´çš„äº‹åŠ¡ç®¡ç†æ¥å£ï¼Œæ”¯æŒå£°æ˜å¼å’Œç¼–ç¨‹å¼äº‹åŠ¡ å£°æ˜å¼ï¼šæ³¨è§£ \u0026amp; ç¼–ç¨‹å¼ï¼šè‡ªè¡Œå®ç°ä»£ç  MVCæ¡†æ¶ï¼šåŸºäºServlet APIæ„å»ºçš„Webæ¡†æ¶ï¼Œé‡‡ç”¨æ¨¡å‹-è§†å›¾-æ§åˆ¶å™¨ï¼ˆMVCï¼‰æ¶æ„ æ”¯æŒURLåˆ°é¡µé¢æ§åˆ¶å™¨çš„æ˜ å°„ä¸å¤šç§è§†å›¾æŠ€æœ¯ IOC \u0026amp; AOP IOCä¸AOPç®€è¿°ï¼š åŒºåˆ«ï¼š IOCï¼šä¸€ç§åˆ›å»ºå’Œè·å–å¯¹è±¡çš„æŠ€æœ¯æ€æƒ³ï¼Œå¯ä»¥é€šè¿‡ä¾èµ–æ³¨å…¥ï¼ˆDIï¼‰å®ç°ã€‚ä¸éœ€newå¯¹è±¡ï¼Œè€Œæ˜¯ç”±IOCå®¹å™¨æ¥å®ä¾‹åŒ–å¯¹è±¡ï¼Œå¯é™ä½å¯¹è±¡é—´çš„è€¦åˆåº¦ AOPï¼šèƒ½å¤Ÿå°†é‚£äº›ä¸ä¸šåŠ¡æ— å…³ï¼Œå´ä¸ºä¸šåŠ¡æ¨¡å—æ‰€å…±åŒè°ƒç”¨çš„é€»è¾‘å°è£…èµ·æ¥ï¼Œä»¥å‡å°‘ç³»ç»Ÿé‡å¤ä»£ç ï¼Œé™ä½æ¨¡å—é—´çš„è€¦åˆåº¦ Spring AOPåŸºäºåŠ¨æ€ä»£ç†ï¼Œè‹¥éœ€ä»£ç†çš„å¯¹è±¡å®ç°äº†æŸæ¥å£ï¼Œåˆ™ä½¿ç”¨JDK proxyåˆ›å»ºä»£ç†å¯¹è±¡ï¼›è‹¥æ²¡å®ç°æ¥å£ï¼ˆä¸èƒ½ç”¨proxyï¼‰ï¼Œåˆ™ç”¨Cglibç”Ÿæˆä¸€ä¸ªè¢«ä»£ç†å¯¹è±¡çš„å­ç±»ä½œä¸ºä»£ç† IOC å’Œ AOP ç»“åˆä½¿ç”¨ï¼Œå¯ä»¥æ›´å¥½åœ°å®ç°ä»£ç çš„æ¨¡å—åŒ–å’Œåˆ†å±‚ç®¡ç† eg. IOC å®¹å™¨ç®¡ç†å¯¹è±¡çš„ä¾èµ–å…³ç³»ï¼ŒAOP å°†æ¨ªåˆ‡å…³æ³¨ç‚¹ç»Ÿä¸€åˆ‡å…¥åˆ°éœ€è¦çš„ä¸šåŠ¡é€»è¾‘ä¸­ eg. IOC å®¹å™¨ç®¡ç† Service å±‚å’Œ DAO å±‚ï¼ˆData Access Objectï¼‰çš„ä¾èµ–å…³ç³»ï¼ŒAOP åœ¨ Service å±‚å®ç°äº‹åŠ¡ç®¡ç†ã€æ—¥å¿—è®°å½•ç­‰æ¨ªåˆ‡åŠŸèƒ½ AOPè¯¦è¿°ï¼š èƒŒæ™¯ï¼šåœ¨ OOPï¼ˆé¢å‘å¯¹è±¡ç¼–ç¨‹ï¼‰ ä¸­æœ€å°çš„å•å…ƒå°±æ˜¯â€œClass å¯¹è±¡â€ï¼ŒAOPä¸­æœ€å°çš„å•å…ƒæ˜¯â€œåˆ‡é¢â€ï¼ˆä¸€ä¸ªâ€œåˆ‡é¢â€å¯ä»¥åŒ…å«å¾ˆå¤šç§ç±»å‹å’Œå¯¹è±¡ï¼Œå¯¹å®ƒä»¬è¿›è¡Œæ¨¡å—åŒ–ç®¡ç†ï¼‰ AOPä¸­åŠŸèƒ½åˆ†ä¸ºæ ¸å¿ƒä¸šåŠ¡ \u0026amp; å‘¨è¾¹åŠŸèƒ½ï¼ˆeg. æ—¥å¿— äº‹åŠ¡ æƒé™ï¼‰ ä½œç”¨ï¼šå°†ä¸ä¸šåŠ¡æ— å…³ï¼Œå´ä¸ºä¸šåŠ¡æ¨¡å—æ‰€å…±åŒè°ƒç”¨çš„é€»è¾‘å°è£…ï¼Œå‡å°‘ç³»ç»Ÿçš„é‡å¤ä»£ç ï¼Œé™ä½æ¨¡å—è€¦åˆåº¦ï¼Œåˆ©äºæœªæ¥çš„å¯æ‹“å±•æ€§ä¸å¯ç»´æŠ¤æ€§ AOPä¸­çš„ä¸€äº›æ¦‚å¿µï¼š Spring AOPåŸºäºJDKåŠ¨æ€ä»£ç† / Cglibå®ç°ï¼Œå‡å±äºè¿è¡Œçš„æ–¹å¼ï¼Œä¸é€šè¿‡ç¼–è¯‘\u0026ndash;\u0026gt;Springé€šè¿‡javaä»£ç å®ç° IOC é€šè¿‡ä»€ä¹ˆæœºåˆ¶å®ç°ï¼Ÿ åå°„ï¼šåˆ©ç”¨Javaçš„åå°„æœºåˆ¶åŠ¨æ€åœ°åŠ è½½ç±»ã€åˆ›å»ºå¯¹è±¡å®ä¾‹ã€è°ƒç”¨å¯¹è±¡æ–¹æ³• ä¾èµ–æ³¨å…¥ï¼šï¼ˆæ ¸å¿ƒï¼‰å®¹å™¨è´Ÿè´£ç®¡ç†ï¼ˆåº”ç”¨ç¨‹åºï¼‰ç»„ä»¶é—´çš„ä¾èµ–å…³ç³»â€”\u0026gt;é€šè¿‡é…ç½®æ–‡ä»¶æˆ–æ³¨è§£æè¿°ä¾èµ–å…³ç³» è®¾è®¡æ¨¡å¼â€”å·¥å‚æ¨¡å¼ï¼šå®¹å™¨é€šå¸¸é‡‡ç”¨å·¥å‚æ¨¡å¼æ¥ç®¡ç†å¯¹è±¡çš„åˆ›å»ºä¸ç”Ÿå‘½å‘¨æœŸ å®¹å™¨ï¼šï¼ˆå®ç°IOCçš„æ ¸å¿ƒï¼‰é€šå¸¸ç”¨BeanFactoryï¼ˆåŸºæœ¬ï¼‰æˆ–ApplicationContextï¼ˆä¼ä¸šçº§ï¼‰ç®¡ç†Beanã€‚ AOP é€šè¿‡ä»€ä¹ˆæœºåˆ¶å®ç°ï¼ˆåŸç†ï¼‰ï¼Ÿ åŠ¨æ€ä»£ç†æŠ€æœ¯â€”\u0026gt;è¿è¡Œæ—¶åŠ¨æ€ç”Ÿæˆä»£ç†å¯¹è±¡ï¼Œè€Œéç¼–è¯‘æ—¶ï¼ˆå…è®¸åœ¨è¿è¡Œæ—¶æŒ‡å®šè¦ä»£ç†çš„æ¥å£å’Œè¡Œä¸ºï¼Œä¸ä¿®æ”¹æºç è€Œå¢å¼ºåŠŸèƒ½ï¼‰ åŸºäºJDKçš„åŠ¨æ€ä»£ç†â€”â€”java.lang.reflect.Proxyç±»ä¸java.lang.reflect.InvocationHandleræ¥å£å®ç°ã€‚éœ€è¦ä»£ç†ç±»å®ç°æ¥å£ åŸºäºæ¥å£çš„ä»£ç† åŸºäºCGLIBçš„åŠ¨æ€ä»£ç†â€”â€”è¢«ä»£ç†çš„ç±»æ²¡æœ‰å®ç°æ¥å£æ—¶ï¼Œä½¿ç”¨CGLIBåº“ç”Ÿæˆä¸€ä¸ªè¢«ä»£ç†ç±»çš„å­ç±»ä½œä¸ºä»£ç† åŸºäºç±»çš„ä»£ç† åŠ¨æ€ä»£ç†ä¸é™æ€ä»£ç†çš„åŒºåˆ«ï¼šé™æ€ä»£ç†ç”±coderï¼ˆæˆ–ç‰¹æ®Šå·¥å…·ï¼‰åˆ›å»ºï¼Œé€šå¸¸åªä»£ç†ä¸€ä¸ªç±»ï¼›åŠ¨æ€ä»£ç†è¿ç”¨åå°„æœºåˆ¶åŠ¨æ€ç”Ÿæˆï¼Œä»£ç†ä¸€ä¸ªæ¥å£ä¸‹çš„å¤šä¸ªç±» ä»£ç†æ˜¯ä¸€ç§å¸¸ç”¨çš„è®¾è®¡æ¨¡å¼ï¼Œå¦‚åœ¨åˆ›å»ºä¸€ä¸ªç±»å¯¹è±¡å‰åæ·»åŠ ä¸šåŠ¡é€»è¾‘ï¼Œè¿™ä¸ªè¿‡ç¨‹åœ¨ä»£ç†ç±»ä¸­å®ç°ï¼ˆè°ƒç”¨ä»£ç†ç±»ï¼‰ æ€ä¹ˆç†è§£SpringIOCï¼Ÿ Inversion Of Controlï¼Œå³æ§åˆ¶åè½¬ï¼Œä¸€ç§è®¾è®¡æ€æƒ³ã€‚ ä¼ ç»Ÿå¯¹è±¡åˆ›å»ºï¼šnew ï¼Œä¾èµ–å…³ç³»ï¼ˆå¦‚Studentçš„Scoreï¼Œéœ€è¦æ‰‹åŠ¨æŒ‡å®šä¾èµ–ï¼‰ IOCï¼šæ ¹æ®é…ç½®åŠ è½½å¹¶å®ä¾‹åŒ–Beanï¼Œä¿å­˜åˆ°IOCå®¹å™¨ä¸­â€”\u0026gt;ApplicationContext.getBean(Student.class); æ§åˆ¶ï¼šå¯¹è±¡çš„åˆ›å»ºã€åˆå§‹åŒ–ã€é”€æ¯â€”\u0026gt;newåˆ°Springå®¹å™¨åˆ›å»ºã€setteråˆ°å®¹å™¨è‡ªåŠ¨æ³¨å…¥ã€èµ‹å€¼nullæˆ–é”€æ¯åˆ°Springç®¡ç†ç”Ÿå‘½å‘¨æœŸ åè½¬ï¼šåè½¬å¯¹è±¡çš„æ§åˆ¶æƒï¼ˆä»coderåˆ°IOCå®¹å™¨ï¼‰ ä¾èµ–å€’ç½®ã€ä¾èµ–æ³¨å…¥ã€æ§åˆ¶åè½¬æ˜¯ä»€ä¹ˆï¼Ÿ æ§åˆ¶åè½¬ï¼šåè½¬æ§åˆ¶æƒï¼ˆè¯¦è§ä¸Šï¼‰ï¼Œä»coderåˆ°æ¡†æ¶æ§åˆ¶ç¨‹åºæ‰§è¡Œæµç¨‹ ä¾èµ–æ³¨å…¥ï¼šä¸€ä¸ªå…·ä½“çš„ç¼–ç æŠ€å·§ã€‚ï¼ˆè¯¦è§ä¸Šï¼‰ä¸é€šè¿‡newï¼Œè€Œæ˜¯å¤–éƒ¨åˆ›å»ºä¾èµ–çš„ç±»å¯¹è±¡ï¼Œé€šè¿‡æ„é€ å‡½æ•°ï¼Œå‡½æ•°å‚æ•°ç­‰æ–¹å¼æ³¨å…¥ç»™ç±»ä½¿ç”¨ ä¾èµ–å€’ç½®ï¼šæŒ‡å¯¼æ¡†æ¶å±‚é¢çš„è®¾è®¡ã€‚é«˜å±‚æ¨¡å—ä¸ä¾èµ–ä½å±‚æ¨¡å—ï¼Œå®ƒä»¬å…±åŒä¾èµ–åŒä¸€ä¸ªæŠ½è±¡ï¼ˆå…·ä½“å®ç°ç»†èŠ‚ä¾èµ–å¯¹è±¡ï¼ŒæŠ½è±¡ä¸ä¾èµ–ç»†èŠ‚ï¼‰ è®¾è®¡ä¸€ä¸ªIOCï¼Œè€ƒè™‘å“ªäº›é—®é¢˜ï¼Ÿ Beançš„ç”Ÿå‘½å‘¨æœŸç®¡ç† ä¾èµ–æ³¨å…¥åŠŸèƒ½ï¼ˆè€ƒè™‘é€šè¿‡åå°„ä¸XMLé…ç½®æ–‡ä»¶å®ç°ï¼‰ Beançš„ä½œç”¨åŸŸï¼Œå¦‚å•ä¾‹ã€åŸå‹ã€ä¼šè¯ã€è¯·æ±‚ç­‰ï¼ˆè€ƒè™‘Mapå®ç°ï¼‰ AOPåŠŸèƒ½å®ç°ï¼ˆè€ƒè™‘åŠ¨æ€ä»£ç†æœºåˆ¶ä¸åˆ‡é¢ç¼–ç¨‹å®ç°ï¼‰ å¼‚å¸¸å¤„ç†ï¼Œå¦‚Beanåˆ›å»ºå¼‚å¸¸ï¼Œä¾èµ–æ³¨å…¥å¼‚å¸¸ç­‰ï¼ˆè€ƒè™‘try-catchï¼‰ é…ç½®æ–‡ä»¶åŠ è½½ï¼Œä»ä¸åŒé…ç½®æ–‡ä»¶ä¸­åŠ è½½Beançš„ç›¸å…³ä¿¡æ¯ï¼ˆè€ƒè™‘XMLã€æ³¨è§£æˆ–Javaé…ç½®ç±»å®ç°ï¼‰ AOPä¸»è¦æƒ³è§£å†³ä»€ä¹ˆé—®é¢˜ï¼Ÿ å¯¹OOPæ€ç»´çš„è¡¥å……ï¼Œéä¾µå…¥æ€§çš„åŠŸèƒ½å¢å¼ºï¼ˆå¦‚æ—¥å¿—ï¼‰ å…·ä½“å®ç°ï¼šåœ¨Aspectä¸­å®šä¹‰å¢å¼ºAdviceï¼ŒåŒ…å«å…·ä½“å®ç°ï¼Œæ•´ç†åˆ‡å…¥ç‚¹ï¼ˆç²’åº¦æ˜¯æ–¹æ³•ï¼‰ï¼Œæœ€åç»‡å…¥åˆ°å¯¹è±¡çš„æ–¹æ³•ä¸­ AOPå®ç°æœ‰å“ªäº›æ³¨è§£ï¼Ÿ @Aspect å®šä¹‰åˆ‡é¢ï¼Œæ ‡æ³¨åœ¨åˆ‡é¢ç±»ä¸Š @Pointcut å®šä¹‰åˆ‡ç‚¹ï¼Œæ ‡æ³¨åœ¨æ–¹æ³•ä¸Šï¼ŒæŒ‡å®šè¿æ¥ç‚¹ @Before æ–¹æ³•æ‰§è¡Œå‰æ‰§è¡Œé€šçŸ¥ï¼Œé€šç”¨çš„æ˜¯@Advice ä»€ä¹ˆæ˜¯åå°„åŠå…¶ä½¿ç”¨åœºæ™¯ åå°„ç‰¹æ€§ï¼š è¿è¡Œæ—¶å¯è®¿é—®ç±»ä¿¡æ¯â€”\u0026gt;å¯è·å–ç±»çš„å®Œæ•´ç»“æ„ä¿¡æ¯ï¼ŒåŒ…æ‹¬ç±»åã€åŒ…åã€çˆ¶ç±»ç­‰ åŠ¨æ€å¯¹è±¡åˆ›å»ºâ€”\u0026gt; å¯ä»¥ä½¿ç”¨åå°„APIåŠ¨æ€åœ°åˆ›å»ºå¯¹è±¡å®ä¾‹ï¼Œå³ä½¿åœ¨ç¼–è¯‘æ—¶ä¸çŸ¥é“å…·ä½“çš„ç±»åã€‚é€šè¿‡Class æˆ– Constructor å¯¹è±¡çš„ newInstance() æ–¹æ³•å®ç° åŠ¨æ€æ–¹æ³•è°ƒç”¨â€”\u0026gt; è¿è¡Œæ—¶å¯ä»¥åŠ¨æ€åœ°è°ƒç”¨å¯¹è±¡çš„æ–¹æ³•ï¼ŒåŒ…æ‹¬ç§æœ‰æ–¹æ³• è®¿é—®ä¸ä¿®æ”¹å­—æ®µå€¼â€”\u0026gt; å…è®¸ç¨‹åºåœ¨è¿è¡Œæ—¶è®¿é—®å’Œä¿®æ”¹å¯¹è±¡çš„å­—æ®µå€¼ï¼ŒåŒ…æ‹¬ç§æœ‰å­—æ®µ è¿ç”¨åœºæ™¯ï¼šä¾èµ–æ³¨å…¥ï¼ˆå¦‚Autowiredï¼‰ä¸æ§åˆ¶åè½¬ + åŠ¨æ€ä»£ç†çš„å®ç°ï¼ˆå¦‚AOPï¼‰ Bean Beançš„ç”Ÿå‘½å‘¨æœŸï¼Ÿ Springå¯åŠ¨æ—¶ï¼ŒæŸ¥æ‰¾å¹¶åŠ è½½éœ€è¦è¢«Springç®¡ç†çš„Beanå¹¶å®ä¾‹åŒ– Beanå®ä¾‹åŒ–åå°†å¯¹Beançš„å¼•å…¥å’Œå€¼æ³¨å…¥åˆ°Beançš„å±æ€§ä¸­ è‹¥å®ç°BeanNameAwareæ¥å£ï¼Œå°†Beançš„Idä¼ ç»™setBeanName()æ–¹æ³• / è‹¥å®ç°BeanFactoryAwareæ¥å£ï¼Œå°†BeanFactoryå®¹å™¨å®ä¾‹ä¼ å…¥ / è‹¥å®ç°ApplicationContextAwareæ¥å£ï¼Œå°†Beanä¸Šä¸‹æ–‡å¼•ç”¨ä¼ å…¥ / è‹¥å®ç°BeanPostProcessoræ¥å£ï¼Œè°ƒç”¨postProcessBeforeInitialization()æ–¹æ³• / â€¦ Beanå‡†å¤‡å°±ç»ªï¼Œé©»ç•™åœ¨åº”ç”¨ä¸Šä¸‹æ–‡ä¸­ï¼Œç›´åˆ°ä¸Šä¸‹æ–‡è¢«é”€æ¯ è‹¥å®ç°DisposableBeanæ¥å£ï¼Œè°ƒç”¨å…¶destroy()æ¥å£æ–¹æ³•ï¼›è‹¥Beanä½¿ç”¨destory-methodå£°æ˜é”€æ¯æ–¹æ³•ï¼Œåˆ™è°ƒç”¨è¯¥æ–¹æ³• Beanæ˜¯å¦å•ä¾‹ï¼Ÿ é»˜è®¤å•ä¾‹ï¼Œå¯è®¾ç½®scopeä¸ºprototypeå®ç°å¤šä¾‹ Beanç”Ÿå‘½å‘¨æœŸåœ¨å•ä¾‹å’Œéå•ä¾‹ä¸€æ ·å—ï¼Ÿ å¦ã€‚Beanç”Ÿå‘½å‘¨æœŸç”±IOCå®¹å™¨æ§åˆ¶ï¼ŒSpringåªç®¡ç†å•ä¾‹Beançš„å®Œæ•´ç”Ÿå‘½å‘¨æœŸï¼Œå¤šä¾‹çš„Beanåœ¨Springåˆ›å»ºå¥½åä¸å†ç®¡ç†ç”Ÿå‘½å‘¨æœŸ Beançš„ä½œç”¨åŸŸæœ‰å“ªäº›ï¼Ÿ Singletonï¼šï¼ˆå¯¹äºä¸€ä¸ªç±»ï¼‰æ•´ä¸ªåº”ç”¨ç¨‹åºä¸­åªæœ‰ä¸€ä¸ªBeanå®ä¾‹ï¼Œåœ¨æ•´ä¸ªç”Ÿå‘½å‘¨æœŸä¸­å…±äº«è¯¥å®ä¾‹ Prototypeï¼šæ¯æ¬¡è¯·æ±‚éƒ½åˆ›å»ºä¸€ä¸ªæ–°Bean Requestï¼šæ¯ä¸ªHTTPè¯·æ±‚éƒ½åˆ›å»ºä¸€ä¸ªæ–°å®ä¾‹ Sessionï¼šSessionèŒƒå›´å†…åªåˆ›å»ºä¸€ä¸ªå®ä¾‹ï¼Œä»…åœ¨Spring Webä¸­ç¨‹åºä¸­æœ‰æ•ˆ Applicationï¼šå½“å‰ServletContextä¸­åªæœ‰ä¸€ä¸ªBeanå®ä¾‹ï¼Œä»…åœ¨Spring Webä¸­ç¨‹åºä¸­æœ‰æ•ˆ WebSocketï¼šWebå¥—æ¥å­—ä¸­åªå­˜åœ¨ä¸€ä¸ªBeanå®ä¾‹ Custom scopesï¼šå¼€å‘è€…è‡ªå®š Springå®¹å™¨ä¸­å­˜ä»€ä¹ˆï¼Ÿ ä¸»è¦å­˜å‚¨Beanå¯¹è±¡ã€‚æ ¹æ®é…ç½®æ–‡ä»¶æˆ–æ³¨è§£æ–¹å¼åˆ›å»ºã€ç®¡ç†Beanå¯¹è±¡ åœ¨BeanåŠ è½½/é”€æ¯å‰åï¼Œæ€ä¹ˆå®ç°æŸäº›é€»è¾‘å‘¢ï¼Ÿ ä½¿ç”¨Springçš„ç”Ÿå‘½å‘¨æœŸå›è°ƒæ¥å£æˆ–æ³¨è§£ï¼š XMLé…ç½®ä¸­æŒ‡å®šinit- methodå’Œdestroy- methodå±æ€§ï¼Œååœ¨Beanç±»ä¸­å®ç° Beanç±»å®ç°InitializingBeanå’ŒDisposableBeanæ¥å£ï¼Œå¹¶åˆ†åˆ«å®ç°afterPropertiesSetä¸destroyæ–¹æ³• Beanç±»ä¸­å®šä¹‰å¸¦@PostConstructå’Œ@PreDestoryæ³¨è§£çš„æ–¹æ³• @Beanæ³¨è§£çš„init- methodå’Œdestroy- methodå±æ€§ Beanæ³¨å…¥å’ŒXMLæ³¨å…¥æ•ˆæœç›¸åŒï¼Œåº•å±‚å¦‚ä½•ï¼Ÿ XMLæ³¨å…¥ï¼šBeanå®šä¹‰è§£æï¼ˆè¯»å–\u0026lt;bean\u0026gt;æ ‡ç­¾è·å–Beanå®šä¹‰ä¿¡æ¯ï¼‰ â€”\u0026gt; æ³¨å†ŒBeanï¼ˆå¦‚æ³¨å†Œåˆ°BeanDefinitionRegistryï¼‰ â€”\u0026gt; å®ä¾‹åŒ–å’Œä¾èµ–æ³¨å…¥ï¼ˆé€šè¿‡åå°„åˆ›å»ºBeanå®ä¾‹ï¼Œåæ ¹æ®Beanå®šä¹‰ä¸­çš„é…ç½®ï¼Œé€šè¿‡setterã€æ„é€ å‡½æ•°æ³¨å…¥éœ€è¦çš„ä¾èµ–Beanï¼‰ æ³¨è§£æ³¨å…¥ï¼šç±»è·¯å¾„æ‰«æï¼ˆ@Componentã€@Serviceã€@Repositoryã€@Controlleræ³¨è§£çš„ç±»ï¼‰ â€”\u0026gt; æ³¨å†ŒBeanå®šä¹‰ â€”\u0026gt; ä¾èµ–æ³¨å…¥ï¼ˆæ£€æŸ¥å­—æ®µä¸Šæ˜¯å¦æœ‰@Autowiredã€@Injectã€@Resourceæ³¨è§£ï¼Œè‹¥æœ‰åˆ™æ ¹æ®æ³¨è§£æ³¨å…¥ï¼‰ åº•å±‚ç›¸ä¼¼æ€§ï¼šBeanDefinitionï¼ˆæœ€ç»ˆéƒ½ä¼šç”ŸæˆBeanDefinitionå¯¹è±¡ï¼‰ + åå¤„ç†å™¨ï¼ˆå¦‚AutowiredAnnotationBeanPostProcessorå¤„ç†Autowiredæ³¨è§£çš„ä¾èµ–æ³¨å…¥ \u0026amp; XMLä¹Ÿæœ‰ï¼‰ + ä¾èµ–æŸ¥æ‰¾ï¼ˆé€šè¿‡BeanFactoryæŸ¥æ‰¾å’Œæ³¨å…¥ä¾èµ– ä¸‰çº§ç¼“å­˜ Spring å¦‚ä½•è§£å†³å¾ªç¯ä¾èµ–ï¼Ÿ å¾ªç¯ä¾èµ–çš„ä¸‰ç§æƒ…å†µï¼š\næ„é€ æ–¹æ³•è¿›è¡Œä¾èµ–æ³¨å…¥æ—¶äº§ç”Ÿï¼Œå¦‚ï¼šï¼ˆæ— æ³•è§£å†³ï¼Œå› ä¸ºå‘ç”Ÿåœ¨Beanå®ä¾‹åŒ–é˜¶æ®µï¼Œæœªåˆ›å»ºæ—©æœŸå¯¹è±¡ï¼Œæ— æ³•æ”¾å…¥ä¸‰çº§ç¼“å­˜ï¼‰ @Component public class BeanA { private BeanB beanB; @Autowired public BeanA(BeanB beanB) { this.beanB = beanB; } } @Component public class BeanB { private BeanA beanA; @Autowired public BeanB(BeanA beanA) { this.beanA = beanA; } } setteræ–¹æ³•è¿›è¡Œä¾èµ–æ³¨å…¥æ—¶äº§ç”Ÿ \u0026amp; å¤šä¾‹ï¼ˆåŸå‹ï¼‰æ¨¡å¼ï¼ˆä½œç”¨åŸŸScopeæŒ‡å®šä¸ºPrototypeï¼‰ å¤šä¾‹ï¼ˆåŸå‹ï¼‰ï¼šï¼ˆå¦‚å¹¶å‘åœºæ™¯ï¼‰åœ¨åŸå‹ä½œç”¨åŸŸä¸‹ï¼Œæ¯æ¬¡è¯·æ±‚éƒ½åˆ›å»ºä¸€ä¸ªæ–°å®ä¾‹ï¼Œä¸€èˆ¬åœ¨è¯·æ±‚ç»“æŸåé”€æ¯ ä¸ä¼šå¯¼è‡´åˆå§‹åŒ–å¤±è´¥ï¼Œä½†æ¯æ¬¡è¯·æ±‚éƒ½ä¼šåˆ›å»ºå¾ˆå¤šå®ä¾‹â€”\u0026gt;æ€§èƒ½é—®é¢˜ @Component @Scope(\u0026#34;prototype\u0026#34;) public class BeanA { private BeanB beanB; @Autowired public void setBeanB(BeanB beanB) { this.beanB = beanB; } } setteræ–¹æ³•è¿›è¡Œä¾èµ–æ³¨å…¥æ—¶äº§ç”Ÿ \u0026amp; å•ä¾‹æ¨¡å¼ï¼ˆè¢«è§£å†³ï¼‰ è§£å†³æ–¹æ³•ï¼šä¸‰çº§ç¼“å­˜â€”\u0026gt;Springåˆ›å»ºBeanæ—¶ï¼Œé€šè¿‡ä¸‰çº§ç¼“å­˜ç¼“å­˜æ­£åœ¨åˆ›å»ºçš„Beanä¸åˆ›å»ºå®Œæˆçš„Beanå®ä¾‹ã€‚æ­¥éª¤ï¼š\nå°è¯•åˆ›å»ºBean Açš„å®ä¾‹ï¼Œå°†Açš„å·¥å‚å¯¹è±¡æ”¾å…¥ä¸‰çº§ç¼“å­˜ èµ‹å€¼æ—¶å¦‚æœå‘ç°å¾ªç¯ä¾èµ–ï¼Œå°†å½“å‰Bean Aå¯¹è±¡æå‰æš´éœ²ç»™åç»­éœ€è¦ä¾èµ–çš„Bean B Bean Båœ¨ä¸‰çº§ç¼“å­˜æŸ¥åˆ°Aï¼ŒåŠæˆå“Aæ”¾å…¥äºŒçº§ç¼“å­˜ï¼ˆå­˜å‚¨æ—©æœŸæš´éœ²çš„å¯¹è±¡ï¼Œå·²å®ä¾‹åŒ–æœªåˆå§‹åŒ–ï¼‰ åˆå§‹åŒ–Beanï¼šå°† Bean B è¿›è¡Œåˆå§‹åŒ–å¹¶æ”¾å…¥ä¸€çº§ç¼“å­˜ï¼Œæ¸…ç©ºå…¶äºŒä¸‰çº§ç¼“å­˜ æ³¨å…¥ä¾èµ–ï¼šç»§ç»­å¯¹Bean Aè¿›è¡Œä¾èµ–æ³¨å…¥ï¼Œå‘ç°å¾ªç¯ä¾èµ–æ—¶ä»ä¸‰çº§ç¼“å­˜ä¸­è·å–å·¥å‚å¯¹è±¡ æ•´è¿‡ç¨‹ä¾‹ï¼šSpringå…ˆåˆ›å»ºAçš„å®ä¾‹ï¼Œå¹¶å°†Açš„å·¥å‚å¯¹è±¡æ”¾å…¥ä¸‰çº§ç¼“å­˜ã€‚å½“åˆ›å»ºBæ—¶ï¼ŒBä¼šå°è¯•ä»ç¼“å­˜ä¸­è·å–Aã€‚ç”±äºAè¿˜æœªå®Œå…¨åˆ›å»ºå¥½ï¼ŒBä¼šä»ä¸‰çº§ç¼“å­˜ä¸­è·å–Açš„å·¥å‚å¯¹è±¡ï¼Œå¹¶é€šè¿‡å·¥å‚å¯¹è±¡è·å–Açš„æ—©æœŸå¼•ç”¨ã€‚è¿™ä¸ªæ—©æœŸå¼•ç”¨æ˜¯Açš„åŠæˆå“ï¼ˆå¹¶æ”¾å…¥äºŒçº§ç¼“å­˜ä¸­ï¼‰ï¼Œä½†å·²è¶³å¤ŸBä½¿ç”¨ã€‚éšåï¼ŒBå®Œæˆåˆ›å»ºï¼ˆå¹¶æ¸…ç©º å…¶ äºŒä¸‰çº§ç¼“å­˜ï¼Œä¸”äºŒçº§ç©ºï¼‰å¹¶è¿”å›ç»™Aï¼ŒAç»§ç»­å…¶åˆå§‹åŒ–è¿‡ç¨‹ï¼Œæœ€åæ¸…ç©º å…¶ äºŒä¸‰çº§ç¼“å­˜ï¼Œä¸”ä¸‰çº§ç©º ä¸‰çº§ç¼“å­˜çš„æ•°æ®ç»“æ„æ˜¯ï¼Ÿ Map ä¸€çº§ç¼“å­˜ï¼ˆsingletonObjectsï¼‰ï¼šå­˜æ”¾å®Œå…¨åˆå§‹åŒ–çš„Beanï¼Œå¯ç›´æ¥ä½¿ç”¨ äºŒçº§ç¼“å­˜ï¼ˆearlySingletonObjectsï¼‰ï¼šå­˜æ”¾å±æ€§æœªå®Œå…¨æ³¨å…¥çš„åŠæˆå“Bean ä¸‰çº§ç¼“å­˜ï¼ˆsingletonFactoriesï¼‰ï¼šå­˜æ”¾Beançš„å·¥å‚å¯¹è±¡ï¼Œç”¨äºç”ŸæˆBeançš„æ—©æœŸå¼•ç”¨ Springæ¡†æ¶ç”¨åˆ°å“ªäº›è®¾è®¡æ¨¡å¼ï¼Ÿï¼ˆä»¥ä¸‹çœç•¥â€œæ¨¡å¼â€äºŒå­—ï¼‰ å·¥å‚è®¾è®¡æ¨¡å¼ï¼šåˆ›å»ºBeanå¯¹è±¡ ä»£ç†è®¾è®¡ï¼šAOPåŠŸèƒ½çš„å®ç° å•ä¾‹è®¾è®¡ï¼šBeané»˜è®¤ä¸ºå•ä¾‹ æ¨¡ç‰ˆæ–¹æ³•ï¼šä»¥Templateç»“å°¾çš„å¯¹æ•°æ®åº“æ“ä½œçš„ç±»ï¼ˆeg.MongoTemplateï¼‰ åŒ…è£…å™¨è®¾è®¡ï¼š è§‚å¯Ÿè€…ï¼šSpringçš„äº‹ä»¶é©±åŠ¨æ¨¡å‹ é€‚é…å™¨ï¼šAOPçš„å¢å¼ºæˆ–Adviceã€MVCç”¨åˆ°é€‚é…å™¨æ¨¡å¼ä»¥é€‚é…Controller MVC ä»‹ç» ä¸€ç§è½¯ä»¶è®¾è®¡è§„èŒƒï¼Œä¸šåŠ¡é€»è¾‘ã€æ•°æ®ã€ç•Œé¢æ˜¾ç¤ºåˆ†ç¦»çš„æ–¹æ³•ç»„ç»‡ä»£ç  Modelï¼šä»£è¡¨ä¸€ä¸ªå­˜å–æ•°æ®çš„å¯¹è±¡æˆ– JAVA POJOï¼ˆPlain Old Java Objectï¼Œç®€å•javaå¯¹è±¡ï¼‰ã€‚å®ƒä¹Ÿå¯ä»¥å¸¦æœ‰é€»è¾‘ï¼Œä¸»è¦ç”¨äºæ‰¿è½½æ•°æ®ï¼Œå¹¶å¯¹ç”¨æˆ·æäº¤è¯·æ±‚è¿›è¡Œè®¡ç®—çš„æ¨¡å—ã€‚æ¨¡å‹åˆ†ä¸ºä¸¤ç±»ï¼Œä¸€ç±»ç§°ä¸ºæ•°æ®æ‰¿è½½Beanï¼Œä¸€ç±»ç§°ä¸ºä¸šåŠ¡å¤„ç†Beanã€‚æ‰€è°“æ•°æ®æ‰¿è½½ Beanæ˜¯æŒ‡å®ä½“ç±»ï¼ˆå¦‚ï¼šUserç±»ï¼‰ï¼Œä¸“é—¨ä¸ºç”¨æˆ·æ‰¿è½½ä¸šåŠ¡æ•°æ®çš„ï¼›è€Œä¸šåŠ¡å¤„ç† Bean åˆ™æ˜¯æŒ‡Service æˆ– Dao å¯¹è±¡ï¼Œ ä¸“é—¨ç”¨äºå¤„ç†ç”¨æˆ·æäº¤è¯·æ±‚çš„ Viewï¼šç”¨æˆ·ç›´æ¥äº¤äº’çš„ä½¿ç”¨ç•Œé¢ Controllerï¼šå°†ç”¨æˆ·è¯·æ±‚è½¬å‘åˆ°ç›¸åº”çš„modelï¼Œæ ¹æ®modelçš„è®¡ç®—ç»“æœå‘ç”¨æˆ·æä¾›å“åº”ï¼Œåˆ†ç¦»è§†å›¾ä¸æ¨¡å‹ åŸºæœ¬æµç¨‹ï¼šç”¨æˆ·ä»Viewé¡µé¢æå‡ºè¯·æ±‚ï¼ŒæœåŠ¡ç«¯Controlleræ¥æ”¶è¯·æ±‚åè§£æï¼Œæ‰¾åˆ°å¯¹åº”Modelï¼ŒModelå¤„ç†åç»“æœäº¤ç»™Controllerï¼ˆæ‰¿ä¸Šå¯ä¸‹ï¼‰ï¼Œæ ¹æ®ç»“æœæ‰¾åˆ°è¦å‘å›çš„å“åº”Viewé¡µé¢ï¼Œæ¸²æŸ“åå‘å›å®¢æˆ·ç«¯ å…·ä½“æµç¨‹ï¼Ÿè¯¦è§ HandlerMappingå’ŒHandlerAdapter mappingï¼šå°†è¯·æ±‚æ˜ å°„åˆ°Controllerã€‚BeanNameUrlHandlerMappingç­‰å¯å®ç°ã€‚æ ¹æ®URLã€è¯·æ±‚å‚æ•°ç­‰è§„åˆ™ç¡®å®šå¯¹åº”çš„å¤„ç†å™¨ adapterï¼šè°ƒç”¨Controllerå¤„ç†è¯·æ±‚ã€‚æ ¹æ®Controllerç±»å‹é€‰æ‹©åˆé€‚æ–¹æ³•è°ƒç”¨ã€‚æ ¹æ®Controlleræ¥å£ç±»å‹ï¼Œé€‰æ‹©å¯¹åº”çš„HandlerAdapterè°ƒç”¨å®ƒ äº‹åŠ¡ é€šè¿‡ä»£ç†å¯¹è±¡\näº‹åŠ¡ä»€ä¹ˆæƒ…å†µä¸‹å¤±æ•ˆï¼Ÿ@Transactional å¼€å¯äº‹åŠ¡æƒ…å†µ æœªæ•è·å¼‚å¸¸ éå—æ£€å¼‚å¸¸ï¼šRuntimeExceptionæˆ–å…¶å­ç±» äº‹åŠ¡ä¼ æ’­å±æ€§è®¾ç½®ä¸å½“ï¼šäº‹åŠ¡åµŒå¥—ä¸”é…ç½®ä¸æ­£ç¡®ï¼Œæ³¨æ„æ–¹æ³•å†…è°ƒç”¨å…·æœ‰è¯¥æ³¨è§£çš„æ–¹æ³• å¤šæ•°æ®æºçš„äº‹åŠ¡ç®¡ç†ï¼šå¤šæ•°æ®æºï¼Œäº‹åŠ¡ç®¡ç†é…ç½®ä¸å½“/å­˜åœ¨å¤šä¸ªäº‹åŠ¡æ³¨è§£ è·¨æ–¹æ³•è°ƒç”¨äº‹åŠ¡é—®é¢˜ï¼šå¦‚æœä¸€ä¸ªäº‹åŠ¡æ–¹æ³•å†…éƒ¨è°ƒç”¨å¦ä¸€ä¸ªæ–¹æ³•ï¼Œè€Œè¿™ä¸ªè¢«è°ƒç”¨çš„æ–¹æ³•æ²¡æœ‰ @Transactional æ³¨è§£ï¼Œæ­¤æ—¶å¤–å±‚äº‹åŠ¡å¯èƒ½å¤±æ•ˆ äº‹åŠ¡åœ¨éå…¬å¼€æ–¹æ³•ä¸­å¤±æ•ˆï¼šæ³¨è§£æ ‡æ³¨åœ¨épublicæ–¹æ³•ä¸Š ä½¿ç”¨thisè°ƒç”¨Springäº‹åŠ¡æ˜¯å¦ç”Ÿæ•ˆï¼Ÿ å¦ã€‚Springäº‹åŠ¡é€šè¿‡ä»£ç†å¯¹è±¡æ§åˆ¶ï¼Œthis è°ƒç”¨ä¼šç»•è¿‡ä»£ç†æœºåˆ¶ï¼Œä¸ä¼šåº”ç”¨äº‹åŠ¡è®¾ç½® å…¶å®ƒ Springæ‹“å±•ç‚¹ï¼Ÿ BeanFactoryPostProcessorï¼šå®ä¾‹åŒ–Beanå‰ä¿®æ”¹Beanå®šä¹‰ BeanPostProcessorï¼šBeanå®ä¾‹åŒ–ã€é…ç½®ä¸åˆå§‹åŒ–ä¹‹åè¿›è¡Œé¢å¤–å¤„ç† Spring MVCä¸­çš„HandlerInterceptorï¼šæ‹¦æˆªå¤„ç†è¯·æ±‚ï¼Œåœ¨è¯·æ±‚å‰ã€ä¸­ã€åæ‰§è¡Œç‰¹å®šé€»è¾‘ Spring MVCä¸­çš„ControllerAdviceï¼šå…¨å±€å¤„ç†æ§åˆ¶å™¨å¼‚å¸¸ã€æ•°æ®ç»‘å®šä¸æ•°æ®æ ¡éªŒ è‡ªå®šä¹‰æ³¨è§£ï¼šæƒé™æ§åˆ¶ æ—¥å¿—è®°å½•ç­‰åŠŸèƒ½ ","permalink":"https://Sattiluvcat.github.io/en/posts/java/%E5%85%AB%E8%82%A1--spring/","summary":"Spring - SpringBoot - Mybatis - SpringCloudï¼ˆç®€ç•¥ï¼‰ï¼Œå†…å®¹æ¥è‡ªå°æ—coding","title":"å…«è‚¡â€”â€”Spring"},{"content":"Â æ•°æ®åº“æ„å»º æ•°æ®ä¿¡æ¯ ä¸»è¦ç»„æˆï¼šæ¥æºäºæ‰€æœ‰çœ‹è¿‡çš„ 520éƒ¨ å½±ç‰‡ï¼ŒåŒ…æ‹¬ç”µå½±åã€ä¸»è¦æ¼”å‘˜ã€å¯¼æ¼”ã€è¯„åˆ†ã€ç±»å‹ã€è¯­è¨€ã€åˆæ¬¡ä¸Šæ˜ æ—¶é—´ç­‰å†…å®¹ è¯„åˆ†åŒ…æ‹¬æˆ‘çš„è¯„åˆ†ä¸è±†ç“£è¯„åˆ†ï¼Œä¼˜å…ˆå†™æˆ‘çš„ğŸ˜¤ æ•°æ®æ¥æºä¸å¤„ç†æ–¹å¼ Pythonçˆ¬è™«ï¼Œåœ¨â€œæˆ‘çœ‹è¿‡çš„â€é¡µé¢è¿›è¡ŒæŠ“å– å‘ç°è±†ç“£çš„upload_auth_tokençœŸçš„æ²¡å˜è¿‡ï¼Œå¤ªç¥å¥‡äº†Â·Â·Â· æŒ‚äº†å­¦æ ¡ VPN ä¼šæœ‰ç™»å½•å¼‚å¸¸ï¼Œå¤ªç¥å¥‡äº†Â·Â·Â· response = requests.get(url, headers=header) soup = BeautifulSoup(response.text, \u0026#39;html.parser\u0026#39;) # æ ¹æ®F12ç½‘é¡µç»“æ„é€æ¡è·å–ä¿¡æ¯ å®šä½åˆ°æœ€è¿‘çš„ä¸€ä¸ªdivå³å¯ for item in soup.select(\u0026#39;div.item.comment-item\u0026#39;): title = item.select_one(\u0026#39;div.info li.title a em\u0026#39;).text.strip() link = item.select_one(\u0026#39;div.info li.title a\u0026#39;).get(\u0026#39;href\u0026#39;) # ç»¼åˆä¿¡æ¯ comp_load = item.select_one(\u0026#39;div.info li.intro\u0026#39;).text.strip() movies.append({\u0026#39;title\u0026#39;: title, \u0026#39;link\u0026#39;: link}) ç»“åˆæ­£åˆ™è¡¨è¾¾å¼å¯¹ä»¥ä¸Šæåˆ°çš„ä¿¡æ¯è¿›è¡Œæå–ï¼Œä»¥ä¸‹åªè´´å¯¼æ¼”ã€æ—¶é•¿ä¸ç±»å‹å‚æ•°çš„è·å–æ–¹å¼ æ¼”å‘˜åçš„æ­£åˆ™è¡¨è¾¾å¼ï¼šr'[\\u4e00-\\u9fa5Â·]+(?:\\s[\\u4e00-\\u9fa5Â·]+)*'ï¼Œå³é€šè¿‡/åˆ†éš”çš„ä¸­æ–‡Unicodeå­—ç¬¦ å¯¼æ¼”è¿™é‡Œæœ‰ä¸€ç‚¹å°é—®é¢˜ï¼Œä¸€èˆ¬æ¥è¯´åº”è¯¥æ˜¯å›½å®¶ã€ç½‘å€ä¹‹åå†™å¯¼æ¼”åå­—ï¼Œæ­¤å¤„é€šè¿‡ç¿»è¯‘åæ¯”è¾ƒæ˜¯å¦æ˜¯å›½å®¶æˆ–è€…æ˜¯å¦éä¸­æ–‡æ¥éš”æ–­ã€‚ å› ä¸ºpycountryåªèƒ½å¤„ç†è‹±æ–‡æ¥ç€Â·Â·Â· åªå–äº†ç¬¬ä¸€ä½å¯¼æ¼” è€ƒè™‘åˆ°å…¶å®å¹¶ä¸å¤ªé‡è¦soÂ·Â·Â· æŸäº›çŸ­ç‰‡ç›´æ¥ç²—æš´å¤„ç†äº† äºæˆ‘è€Œè¨€å¹¶æ— åŒºåˆ« duration_match = re.search(r\u0026#39;\\d+åˆ†é’Ÿ\u0026#39;, info) # é€‰æ‹©ç¬¬ä¸€ä¸ªæ—¶é•¿ duration = None director = None tags = [] if duration_match: duration = duration_match.group(0) # åŒ¹é…å¯¼æ¼”--\u0026gt;æœ€åä¸€ä¸ªä¸­æ–‡å text_before_duration = info[:duration_match.start()] # ä»¥æ–œæ ä¸ºæ ‡å¿—ï¼Œåˆ†å‰²å¯¼æ¼” director_match = re.findall(r\u0026#39;[\\u4e00-\\u9fa5Â·]+(?:\\s[\\u4e00-\\u9fa5Â·]+)*\u0026#39;, text_before_duration) if director_match: director = director_match[-1] # åŒ¹é…æ ‡ç­¾ text_after_duration = info[duration_match.end():] slash_index = text_after_duration.find(\u0026#39;/\u0026#39;) if slash_index != -1: after_name_slash_index = text_after_duration.find(\u0026#39;/\u0026#39;, slash_index + 1) text_after_movie_name = text_after_duration[after_name_slash_index + 1:] for tag in text_after_movie_name.split(\u0026#39;/\u0026#39;): tag = tag.strip() if tag in tag_list: tags.append(tag) else: break return director, duration, tags å­˜å‚¨åˆ°MongoDBåº“ å¤§å¤šä¸ºæ–‡æœ¬æ•°æ®ï¼Œæ‰€ä»¥ä¸é€‰æ‹©MySQLæ–¹æ³•ï¼Œåç»­å¯èƒ½ä¼šåœ¨ç”¨æˆ·ç™»å½•ç­‰æ–¹é¢ä½¿ç”¨MySQLï¼Œä½†æ–‡æœ¬æ•°æ®æ›´é€‚åˆMongoDB æœ€å¥½æ·»åŠ _idä¿¡æ¯ï¼ˆé¿å…åæœŸå¢åŠ idï¼Œä¼šè¢«è‡ªåŠ¨è®¤æˆä¸»é”®ï¼Œåœ¨å‰ç«¯è°ƒå–ä¿¡æ¯æ—¶ä¹Ÿå¾ˆéº»çƒ¦ï¼‰ è®¿é—®æŸäº›ç½‘ç«™æ—¶é”™è¯¯æŠ¥404ï¼Œå»ºè®®ä»æµè§ˆå™¨è®¿é—®ä¸€æ¬¡ï¼Œå¤åˆ¶cookieåˆ°è¯·æ±‚ä¸­å³å¯ MongoDBå­˜å‚¨ä¸è¯»å– ä¿å­˜ä¸ºjsonæ ¼å¼å³å¯ javaä¸­é€šè¿‡@Document(collection = \u0026quot;movies\u0026quot;)æ³¨è§£å¼•å…¥MongoDBæ•°æ®åº“ åç«¯Java åŸºæœ¬æ¡†æ¶ ä¸»ä½“æ¨¡å¼ï¼š ç”¨æˆ·è¿›å…¥\u0026ndash;\u0026gt;è¿˜æ˜¯å¼ºåˆ¶ç™»å½•äº† æ¨¡ç³Šæœç´¢ tagsæœç´¢ æŸ¥çœ‹å…¨éƒ¨ ç‚¹å‡»ç¼©ç•¥å›¾ï¼Œè°ƒç”¨{id}æ¥å£ï¼Œè·³è½¬é¡µé¢ æœç´¢ç»“æœä¸ºPageResultï¼Œå…¶ä¸­æ•°æ®æ˜¯List\u0026lt;MovieRow\u0026gt; ï¼ˆéœ€è¦è®°å½•ç”¨æˆ·æ˜µç§°ç­‰ä¿¡æ¯ï¼‰ä¸€èµ·çœ‹ç‚¹å‡»åå‘æŒ‡å®šé‚®ç®±å‘æ¶ˆæ¯ ï¼ˆéœ€è¦è®°å½•ç”¨æˆ·æ˜µç§°ç­‰ä¿¡æ¯ï¼‰ä¸ªäººè¯„åˆ†æŒ‡å®šåå‘æŒ‡å®šé‚®ç®±å‘æ¶ˆæ¯ ç™»å…¥ç™»å‡ºï¼š ç”¨ThreadLocalæœ‰ç‚¹å°é—®é¢˜ï¼Œæœ€åç”¨äº†Sessionï¼Œç›‘å¬åˆ°é¡µé¢è¢«å…³é—­å³è°ƒç”¨ç™»å‡ºåŠŸèƒ½ æŸ¥çœ‹å…¨éƒ¨ç”µå½±åŠŸèƒ½ è¿‡ç¨‹ ç‰¹æ®ŠåŠŸèƒ½ å‘é€é‚®ä»¶ï¼š å…¶å®ä¹Ÿå¯ä»¥ç›´æ¥å‘åç«¯ä¼ æ¶ˆæ¯ï¼Œä½†æ˜¯ä¸å–œæ¬¢ã€‚ æœ¬æ¥æƒ³å®ç°çš„ä¹Ÿæ˜¯å¯ä»¥ç›´æ¥åœ¨å¾®ä¿¡ç«¯æ¨é€çš„åŠŸèƒ½ï¼ˆå°±æ˜¯ä¸ºäº†è¿™ç›˜é†‹åŒ…çš„é¥ºå­ï¼ï¼‰ï¼Œé‚®ç®±è·Ÿå¾®ä¿¡ç»‘å®šä¸€ä¸‹åˆæ›²çº¿æ•‘å›½äº†ï¼ˆä¸æ˜¯ å¼•å…¥ä¾èµ–\u0026ndash;\u0026gt;é…ç½®mail\u0026ndash;\u0026gt;æ·»åŠ é‚®ç®±æœåŠ¡ç±» å³å¯ å¤„ç†é—®é¢˜ ä¸­æ–‡ç¼–ç ä¸èƒ½å‡ºç°åœ¨åœ°å€é‡Œ\u0026ndash;\u0026gt;URLEncoder \u0026amp; URLDecoderç¼–ç è§£ç å³å¯ è®©æˆ‘ä»¬è¯´ä¸­æ–‡ Let us speak ChineseğŸ¤ è¿™éƒ¨åˆ†é—®é¢˜ä¸»è¦æ˜¯åç«¯ç”¨httpå‘é€è¯·æ±‚è°ƒè¯•æ—¶å‡ºç°ï¼Œå‰åç«¯è”è°ƒæƒ…å†µä¸‹å¹¶ä¸å½±å“ bugåˆé›† commonæ¨¡å—çš„Resultç±»é€šè¿‡åœ¨serveræ¨¡å—çš„pom.xmlæ–‡ä»¶ä¸­æ·»åŠ å¿«ç…§ä¾èµ–dependency--\u0026gt;SNAPSHOTå®ç°åœ¨serveræ¨¡å—çš„è°ƒç”¨ æ¯ä¸ªç±»è®¾ç½®è‡ªåŠ¨å¡«å……getter \u0026amp; setterä¿¡æ¯éœ€è¦çš„æ³¨è§£ï¼š @Data @Builder @AllArgsConstructor @NoArgsConstructor Mysqlæ•°æ®åº“é…ç½®çš„druidéœ€è¦æ ¹æ®mavençš„ç‰ˆæœ¬æ”¹å˜ä¾èµ–çš„ç‰ˆæœ¬ å¦‚ SpringBoot3 å¯¹åº” alibaba.druid 2.x å³å¯ï¼ˆå¤ªå¤æ—©çš„ç‰ˆæœ¬ä¼šå¯¼è‡´æ— æ³•è¯»åˆ°MySQLçš„urlï¼‰ MongoDBè‡ªè®¾ä¸»é”®_idï¼Œé»˜è®¤æ–¹æ³•ä¸­çš„getByIdå³æŒ‡è¯¥ä¸»é”®ï¼Œè‹¥éœ€æŒ‰è‡ªå®šä¹‰idæœç´¢ï¼Œéœ€è¦æ¢ç”¨MongoTemplate è°ƒç”¨Pythonæ–‡ä»¶è¿‡ç¨‹ï¼š ProcessBuilderå¯¹è±¡è°ƒç”¨\u0026ndash;\u0026gt;å¯ä»¥è¾“å…¥å‚æ•° æ¥æ”¶åˆ°çš„æ˜¯è¾“å‡ºæµï¼ˆå³printéƒ¨åˆ†ï¼‰ ä¹‹å‰ä¸€ç›´è°ƒç”¨å¤±è´¥ï¼Œæœ€ååœ¨ProcessBuilderå¯¹è±¡ä¸­æ·»åŠ äº†è§£é‡Šå™¨è·¯å¾„å°±å¥½ä½¿äº† å…¶å®è¿™é‡Œæ˜¯æ¨¡æ‹Ÿå‘½ä»¤è¡Œï¼Œpython3åœ¨å‘½ä»¤è¡Œä¸­ä¸èƒ½ç”¨pythonï¼Œéœ€è¦pyè°ƒç”¨æ¥ç€ é‚®ç®±æœåŠ¡ç±»ä¸­éœ€é…ç½®å‘ä¿¡åœ°å€ï¼Œåœ¨é‚®ç®±æœåŠ¡ç±»ä¸­å®šä¹‰å‘ä¿¡æ–¹æ³•æ—¶æ·»åŠ ï¼šmessage.setFrom(from); é¿å…501 Mail from address must be same as authorization useræŠ¥é”™ @Value(\u0026#34;${spring.mail.username}\u0026#34;) // æ­¤å¤„å¼•ç”¨çš„æ˜¯é…ç½®æ–‡ä»¶ä¸­çš„ä¿¡æ¯ private String from; Postmanå‘é€è¯·æ±‚æŠ¥é”™ï¼šError: connect ECONNREFUSED balabal å…³é—­ç³»ç»Ÿä»£ç†ï¼Œè‡ªè¡Œè®¾ç½®ä»£ç†åˆ°ç«¯å£127.0.0.1:8080 Javaè°ƒç”¨Pythonè„šæœ¬å¾—åˆ°çš„ä¸­æ–‡ä¿¡æ¯ï¼ŒPythonä¸­é»˜è®¤ä½¿ç”¨cp936å­—ç¬¦é›†ï¼Œå³gb2312ã€‚æ•…åœ¨Javaä¸­éœ€è¦æ˜¾å¼æŒ‡å®šç”¨gb2312å­—ç¬¦æ¥æ”¶ æ­¤å¤„æ›´æ”¹Pythonçš„encode decodeæ— æ•ˆ Windowsç³»ç»Ÿé»˜è®¤å­—ç¬¦é›†gb2312ï¼ŒMACç³»ç»Ÿé»˜è®¤å­—ç¬¦é›†UTF-8ï¼Œéœ€é’ˆå¯¹ä¸åŒç³»ç»Ÿè¿›è¡Œè®¾å®š BufferedReader in = new BufferedReader(new InputStreamReader(process.getInputStream(), \u0026#34;gb2312\u0026#34;)); ä»£ç† nginxä»å‰ç«¯8888ç«¯å£åå‘ä»£ç†åˆ°åç«¯8080ç«¯å£ å®é™…ç”¨ä¸ä¸Š Vueè‡ªå·±è®¾ç½®ä¸€ä¸‹å³å¯ï¼ˆæ¯•ç«Ÿæœ¬åœ°éšä¾¿è·‘è·‘ ä¸å¤ªç”¨è€ƒè™‘å®‰å…¨æ€§ è´Ÿè½½å‡è¡¡ç­‰ åç«¯é…ç½®ç±»ä»¥æ¥å—å‰ç«¯è°ƒç”¨ï¼šWebConfig @Configuration public class WebConfig implements WebMvcConfigurer { @Override public void addCorsMappings(CorsRegistry registry) { registry.addMapping(\u0026#34;/**\u0026#34;) // !! å¡«å‰ç«¯åœ°å€ .allowedOrigins(\u0026#34;http://localhost:8889\u0026#34;) .allowedMethods(\u0026#34;GET\u0026#34;, \u0026#34;POST\u0026#34;, \u0026#34;PUT\u0026#34;, \u0026#34;DELETE\u0026#34;, \u0026#34;OPTIONS\u0026#34;) .allowCredentials(true) .allowedHeaders(\u0026#34;*\u0026#34;); } } bugåˆé›† WebConfigé…ç½®ç±»ï¼Œoriginæ˜¯å‰ç«¯åœ°å€ æ³¨æ„å‰ç«¯è¿”å›åç«¯æ¥æ”¶çš„æ ¼å¼ åœ¨å‰ç«¯çš„é¡µé¢ä¹‹é—´ä¼ é€’å‚æ•°æ—¶éœ€è¦ä½¿ç”¨Vuex æ¥æ”¶å‚æ•°ç«¯ï¼š export default { computed: { ...mapGetters([\u0026#39;getMovies\u0026#39;]), movies() { return this.getMovies; } } } å‘é€å‚æ•°ç«¯ï¼š this.updateMovies(movies); // ä¸ç”¨å¼‚æ­¥ç­‰å¾… this.$router.push({ name: \u0026#39;SearchResults\u0026#39;}); ä»å‰ç«¯å¼€å‘è€…å·¥å…·è°ƒè¯•ï¼Œæ³¨æ„æå–çš„å†…å®¹å±‚çº§å…³ç³» å‰ç«¯Vue å¤§è‡´å½¢å¼ ä¸»è¦æµç¨‹ï¼š ç”¨æˆ·è®¿é—®\u0026ndash;\u0026gt;é¦–é¡µ\u0026ndash;\u0026gt;è®¾ç½®æœç´¢æ ä¸æŒ‰ç±»åˆ«æœç´¢å…¥å£ \u0026amp; ä¸‹åˆ—4~5ä¸ªç”µå½±ç¼©ç•¥å›¾ ç”µå½±ç¼©ç•¥å›¾\u0026ndash;\u0026gt;ç‚¹å‡»è¿›å…¥ç”µå½±è¯¦æƒ…é¡µ ç”µå½±è¯¦æƒ…é¡µP1\u0026ndash;\u0026gt;ä¸Šåˆ—ç”µå½±è¯¦æƒ…ï¼ˆåŒ…æ‹¬å®æ—¶ä»è±†ç“£ç”µå½±çˆ¬ä¸‹æ¥çš„æµ·æŠ¥ä¸è¯„åˆ†ï¼‰ ç”µå½±è¯¦æƒ…é¡µP2\u0026ndash;\u0026gt;ä¸‹åˆ—â€œä¸€èµ·çœ‹â€ä¸è¯„åˆ†åŠŸèƒ½\u0026ndash;\u0026gt;å¤šäººè¯„åˆ†è®¡ç®—å¹³å‡åˆ†åœ¨å³ä¾§æ˜¾ç¤º æœç´¢\u0026ndash;\u0026gt;æœç´¢ç»“æœä»¥ç¼©ç•¥å›¾å½¢å¼æ˜¾ç¤ºï¼Œåˆ†é¡µç»“æœ æ“ä½œ npmå‘½ä»¤è¡Œæ“ä½œ å®Œå…¨æ²¡æ¥è§¦è¿‡vueâ€¦å…¨æ˜¯é copilotæ•™ æ„Ÿè°¢å‰¯é©¾â™¥ å‰åç«¯è”è°ƒâ€”â€”F12å¼€å‘è€…æ¨¡å¼ åç«¯å‘é‚®ç®±å‘é€è¯·æ±‚æ˜¯é€šè¿‡Sessionï¼ˆå³Cookieï¼‰ï¼Œéœ€è¦åœ¨å‰ç«¯å¼€å¯é…ç½®axios.defaults.withCredentials = true; ä»localhostè®¿é—®ç½‘é¡µå›¾ç‰‡ï¼š\u0026lt;img referrerpolicy=\u0026quot;no-referrer\u0026quot; :src=\u0026quot;cover_url\u0026quot; alt=\u0026quot;Movie Cover\u0026quot; class=\u0026quot;movie-cover\u0026quot; /\u0026gt; é‡ç‚¹æ˜¯è®¾å®šreferrerpolicy å‰ç«¯å®ç°åˆ†é¡µ æœ¬æ¥æ˜¯åç«¯å®ç°çš„ï¼Œä½†æ˜¯äº¤äº’å¤ªéº»çƒ¦ï¼ŒåŠŸèƒ½ä¹Ÿä¸å¤æ‚ï¼ˆä»¥åŠæ˜¯åœ¨æœ¬åœ°è·‘çš„ï¼‰ï¼Œæœ€åè¿˜æ˜¯ç”¨å‰ç«¯å®ç°å®Œäº† åå¤„æ˜¯ä¸èƒ½ä»urlè·³è½¬é¡µé¢ totalPages() { return Math.ceil(this.movies.length / this.itemsPerPage); }, paginatedMovies() { const start = (this.currentPage - 1) * this.itemsPerPage; const end = start + this.itemsPerPage; return this.movies.slice(start, end); }, paginationPages() { const pages = []; if (this.totalPages \u0026lt;= 5) { for (let i = 1; i \u0026lt;= this.totalPages; i++) { pages.push(i); } } else { if (this.currentPage \u0026gt; 3) { pages.push(1); pages.push(\u0026#39;...\u0026#39;); } for (let i = Math.max(1, this.currentPage - 2); i \u0026lt;= Math.min(this.totalPages, this.currentPage + 2); i++) { pages.push(i); } if (this.currentPage \u0026lt; this.totalPages - 2) { pages.push(\u0026#39;...\u0026#39;); pages.push(this.totalPages); } } return pages; } bugåˆé›† api.jså®šä¹‰è·¯å¾„ä¸ç”¨å¼•å·ï¼Œè€Œæ˜¯åå•å¼•å· `ï¼š export const getSuggestedMovies = () =\u0026gt; { return axios.get(`${API_URL}/suggest`); }; ä¸Šçº¿ ä¸è´­ä¹°åŸŸå æ­¤å¤„ä»…ä½¿ç”¨ipè®¿é—®\næµç¨‹ è´­ä¹°äº‘æœåŠ¡å™¨ äº‘æœåŠ¡å™¨ä¸­ä½¿ç”¨å®å¡”è¿›è¡Œç®¡ç† ä¿®æ”¹é¡¹ç›®é…ç½®â€”â€”localhostæ›´æ”¹ äº‘æ•°æ®åº“ï¼ˆMongoDBï¼‰ åœ¨MongoDB Atlasä¸Šç›´æ¥ç”¨jsonæ ¼å¼å¯¼å…¥æ•°æ® é¡¹ç›®æ‰“åŒ… éƒ¨ç½² å‰åç«¯åˆ†åˆ«æ‰“åŒ… åç«¯æ‰“ä¸ªjaråŒ…ï¼ˆwaråŒ…ä¸åŒ…æ‹¬Tomcatï¼Œä¿®æ”¹ä¾èµ–å³å¯ï¼‰ å†™åœ¨æœ€å ä¸€ä¸ªå°ç©æ„ï¼Œç”¨äº†ä¸€äº›ä¹‹å‰å­¦åˆ°çš„å’Œæƒ³æ¥è§¦çš„ä¸œè¥¿ è·Ÿè‡ªå·±å¦å¤–å¾ˆå–œæ¬¢çš„ä¸œè¥¿åšäº†ä¸€ç‚¹ç»“åˆä¸åˆ›é€ ï¼Œè¿™å°±æ˜¯äºæˆ‘è€Œè¨€æŠ€æœ¯çš„æ„ä¹‰ æ€»ä¹‹ ğŸŠğŸ‰ğŸŠ\n","permalink":"https://Sattiluvcat.github.io/en/posts/hobbies/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E7%9A%84%E7%94%B5%E5%BD%B1%E4%B9%8B%E5%A4%9C/","summary":"åç«¯SpringBootï¼Œå‰ç«¯Vueä¸MongoDBæ•°æ®åº“","title":"ä»0å¼€å§‹çš„ç”µå½±ä¹‹å¤œ"},{"content":"Â ä»¥ä¸‹éƒ¨åˆ†ç®—æ³•å‚è€ƒVF-RRT* åŸç† æ”¹è¿›éƒ¨åˆ† æ–°ç‚¹çš„ç”Ÿæˆâ€”â€”éšæœºç‚¹æ–¹å‘ä¸å½“å‰ä½ç½®å‘é‡åœºæ–¹å‘\næœ€ä¼˜RRTè·¯å¾„â€”â€”é‡å¤ç”Ÿæˆå¤šæ¡RRTè·¯å¾„åå¯¹æ¯æ¡è·¯å¾„è®¡ç®—ä¸Šæ¸¸ç³»æ•°çš„ç§¯åˆ†ï¼Œé€‰å–èƒ½è€—æ¶ˆè€—æœ€å°‘çš„ä¸€æ¡\nå‰ªæä¼˜åŒ–â€”â€”æ¯”è¾ƒå‰ªæä¸å¦å¾—åˆ°çš„è·¯å¾„è¯„åˆ†ï¼Œåˆ¤æ–­æ˜¯å¦è¿›è¡Œå‰ªæï¼ˆåŒ…æ‹¬èƒ½è€—å½±å“ã€è·¯å¾„æ€»è½¬è§’ã€æ€»é•¿ç­‰ï¼‰\nDWAä¼˜åŒ–â€”â€”è¯„åˆ†ç³»ç»Ÿä¸­å¼•å…¥ä¸Šæ¸¸ç³»æ•°\nç”Ÿæˆæ–°èŠ‚ç‚¹ ç¡®å®šæ–¹å‘å‘é‡ï¼š\néšæœºæ–¹å‘å‘é‡ï¼šè®¡ç®—ä» ( q_{\\text{near}} ) åˆ° ( q_{\\text{rand}} ) çš„æ–¹å‘å‘é‡ ( v_{\\text{rand}} )ï¼Œå¹¶å°†å…¶å½’ä¸€åŒ–ä¸ºå•ä½å‘é‡. å‘é‡åœºæ–¹å‘å‘é‡ï¼šè·å– ( q_{\\text{near}} ) å¤„çš„å‘é‡åœºæ–¹å‘ ( F )ï¼Œå¹¶å°†å…¶å½’ä¸€åŒ–ä¸ºå•ä½å‘é‡ ( v_{\\text{field}} ). è®¡ç®—æƒé‡ï¼šç¡®å®šå‘é‡åœºæ–¹å‘å¯¹éšæœºæ–¹å‘çš„å½±å“æƒé‡ ( w )ã€‚æƒé‡çš„è®¡ç®—æ–¹æ³•å¦‚ä¸‹ï¼š\nè®¡ç®— ( v_{\\text{rand}} ) å’Œ ( v_{\\text{field}} ) ä¹‹é—´çš„å¤¹è§’ ( \\theta_{\\text{rand}} ). æ ¹æ®ä¸Šæ¸¸å‡†åˆ™å’ŒæŒ‡æ•°åˆ†å¸ƒçš„å…³ç³»ï¼Œè®¡ç®—æ–°çš„å¤¹è§’ ( \\theta_{\\text{new}} ). ä½¿ç”¨æ­£å¼¦å®šç†è®¡ç®—æƒé‡ ( w )ï¼š [ w = \\frac{|v_{\\text{rand}}| \\sin(\\theta_{\\text{rand}} - \\theta_{\\text{new}})}{|v_{\\text{field}}| \\sin(\\theta_{\\text{new}})} ] ç¡®å®šæ–°èŠ‚ç‚¹æ–¹å‘ï¼šæ ¹æ®æƒé‡ ( w )ï¼Œè®¡ç®—æ–°çš„æ–¹å‘å‘é‡ ( v_{\\text{new}} )ï¼š [ v_{\\text{new}} = \\frac{v_{\\text{rand}} + w v_{\\text{field}}}{|v_{\\text{rand}} + w v_{\\text{field}}|} ] ä»¥ä¸Šæ¥è‡ªGPTæ€»ç»“ã€‚å®é™…ç¨‹åºçš„æƒé‡è®¡ç®—ä¸­ï¼Œç®€åŒ–äº†ç›¸å…³è¿‡ç¨‹ã€‚ ä¸Šæ¸¸ç³»æ•° æ ¹æ®æŸ¯è¥¿-æ–½ç“¦èŒ¨ä¸ç­‰å¼å¾—åˆ°ï¼Œä¸Šæ¸¸ç³»æ•°æ˜¯ä¸€ä¸ªè¡¡é‡èƒ½è€—çš„æŒ‡æ ‡ï¼Œå¹¶éå®šé‡è®¡ç®—ç»“æœ $$ \\mathcal{U}(q)=\\int_0^L(|F(q(s))|-\\langle F(q(s)), \\dot{q}(s)\\rangle) d s $$ è¯„åˆ†æ ‡å‡† ä¸»è¦è€ƒè™‘èƒ½è€—æ°´å¹³ã€è·¯å¾„æ€»é•¿ä¸ç´¯è®¡è½¬è§’ç­‰å‚æ•° é—®é¢˜ä¸è§£å†³ä¸Diff Qï¼šé‡‡ç”¨VF-RRTæ–¹æ³•è¿›è¡Œè·¯å¾„è§„åˆ’è®¾è®¡ï¼Œå®é™…ä¸Šä¸åŒå‘RRTå¹¶ä¸èƒ½å®Œå…¨ç»“åˆã€‚ä¸€ä¸ªæ¯”è¾ƒæ˜æ˜¾çš„ä¾‹å­å¦‚ä¸‹å›¾ï¼Œå¯ä»¥å‘ç°ï¼Œåœ¨ä¸€ä¸ªä»¥å›¾å½¢ä¸­å¿ƒä¸ºä¸­å¿ƒæ—‹è½¬çš„å‘é‡åœºä¸­ï¼Œä»èµ·ç‚¹ã€ç»ˆç‚¹åˆ†åˆ«è¿›è¡Œè·¯å¾„æ¢ç´¢æ—¶ï¼Œæ˜¾ç„¶éƒ½æ˜¯é¡ºæ—¶é’ˆæ–¹å‘å¯»æ‰¾ã€‚æ­¤æ—¶è‹¥èµ·ç‚¹ã€ç»ˆç‚¹è·¯å¾„åœ¨éèµ·ç»ˆç‚¹ç›¸é‡ï¼Œå›æº¯æ•´æ¡è·¯å¾„ï¼Œåœ¨ä¸‹åŠæ®µä¸­æœºå™¨äººé€†å‘é‡åœºæ–¹å‘å‰è¿›ï¼Œè‹¥åœ¨èµ·ç»ˆç‚¹ç›¸é‡ï¼Œåˆ™åŒå‘æ ‘æ— æ„ä¹‰ã€‚ RESï¼šä»ç»ˆç‚¹å‡ºå‘çš„æ ‘ï¼Œè§†å‘é‡åœºä¸ºåå‘ï¼Œåˆ™ç»ˆç‚¹æ ‘å¯ä»¥ä»¥é€†æ—¶é’ˆæ–¹å‘ç”Ÿæˆï¼Œå¯ä»¥å¾—åˆ°å¦‚ä¸‹ç»“æœï¼Œè®¤ä¸ºå¯ä»¥è§£å†³è¯¥é—®é¢˜ã€‚ Diffï¼šç›¸å¯¹äºRRTï¼Œé‡‡ç”¨ä¸¤æ£µæ ‘åˆ†åˆ«ç”Ÿæˆä¸¤ä¸ªéšæœºç‚¹åå»¶ç”³çš„ç­–ç•¥ï¼Œå®é™…ä¸Šå¯¹ç»“æœçš„å½±å“ä¸å¤§ã€‚ Qï¼šå‰ªææ•ˆæœä¸ä½³ï¼Œä¸ºä½•ï¼Ÿ RESï¼šå¾ˆå¤šåŸå› ã€‚å…¶ä¸€ï¼Œå‰ªæè¯„åˆ†å‡½æ•°ä¸­å‚æ•°å½’ä¸€åŒ–åè¿‡å°ï¼Œç²¾åº¦ä¸¢å¤±ï¼Œä»ç»ˆç‚¹å¼€å§‹æ‰¾ï¼Œå®¹æ˜“æ‰¾åˆ°è¿‡å¤§çš„ç‚¹ï¼Œå› æ­¤é€‰æ‹©ä¸å½’ä¸€åŒ–ï¼›å…¶äºŒï¼Œè®¡ç®—è§’åº¦ï¼Œåšè½¬è§’çº¦æŸçš„æ–¹æ³•å®šä¹‰é”™è¯¯ï¼Œå¯¼è‡´æ‹¦æˆªäº†å¾ˆå¤šä¸è¯¥æ‹¦æˆªçš„ç‚¹ï¼›å…¶ä¸‰ï¼Œæ·»åŠ è·¯å¾„ã€è¿æ¥è·¯å¾„ç­‰å°partå‡ºç°é”™è¯¯ã€‚ä»¥ä¸Šæ”¹æ­£åæœ€ç»ˆå¯ä»¥å¾—åˆ°ä¸‹å›¾æ•ˆæœã€‚ï¼ˆæ›´æ–°è¯„åˆ†å‡½æ•°ä¸­çš„ä¸€ã€ä¸‰é¡¹å æ¯”ï¼Œæ¯”å¦‚å‡å–0.1ï¼Œå¾—åˆ°æ›´è´´åˆåŸè·¯å¾„çš„ç»“æœï¼Œå‡å–0.3ï¼Œå¾—åˆ°ä¸åŸå‰ªæå‡½æ•°ç±»ä¼¼çš„ç»“æœï¼‰ Qï¼šDWAè®¡ç®—æ—¶æ— è§†äº†éšœç¢ç‰©ã€‚ RESï¼šDWAçš„éšœç¢ç‰©costè®¡ç®—å‡½æ•°ä¸­ï¼ŒåŸæœ¬çš„é€šè¿‡è½¨è¿¹é•¿åº¦å¾—åˆ°forå¾ªç¯é•¿åº¦çš„æ–¹æ³•å·²ä¸é€‚ç”¨ï¼Œå¾—åˆ°çš„æ˜¯-1ï¼Œæ”¹ä¸ºäººä¸ºæŒ‡å®šçš„å‰ 2 æ­¥ç»“æœå³å¯ã€‚ å®ç° ä»¥ä¸‹ä¸»è¦èµ·åˆ° demo ä½œç”¨ï¼Œæœ‰ä¸€äº› TODO å°šæœªå®Œæˆï¼Œå¹¶éæœ€ç»ˆç‰ˆ\nç”Ÿæˆæ–°èŠ‚ç‚¹\ndef vf_generate_new_node(nearest_node, random_node, extend_length, vector_field): # è·å–æœ€è¿‘èŠ‚ç‚¹åˆ°éšæœºç‚¹çš„æ–¹å‘å‘é‡ direction_to_random = Â·Â·Â· # è·å–æœ€è¿‘èŠ‚ç‚¹å¤„çš„å‘é‡åœºæ–¹å‘ u, v = get_vector_field(nearest_node.x, nearest_node.y, vector_field) direction_vector_field = np.array([u, v]) # TODO æ–¹å‘é€‰å–çš„ä¼˜åŒ– # ä¸¤ä¸ªæ–¹å‘å‘é‡çš„åŠ æƒå¹³å‡æ–¹å‘ average_direction_vector = (direction_to_random*4 + direction_vector_field) / 5 # å½’ä¸€åŒ–å¹³å‡æ–¹å‘å‘é‡ average_direction_vector /= np.linalg.norm(average_direction_vector) # æ ¹æ®è¿™ä¸ªå¹³å‡æ–¹å‘ç”Ÿæˆæ–°èŠ‚ç‚¹ new_x = nearest_node.x + extend_length * average_direction_vector[0] new_y = nearest_node.y + extend_length * average_direction_vector[1] new_node = Node(new_x, new_y) new_node.parent = nearest_node return new_node è®¡ç®—ä¸Šæ¸¸ç³»æ•°\ndef upstream_criterion(path, vector_field): total_difference = 0 for i in range(1, len(path)): # å½“å‰ä½ç½®çš„å‘é‡åœº u, v = get_vector_field(path[i][0], path[i][1], vector_field) vector_field_magnitude = np.sqrt(u**2 + v**2) # å½“å‰é€Ÿåº¦æ–¹å‘â€”â€”è·¯å¾„æ±‚å¯¼ direction_path = np.gradient(np.array(path), axis=0)[i] path_magnitude = np.linalg.norm(direction_path) # å½’ä¸€åŒ–é€Ÿåº¦æ–¹å‘ --\u0026gt; éœ€è¦ï¼Œå› ä¸ºå‘é‡åœºæœ¬èº«å·²ç»å½’ä¸€åŒ– --\u0026gt; åº”ç”¨ä¸ç­‰å¼æ—¶ä¸¤è€…æ¨¡é•¿ç›¸ç­‰ï¼Œå‡ä¸º1 direction_path /= path_magnitude # Cauchy-Schwarz ä¸ç­‰å¼: |a Â· b| \u0026lt;= ||a|| * ||b|| dot_product = np.dot(direction_path, direction_vector_field) # ğŸ‘†å½’ä¸€åŒ–åç›´æ¥å– 1 å³å¯ total_difference += Â·Â·Â· return total_difference å‰ªææ›´æ–°\ndef vf_prune_path(path, obs_list, vector_field): pruned_path = [path[0]] i = 0 while i \u0026lt; len(path) - 1: found = False for j in range(len(path) - 1, i, -1): # TODO è½¬è§’çº¦æŸ if not check_collision(path[i], path[j], obs_list): # ç°æœ‰ä¼˜åŒ–è·¯å¾„+ç°åœ¨è€ƒè™‘çš„è·¯å¾„ä¸å‰ªæå½¢å¼ï¼Œè¯„åˆ†åæ¯”è¾ƒ Â·Â·Â· pruned_path.append(path[j]) i = j found = True break if not found: i += 1 if pruned_path[-1] != path[-1]: pruned_path.append(path[-1]) return pruned_path å‰ªæè¯„åˆ†\ndef path_score(path, vector_field): total_difference = 0 total_angle = 0 # TODO è¯„åˆ†ç»†åˆ™ for i in range(len(path) - 1): # æœ€å¤§å€¼æ˜¯ len(path) - 2 u, v = get_vector_field(path[i][0], path[i][1], vector_field) direction_vector_field = np.arctan2(v, u) direction_path = np.arctan2(path[i + 1][1] - path[i][1], path[i + 1][0] - path[i][0]) total_difference += abs(direction_path - direction_vector_field) if i \u0026lt; len(path) - 2: angle = abs(np.arctan2(path[i + 2][1] - path[i + 1][1], path[i + 2][0] - path[i + 1][0]) - direction_path) total_angle += angle return total_difference + total_angle ","permalink":"https://Sattiluvcat.github.io/en/posts/else/vf-rrt/","summary":"å°†æµåœºè§†ä¸ºå‘é‡åœºçš„RRTç®—æ³•","title":"VF-RRT"},{"content":"Â æ•°æ®åº“ åŸºæœ¬ æ•°æ®åº“ å¸¸è§åè¯ å…ƒç»„â€”â€”ä¸€æ¡è®°å½•å°±æ˜¯ä¸€ä¸ªå…ƒç»„ï¼ˆä¸€è¡Œï¼‰ ç â€”â€”å”¯ä¸€æ ‡è¯†å®ä½“çš„å±æ€§ï¼ˆä¸€åˆ—ï¼‰ å€™é€‰ç â€”â€”å€™é€‰çš„å¯ä»¥å”¯ä¸€æ ‡è¯†å…ƒç»„çš„ç ï¼ˆä¸”ä¸åŒ…æ‹¬å¤šä½™å±æ€§â€”â€”å¦åˆ™ä¸ºè¶…é”®ï¼Œå…¶å®ä¹Ÿæ˜¯è¶…é”®çš„ä¸€ç§ï¼‰ ä¸»ç â€”â€”ä¸»é”® å¤–ç â€”â€”å¦å¤–å…³ç³»ä¸­çš„ä¸»ç  ä¸»å±æ€§ï¼ˆå¯ä»¥å½“å€™é€‰ç çš„ï¼‰ éä¸»å±æ€§ï¼ˆä¸åŒ…å«åœ¨ä»»ä½•å€™é€‰ç çš„å±æ€§ï¼‰ ERå›¾â€”â€”å®ä½“è”ç³»å›¾ åŒ…æ‹¬ï¼šå®ä½“ å±æ€§ è”ç³»ï¼ˆå®ä½“ä¸å®ä½“é—´çš„å…³ç³»ï¼‰ å½¢çŠ¶ï¼šçŸ©å½¢ æ¤­åœ† è±å½¢ï¼ˆä¸€ä¸€å¯¹åº”ï¼‰ èŒƒå¼ï¼š1NFï¼ˆç¬¬ä¸€èŒƒå¼ï¼‰ 2NF 3NF 1NF:å­—æ®µæœ‰åŸå­æ€§ æ•°æ®ä¸å¯å†åˆ†ï¼ˆæ¯æ ¼æ•°æ®ä¸å¯å†åˆ†ï¼‰ 2NFï¼šæ¶ˆé™¤éä¸»å±æ€§å¯¹ç çš„éƒ¨åˆ†å‡½æ•°ä¾èµ–ï¼ˆ= å®Œå…¨ä¾èµ–ï¼‰ ä¸€å¼ è¡¨ä¸­ Xç¡®å®š Yå¿…ç¡®å®š = X\u0026ndash;\u0026gt;Yï¼ˆYå‡½æ•°ä¾èµ–äºXï¼‰ X çš„çœŸå­é›† Xo\u0026ndash;\u0026gt;Yï¼ˆY éƒ¨åˆ†å‡½æ•°ä¾èµ–äº Xï¼‰â€”â€”æ•°æ®å†—ä½™ CUD å¼‚å¸¸ CRUD create read update delete å®Œå…¨ä¾èµ–ï¼š(X,Y)\u0026ndash;\u0026gt;Z ä½†X Yå•ä¸ªéƒ½ä¸å¯ä¾èµ– 3NF:æ‰€æœ‰éä¸»é”®å±æ€§é—´ä¸èƒ½ä¾èµ– å¿…ç›¸äº’ç‹¬ç«‹ å¤–é”®ä¸çº§è”ï¼š çº§è”æ›´æ–°\u0026amp;åˆ é™¤ï¼šæ›´æ–°/åˆ é™¤æŸä¸»é”® è‹¥å…¶è¢«å…¶ä»–è¡¨å¼•ç”¨ åˆ™éœ€æ›´æ–°/åˆ é™¤æ‰€æœ‰å¼•ç”¨è®°å½• delete vs drop vs truncate ç”¨æ³•ï¼šdropä¸¢å¼ƒï¼ˆtableï¼‰ truncateæ¸…ç©ºæ•°æ® idå›åˆ°1 deleteåˆ é™¤æ•°æ®ï¼ˆè¡Œï¼‰idæ— å½±å“ deleteå¯ä»¥å›æ»š äº‹åŠ¡æäº¤åç”Ÿæ•ˆï¼ˆä¼šäº§ç”Ÿæ—¥å¿—ï¼‰ dropé‡Šæ”¾è¡¨ç©ºé—´ truncateä¸äº§ç”Ÿæ—¥å¿—ï¼ˆä¸èƒ½å›æ»š NoSQL ä¸SQLçš„åŒºåˆ«ï¼š éç»“æ„åŒ–å­˜å‚¨ vs ç»“æ„åŒ–å­˜å‚¨ï¼ˆå›ºå®šè¡Œå’Œåˆ—ï¼‰ é€šå¸¸ä¸æ”¯æŒACID vs ACID MongoDBæ”¯æŒ ä½†æœ‰æ‰€åŒºåˆ« atom consistency isolation durability balabal vs æ€§èƒ½å–å†³äºç£ç›˜å­ç³»ç»Ÿ ä¼˜åŒ–æŸ¥è¯¢ ç´¢å¼• è¡¨ç»“æ„ç­‰è·å¾—æœ€ä½³æ€§èƒ½ æ¨ªå‘æ‹“å±•ï¼ˆåŸºäºåˆ†ç‰‡æœºåˆ¶â€”â€”æ°´å¹³åˆ†å‰² ä»¥è¡Œä¸ºå•ä½åˆ†å‰²å¹¶åˆ†å¼€å­˜å‚¨ï¼‰ vs å‚ç›´ï¼ˆè¯»å†™åˆ†ç¦» åˆ†åº“åˆ†è¡¨ Â·Â·Â·ï¼‰ ç‰¹ç‚¹ï¼šçµæ´» å¯æ‹“å±• é«˜æ€§èƒ½ ç±»å‹ï¼šæ–‡æ¡£ é”®å€¼ å›¾å½¢ å®½åˆ— å­—ç¬¦é›† utf8 utf8mb4\nå­—ç¬¦é›†åˆ eg.ASCII UTF(Unicode) UTF-8 = 8æ¯”ç‰¹UTFï¼ˆä¸€ä¸ªå­—æœ€å¤šå 3å­—èŠ‚ï¼‰ UTF8mb4 = ä¸€ä¸ªå­—æœ€å¤šå æ®4å­—èŠ‚çš„utf8 MysqlæŒ‡å®šå­—ç¬¦é›†ä¼˜å…ˆçº§ server-æ•°æ®åº“-è¡¨-å­—æ®µcolumnæ¸å¢ è¿æ¥å­—ç¬¦é›†ï¼šå®¢æˆ·ç«¯ä¸æœåŠ¡å™¨æ²Ÿé€šæ—¶ç›¸äº’ç¿»è¯‘é€‰æ‹©çš„å­—ç¬¦é›† JDBCï¼ˆJavaæ“æ§æ•°æ®åº“çš„apiï¼‰é©±åŠ¨ä¼šå½±å“è¿æ¥å­—ç¬¦é›† SQL database\u0026ndash;\u0026gt;table\u0026ndash;\u0026gt;schema(ok for table/db)\u0026ndash;\u0026gt;column\u0026ndash;\u0026gt;row\u0026ndash;\u0026gt;primary key\næ³¨æ„ï¼šæ‰€æœ‰ç©ºæ ¼éƒ½è¢«å¿½ç•¥ è¿æ¥JOINå…³é”®å­— ONæŒ‡å®šè¿æ¥æ¡ä»¶ï¼ˆæœ€ç»ˆç”Ÿæˆä¸´æ—¶è¡¨ï¼‰ left rightå…³é”®è¯\u0026ndash;\u0026gt;å³ä½¿å³/å·¦è¡¨æ²¡æœ‰æ»¡è¶³æ¡ä»¶çš„è¡Œä¹Ÿè¿”å›å·¦/å³è¡¨ä¸­çš„æ‰€æœ‰è¡Œ select something from table1 join table2 on table1.id=table2.id; ç´¢å¼• äº‹åŠ¡ ä¾‹é¢˜ï¼ˆçª—å£å‡½æ•°balabalç•¥ï¼‰ MySql åŸºç¡€ åè¯ï¼š å…³ç³»å‹æ•°æ®åº“ï¼šåŸºäºå…³ç³»æ¨¡å‹çš„æ•°æ®åº“ å…³ç³»æ¨¡å‹è¡¨æ˜dbä¸­å­˜å‚¨æ•°æ®é—´çš„è”ç³» SQLï¼šç»“æ„åŒ–æŸ¥è¯¢è¯­è¨€ å­—æ®µ å­—æ®µç±»å‹ æ•°å€¼ å­—ç¬¦ä¸² æ—¥æœŸ DECIMAL vs FLOAT/DOUBLE \u0026ndash;\u0026gt; é¿å…ç²¾åº¦æŸå¤± whyï¼šTEXT BLOBä¸å»ºè®®ï¼Ÿ ä¸å¸¸ç”¨ï¼štext â‰ˆ é•¿æ–‡æœ¬çš„char varchar \u0026amp; blob = äºŒè¿›åˆ¶å¤§å¯¹è±¡ ç¼ºç‚¹ï¼šä¸èƒ½æœ‰é»˜è®¤å€¼ \u0026amp; æ™ºèƒ½åœ¨ç£ç›˜ä¸Šåˆ›å»ºä¸´æ—¶è¡¨ \u0026amp; æ£€ç´¢æ•ˆç‡ä½ diffï¼šNULL vs '' NULLä»£è¡¨ä¸€ä¸ªä¸ç¡®å®šçš„å€¼\u0026ndash;\u0026gt;ä¸èƒ½ç”¨= != \u0026gt; \u0026lt;ç­‰è¿ç®—ç¬¦ \u0026amp; NULL=NULL ==\u0026gt; False åªèƒ½ç”¨is NULL / is not NULLæŸ¥è¯¢ ''é•¿åº¦ä¸º0 ä¸å ç”¨ç©ºé—´ vs NULLè¦å ç”¨ç©ºé—´ howï¼šbooleanç±»å‹ï¼Ÿ tinyintç±»å‹\u0026ndash;\u0026gt;åªèƒ½å­˜å‚¨0 or 1 æ¶æ„ whatï¼šæ‰§è¡Œsqlè¯­å¥çš„æµç¨‹ï¼Ÿ è¿æ¥å™¨â€”â€”èº«ä»½è®¤è¯\u0026amp;æƒé™ æŸ¥è¯¢ç¼“å­˜ï¼ˆmysql8.0åç§»é™¤ï¼‰ æœªå‘½ä¸­åæ‰§è¡Œä¸‹è¿°æµç¨‹ åˆ†æå™¨â€”â€”æ£€æŸ¥è¯­æ³•Â·Â·Â· ä¼˜åŒ–å™¨â€”â€”é€‰æ‹©æœ€ä¼˜æ‰§è¡Œæ–¹æ¡ˆ æ‰§è¡Œå™¨â€”â€”æ‰§è¡Œå‰å…ˆåˆ¤æ–­æœ‰å¦æƒé™ æ— æƒé™åˆ™æŠ¥é”™ æœ‰åˆ™ä»å­˜å‚¨å¼•æ“è¿”å›æ•°æ® æ’ä»¶å¼å­˜å‚¨å¼•æ“â€”â€”æ•°æ®çš„å­˜å‚¨ä¸è¯»å– æ”¯æŒInnoDB MyIsam Â·Â·Â· æ‰§è¡Œå™¨ä¸å­˜å‚¨å¼•æ“äº¤äº’ ç´¢å¼•ä¸‹æ¨ï¼šMySql5.6 åœ¨è”åˆç´¢å¼•éå†è¿‡ç¨‹ä¸­ï¼Œå¯¹è”åˆç´¢å¼•ä¸­åŒ…å«çš„å­—æ®µå…ˆåšåˆ¤æ–­ ç´¢å¼•â­â­ åˆ†ç±» æ•°æ®ç»“æ„ åˆ†ç±»ï¼š B+æ ‘â€”â€”ä¸»é”®ç´¢å¼•å’ŒäºŒçº§ç´¢å¼•é»˜è®¤ Hash Full-Text B+ï¼šæ¯ä¸ªèŠ‚ç‚¹å­˜æ”¾æŒ‰ä¸»é”®é¡ºåºçš„æ•°æ® å¶å­èŠ‚ç‚¹å½¢æˆåŒå‘é“¾è¡¨ï¼ˆä¸‹å›¾æ¥è‡ªå°æ—codingï¼Œç½‘å€https://www.xiaolincoding.com/ï¼‰ ç´¢å¼•ä¸æ•°æ®å­˜å‚¨åœ¨ç£ç›˜ è¯»å–ä¸€ä¸ªèŠ‚ç‚¹ = è¿›è¡Œä¸€æ¬¡ç£ç›˜I/O Bæ ‘ = æ²¡æœ‰åŒå‘é“¾è¡¨çš„B+æ ‘ ä¸»é”®ç´¢å¼•çš„æ ‘çš„å¶å­å­˜æ”¾å®é™…æ•°æ® äºŒçº§ç´¢å¼•çš„å¶å­å­˜æ”¾ä¸»é”®å€¼ï¼ˆè™½ç„¶æ˜¯æŒ‰ä¸»é”®é¡ºåº ä½†è¡¨ç¤ºè¿˜æ˜¯æŒ‰äºŒçº§ç´¢å¼•é€‰ç”¨çš„ç‰©ç†é‡eg.å­¦å· æ¥è¡¨ç¤ºï¼‰ äºŒçº§ç´¢å¼•æŸ¥æ•°æ® = äºŒçº§ç´¢å¼•æ ‘\u0026ndash;\u0026gt;ä¸»é”®æ ‘ï¼ˆæ­¤è¿‡ç¨‹å³ä¸ºå›è¡¨ï¼‰ B+ä¼˜åŠ¿ï¼š B+ vs Bï¼šBæ ‘éå¶å­èŠ‚ç‚¹ä¹Ÿè¦å­˜å‚¨æ•°æ®ï¼ˆç›¸åŒç£ç›˜IO b+èƒ½æŸ¥æ›´å¤šèŠ‚ç‚¹ï¼‰ ä¸”æ²¡æœ‰åŒå‘é“¾è¡¨ï¼ˆä¸èƒ½é¡ºåºæŸ¥æ‰¾ï¼‰ vs äºŒå‰æ ‘ï¼šb+æœç´¢å¤æ‚åº¦ $log_dN$ Nä¸ªèŠ‚ç‚¹ æ¯ä¸ªèŠ‚ç‚¹æœ€å¤§å­èŠ‚ç‚¹dä¸ªï¼ˆä¸€èˆ¬å¤§äº100ï¼‰â€”â€”åƒä¸‡çº§å¯¹åº”3-4å±‚ vs Hashï¼šhashåªé€‚åˆç­‰å€¼æŸ¥è¯¢ ç‰©ç†å­˜å‚¨ èšç°‡ç´¢å¼•ï¼ˆä¸»é”®ç´¢å¼•ï¼‰ äºŒçº§ç´¢å¼•ï¼ˆè¾…åŠ©/éèšç°‡ï¼‰ èšç°‡ = ä¸»é”®ï¼šæ‰¾åˆ°ç´¢å¼•å°±æ‰¾åˆ°äº†æ•°æ® æœ‰ä¸»é”®å°±æ˜¯ä¸»é”® æ— ä¸»é”®é€‰ç¬¬ä¸€ä¸ªä¸å«NULLçš„å”¯ä¸€åˆ— ä¹Ÿæ²¡æœ‰åˆ™InnoDBè‡ªåˆ›éšå¼è‡ªå¢IDåˆ— éèšç°‡ï¼šç”¨æ­¤ç´¢å¼•ä¸èƒ½æ‰¾åˆ°æ•°æ®ï¼ˆåªæ‰¾åˆ°ä¸»é”®ï¼‰ éœ€è¦å›è¡¨æŸ¥è¯¢ å­—æ®µç‰¹æ€§ ä¸»é”®ç´¢å¼• å”¯ä¸€ç´¢å¼•ï¼ˆå»ºç«‹åœ¨UNIQUEå­—æ®µä¸Šï¼‰ æ™®é€šç´¢å¼• å‰ç¼€ç´¢å¼• å‰ç¼€ç´¢å¼•ï¼šé’ˆå¯¹å­—ç¬¦ç±»å‹å­—æ®µçš„å‰å‡ ä¸ªå­—ç¬¦å»ºç«‹ å­—æ®µä¸ªæ•° å•åˆ—ç´¢å¼• è”åˆç´¢å¼• è”åˆç´¢å¼•ï¼šå¤šä¸ªå­—æ®µç»„åˆ eg.(product_no,name) æœ‰å…ˆåé¡ºåº è”åˆç´¢å¼•çš„æœ€å·¦åŒ¹é…ï¼šæŒ‰æœ€å·¦ä¼˜å…ˆçš„æ–¹å¼è¿›è¡ŒåŒ¹é… å…ˆæ‰¾product_no åæ‰¾name è‹¥æŸselectåªæœ‰nameåˆ™è¯¥ç´¢å¼•å¤±æ•ˆ è”åˆç´¢å¼•çš„æœ€å·¦åŒ¹é…é‡åˆ°èŒƒå›´æŸ¥è¯¢åå¤±æ•ˆ èŒƒå›´æŸ¥è¯¢è‡ªèº«è¿˜æœ‰æ•ˆ ä½†è‹¥èŒƒå›´æŸ¥è¯¢ä¸­æœ‰= åˆ™è¿˜å¯ä»¥å‘åæŸ¥è¯¢ï¼ˆå‡†ç¡®æ¥è¯´ç”¨è”åˆç´¢å¼•å‘åæŸ¥çš„å°±åªæœ‰=çš„æƒ…å†µï¼‰ è”åˆç´¢å¼•æœ€å¥½æŠŠåŒºåˆ†åº¦å¤§çš„æ”¾å‰é¢ï¼ˆdistinctå¤šçš„ å¦‚UUIDï¼‰ åœ¨CS186ä¸­å®ç°çš„æ˜¯å•åˆ—ç´¢å¼• é”®DataBox key å€¼ï¼ˆå¶å­èŠ‚ç‚¹ï¼‰RecordIdï¼ˆå”¯ä¸€æ ‡è¯†ç¬¦ï¼‰ ä¹Ÿæ²¡æœ‰æå‰æ’åº\nåº”ç”¨ ç¼ºç‚¹ï¼šå ç”¨ç‰©ç†ç©ºé—´ï¼ˆç£ç›˜ï¼‰+åˆ›å»ºä¸ç»´æŠ¤è€—æ—¶+é™ä½å¢åˆ æ”¹æ•ˆç‡ é€‚ç”¨ç´¢å¼•çš„æƒ…å†µï¼šUNIQUEå­—æ®µ / ç»å¸¸ç”¨äºwhere/order by/group byçš„å­—æ®µ ä¸é€‚ç”¨ï¼šå¤§é‡é‡å¤/ä¸æ€ä¹ˆä½¿ç”¨ä¸Šè¿°ä¸‰ç§/è¡¨æ•°æ®å¤ªå°‘/ç»å¸¸æ›´æ–°çš„ ä¼˜åŒ–æ–¹æ³•ï¼šå‰ç¼€ç´¢å¼•ä¼˜åŒ– è¦†ç›–ç´¢å¼•ä¼˜åŒ– ä¸»é”®ç´¢å¼•æœ€å¥½æ˜¯è‡ªå¢çš„ é˜²æ­¢ç´¢å¼•å¤±æ•ˆ å‰ç¼€ç´¢å¼•å±€é™æ€§ï¼šorder byä¸èƒ½ç”¨ï¼ˆå‰ç¼€åé¢çš„é¡ºåºä¸ä¸€å®šå¯¹ï¼‰ \u0026amp; ä¸èƒ½ç”¨ä½œè¦†ç›–ç´¢å¼• è¦†ç›–ç´¢å¼•ï¼šæŸ¥è¯¢çš„æ‰€æœ‰å­—æ®µï¼Œåœ¨B+çš„å¶å­èŠ‚ç‚¹ä¸Šéƒ½èƒ½æ‰¾åˆ°ï¼ˆä¸ç”¨å›è¡¨ï¼‰ ä¸»é”®ç´¢å¼•æœ€å¥½è‡ªå¢â€”â€”æ’å…¥æ–¹ä¾¿ï¼ˆä¸»é”®å­—æ®µä¸è¦å¤ªé•¿ äºŒçº§ç´¢å¼•å¶å­èŠ‚ç‚¹å¯ä»¥æ›´å°ï¼‰ å¯èƒ½ç´¢å¼•å¤±æ•ˆçš„æƒ…å†µï¼šï¼ˆinåæ¡ä»¶è¿‡å¤šï¼Œå¯¼è‡´ä¼˜åŒ–å™¨è¿›è¡ŒæŸ¥è¯¢ä¼˜åŒ–æ—¶éœ€è¦çš„å†…å­˜è¶…è¿‡å†…å­˜é™åˆ¶\u0026ndash;\u0026gt;å…¨è¡¨æ‰«æ å¯è®¾ç½®rangeoptimizermaxmemsizeï¼‰ like %Â·Â· ç±»ä¼¼æœ€å·¦å‰ç¼€ï¼ˆæ‰€ä»¥æ˜¯å·¦æ¨¡ç³Š/å·¦å³æ¨¡ç³Šæ—¶å¤±æ•ˆï¼‰ å¯¹ç´¢å¼•åˆ—åšäº†è®¡ç®— å‡½æ•° ç±»å‹è½¬æ¢æ“ä½œ è”åˆç´¢å¼•çš„æœ€å·¦å‰ç¼€ whereä¸­ è‹¥orå‰æ¡ä»¶ä¸ºç´¢å¼•åˆ— oråä¸æ˜¯ åˆ™å¤±æ•ˆï¼šä¼˜åŒ–å™¨åœ¨å¤„ç†ORæ“ä½œç¬¦æ—¶ï¼Œé€šå¸¸ä¼šé€‰æ‹©ä¸€ç§èƒ½å¤Ÿå¤„ç†æ‰€æœ‰æ¡ä»¶çš„æ‰§è¡Œè®¡åˆ’ äº‹åŠ¡â­â­ ç‰¹æ€§ï¼šACID ç‰¹æ€§ï¼šåŸå­æ€§ï¼ˆè¦ä¹ˆå…¨éƒ¨å®Œæˆ è¦ä¹ˆå…¨éƒ¨ä¸å®Œæˆï¼‰ ä¸€è‡´æ€§ï¼ˆäº‹åŠ¡æ“ä½œå‰åï¼Œæ•°æ®æ»¡è¶³å®Œæ•´æ€§çº¦æŸï¼‰ éš”ç¦»æ€§ï¼ˆå…è®¸å¤šä¸ªå¹¶å‘äº‹åŠ¡åŒæ—¶å¯¹å…¶æ•°æ®è¿›è¡Œè¯»å†™å’Œä¿®æ”¹ï¼‰ æŒä¹…æ€§ï¼ˆäº‹åŠ¡å¤„ç†ç»“æŸåï¼Œå¯¹æ•°æ®çš„ä¿®æ”¹å°±æ˜¯æ°¸ä¹…çš„ï¼‰ å®ç°ï¼šAâ€”â€”undo log Iâ€”â€”MVCC/é” Dâ€”â€”redo log Câ€”â€”å‰è€…å…±åŒä¿è¯ CS186ä¸­å¹¶å‘é‡‡ç”¨é”æœºåˆ¶ æ¢å¤é‡‡ç”¨ARIESæ¨¡å‹ï¼ˆå„ç§æ—¥å¿—ï¼‰\néš”ç¦»æ€§ å¹¶è¡Œäº‹åŠ¡å¯èƒ½å¼•å‘çš„é—®é¢˜ï¼š ä¸å¯é‡å¤è¯»RRæ˜¯é’ˆå¯¹æ™®é€šæŸ¥è¯¢è€Œè¨€çš„ï¼Œå¯¹å…¶å®ƒæƒ…å†µéƒ½ç”¨å½“å‰è¯»ã€‚æ‰€ä»¥InnoDBä¸­çš„RRåªä¿è¯æ™®é€šæŸ¥è¯¢æ—¶å‰åä¸¤ä¸ªæ•°æ®ä¸€è‡´ï¼Œä¸ä¿è¯selectÂ·Â·Â·for updateä¸selectä¸€è‡´\nè„è¯»â€”â€”äº‹åŠ¡Bè¯»åˆ°äº‹åŠ¡Aä¿®æ”¹äº†ä½†æœªæäº¤çš„æ•°æ®ï¼ˆAå¯èƒ½å›æ»š Bè¯»åˆ°çš„å°±æ˜¯è¿‡æœŸæ•°æ®ï¼‰ ä¸å¯é‡å¤è¯»â€”â€”äº‹åŠ¡Aå¤šæ¬¡è¯»åŒä¸ªæ•°æ® å‰åä¸¤æ¬¡è¯»åˆ°çš„æ•°æ®ä¸ä¸€æ ·ï¼ˆå¯¹åº”ä¿®æ”¹è¡Œï¼‰ å¹»è¯»â€”â€”åœ¨ä¸€ä¸ªäº‹åŠ¡å†…å¤šæ¬¡æŸ¥è¯¢æŸä¸ªç¬¦åˆæŸ¥è¯¢æ¡ä»¶çš„ã€Œè®°å½•æ•°é‡ã€ æŸ¥è¯¢åˆ°çš„æ•°é‡ä¸åŒï¼ˆå¯¹åº”å¢åˆ è¡Œï¼‰ ä¸¥é‡æ€§ï¼šä»ä¸Šåˆ°ä¸‹é€’å‡ éš”ç¦»çº§åˆ«ï¼šä»ä¸Šè‡³ä¸‹é€’å¢ï¼ˆæ•ˆç‡é€’å‡ï¼‰ è¯»æœªæäº¤â€”â€”å¯è¯»åˆ°æœªæäº¤çš„äº‹åŠ¡ è¯»æäº¤â€”â€”åªèƒ½è¯»å·²æäº¤çš„äº‹åŠ¡ å¯é‡å¤è¯»â€”â€”ä¸€ä¸ªäº‹åŠ¡æ‰§è¡Œè¿‡ç¨‹çœ‹åˆ°çš„æ•°æ®ä¿æŒä¸å˜ï¼ˆInnoDBé»˜è®¤çº§åˆ«ï¼‰ ä¸²è¡ŒåŒ–â€”â€”åŠ è¯»å†™é” è¯»å†™å†²çªæ—¶ åè®¿é—®çš„äº‹åŠ¡ç­‰å‰ä¸€ä¸ªå®Œæˆåæ‰èƒ½æ‰§è¡Œ InnoDBå¯ä»¥å¾ˆå¤§ç¨‹åº¦ä¸Šé¿å…å¹»è¯» å…¶ï¼ˆInnoDBï¼‰å®ç°ï¼š å¿«ç…§è¯»æ˜¯MVCCçš„åŠŸèƒ½ \u0026ndash;\u0026gt; MVCCçš„æ ¸å¿ƒéƒ¨åˆ†æœ‰Read View \u0026ndash;\u0026gt; Read Viewèƒ½å®ç°è¯»æäº¤ä¸å¯é‡å¤è¯»\nå¿«ç…§è¯»ï¼ˆæ™®é€šselectè¯­å¥ï¼‰â€”â€”MVCC å¯é‡å¤è¯»æ¡ä»¶ä¸‹ æ’å…¥çš„æ•°æ®æ— æ³•æŸ¥è¯¢ å½“å‰è¯»ï¼ˆå…¶å®ƒè¯­å¥ å¦‚select Â·Â·Â· for update updateæ—¶è¦è·å¾—æœ€æ–°çš„æ•°æ®ï¼‰â€”â€”é€šè¿‡è®°å½•é”+é—´éš™é”(next-key lock)è§£å†³ åœ¨äºŒé”çš„èŒƒå›´å†…æ’å…¥çš„æ•°æ®è¢«é˜»å¡ æ— æ³•æˆåŠŸæ’å…¥ Read View in MVCC,how to work? é€šè¿‡ç‰ˆæœ¬é“¾æ§åˆ¶å¹¶å‘äº‹åŠ¡è®¿é—®åŒä¸ªè®°å½• = MVCCï¼ˆå¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶ï¼‰ ReadViewå››ä¸ªå­—æ®µï¼š m_idsï¼šå½“å‰æ•°æ®åº“ã€Œæ´»è·ƒäº‹åŠ¡ã€ï¼ˆå¯åŠ¨äº†æœªæäº¤ï¼‰çš„äº‹åŠ¡ id åˆ—è¡¨ min_trx_idï¼šã€Œæ´»è·ƒäº‹åŠ¡ã€ä¸­äº‹åŠ¡ id æœ€å°çš„äº‹åŠ¡ max_trx_idï¼šåˆ›å»ºRVæ—¶å…¨å±€äº‹åŠ¡ä¸­æœ€å¤§çš„äº‹åŠ¡ id å€¼ + 1ï¼ˆRVæ²¡ç…§åˆ°çš„äº‹åŠ¡ï¼‰ creator_trx_idï¼šåˆ›å»ºè¯¥ Read View çš„äº‹åŠ¡çš„ id èšç°‡ç´¢å¼•çš„ä¸¤ä¸ªéšè—åˆ—ï¼š trx_idï¼šå½“ä¸€ä¸ªäº‹åŠ¡å¯¹æŸæ¡èšç°‡ç´¢å¼•è®°å½•è¿›è¡Œæ”¹åŠ¨æ—¶ï¼ŒæŠŠè¯¥äº‹åŠ¡çš„ id è®°å½•åœ¨æ­¤å¤„ roll_pointerï¼šå¯¹èšç°‡ç´¢å¼•è®°å½•æ”¹åŠ¨æ—¶ æŠŠæ—§ç‰ˆæœ¬çš„è®°å½•å†™å…¥undo log æ­¤éšè—åˆ—ä½œä¸ºæŒ‡é’ˆæŒ‡å‘è¯¥æ—§ç‰ˆæœ¬è®°å½•ï¼ˆsoå¯ä»¥æ‰¾åˆ°åæ¢å¤ï¼‰ ä¸€ä¸ªäº‹åŠ¡è®¿é—®è®°å½•æ—¶ï¼šï¼ˆè‡ªå·±çš„è®°å½•æ€»æ˜¯å¯è§ï¼‰ trxId\u0026lt;minï¼šè¯¥è®°å½•æ˜¯ï¼ˆåˆ›å»ºRVå‰ï¼‰å·²æäº¤äº‹åŠ¡ç”Ÿæˆçš„\u0026ndash;\u0026gt;å¯è§ trxId\u0026gt;maxï¼šåˆ›å»ºRVåçš„å¯åŠ¨çš„äº‹åŠ¡\u0026ndash;\u0026gt;ä¸å¯è§ åœ¨minä¸maxä¹‹é—´ï¼šå±äºm_ids = æœªæäº¤çš„äº‹åŠ¡\u0026ndash;\u0026gt;ä¸å¯è§ / ä¸å±äº = å·²æäº¤çš„äº‹åŠ¡\u0026ndash;\u0026gt;å¯è§ è¯»æäº¤\u0026amp;å¯é‡å¤è¯»çš„å®ç°ï¼šRead Viewï¼ˆç±»ä¼¼å¿«ç…§ï¼‰ã€Œè¯»æäº¤ã€åœ¨ã€Œæ¯ä¸ªè¯­å¥æ‰§è¡Œå‰ã€éƒ½ç”Ÿæˆ ã€Œå¯é‡å¤è¯»ã€åœ¨ã€Œå¯åŠ¨äº‹åŠ¡æ—¶ã€ç”Ÿæˆ explainï¼šè¯»æäº¤åœ¨äº‹åŠ¡ä¸­ä¹Ÿæ˜¯æ¯å¥éƒ½é‡æ–°ç”Ÿæˆå¿«ç…§ Bçº¿ç¨‹åœ¨æœŸé—´æ›´æ”¹æ•°æ®ä¹Ÿä¼šè¢«Açº¿ç¨‹å¿«ç…§åˆ°\u0026ndash;\u0026gt;äº‹åŠ¡ä¸­é—´æ•°æ®ä¼šå‘ç”Ÿå˜åŒ– CS186ä¸­å®ç°çš„æ˜¯ä¸²è¡ŒåŒ–çº§åˆ«ï¼Œç”±ä¸¥æ ¼ä¸¤é˜¶æ®µé”ï¼ˆstrict 2PLï¼‰å®ç°ã€‚å³ç¬¬ä¸€é˜¶æ®µåªèƒ½è·å¾—é”ä¸èƒ½é‡Šæ”¾é”ï¼Œç¬¬äºŒé˜¶æ®µåªèƒ½é‡Šæ”¾é”ä¸èƒ½è·å¾—é”ï¼Œå¦å¤–å†™é”åªèƒ½åœ¨äº‹åŠ¡ç»“æŸæˆ–å›æ»šæ—¶é‡Šæ”¾\nMySqlå¯é‡å¤è¯»ä¸å¹»è¯» è®°å½•é”+é—´éš™é”å¯ä»¥é˜²åˆ é™¤â€”â€”ä¸»é”®ç´¢å¼•è¢«è®°å½•é”é”å®š æ— æ³•åˆ é™¤ é—´éš™é”å¯ä»¥é˜²æ’å…¥\nä¸èƒ½é˜²æ­¢å¹»è¯»çš„ä¾‹å­ï¼š Aäº‹åŠ¡å…ˆæ™®é€šselectï¼ˆå¿«ç…§è¯»ï¼‰ Bäº‹åŠ¡æ’å…¥æ•°æ®å¹¶æäº¤ Aäº‹åŠ¡updateæ’å…¥çš„æ•°æ®ï¼ˆå½“å‰è¯»ï¼‰ Aå†æ¬¡select\u0026ndash;\u0026gt;æˆåŠŸ Aç¬¬ä¸€æ¬¡selectæ—¶å¹¶æ²¡æœ‰åŠ é” æ­¤æ—¶è‹¥Aä¸update ç›´æ¥select for updateæ•ˆæœç›¸åŒ è§£å†³ï¼šå…ˆåšfor update äº‹åŠ¡æäº¤æ—¶è¡Œçº§é”æ‰ä¼šè§£é™¤ é”â­â­â­ é”çš„åˆ†ç±» for allï¼šSSå…¼å®¹ SXä¸å…¼å®¹ XXä¸å…¼å®¹\nå…¨å±€é” + è¡¨çº§é” + è¡Œçº§é” å…¨å±€é”ï¼šflush tables with read lock ä¸»è¦ç”¨äºå…¨å±€é€»è¾‘å¤‡ä»½ æ€ä¹ˆåˆå¤‡ä»½åˆä¸å½±å“ä¸šåŠ¡ï¼Ÿåœ¨å¯é‡å¤è¯»çš„çº§åˆ«ä¸‹å¼€å¯äº‹åŠ¡ï¼ˆMVCCæ”¯æŒï¼‰ è¡¨çº§é” = è¡¨é” + å…ƒæ•°æ®é”ï¼ˆMDLï¼‰ + æ„å‘é” + AUTO-INCé” è¡¨é”ï¼šlock tables student read å…¶å®ƒçº¿ç¨‹ä¸å¯å†™ è¯¥çº¿ç¨‹åªå¯è¯»æ­¤è¡¨ï¼ˆä¸èƒ½å†™ ä¹Ÿä¸èƒ½æ“ä½œå…¶ä»–è¡¨ï¼‰ MDLï¼šå¯¹è¡¨è¿›è¡ŒCRUD = åŠ MDLè¯»é” å¯¹è¡¨åšç»“æ„æ›´æ”¹ = å†™é” äº‹åŠ¡æäº¤æ—¶é‡Šæ”¾é” whyç”³è¯·ä¸åˆ°å†™é” è½¬è€Œç”³è¯·è¯»é”ä¹Ÿè¢«é˜»å¡ï¼Ÿ ç”³è¯·é”çš„è¯·æ±‚å½¢æˆé˜Ÿåˆ— å†™é”ä¼˜å…ˆçº§é«˜äºè¯»é”ï¼ˆå†™é”ç­‰å¾…æ—¶ è¯¥è¡¨çš„CRUDæ“ä½œå…¨éƒ¨é˜»å¡ï¼‰ æ™®é€šselectä¸ä¼šåŠ é” ç”¨MVCCå®ç° ä½†CS186ä¸­æ™®é€šselectæ˜¯åŠ äº†è¯»é”çš„\næ„å‘é”ï¼šIS IX æ„å‘é”ä¹‹é—´ä¸ä¼šå†²çª åªä¸è¡¨é”å†²çª ç”¨äºåˆ¤æ–­è¡¨é‡Œæ˜¯å¦æœ‰è®°å½•è¢«åŠ é” AUTO-INCï¼šæŒç®¡ä¸»é”®è‡ªå¢ æ’å…¥å®Œé‡Šæ”¾ï¼ˆé¿å…å…¶ä»–äº‹åŠ¡åŒæ—¶æ’å…¥ ä¸»é”®ä¸è¿ç»­è‡ªå¢ï¼‰ è½»é‡çº§é”ï¼ˆMySql5.1.22 ï¼ŒæŒ‡è¡¨çº§é”æˆ–è¡Œçº§é”ã€‚é‡é‡çº§é”ä¸ºå…¨å±€é”ï¼‰ä¸ºå­—æ®µèµ‹è‡ªå¢å€¼åé‡Šæ”¾ ä¸éœ€ç­‰æ•´ä¸ªæ’å…¥è¯­å¥æ‰§è¡Œå®Œ è½»é‡çº§é”åœ¨ä¸»ä»å¤åˆ¶æ—¶ä¼šå‡ºé”™ï¼ˆçº¿ç¨‹ABåˆ†åˆ«å‘è¡¨ä¸­æ’å…¥è®°å½• binlogè®°å½•åŸå§‹è¯­å¥ å…ˆè®°å®ŒAæˆ–Bæ‰èƒ½è®°åˆ«çš„ å†™å…¥ä»åº“æ—¶é‡æ–°insert åºå·ä¼šå˜åŒ–ï¼‰ è®¾ç½®binlog_format=row è§£å†³ï¼ˆä¿ç•™ä¸»åº“ä¸­åºå·ï¼‰ è¡Œçº§é”ï¼š è®°å½•é”ï¼šé”ä¸€æ¡è®°å½•S or X é—´éš™é”èŒƒå›´ï¼šå¦‚updateè®°å½•25 åªæœ‰10 20 30 \u0026ndash;\u0026gt;é”ä½20~30\né—´éš™é”ï¼šåªå­˜åœ¨äºå¯é‡å¤è¯»ï¼ˆè§£å†³è¯¥çº§åˆ«å¹»è¯»ï¼‰ + é”ä¸äº’æ–¥ï¼ˆå¯ä»¥åŒ…å«å…±åŒé—´éš™èŒƒå›´ï¼‰ + ä¸åŒ…å«è¾¹ç•Œ è®°å½•é”æ˜¯äº’æ–¥çš„ï¼Œä½†é—´éš™é”æ˜¯å…±äº«çš„ ä¸´é”®é”ï¼ˆäºŒè€…ç»“åˆï¼‰ï¼šåŒ…å«è¾¹ç•Œ æœ‰äº’æ–¥ æ’å…¥æ„å‘é”ï¼šä¸æ˜¯æ„å‘é” æ’å…¥çš„ä½ç½®é‡åˆ°é—´éš™é”æ—¶ç”Ÿæˆ çŠ¶æ€ä¸ºç­‰å¾… é—´éš™é”é‡Šæ”¾åæ­¤é”å¼€å§‹ä½œç”¨ æ˜¯ä¸€ç§ç‰¹æ®Šçš„é—´éš™é” ç±»ä¼¼äºé”ä½ä¸€ä¸ªç‚¹ è‹¥æ’å…¥ä½ç½®æ— é—´éš™é”ï¼Œåˆ™ç›´æ¥æ’å…¥ï¼Œå¹¶æ‹¥æœ‰è®°å½•é”ï¼ˆè€Œéé—´éš™é”ï¼‰ MySqlæ€ä¹ˆåŠ é” ä¸²è¡ŒåŒ–çº§åˆ«selectè¯­å¥ä¼šåŠ é”\nåŠ è¡Œçº§é”ï¼šç´¢å¼•åŠ é” åŸºæœ¬å•ä½next-key lock äº‹åŠ¡æäº¤åæ‰é‡Šæ”¾ åœ¨ä½¿ç”¨è®°å½•é”æˆ–è€…é—´éš™é”å°±èƒ½é¿å…å¹»è¯»ç°è±¡çš„åœºæ™¯ä¸‹ä¼šé€€åŒ– åˆ†æåŠ é”å‘½ä»¤ï¼šselect * from performance_schema.data_locks\\G;\néå”¯ä¸€ç´¢å¼•ï¼ˆä¸»é”®+äºŒçº§ éuniqueå­—æ®µï¼‰ ç­‰å€¼æŸ¥è¯¢ï¼šä¸¤ç´¢å¼•éƒ½åŠ é” ä½†ä¸»é”®ç´¢å¼•åªå¯¹æ»¡è¶³æ¡ä»¶çš„ç´¢å¼•åŠ é”ï¼ˆæŸ¥è¯¢ç»“æœå­˜åœ¨ ä¸»é”®ç´¢å¼•åŠ è®°å½•é” ä¸å­˜åœ¨åˆ™ä¸»é”®ç´¢å¼•ä¸åŠ é”ï¼‰ èŒƒå›´æŸ¥è¯¢ï¼šäºŒçº§ç´¢å¼•ä¸é€€åŒ– è‹¥ä¸åŠ ç´¢å¼•è¿›è¡ŒæŸ¥è¯¢ = å…¨è¡¨æ‰«æ = æ¯æ¡è®°å½•çš„ç´¢å¼•éƒ½åŠ next-key lock = å…¨éƒ¨é”ä½ æ­»é” ç”±next-key locké€ æˆ\nä¸¤ä¸ªçº¿ç¨‹select for update éƒ½è¦æ’å…¥\u0026ndash;\u0026gt;ç­‰å¯¹æ–¹é—´éš™é”é‡Šæ”¾æ‰å¯è·å–æ’å…¥æ„å‘é” é¿å…æ­»é”ï¼š å¿…è¦æ¡ä»¶ï¼šäº’æ–¥ å æœ‰ä¸”ç­‰å¾… ä¸å¯å¼ºå ç”¨ å¾ªç¯ç­‰å¾… æ–¹æ³•ï¼šè®¾ç½®ç­‰å¾…é”çš„è¶…æ—¶æ—¶é—´ / å¼€å¯ä¸»åŠ¨æ­»é”æ£€æµ‹ æ—¥å¿—â­ why undo logï¼Ÿ äº‹åŠ¡æäº¤å‰æœ‰ç”¨\nä¿è¯åŸå­æ€§ å¯ä»¥å›æ»šâ€”â€”è®°å½•æ¯æ­¥æ“ä½œ å®ç°MVCCçš„å…³é”®å› ç´ â€”â€”undo logçš„ç‰ˆæœ¬é“¾ä¸ºæ¯æ¡è®°å½•ä¿å­˜å¤šä»½å†å²æ•°æ® why buffer pool? ä½œç”¨ï¼šç¼“å­˜æ•°æ® å®¢æˆ·ç«¯å¯ä»¥ç›´æ¥è¯»å– + ä¿®æ”¹æ•°æ®å¯ä»¥ç›´æ¥ä¿®æ”¹poolä¸­çš„ å¹¶æ ‡è®°ä¸ºè„é¡µï¼ˆä¸ç£ç›˜è®°å½•ä¸ä¸€è‡´ï¼‰ ç¼“å­˜ä»€ä¹ˆï¼Ÿä»¥é¡µä¸ºå•ä½ï¼ˆ16KBï¼‰ CS186ä¸­ GHJç”¨ä½œjoinä¸¤ä¸ªå¤§è¡¨ å¤–éƒ¨å½’å¹¶æ’åºç”¨ä½œå°†ä¸€ä¸ªå¤§è¡¨ï¼ˆå¯èƒ½æ˜¯joinçš„ç»“æœï¼‰è¿›è¡Œæ’åºåå­˜æ”¾åˆ°é¡µä¸Š\nç¼“å­˜æ•°æ®é¡µ ç´¢å¼•é¡µ undoé¡µï¼ˆè®°å½•undologï¼‰ é”ä¿¡æ¯ è‡ªé€‚åº”å“ˆå¸Œç´¢å¼•æ’å…¥ç¼“å­˜é¡µ æŸ¥è¯¢ä¸€æ¡è®°å½•ä¼šæŠŠæ•´é¡µæ•°æ®åŠ è½½åˆ°pool why redo log? è¿‡ç¨‹ï¼šå…ˆæ›´æ–°å†…å­˜ï¼ˆåŒæ—¶æ ‡è®°ä¸ºè„é¡µï¼‰ï¼Œç„¶åå°†æœ¬æ¬¡å¯¹è¿™ä¸ªé¡µçš„ä¿®æ”¹ä»¥ redo log çš„å½¢å¼è®°å½•\u0026ndash;\u0026gt;åå°çº¿ç¨‹é€‚æ—¶å°†è„é¡µåˆ·ç›˜ å…ˆå†™æ—¥å¿—ååˆ·ç›˜ == WAL äº‹åŠ¡æäº¤æ—¶ å…ˆæŒä¹…åŒ–redolog undologä¿®æ”¹ä¹Ÿè¦è®°å½•åˆ°redolog ä½œç”¨ï¼šå®ç°äº‹åŠ¡æŒä¹…åŒ– crash-safe + å†™æ“ä½œä»éšæœºå†™å˜ä¸ºé¡ºåºå†™ï¼ˆredologåœ¨ç£ç›˜ä¸­ä¸ºè¿½åŠ æ“ä½œ é¡ºåºå†™ï¼‰ redoè‡ªèº«æ˜¯å¾ªç¯å†™ redo undoçš„åŒºåˆ«ï¼šredoè®°å½•äº‹åŠ¡ä¿®æ”¹åçŠ¶æ€ ç”¨äºå´©æºƒæ¢å¤ï¼›undoè®°å½•äº‹åŠ¡ä¿®æ”¹å‰çŠ¶æ€ ç”¨äºå›æ»š redologä¸binlogçš„åŒºåˆ«ï¼šï¼ˆbinlogåŸæ¥æ˜¯MyISAMä¸­çš„ æ²¡æœ‰crash-safeèƒ½åŠ› InnoDBå®ç°äº†è¿™ä¸ªåŠŸèƒ½ï¼‰ binlogä¸è®°å½•æŸ¥è¯¢è¯­å¥ åœ¨æ¯æ¡æ›´æ–°è¯­å¥åç”Ÿæˆ äº‹åŠ¡æäº¤æ—¶ä¼šæŠŠbinlogç»Ÿä¸€å†™å…¥binlogæ–‡ä»¶\nbinæ˜¯serverå±‚å®ç°çš„ redoæ˜¯å¼•æ“å®ç°çš„ redoæ˜¯ç‰©ç†æ—¥å¿—ï¼ˆè®°å½•åšäº†ä»€ä¹ˆä¿®æ”¹å¦‚åœ¨Â·å¤„åšäº†Â·æ›´æ–°ï¼‰binæœ‰statementæ¨¡å¼ï¼ˆåªè®°å½•æ“ä½œå¦‚update é€»è¾‘æ—¥å¿—ï¼‰ã€rowæ¨¡å¼ï¼ˆè®°å½•æ•°æ®å¦‚ä¸€è¡Œï¼‰ã€mixedï¼ˆè‡ªåŠ¨åˆ‡æ¢ï¼‰ binæ˜¯è¿½åŠ å†™ redoå¾ªç¯å†™ binç”¨äºä¸»ä»å¤åˆ¶ å¤‡ä»½æ¢å¤ redoç”¨äºæ•…éšœæ¢å¤ ä¸»ä»å¤åˆ¶å®ç°ï¼Ÿ ä¾èµ–binlog è®°å½•mysqlæ‰€æœ‰å˜åŒ–å¹¶ä»¥äºŒè¿›åˆ¶å½¢å¼ä¿å­˜åœ¨ç£ç›˜ä¸Š å°†å…¶ä¼ åˆ°ä»åº“ä»¥å®ç°å¤åˆ¶ï¼ˆä¸€èˆ¬å¼‚æ­¥ ä¸»åº“ä¸ç­‰å¤åˆ¶ï¼‰ äºŒè€…å»ºç«‹è”ç³» æ­¤åä¸€ç›´ä¿æŒè”ç³» binlogä»€ä¹ˆæ—¶å€™åˆ·ç›˜ï¼Ÿ äº‹åŠ¡æ‰§è¡Œè¿‡ç¨‹ä¸­ å…ˆæŠŠæ—¥å¿—å†™åˆ°binlog cache æäº¤æ—¶å°†å…¶å†™å…¥binlog æ…¢æŸ¥è¯¢æ—¥å¿—â€”â€”è®°å½•æ‰§è¡Œæ—¶é•¿è¶…è¿‡é˜ˆå€¼çš„æŸ¥è¯¢è¯­å¥ ç”¨é€”ï¼šéœ€è¦ä¼˜åŒ–çš„æŸ¥è¯¢ ç›‘æ§åº”ç”¨ç¨‹åºçš„æ•°æ®åº“äº¤äº’æ€§èƒ½ å®¹é‡è§„åˆ’ æ‰‹åŠ¨è®¾ç½®SET GLOBAL slow_query_log = 1;å¼€å¯,å®šä½ç”¨mysqldumpslow(å¦‚æŸ¥è¯¢æœ€æ…¢çš„åæ¡) ä¸¤é˜¶æ®µæäº¤ why needï¼Ÿbinlogä¸redoä¸åŒæ—¶è¿›è¡Œ è‹¥æœ‰ä¸€ä¸ªæ²¡æˆåŠŸåˆ·ç›˜ éƒ½ä¼šä¸»ä»ä¸ä¸€è‡´ è¿‡ç¨‹ï¼š prepareé˜¶æ®µï¼šå°†å†…éƒ¨XAäº‹åŠ¡çš„IDï¼ˆXIDï¼‰å†™å…¥redo å°†å…¶äº‹åŠ¡çŠ¶æ€è®¾ç½®ä¸ºprepare redoæŒä¹…åŒ– commité˜¶æ®µï¼šXIDå†™å…¥binlog binlogæŒä¹…åŒ– redoçŠ¶æ€è®¾ç½®ä¸ºcommit æ­¤çŠ¶æ€writeåˆ°page cache è‹¥é‡prepareæ€redolog æ‰¾binlogä¸­æ˜¯å¦æœ‰XID\u0026ndash;\u0026gt;æœ‰åˆ™æäº¤äº‹åŠ¡ æ— åˆ™å›æ»šäº‹åŠ¡ binlogç»„æäº¤â€”â€”å¤šä¸ªäº‹åŠ¡æäº¤æ—¶ å¤šä¸ªbinlogåˆ·ç›˜æ“ä½œåˆå¹¶ä¸ºä¸€ä¸ª MySQLç£ç›˜I/Oå¾ˆé«˜çš„ä¼˜åŒ–æ–¹æ³•â€”â€”å»¶è¿Ÿbinlog redologçš„åˆ·ç›˜æ—¶æœº æ€§èƒ½ä¸æ¶æ„ explainï¼šæŸ¥çœ‹sqlæ‰§è¡Œè®¡åˆ’ å¦‚æ˜¯å¦èµ°ç´¢å¼• æœ‰æ— å¤–éƒ¨æ’åº æœ‰æ— ç´¢å¼•è¦†ç›– explainçš„ç´¢å¼•ä¸å¯¹\u0026ndash;\u0026gt;ä½¿ç”¨force indexå¼ºåˆ¶ç´¢å¼•\næŸ¥è¯¢é€Ÿåº¦æ…¢ æ€ä¹ˆè§£å†³ï¼Ÿ ç”¨explainåˆ†ææŸ¥è¯¢è¯­å¥ åˆ›å»ºæˆ–ä¼˜åŒ–ç´¢å¼• é¿å…ç´¢å¼•å¤±æ•ˆ æŸ¥è¯¢ä¼˜åŒ–ï¼ˆselect *ï¼‰ ä¼˜åŒ–æ•°æ®åº“è¡¨ï¼ˆæ‹†åˆ†ä¸ºå°è¡¨ï¼‰ ç¼“å­˜æŠ€æœ¯ ä¸»ä»å»¶è¿Ÿè§£å†³ï¼šå¼ºåˆ¶èµ°ä¸»åº“ï¼ˆé’ˆå¯¹å¤§äº‹åŠ¡/èµ„æºå¯†é›†å‹æ“ä½œï¼‰ åˆ†åº“åˆ†è¡¨æ˜¯ä»€ä¹ˆ\u0026amp;åŒºåˆ«ï¼š åˆ†åº“ï¼šæ°´å¹³æ‰©å±•æ•°æ®åº“ æ•°æ®æŒ‰ä¸€å®šè§„åˆ™åˆ’åˆ†åˆ°å¤šä¸ªç‹¬ç«‹æ•°æ®åº“ æ¯ä¸ªæ•°æ®åº“åªå­˜å‚¨éƒ¨åˆ†æ•°æ®ï¼ˆåˆ†å¸ƒå¼å­˜å‚¨ï¼‰\u0026ndash;\u0026gt;è§£å†³å¹¶å‘è¿æ¥è¿‡å¤šé—®é¢˜ åˆ†è¡¨ï¼šå•ä¸ªæ•°æ®åº“ä¸­çš„è¡¨æ‹†åˆ†ä¸ºå¤šä¸ªè¡¨\u0026ndash;\u0026gt;æé«˜æŸ¥è¯¢æ•ˆç‡ å‡è½»å•è¡¨å‹åŠ›\u0026ndash;\u0026gt;è§£å†³å•è¡¨æ•°æ®é‡è¿‡å¤§ æŸ¥è¯¢æ€§èƒ½ä¸‹é™é—®é¢˜ åˆ†åº“åˆ†è¡¨æ“ä½œï¼š å‚ç›´åˆ†åº“ï¼ˆç«–ç€åˆ‡ï¼‰ï¼šæ ¹æ®ä¸šåŠ¡ä¸åŠŸèƒ½çš„ç»´åº¦ å°†ä¸åŒä¸šåŠ¡æ•°æ®æ”¾åˆ°ä¸åŒæ•°æ®åº“â€”â€”ä¸“åº“ä¸“ç”¨ æ²¡æœ‰è§£å†³å•è¡¨æ•°æ®é‡è¿‡å¤§çš„é—®é¢˜ å‚ç›´åˆ†è¡¨ï¼šå­—æ®µæ¯”è¾ƒå¤šçš„å¤§è¡¨ å°†è¾ƒä¸ºç‹¬ç«‹æˆ–ä¸å¸¸ç”¨çš„å­—æ®µæ‹†åˆ†åˆ°å•ç‹¬çš„æ•°æ®è¡¨ä¸­ æ ¸å¿ƒè¡¨å­—æ®µé•¿åº¦è¾ƒçŸ­ å¯ä»¥åŠ è½½æ›´å¤šæ•°æ®åˆ°å†…å­˜ä¸­ å‡å°‘ç£ç›˜IO æ°´å¹³åˆ†åº“ï¼ˆæ¨ªç€åˆ‡ï¼‰ï¼šåŒä¸ªè¡¨æŒ‰ä¸€å®šè§„åˆ™æ‹†åˆ†åˆ°ä¸åŒæ•°æ®åº“ä¸­ï¼ˆè¡¨ç»“æ„ä¸å˜ï¼‰ æ•ˆç‡é«˜ ä½†æ•°æ®è®¿é—®éœ€è¦é¢å¤–çš„è·¯ç”±å·¥ä½œ ç³»ç»Ÿå¤æ‚åº¦é«˜ æ°´å¹³åˆ†è¡¨ï¼šæ‹†åˆ†åˆ°åŒä¸ªæ•°æ®åº“å†…ï¼ˆè¡¨ç»“æ„ä¸å˜ï¼‰ åªè§£å†³äº†å•è¡¨è¿‡å¤§çš„é—®é¢˜ è¿˜è¦ç«äº‰åŒä¸ªç‰©ç†æœºçš„CPU å†…å­˜ç­‰ å­˜å‚¨å¼•æ“ æ¶æ„ï¼Ÿ æ’ä»¶å¼æ¶æ„ åŸºäºè¡¨ï¼ˆéæ•°æ®åº“ï¼‰ MyISAM vs InnoDB è¡Œçº§é” \u0026amp; MVCC ==\u0026gt; ä¸æ”¯æŒ vs æ”¯æŒ äº‹åŠ¡ \u0026amp; å´©æºƒåçš„æ¢å¤ ï¼ˆåŒä¸Šï¼‰InnoDBä½¿ç”¨redo logï¼ˆåŒCS186ï¼‰ å¤–é”® ï¼ˆåŒä¸Šï¼‰ éèšç°‡ç´¢å¼• vs èšç°‡ç´¢å¼• ç¼“å­˜ é”®ç¼“å­˜ï¼ˆä»…ç¼“å­˜æ•°æ®é¡µï¼‰ vs buffer poolç¼“å­˜æ•°æ®é¡µ\u0026amp;ç´¢å¼•é¡µ æŸ¥è¯¢ç¼“å­˜ nothing\nRedisâ­â­ æ€§èƒ½ Redisä¸ºä»€ä¹ˆå¿«\né«˜æ€§èƒ½ é«˜å¹¶å‘\næ•°æ®ç»“æ„ æ•°æ®ç±»å‹ä¸ä½¿ç”¨åœºæ™¯ å¸¸è§5ç§ï¼šStringï¼ˆå­—ç¬¦ä¸²/æ•´æ•°/æµ®ç‚¹ï¼‰ Hashï¼ˆæ•£åˆ—ï¼‰ Listï¼ˆé“¾è¡¨ ä¸¤ç«¯push popï¼‰ Setï¼ˆæ— åºé›†åˆ ä¸å¯é‡å¤ï¼‰ Zsetï¼ˆæœ‰åºé›†åˆ ä¸å¯é‡å¤ï¼‰ ååŠ ï¼šBitMapï¼ˆ2.2 ç‰ˆæ–°å¢ï¼‰ HyperLogLogï¼ˆ2.8 ç‰ˆæ–°å¢ï¼‰ GEOï¼ˆ3.2 ç‰ˆæ–°å¢ï¼‰ Streamï¼ˆ5.0 ç‰ˆæ–°å¢ï¼‰ String ç±»å‹çš„åº”ç”¨åœºæ™¯ï¼šç¼“å­˜å¯¹è±¡ã€å¸¸è§„è®¡æ•°ã€åˆ†å¸ƒå¼é”ã€å…±äº« session ä¿¡æ¯ç­‰ Listï¼šæ¶ˆæ¯é˜Ÿåˆ—ï¼ˆä½†æ˜¯æœ‰ä¸¤ä¸ªé—®é¢˜ï¼š1. ç”Ÿäº§è€…éœ€è¦è‡ªè¡Œå®ç°å…¨å±€å”¯ä¸€ IDï¼›2. ä¸èƒ½ä»¥æ¶ˆè´¹ç»„å½¢å¼æ¶ˆè´¹æ•°æ®ï¼‰ç­‰ Hash ç±»å‹ï¼šç¼“å­˜å¯¹è±¡ å¯ä»¥ç”¨ä½œè´­ç‰©è½¦ Set ç±»å‹ï¼šèšåˆè®¡ç®—ï¼ˆå¹¶é›†ã€äº¤é›†ã€å·®é›†ï¼‰åœºæ™¯ï¼Œæ¯”å¦‚ç‚¹èµã€å…±åŒå…³æ³¨ Zset ç±»å‹ï¼šæ’åºåœºæ™¯ï¼Œæ¯”å¦‚æ’è¡Œæ¦œã€ç”µè¯å’Œå§“åæ’åº BitMapï¼šäºŒå€¼çŠ¶æ€ç»Ÿè®¡çš„åœºæ™¯ï¼Œæ¯”å¦‚ç­¾åˆ°ã€åˆ¤æ–­ç”¨æˆ·ç™»é™†çŠ¶æ€ã€è¿ç»­ç­¾åˆ°ç”¨æˆ·æ€»æ•°ç­‰ HyperLogLogï¼šæµ·é‡æ•°æ®åŸºæ•°ç»Ÿè®¡çš„åœºæ™¯ï¼Œæ¯”å¦‚ç™¾ä¸‡çº§ç½‘é¡µ UV è®¡æ•°ç­‰ GEOï¼šå­˜å‚¨åœ°ç†ä½ç½®ä¿¡æ¯çš„åœºæ™¯ï¼Œæ¯”å¦‚æ»´æ»´å«è½¦ Streamï¼ˆ5.0 ç‰ˆæ–°å¢ï¼‰ï¼šæ¶ˆæ¯é˜Ÿåˆ—ï¼Œå…‹æœäº†Liståšæ¶ˆæ¯é˜Ÿåˆ—çš„ä¸¤ä¸ªé—®é¢˜ æ•°æ®ç±»å‹å®ç°ï¼š Stringå†…éƒ¨ï¼šSDSï¼ˆç®€å•åŠ¨æ€å­—ç¬¦ä¸²ï¼‰ å¯ä»¥ä¿å­˜äºŒè¿›åˆ¶æ•°æ®â€”â€”ä½¿ç”¨ len å±æ€§çš„å€¼è€Œéç©ºå­—ç¬¦ä¸²åˆ¤æ–­å­—ç¬¦ä¸²æ˜¯å¦ç»“æŸ\u0026ndash;\u0026gt;è·å–å­—ç¬¦ä¸²çš„æ—¶é—´å¤æ‚åº¦ä¸ºO(1) Redis çš„ SDS API æ˜¯å®‰å…¨çš„ï¼Œæ‹¼æ¥å­—ç¬¦ä¸²ä¸ä¼šé€ æˆç¼“å†²åŒºæº¢å‡ºã€‚SDSæ‹¼æ¥å­—ç¬¦ä¸²ä¹‹å‰ä¼šæ£€æŸ¥SDS ç©ºé—´æ˜¯å¦æ»¡è¶³è¦æ±‚ Listï¼šå‹ç¼©åˆ—è¡¨ï¼ˆå…ƒç´ ä¸ªæ•°å°‘äº512ä¸ª æ¯ä¸ªå…ƒç´ çš„å€¼å°äº64å­—èŠ‚ éƒ½å¯ç”¨list-max-ziplist-balè°ƒ+åŒå‘é“¾è¡¨\u0026ndash;\u0026gt;quickListï¼ˆ3.2åï¼‰ Hashï¼šå‹ç¼©åˆ—è¡¨+å“ˆå¸Œè¡¨\u0026ndash;\u0026gt;listpackï¼ˆ7.0åï¼‰ Setï¼šæ•´æ•°é›†åˆï¼ˆå‡ä¸ºæ•´æ•°ä¸”ä¸ªæ•°å°äº512ï¼‰+å“ˆå¸Œè¡¨ ZSetï¼šå‹ç¼©åˆ—è¡¨+è·³è¡¨\u0026ndash;\u0026gt;listpackï¼ˆ7.0ï¼‰ å…·ä½“æ•°æ®ç»“æ„ è·³è¡¨ï¼šè·³è¡¨åœ¨åˆ›å»ºèŠ‚ç‚¹æ—¶å€™ï¼Œä¼šç”ŸæˆèŒƒå›´ä¸º[0-1]çš„ä¸€ä¸ªéšæœºæ•°ï¼Œå¦‚æœè¿™ä¸ªéšæœºæ•°å°äº 0.25ï¼ˆç›¸å½“äºæ¦‚ç‡25%ï¼‰ï¼Œé‚£ä¹ˆå±‚æ•°å°±å¢åŠ  1 å±‚ï¼Œç„¶åç»§ç»­ç”Ÿæˆä¸‹ä¸€ä¸ªéšæœºæ•°ï¼Œç›´åˆ°éšæœºæ•°çš„ç»“æœå¤§äº 0.25 ç»“æŸ è·³è¡¨ä¸B+æ ‘æ¯”è¾ƒï¼š å‹ç¼©åˆ—è¡¨ï¼šæ ¹æ®æ•°æ®å¤§å°å’Œç±»å‹è¿›è¡Œä¸åŒçš„ç©ºé—´å¤§å°åˆ†é…ï¼Œé¡ºåºå­˜å‚¨ï¼ˆåªèƒ½é¡ºåºæŸ¥æ‰¾ï¼‰â€”â€”èŠ‚çœå†…å­˜ ç¼ºç‚¹ï¼šè¿é”æ›´æ–°ï¼ˆæ¯ä¸ªèŠ‚ç‚¹éœ€è®°å½•å‰ä¸€ä¸ªèŠ‚ç‚¹çš„é•¿åº¦ï¼‰\u0026ndash;\u0026gt;åªé€‚ç”¨èŠ‚ç‚¹ä¸å¤šçš„æƒ…å†µ listpackï¼šï¼ˆä»£æ›¿å‹ç¼©åˆ—è¡¨ï¼‰ä¸€ä¸ªèŠ‚ç‚¹åŒ…æ‹¬ç¼–ç ç±»å‹+data+èŠ‚ç‚¹æ€»é•¿\u0026ndash;\u0026gt;ä¸è®°å½•å‰ä¸€ä¸ªèŠ‚ç‚¹çš„é•¿åº¦ï¼Œé¿å…è¿é”æ›´æ–° å“ˆå¸Œè¡¨æ‰©å®¹ï¼šç»™ã€Œå“ˆå¸Œè¡¨ 2ã€ åˆ†é…ç©ºé—´\u0026ndash;\u0026gt;å°†ã€Œå“ˆå¸Œè¡¨ 1 ã€çš„æ•°æ®è¿ç§»åˆ°ã€Œå“ˆå¸Œè¡¨ 2ã€ ä¸­\u0026ndash;\u0026gt;è¿ç§»å®Œæˆåï¼Œã€Œå“ˆå¸Œè¡¨ 1 ã€çš„ç©ºé—´ä¼šè¢«é‡Šæ”¾ï¼Œå¹¶æŠŠã€Œå“ˆå¸Œè¡¨ 2ã€ è®¾ç½®ä¸ºã€Œå“ˆå¸Œè¡¨ 1ã€ï¼Œç„¶ååˆ›å»ºæ–°çš„ç©ºç™½å“ˆå¸Œè¡¨2 æ‹·è´è¿‡ç¨‹æ˜¯æ¸è¿›å¼rehashï¼šæ¯æ¬¡å“ˆå¸Œè¡¨å…ƒç´ è¿›è¡ŒCRUDæ“ä½œï¼Œè¿˜ä¼šé¡ºåºè¿ç§»æ•°æ®\u0026ndash;\u0026gt;è¿ç§»äº†çš„æ•°æ®ç›´æ¥ä»å“ˆå¸Œè¡¨1ä¸­åˆ é™¤ï¼ˆå…ˆåœ¨è¡¨1é‡Œæ‰¾ï¼Œæ‰¾ä¸åˆ°å»è¡¨2æ‰¾ï¼‰ \u0026amp; æ’å…¥æ•°æ®åªåœ¨è¡¨2ä¸­ SDSï¼šåŒ…æ‹¬å­—ç¬¦ä¸²é•¿åº¦+åˆ†é…ç»™å­—ç¬¦æ•°ç»„çš„ç©ºé—´é•¿åº¦+ç”¨æ¥è¡¨ç¤ºä¸åŒç±»å‹çš„ SDSçš„å˜é‡+å­—ç¬¦æ•°ç»„ï¼Œç”¨æ¥ä¿å­˜å®é™…æ•°æ® ç›¸å¯¹Cè¯­è¨€Stringçš„ä¼˜ç‚¹ï¼šO(1)å¤æ‚åº¦è·å–å­—ç¬¦ä¸²é•¿åº¦ + äºŒè¿›åˆ¶å®‰å…¨ï¼ˆä¸ç”¨ä»¥'\\0'ç»“å°¾ï¼‰ + ä¸ä¼šç¼“å†²åŒºæº¢å‡º çº¿ç¨‹æ¨¡å‹ Rediså·¥ä½œæ¨¡å¼ï¼šäº‹ä»¶é©±åŠ¨å‹\næ˜¯å•çº¿ç¨‹ï¼Ÿ Redis å•çº¿ç¨‹æŒ‡çš„æ˜¯ã€Œæ¥æ”¶å®¢æˆ·ç«¯è¯·æ±‚-\u0026gt;è§£æè¯·æ±‚ -\u0026gt;è¿›è¡Œæ•°æ®è¯»å†™ç­‰æ“ä½œ-\u0026gt;å‘é€æ•°æ®ç»™å®¢æˆ·ç«¯ã€è¿™ä¸ªè¿‡ç¨‹æ˜¯ç”±ä¸€ä¸ªçº¿ç¨‹ï¼ˆä¸»çº¿ç¨‹ï¼‰å®Œæˆ ä½†æ˜¯Redisç¨‹åºéå•çº¿ç¨‹ï¼Œå¯åŠ¨æ—¶ä¼šå¯åŠ¨åå°çº¿ç¨‹ï¼ˆBIOï¼‰ Redis2.6å\u0026ndash;\u0026gt;å…³é—­æ–‡ä»¶ + AOFåˆ·ç›˜ï¼ˆx2åå°çº¿ç¨‹ï¼‰ Redis4.0å\u0026ndash;\u0026gt;æ–°å¢å¼‚æ­¥é‡Šæ”¾Rediså†…å­˜ï¼ˆå³lazyfreeçº¿ç¨‹ï¼‰ ä¾‹å¦‚unlink key / flushdb async / flushall asyncï¼Œä¼šæŠŠè¿™äº›åˆ é™¤æ“ä½œäº¤ç»™åå°çº¿ç¨‹æ‰§è¡Œ å¥½å¤„ï¼šè¿™äº›æ“ä½œéƒ½å¾ˆè€—æ—¶ï¼Œå¦‚æœæŠŠè¿™äº›ä»»åŠ¡éƒ½æ”¾åœ¨ä¸»çº¿ç¨‹æ¥å¤„ç†ï¼Œé‚£ä¹ˆ Redis ä¸»çº¿ç¨‹å°±å¾ˆå®¹æ˜“å‘ç”Ÿé˜»å¡ å•çº¿ç¨‹æ¨¡å¼ï¼š åˆå§‹åŒ–\u0026ndash;\u0026gt;äº‹ä»¶å¾ªç¯å‡½æ•° äº‹ä»¶å¾ªç¯å‡½æ•°ï¼š è°ƒç”¨å¤„ç†å‘é€é˜Ÿåˆ—å‡½æ•°ï¼Œçœ‹æ˜¯å‘é€é˜Ÿåˆ—é‡Œæ˜¯å¦æœ‰ä»»åŠ¡ æœ‰å‘é€ä»»åŠ¡ï¼Œåˆ™é€šè¿‡ write å‡½æ•°ï¼Œå°†å®¢æˆ·ç«¯å‘é€ç¼“å­˜åŒºé‡Œçš„æ•°æ®å‘é€å‡ºå» å¦‚æœè¿™ä¸€è½®æ•°æ®æ²¡æœ‰å‘é€å®Œï¼Œå°±ä¼šæ³¨å†Œå†™äº‹ä»¶å¤„ç†å‡½æ•° è°ƒç”¨ epoll_waitå‡½æ•°ç­‰å¾…äº‹ä»¶ï¼Œè‹¥ä¸ºè¿æ¥äº‹ä»¶\u0026ndash;\u0026gt;è¿æ¥äº‹ä»¶å¤„ç†å‡½æ•° / è¯»äº‹ä»¶\u0026ndash;\u0026gt;è¯»å–å®¢æˆ·ç«¯å‘é€çš„å†…å®¹å¹¶å¤„ç†ï¼Œå°†æ‰§è¡Œç»“æœå†™åˆ°å®¢æˆ·ç«¯å‘é€ç¼“å†²åŒº / å†™äº‹ä»¶\u0026ndash;\u0026gt;é€šè¿‡writeå‘å®¢æˆ·ç«¯å‘é€å®¢æˆ·ç«¯å‘é€ç¼“å†²åŒºä¸­çš„æ•°æ® å•çº¿ç¨‹ä¸ºä»€ä¹ˆè¿˜å¿«ï¼Ÿâ€”â€”ååé‡10ä¸‡/s å¤§éƒ¨åˆ†æ“ä½œå†…å­˜å®Œæˆ é¿å…å¤šçº¿ç¨‹ç«äº‰ I/Oå¤šè·¯å¤ç”¨ æ–‡ä»¶æè¿°ç¬¦FDâ€”â€”OSä¸­æ¯ä¸ªæ‰“å¼€çš„èµ„æºï¼ˆæ–‡ä»¶ã€socketç­‰ï¼‰åœ¨è¿›ç¨‹ä¸­è¢«åˆ†é…å”¯ä¸€çš„æ•´æ•°FDï¼Œæœ‰å¯è¯»ã€å¯å†™çŠ¶æ€ Redisï¼ˆLinuxï¼‰ä½¿ç”¨epollå®ç°IOå¤šè·¯å¤ç”¨ï¼šç›‘å¬ç«¯å£ï¼ˆç›‘å¬å®¢æˆ·ç«¯è¿æ¥ï¼‰\u0026ndash;\u0026gt;ç›‘å¬FDæ³¨å†Œåˆ°epollï¼Œå…³æ³¨æ–°è¿æ¥ï¼ˆå¯è¯»äº‹ä»¶ï¼‰\u0026ndash;\u0026gt;äº‹ä»¶å¾ªç¯ï¼ˆé˜»å¡ç­‰å¾…äº‹ä»¶\u0026ndash;\u0026gt;è§¦å‘ç›‘å¬è¿æ¥å­—çš„å¯è¯»äº‹ä»¶ï¼ˆå†™å…¥æ—¶ï¼‰ï¼Œæ¥æ”¶è¿æ¥å¹¶å°†æ–°FDåŠ å…¥epoll\u0026ndash;\u0026gt;æŸå®¢æˆ·ç«¯FDè§¦å‘å¯è¯»äº‹ä»¶ï¼Œè¯»å–å‘½ä»¤å¹¶æ‰§è¡Œ\u0026ndash;\u0026gt;ç»“æœå†™å…¥è¾“å‡ºç¼“å†²åŒºï¼Œå…³æ³¨å¯å†™äº‹ä»¶ï¼‰ è§¦å‘ï¼šå¯¹ç«¯æœ‰æ•°æ®å†™å…¥æ—¶è§¦å‘ï¼ˆEPOLLINï¼ˆå¯è¯»ï¼‰æˆ–EPOLLOUTï¼ˆå¯å†™ï¼‰äº‹ä»¶ï¼‰ æ—©æœŸä¸ºä»€ä¹ˆæ˜¯å•çº¿ç¨‹ï¼ˆRedis6.0ä¹‹å‰ï¼‰ï¼Ÿ å•çº¿ç¨‹ç¨‹åºæ— æ³•ç”¨å¤šæ ¸CPU\nCPUå¹¶ä¸æ˜¯åˆ¶çº¦Redisæ€§èƒ½çš„ç“¶é¢ˆ æ›´å¤šå—å†…å†…å­˜å¤§å°\u0026amp;ç½‘ç»œI/Oé™åˆ¶ å¤šçº¿ç¨‹å¤æ‚åº¦é«˜ï¼Œå¯èƒ½å­˜åœ¨çº¿ç¨‹åˆ‡æ¢ã€åŠ é”è§£é”ä¸æ­»é”ç­‰æ€§èƒ½æŸè€— ä¸ºä»€ä¹ˆä¹‹åå¼•å…¥äº†å¤šçº¿ç¨‹ï¼Ÿ Redisä¸»è¦å·¥ä½œæ˜¯ç½‘ç»œI/Oä¸æ‰§è¡Œå‘½ä»¤\nå®é™…ä¸Šæ˜¯é‡‡ç”¨å¤šä¸ª I/O çº¿ç¨‹æ¥å¤„ç†ç½‘ç»œè¯·æ±‚ï¼Œéšç€ç½‘ç»œç¡¬ä»¶çš„æ€§èƒ½æå‡ï¼ŒRedis çš„æ€§èƒ½ç“¶é¢ˆæœ‰æ—¶ä¼šå‡ºç°åœ¨ç½‘ç»œ I/O çš„å¤„ç†ä¸Š ä½†å‘½ä»¤çš„å¤„ç†è¿˜æ˜¯ä½¿ç”¨å•çº¿ç¨‹ 6.0ä¹‹åï¼Œé»˜è®¤æƒ…å†µä¸‹I/O å¤šçº¿ç¨‹åªé’ˆå¯¹å‘é€å“åº”æ•°æ®ï¼ˆwrite client socketï¼‰ã€‚å¯ä»¥è®¾ç½®io-threads-do-readså¤šçº¿ç¨‹å¤„ç†è¯»è¯·æ±‚ 6.0ä¹‹åé»˜è®¤æƒ…å†µä¸‹é¢å¤–åˆ›å»º6ä¸ªçº¿ç¨‹ï¼ˆé™¤ä¸»çº¿ç¨‹ï¼Œä¸»çº¿ç¨‹ä¸»è¦è´Ÿè´£æ‰§è¡Œå‘½ä»¤ï¼Œä¹Ÿå¯ä»¥å¤„ç†I/Oï¼‰ï¼šåå°çº¿ç¨‹x3ï¼Œé¢å¤–çš„I/Oçº¿ç¨‹x3ï¼ˆè®¾ç½®io-threads é»˜è®¤ 4ï¼Œé™¤å»ä¸»çº¿ç¨‹å³ä¸º3ä¸ªï¼‰ æŒä¹…åŒ– å†…å­˜ä¸­æ‰§è¡Œï¼Œæ€ä¹ˆä¿è¯æŒä¹…åŒ–ï¼Ÿ\næ–¹å¼ï¼šAOFæ—¥å¿— RDBå¿«ç…§ æ··åˆæŒä¹…åŒ– AOFï¼šæ¯æ‰§è¡Œä¸€æ¡å†™æ“ä½œå‘½ä»¤ï¼Œå°±æŠŠè¯¥å‘½ä»¤ä»¥è¿½åŠ çš„æ–¹å¼å†™å…¥åˆ°ä¸€ä¸ªæ–‡ä»¶é‡Œâ€”â€”å…ˆå†™åè®° RDBï¼šå°†æŸä¸€æ—¶åˆ»çš„å†…å­˜æ•°æ®ï¼Œä»¥äºŒè¿›åˆ¶çš„æ–¹å¼å†™å…¥ç£ç›˜ æ··åˆï¼šRedis 4.0 æ–°å¢çš„æ–¹å¼ï¼Œé›†æˆäº† AOF å’Œ RBD çš„ä¼˜ç‚¹ AOFæ—¥å¿—ï¼šå†™å…¥çš„æ–‡ä»¶åœ¨ç£ç›˜ä¸­ï¼Œé‡å¯æ—¶è¯»å–è¯¥æ–‡ä»¶è®°å½•çš„æ“ä½œå‘½ä»¤ï¼Œç„¶åé€ä¸€æ‰§è¡Œï¼ˆå®ç°æ•°æ®æ¢å¤ï¼‰ å¥½å¤„ï¼š é¿å…é¢å¤–çš„æ£€æŸ¥å¼€é”€ï¼ˆå¦‚æœå‘½ä»¤è¯­æ³•æœ‰é—®é¢˜ï¼Œåˆå†™å…¥äº†æ—¥å¿— æ¢å¤æ•°æ®æ—¶æœ‰é—®é¢˜ï¼‰ ä¸ä¼šé˜»å¡å½“å‰å†™æ“ä½œå‘½ä»¤çš„æ‰§è¡Œï¼ˆå†™æˆåŠŸåæ‰ä¼šè®°å½•ï¼‰ åå¤„ï¼š æ•°æ®å¯èƒ½ä¸¢å¤±ï¼ˆæ‰§è¡Œå®Œæ²¡æ¥å¾—åŠå†™å…¥æ—¥å¿—ï¼‰ å¯èƒ½é˜»å¡å…¶ä»–æ“ä½œï¼ˆAOFæ—¥å¿—ä¹Ÿåœ¨ä¸»çº¿ç¨‹ä¸­æ‰§è¡Œï¼‰ å…·ä½“è¿‡ç¨‹ï¼š Redis æ‰§è¡Œå®Œå†™æ“ä½œå‘½ä»¤åï¼Œå°†å‘½ä»¤è¿½åŠ åˆ° server.aof_buf ç¼“å†²åŒº é€šè¿‡ write() ç³»ç»Ÿè°ƒç”¨ï¼Œå°† aof_buf ç¼“å†²åŒºçš„æ•°æ®å†™å…¥åˆ° AOF æ–‡ä»¶ã€‚å¹¶æœªå†™å…¥ç¡¬ç›˜ï¼Œè€Œæ˜¯æ‹·è´åˆ°äº†å†…æ ¸ç¼“å†²åŒº page cacheï¼Œç­‰å¾…å†…æ ¸å°†æ•°æ®å†™å…¥ å†…æ ¸å†³å®šä½•æ—¶å†™å…¥â€”â€”Redis.confæ–‡ä»¶å¯é…ç½®appendfsyncï¼ˆalwaysæ¯æ¬¡å†™æ“ä½œæ‰§è¡Œå®Œå†™å› everysecæ¯ç§’å†™å› noç”±OSå†³å®šå†™å›æ—¶æœºï¼‰ AOFæ—¥å¿—è¿‡å¤§ï¼Œä¼šï¼Ÿ ä¼šAOFé‡å†™æ¥å‹ç¼©AOFæ–‡ä»¶â€”â€”è¯»å–å½“å‰æ•°æ®åº“ä¸­çš„æ‰€æœ‰é”®å€¼å¯¹ï¼Œç„¶åå°†æ¯ä¸ªé”®å€¼å¯¹ç”¨ä¸€æ¡å‘½ä»¤è®°å½•åˆ°æ–°çš„AOFæ–‡ä»¶ï¼Œå…¨éƒ¨è®°å½•å®Œåæ›¿æ¢ç°æœ‰AOF å¦‚é‡å¤è®°å½•set name balablï¼Œåªä¿ç•™æœ€æ–°æ•°æ®å³å¯ é‡å†™AOFæ—¥å¿—çš„è¿‡ç¨‹ï¼Ÿ ç”±åå°å­è¿›ç¨‹ bgrewriteaof å®Œæˆ å¥½å¤„ï¼šé¿å…é˜»å¡ä¸»è¿›ç¨‹ \u0026amp; è‹¥ä½¿ç”¨çº¿ç¨‹ï¼Œå¤šçº¿ç¨‹é—´ä¼šå…±äº«å†…å­˜ï¼Œä¿®æ”¹å…±äº«æ•°æ®æ—¶éœ€è¦åŠ é”ï¼Œäº²å­è¿›ç¨‹é—´ä»¥åªè¯»æ–¹å¼å…±äº«æ•°æ®ï¼Œè‹¥ä¿®æ”¹ä¼šå‘ç”Ÿå†™æ—¶å¤åˆ¶ï¼Œå³äº²å­é—´æœ‰ç‹¬ç«‹çš„æ•°æ®å‰¯æœ¬ï¼ˆä¸ç”¨åŠ é”ï¼‰ é‡å†™æ—¶ä¸»è¿›ç¨‹ä¾ç„¶æ­£å¸¸å¤„ç†å‘½ä»¤ï¼Œä¼šå°†å†™å‘½ä»¤å†™å…¥åˆ° ã€ŒAOF ç¼“å†²åŒºã€å’Œã€ŒAOF é‡å†™ç¼“å†²åŒºã€ï¼ˆåˆ›å»ºå­è¿›ç¨‹åå¯ç”¨ï¼‰ å­è¿›ç¨‹å®Œæˆé‡å†™æ—¶å‘ä¸»è¿›ç¨‹å‘é€ï¼ˆå¼‚æ­¥ï¼‰ä¿¡å·ï¼ˆè¿›ç¨‹é—´é€šè®¯çš„ä¸€ç§æ–¹å¼ï¼‰ ä¸»è¿›ç¨‹æ”¶åˆ°ä¿¡å·ï¼Œå°† AOF é‡å†™ç¼“å†²åŒºä¸­çš„æ‰€æœ‰å†…å®¹è¿½åŠ åˆ°æ–°çš„ AOF çš„æ–‡ä»¶ä¸­ï¼Œæ–°çš„ AOF çš„æ–‡ä»¶æ”¹åï¼Œè¦†ç›–ç°æœ‰çš„ AOF æ–‡ä»¶ RDBå¿«ç…§ï¼šè®°å½•å®é™…æ•°æ® å¿«ç…§æ—¶æ˜¯å¦é˜»å¡çº¿ç¨‹ï¼Ÿ æ‰§è¡Œsaveï¼Œåœ¨ä¸»çº¿ç¨‹ç”ŸæˆRDBæ–‡ä»¶â€”â€”ä¼šé˜»å¡ æ‰§è¡Œbgsaveï¼Œå­è¿›ç¨‹ç”ŸæˆRDBæ–‡ä»¶â€”â€”é¿å…é˜»å¡ é…ç½®æ–‡ä»¶ä¸­è®¾ç½®saveå³ä¸ºbgsave å…¨é‡å¿«ç…§â€”â€”å†…å­˜ä¸­æ‰€æœ‰æ•°æ®éƒ½è®°å½• æ‰§è¡Œå¿«ç…§æ—¶ æ•°æ®èƒ½ä¿®æ”¹å—ï¼Ÿâ€”â€”ä¸“æŒ‡bgsave å¯ä»¥ï¼Œé‡‡ç”¨å†™æ—¶å¤åˆ¶ï¼ˆCopy-On-Write, COWï¼‰â€”â€”æ‰§è¡Œ bgsave å‘½ä»¤çš„æ—¶å€™ï¼Œä¼šé€šè¿‡ fork() åˆ›å»ºå­è¿›ç¨‹ å…±äº«å†…å­˜æ•°æ® ä¸»çº¿ç¨‹æ‰§è¡Œå†™æ“ä½œï¼Œå°†è¢«ä¿®æ”¹çš„æ•°æ®å¤åˆ¶å‰¯æœ¬ï¼Œå­è¿›ç¨‹å°†å‰¯æœ¬æ•°æ®å†™å…¥RDBæ–‡ä»¶ï¼Œä¸»è¿›ç¨‹å¯ç›´æ¥ä¿®æ”¹æ•°æ® æ··åˆæŒä¹…åŒ–ï¼Ÿ AOFä¸¢å¤±æ•°æ®å°‘ä½†æ¢å¤é€Ÿåº¦ä¸å¿«ï¼ŒRDBå¿«ç…§é¢‘ç‡ä¸å¥½ç¡®å®šï¼Œè¿‡ä½ä¸¢å¤±æ•°æ®å¤šï¼Œè¿‡é«˜å½±å“æ€§èƒ½\nå¦‚ä½•å®ç°ï¼Ÿ å·¥ä½œåœ¨AOFé‡å†™è¿‡ç¨‹ï¼šé‡å†™å­è¿›ç¨‹å°†ä¸ä¸»çº¿ç¨‹å…±äº«çš„å†…å­˜æ•°æ®ä»¥ RDB æ–¹å¼å†™å…¥åˆ° AOF æ–‡ä»¶ï¼Œä¸»çº¿ç¨‹å¤„ç†çš„æ“ä½œå‘½ä»¤è¢«è®°å½•åœ¨é‡å†™ç¼“å†²åŒºï¼Œé‡å†™ç¼“å†²åŒºé‡Œçš„å¢é‡å‘½ä»¤ä¼šä»¥ AOF æ–¹å¼å†™å…¥åˆ° AOF æ–‡ä»¶ã€‚é‡å†™å®Œæˆåæ›¿æ¢ã€‚ AOFä¸­å‰åŠæ˜¯RDBæ ¼å¼å…¨é‡æ•°æ®ï¼ŒååŠæ˜¯AOFæ ¼å¼å¢é‡æ•°æ® ä¼˜ç‚¹ï¼šå¼€å¤´ä¸º RDB çš„æ ¼å¼ï¼Œä½¿å¾— Redis å¯ä»¥æ›´å¿«çš„å¯åŠ¨ + ç»“åˆ AOF ä¼˜ç‚¹ï¼Œå‡ä½äº†å¤§é‡æ•°æ®ä¸¢å¤±çš„é£é™© ç¼ºç‚¹ï¼šæ·»åŠ äº†RDBæ ¼å¼å†…å®¹ï¼ŒAOF æ–‡ä»¶çš„å¯è¯»æ€§å¾ˆå·® + å…¼å®¹æ€§å·®ï¼ŒRedis4.0å‰ç‰ˆæœ¬ä¸èƒ½è¯†åˆ« é›†ç¾¤ lessâ­ ä¸»ä»å¤åˆ¶ï¼šä¸€ä¸»å¤šä» è¯»å†™åˆ†ç¦» ä¸»æœåŠ¡å™¨è¯»å†™ï¼Œå‘ç”Ÿå†™æ—¶åŒæ­¥åˆ°ä»ï¼›ä»ä¸€èˆ¬åªè¯»ï¼Œæ¥å—ä¸»æœåŠ¡å™¨çš„å†™å‘½ä»¤å¹¶æ‰§è¡Œ å¼‚æ­¥ï¼šä¸»æœåŠ¡å™¨åœ¨æœ¬åœ°æ‰§è¡Œå®Œå‘½ä»¤ï¼Œå°±å‘å®¢æˆ·ç«¯è¿”å›ç»“æœ\u0026ndash;\u0026gt;æ— æ³•å®ç°å¼ºä¸€è‡´æ€§ï¼ˆæ—¶åˆ»ä¸€è‡´ï¼‰ å“¨å…µæ¨¡å¼sentinelï¼šç›‘æ§ä¸»ä»æœåŠ¡å™¨ \u0026amp; ä¸»ä»èŠ‚ç‚¹æ•…éšœè½¬ç§»åŠŸèƒ½ï¼ˆä¸æ‡‚ï¼‰\u0026ndash;\u0026gt;é€‰ä¸€ä¸ªæ–°leader åˆ‡ç‰‡é›†ç¾¤clusterï¼šï¼ˆä¸€ä¸ªï¼‰åˆ‡ç‰‡é›†ç¾¤æœ‰ 16384 ä¸ªå“ˆå¸Œæ§½ï¼Œç±»ä¼¼äºæ•°æ®åˆ†åŒºï¼Œæ¯ä¸ªé”®å€¼å¯¹æ ¹æ®å®ƒçš„ keyï¼Œè¢«æ˜ å°„åˆ°ä¸€ä¸ªå“ˆå¸Œæ§½\u0026ndash;\u0026gt;å“ˆå¸Œæ§½è¢«æ˜ å°„åˆ°å…·ä½“çš„RedisèŠ‚ç‚¹ï¼ˆIPä¸åŒçš„å°±æ˜¯ä¸åŒèŠ‚ç‚¹ï¼‰ å“ˆå¸Œæ§½çš„æ˜ å°„ï¼šå¹³å‡åˆ†é… / æ‰‹åŠ¨åˆ†é…ï¼ˆcluster meet èŠ‚ç‚¹å»ºç«‹è¿æ¥åï¼Œcluster addslots æŒ‡å®šå„èŠ‚ç‚¹ä¸Šå“ˆå¸Œæ§½æ•°ï¼‰ é›†ç¾¤è„‘è£‚é—®é¢˜ä¸è§£å†³ é›†ç¾¤è„‘è£‚æ˜¯å•¥ï¼Ÿ ç”±äºç½‘ç»œé—®é¢˜ï¼Œé›†ç¾¤èŠ‚ç‚¹ä¹‹é—´å¤±å»è”ç³»ï¼ˆä¸»ä»é—´ï¼‰\u0026ndash;\u0026gt;å“¨å…µé‡é€‰ä¸»èŠ‚ç‚¹ï¼Œäº§ç”Ÿä¸¤ä¸ªä¸»æœåŠ¡\u0026ndash;\u0026gt;ç½‘ç»œæ¢å¤ï¼Œæ—§ä¸»èŠ‚ç‚¹é™çº§ä¸ºä»èŠ‚ç‚¹ï¼Œéœ€è¦ä¸æ–°ä¸»è¿›è¡ŒåŒæ­¥å¤åˆ¶\u0026ndash;\u0026gt;ä»èŠ‚ç‚¹æ¸…ç©ºè‡ªå·±ç¼“å†²åŒºï¼ˆä¹‹å‰æœªåŒæ­¥çš„æ•°æ®ï¼‰\u0026ndash;\u0026gt;å®¢æˆ·ç«¯å½“æ—¶å†™å…¥çš„æ•°æ®ä¸¢å¤± è§£å†³ï¼š å½“ä¸»èŠ‚ç‚¹å‘ç°ä»èŠ‚ç‚¹ä¸‹çº¿æˆ–è€…é€šä¿¡è¶…æ—¶çš„æ€»æ•°é‡å°äºé˜ˆå€¼æ—¶ï¼Œå°±ç¦æ­¢ä¸»èŠ‚ç‚¹å†™æ•°æ®ï¼ŒæŠŠé”™è¯¯è¿”å›ç»™å®¢æˆ·ç«¯\u0026ndash;\u0026gt;ç­‰å¾…æ–°ä¸»æœºä¸Šçº¿åå†™ å¯ä»¥è®¾ç½®å‚æ•° min-slaves-to-write xã€min-slaves-max-lag xè‹¥ä»èŠ‚ç‚¹è¿æ¥æ•°å°äºç¬¬ä¸€ä¸ª/å»¶è¿Ÿè¶…è¿‡ç¬¬äºŒä¸ªï¼Œä¸»èŠ‚ç‚¹ç¦æ­¢å†™ è¿‡æœŸåˆ é™¤ä¸å†…å­˜æ·˜æ±° Redisçš„è¿‡æœŸåˆ é™¤ç­–ç•¥ï¼Ÿ\u0026ndash;\u0026gt; æƒ°æ€§åˆ é™¤ + å®šæ—¶åˆ é™¤ è®¾ç½®äº†è¿‡æœŸæ—¶é—´çš„keyè¢«å¸¦ä¸Šè¿‡æœŸæ—¶é—´å­˜å‚¨åˆ°è¿‡æœŸå­—å…¸ ï¼ˆä¸ä¸»åŠ¨åˆ é™¤é”®ï¼‰æŸ¥è¯¢keyæ—¶å…ˆæ£€æŸ¥æ˜¯å¦åœ¨è¿‡æœŸå­—å…¸ä¸­ï¼Œåœ¨åˆ™æ¯”å¯¹ç³»ç»Ÿæ—¶é—´ï¼Œåˆ¤æ–­æ˜¯å¦è¿‡æœŸâ€”â€”æƒ°æ€§åˆ é™¤ ä¼˜ç¼ºç‚¹ï¼šå ç”¨å¾ˆå°‘çš„ç³»ç»Ÿèµ„æº å¯¹CPUæ—¶é—´å‹å¥½ but è¿‡æœŸkeyä¸€ç›´ä¸è¢«è®¿é—®ï¼Œå¯¹å†…å­˜ä¸å‹å¥½ï¼ˆå†…å­˜ä¸é‡Šæ”¾ï¼‰ å®šæœŸåˆ é™¤ï¼šæ¯éš”ä¸€æ®µæ—¶é—´éšæœºæŠ½å–ä¸€å®šé‡çš„keyï¼Œæ£€æŸ¥å¹¶åˆ é™¤ï¼Œè‹¥è¿‡æœŸkeyè¶…è¿‡ä¸€å®šæ¯”ä¾‹åˆ™ç»§ç»­éšæœºæŠ½å–Â·Â·Â·\u0026ndash;\u0026gt;é™åˆ¶æ—¶é—´ä¸Šé™ ä¼˜ç¼ºç‚¹ï¼šbalabalï¼ˆé™åˆ¶æ—¶é•¿é¢‘ç‡å‡å°‘cpuå ç”¨ å‡å°‘è¿‡æœŸé”®å¯¹ç©ºé—´çš„å ç”¨ï¼‰ but éš¾ä»¥ç¡®å®šåˆ é™¤çš„æ—¶é•¿ä¸é¢‘ç‡ æŒä¹…åŒ–æ—¶æ€ä¹ˆå¤„ç†è¿‡æœŸé”®ï¼Ÿ RDBâ€”â€”ç”ŸæˆRDBæ—¶ä¸ä¿å­˜è¿‡æœŸäº†çš„é”®ï¼›åŠ è½½æ—¶ä¸»æœåŠ¡å™¨ä¸è½½å…¥ï¼Œä»æœåŠ¡å™¨è½½å…¥ï¼ˆä½†æ•°æ®åŒæ­¥æ—¶ï¼Œä»æœåŠ¡å™¨æ•°æ®ä¼šè¢«æ¸…ç©ºï¼‰ AOFâ€”â€”å†™å…¥æ—¶è‹¥è¿‡æœŸé”®æœªè¢«åˆ é™¤ï¼ŒAOFä¼šä¿ç•™ï¼Œè¢«åˆ é™¤æ—¶å‘AOFè¿½åŠ DELå‘½ä»¤ï¼›é‡å†™æ—¶ä¸é‡å†™è¿‡æœŸé”® ä¸»ä»æ¨¡å¼ä¸‹æ€ä¹ˆå¤„ç†è¿‡æœŸé”®ï¼Ÿ ä»åº“ä¸è¿›è¡Œè¿‡æœŸæ‰«æï¼Œä¸»åº“åˆ é™¤é”®ï¼Œåœ¨AOFæ–‡ä»¶ä¸­å¢åŠ DELæŒ‡ä»¤ï¼ŒæŒ‡ä»¤åŒæ­¥åˆ°ä»åº“ Rediså†…å­˜æ»¡äº†ä¹‹åï¼Ÿ å†…å­˜æ·˜æ±°æœºåˆ¶ å†…å­˜æ·˜æ±°ç­–ç•¥æœ‰ï¼Ÿ ä¸è¿›è¡Œæ•°æ®æ·˜æ±°â€”â€”noeviction è¶…è¿‡æœ€å¤§å†…å­˜æ—¶åœæ­¢æä¾›æœåŠ¡ï¼Œç›´æ¥è¿”å›é”™è¯¯ï¼ˆRedis3.0åé»˜è®¤ï¼‰ è¿›è¡Œæ•°æ®æ·˜æ±°ï¼š åœ¨è®¾ç½®äº†TTLçš„æ•°æ®ä¸­æ·˜æ±°ï¼š volatile-random éšæœºæ·˜æ±°è®¾ç½®äº†TTLçš„ä»»æ„é”®å€¼ volatile-ttl ä¼˜å…ˆæ·˜æ±°æ›´æ—©è¿‡æœŸçš„é”®å€¼ volatile-lru æ·˜æ±°æ‰€æœ‰è®¾ç½®äº†TTLçš„æœ€ä¹…æœªä½¿ç”¨çš„é”®å€¼ï¼ˆRedis3.0å‰é»˜è®¤ï¼‰ volatile-lfu æ·˜æ±°æ‰€æœ‰è®¾ç½®äº†TTLçš„æœ€å°‘ä½¿ç”¨çš„é”®å€¼ æ‰€æœ‰æ•°æ®èŒƒå›´ï¼š allkeys-random/allkeys-lru/allkeys-lfu LRU vs LFU Least Recently Used ä¸ Least Frequently Used\nLRUæ˜¯ï¼Ÿ é“¾è¡¨ï¼Œè¢«ä½¿ç”¨çš„ç§»åˆ°é“¾è¡¨å¤´ï¼Œè¦åˆ é™¤æ—¶åˆ é™¤é“¾è¡¨å°¾å…ƒç´ å³å¯ é—®é¢˜ï¼šéœ€è¦é“¾è¡¨ï¼Œå¸¦æ¥é¢å¤–ç©ºé—´å¼€é”€ï¼›éœ€è¦ç§»åŠ¨æ•°æ®ï¼Œå¤§é‡æ•°æ®è¦æ“ä½œæ—¶ä¼šè€—æ—¶ Redisçš„LRUå®ç° åœ¨ Redis çš„å¯¹è±¡ç»“æ„ä½“redisObjectï¼ˆç®¡ç†æŸæ•°æ®ç±»å‹çš„æ•°æ®å¯¹è±¡ï¼‰ä¸­æ·»åŠ é¢å¤–çš„å­—æ®µè®°å½•æ­¤æ•°æ®çš„æœ€åä¸€æ¬¡è®¿é—®æ—¶é—´ \u0026ndash;\u0026gt; éšæœºé‡‡æ ·ï¼Œæ·˜æ±°æœ€ä¹…æ²¡ç”¨çš„ ç¼ºç‚¹ï¼šç¼“å­˜æ±¡æŸ“ä¸èƒ½è§£å†³ï¼ˆä¸€æ¬¡æ€§ç¼“å­˜åˆ ä¸äº†ï¼‰ LFUï¼Ÿ Redis4.0åå¼•å…¥ï¼Œè®°å½•è®¿é—®æ¬¡æ•° Redisçš„LFUï¼Ÿ ä¹Ÿè®°å½•åœ¨redisObjectçš„lruå­—æ®µä¸­\nå¤šè®°å½•ã€Œæ•°æ®çš„è®¿é—®é¢‘æ¬¡ã€çš„ä¿¡æ¯ \u0026ndash;\u0026gt; 24 bits çš„ lru å­—æ®µä¸­é«˜16bitè®°å½•è®¿é—®æ—¶é—´æˆ³ï¼Œä½8ä½è®°å½•è®¿é—®é¢‘æ¬¡ ç¼“å­˜è®¾è®¡ é¿å…ç¼“å­˜é›ªå´©ï¼Ÿ æ‰“æ•£ç¼“å­˜TTL è®¾ç½®ç¼“å­˜ä¸è¿‡æœŸâ€”â€”åå°æ›´æ–°ç¼“å­˜ é¿å…ç¼“å­˜å‡»ç©¿ï¼Ÿ çƒ­ç‚¹keyé—®é¢˜ï¼Œçƒ­ç‚¹keyè¿‡æœŸ\u0026ndash;\u0026gt;ç±»ä¼¼ç¼“å­˜é›ªå´©\näº’æ–¥é”\u0026ndash;\u0026gt;æœªèƒ½è·å–äº’æ–¥é”çš„è¯·æ±‚ï¼Œè¦ä¹ˆç­‰å¾…é”é‡Šæ”¾åé‡æ–°è¯»å–ç¼“å­˜ï¼Œè¦ä¹ˆè¿”å›ç©ºå€¼æˆ–é»˜è®¤å€¼ çƒ­ç‚¹keyä¸è®¾ç½®è¿‡æœŸæ—¶é—´ é¿å…ç¼“å­˜ç©¿é€ï¼Ÿ éæ³•è¯·æ±‚é™åˆ¶ è®¾ç½®ç©ºå€¼/é»˜è®¤å€¼ å¸ƒéš†è¿‡æ»¤å™¨ å¦‚ä½•è®¾è®¡ç¼“å­˜ç­–ç•¥ä»¥åŠ¨æ€ç¼“å­˜çƒ­ç‚¹æ•°æ® æ€»ä½“æ€è·¯ï¼šé€šè¿‡æ•°æ®æœ€æ–°è®¿é—®æ—¶é—´æ¥åšæ’åï¼Œå¹¶è¿‡æ»¤æ‰ä¸å¸¸è®¿é—®çš„æ•°æ® ç¼“å­˜æ›´æ–°ç­–ç•¥ï¼Ÿè¯¦è§ æ—è·¯ç¼“å­˜ è¯»ç©¿/å†™ç©¿ å†™å› ä¿è¯æ—è·¯ç¼“å­˜çš„ç¬¬äºŒæ­¥ åˆ ç¼“å­˜ æˆåŠŸçš„æ–¹æ³•ï¼š é€šè¿‡æ¶ˆæ¯é˜Ÿåˆ—ï¼Œé‡è¯•ç¼“å­˜åˆ é™¤ï¼ˆåˆ é™¤æˆåŠŸåˆ™ç§»å‡ºé˜Ÿåˆ—ï¼‰\u0026ndash;\u0026gt;ä¸šåŠ¡ä»£ç ä¾µå…¥ è®¢é˜… MySQL binlogï¼ˆæ›´æ–°åä¼šæ›´æ–°binlogï¼‰ + æ¶ˆæ¯é˜Ÿåˆ— + é‡è¯•ç¼“å­˜çš„åˆ é™¤\u0026ndash;\u0026gt;é¿å…å…¥ä¾µ but å¼•å…¥ç»„ä»¶å¤š é‡‡é›†binlogæ—¥å¿—ä¿¡æ¯ï¼Œå‘é€åˆ°MQé˜Ÿåˆ— \u0026ndash;\u0026gt; ç¼–å†™ä¸€ä¸ªç®€å•çš„ä¾›ç¼“å­˜åˆ é™¤æ¶ˆæ¯è€…ï¼ˆéœ€è¦æ¥æ”¶/å‘é€ åˆ é™¤ç¼“å­˜ æ¶ˆæ¯çš„ï¼‰è®¢é˜…çš„binlogæ—¥å¿— \u0026ndash;\u0026gt; æ ¹æ®æ›´æ–°çš„logåˆ é™¤ç¼“å­˜ï¼Œé€šè¿‡ACKæœºåˆ¶ç¡®è®¤å¤„ç†è¿™æ¡æ›´æ–°log å®æˆ˜ å¦‚ä½•å®ç°å»¶è¿Ÿé˜Ÿåˆ—ï¼Ÿâ€”â€”ä¸‹å•åè¶…è¿‡ä¸€å®šæ—¶é—´æœªæ”¯ä»˜åˆ™å–æ¶ˆ Zsetï¼Œå…¶ä¸­Scoreå±æ€§å¯ä»¥å­˜å‚¨å»¶è¿Ÿæ‰§è¡Œçš„æ—¶é—´ï¼ˆæœ€æ™šçš„æ—¶é—´ï¼ŒæŸ¥æ‰¾æ—¶æ’åºé€‰æ‹©scoreå°äºç³»ç»Ÿæ—¶é—´çš„ï¼‰ Redisçš„å¤§keyé—®é¢˜ ä»€ä¹ˆæ˜¯å¤§key valueå¤§çš„key\u0026ndash;\u0026gt;String ç±»å‹çš„å€¼å¤§äº 10 KB / Hashã€Listã€Setã€ZSet ç±»å‹çš„å…ƒç´ çš„ä¸ªæ•°è¶…è¿‡ 5000ä¸ª å¯èƒ½çš„é—®é¢˜ï¼Ÿ ç”±äºå¤§keyæ“ä½œæ›´è€—æ—¶è€Œäº§ç”Ÿ\nå®¢æˆ·ç«¯è¶…æ—¶é˜»å¡ï¼šæ“ä½œè€—æ—¶ï¼Œå®¢æˆ·ç«¯è§†ä¸ºå¾ˆä¹…ä¸å“åº” ç½‘ç»œé˜»å¡ï¼šè·å–å¤§keyäº§ç”Ÿçš„ç½‘ç»œæµé‡å¤§\u0026ndash;\u0026gt;å¦‚æœä¸€ä¸ª key çš„å¤§å°æ˜¯ 1 MBï¼Œæ¯ç§’è®¿é—®é‡ä¸º1000ï¼Œé‚£ä¹ˆæ¯ç§’ä¼šäº§ç”Ÿ 1000MB çš„æµé‡ å·¥ä½œçº¿ç¨‹é˜»å¡ï¼šdelåˆ é™¤å¤§keyæ—¶ä¼šé˜»å¡ å†…å­˜åˆ†å¸ƒä¸å‡ï¼šéƒ¨åˆ†æœ‰å¤§ key çš„ RedisèŠ‚ç‚¹å ç”¨å†…å­˜å¤šï¼ŒQPS ä¹Ÿä¼šæ¯”è¾ƒå¤§ Redisç®¡é“ï¼Ÿ å®¢æˆ·ç«¯æä¾›çš„æ‰¹å¤„ç†æŠ€æœ¯ï¼Œç”¨äºä¸€æ¬¡å¤„ç†å¤šä¸ª Redis å‘½ä»¤\u0026ndash;\u0026gt;ä¸€æ¬¡æ€§å‘é€å¤šä¸ªå‘½ä»¤ï¼Œå¤„ç†åä¸€èµ·è¿”å› ä¼˜ç¼ºç‚¹ï¼šè§£å†³å¤šä¸ªå‘½ä»¤æ‰§è¡Œæ—¶çš„ç½‘ç»œç­‰å¾… but å‘é€çš„å‘½ä»¤è¿‡å¤§ï¼Œæˆ–ç®¡é“å†…çš„æ•°æ®å¤ªå¤šä¼šå¯¼è‡´ç½‘ç»œé˜»å¡ Redisäº‹åŠ¡æ”¯æŒå›æ»šå—ï¼Ÿ NOã€‚ç±»ä¼¼çš„Discardå‘½ä»¤åªèƒ½ä¸»åŠ¨æ”¾å¼ƒäº‹åŠ¡æ‰§è¡Œï¼Œæ¸…ç©ºæš‚å­˜çš„å‘½ä»¤é˜Ÿåˆ—ï¼ˆæ²¡å®Œæˆçš„æ‰”æ‰ï¼Œå®Œæˆäº†çš„å·²ç»å†™å…¥\u0026ndash;\u0026gt;ä¸ä¿è¯åŸå­æ€§ï¼‰ å¦‚ä½•å®ç°åˆ†å¸ƒå¼é”â€”â€”setNX åŠ é”ï¼šsetNX+ è¿‡æœŸæ—¶é—´+åŒºåˆ†å®¢æˆ·ç«¯ï¼ˆå”¯ä¸€æ ‡è¯†ï¼‰ è§£é”ï¼šåˆ¤æ–­ç”¨æˆ·+åˆ é™¤é”é”® ï¼ˆRediså®ç°åˆ†å¸ƒå¼é”çš„ï¼‰ä¼˜ç¼ºç‚¹ï¼šé«˜æ•ˆã€å®ç°æ–¹ä¾¿ã€é¿å…å•ç‚¹æ•…éšœ but è¶…æ—¶æ—¶é—´ä¸å¥½è®¾ç½®ã€ä¸»ä»å¼‚æ­¥å¤åˆ¶ é”ä¸å¯é ï¼ˆä¸»è·å¾—é”ï¼Œæœªå¤åˆ¶æ—¶è‹¥ä¸»å®•æœºï¼Œæ–°çš„ä¸»è¿˜å¯ä»¥è·å–é”ï¼‰ å¦‚ä½•åˆç†è®¾ç½®è¶…æ—¶æ—¶é—´ï¼šåŸºäºç»­çº¦çš„æ–¹å¼è®¾ç½®ï¼Œè®¾ç½®è¶…æ—¶æ—¶é—´åå¯åŠ¨å®ˆæŠ¤çº¿ç¨‹ï¼Œå…¶åœ¨ä¸€æ®µæ—¶é—´åï¼Œé‡æ–°è®¾ç½®é”çš„è¶…æ—¶æ—¶é—´ é›†ç¾¤æƒ…å†µå¦‚ä½•ä¿è¯åˆ†å¸ƒå¼é”çš„å¯é æ€§ RedLockçº¢é” åŸºäºå¤šä¸ªRedisèŠ‚ç‚¹ è®©å®¢æˆ·ç«¯å’Œå¤šä¸ªç‹¬ç«‹çš„ Redis èŠ‚ç‚¹ä¾æ¬¡è¯·æ±‚ç”³è¯·åŠ é”ï¼Œå¦‚æœå®¢æˆ·ç«¯èƒ½å¤Ÿå’ŒåŠæ•°ä»¥ä¸Šçš„èŠ‚ç‚¹æˆåŠŸåœ°å®ŒæˆåŠ é”æ“ä½œï¼Œé‚£ä¹ˆè®¤ä¸ºå®¢æˆ·ç«¯æˆåŠŸåœ°è·å¾—åˆ†å¸ƒå¼é”ï¼Œå¦åˆ™åŠ é”å¤±è´¥ åŠ é”å¤±è´¥åï¼Œå®¢æˆ·ç«¯å‘æ‰€æœ‰ Redis èŠ‚ç‚¹å‘èµ·é‡Šæ”¾é”çš„æ“ä½œï¼Œé‡Šæ”¾é”çš„æ“ä½œå’Œåœ¨å•èŠ‚ç‚¹ä¸Šé‡Šæ”¾é”çš„æ“ä½œä¸€æ · æ‚ä¸ƒæ‚å…«â­â­ è¿›ç¨‹ä¸çº¿ç¨‹çš„åŒºåˆ«ï¼Ÿ è¿›ç¨‹æ˜¯OSå±‚é¢ æ˜¯ç¨‹åºçš„ä¸€æ¬¡æ‰§è¡Œè¿‡ç¨‹ ä¸€ä¸ªè¿›ç¨‹å†…å¯èƒ½æœ‰å¤šä¸ªçº¿ç¨‹ çº¿ç¨‹æ˜¯CPUè°ƒåº¦çš„åŸºæœ¬å•ä½ å…±äº«è¿›ç¨‹çš„åœ°å€ç©ºé—´ä¸å†…å­˜èµ„æº Javaä¸­ ä¸åŒçº¿ç¨‹æ‹¥æœ‰ç‹¬ç«‹çš„JVMæ ˆï¼ˆjavaè™šæ‹Ÿæœºï¼‰ æœ¬åœ°æ–¹æ³•æ ˆ ç¨‹åºè®¡æ•°å™¨ è¿›ç¨‹é€šä¿¡éœ€è¦ç®¡é“ã€ä¿¡å·é‡ç­‰ çº¿ç¨‹é€šä¿¡é€šè¿‡å…±äº«èµ„æºçš„è¯»å†™æ“ä½œå®ç° Mapåº•å±‚å®ç°ï¼š HashMapï¼šJDK1.8ä¹‹å‰ æ•°ç»„+é“¾è¡¨ï¼ˆè§£å†³å“ˆå¸Œå†²çªé—®é¢˜â€”â€”æ‹‰é“¾æ³•ï¼‰ vs JDK1.8å é“¾è¡¨é•¿åº¦å¤§äºé˜ˆå€¼ï¼ˆä¸€èˆ¬ä¸º8ï¼‰æ—¶ æ•°ç»„é•¿åº¦å°äº64å°±è¿›è¡Œæ•°ç»„æ‰©å®¹ å¤§äºæ—¶å°†é“¾è¡¨è½¬æ¢ä¸ºçº¢é»‘æ ‘ LinkedHashMapï¼šç»§æ‰¿HashMap åŠ å…¥åŒå‘é“¾è¡¨ ä½¿é”®å€¼å¯¹å¯ä»¥ä¿æŒæ’å…¥é¡ºåº HashTableï¼šç”±æ•°ç»„å’Œé“¾è¡¨ç»„æˆ ç±»ä¼¼HashMapçš„åˆå§‹å½¢å¼ TreeMapï¼šçº¢é»‘æ ‘ è§£é‡Šå‹ä¸ç¼–è¯‘å‹ï¼š ç¼–è¯‘å‹è¯­è¨€ï¼Œé€šè¿‡ç¼–è¯‘å™¨å°†æºä»£ç ä¸€æ¬¡æ€§ç¿»è¯‘æˆå¯è¢«æ‰§è¡Œçš„æœºå™¨ç ã€‚æ‰§è¡Œå¿« å¼€å‘æ…¢ è§£é‡Šå‹è¯­è¨€ã€‚é€šè¿‡è§£é‡Šå™¨ä¸€å¥ä¸€å¥çš„è§£é‡Šï¼Œè¾¹è§£é‡Šè¾¹æ‰§è¡Œã€‚å¼€å‘å¿«ï¼Œæ‰§è¡Œæ…¢ Javaï¼šç¼–è¯‘ä¸è§£é‡Šå¹¶å­˜ã€‚Javaç¨‹åºè¦å…ˆç¼–è¯‘ç”Ÿæˆå­—èŠ‚ç ï¼ˆ.classæ–‡ä»¶ï¼‰ åå­—èŠ‚ç é€šè¿‡Javaè§£é‡Šå™¨æ¥è§£é‡Šæ‰§è¡Œ JIT vs AOT(ahead of time compilation)JDK9å¼•å…¥æ–°çš„ç¼–è¯‘æ¨¡å¼ AOTï¼šç¨‹åºæ‰§è¡Œå‰å°†å…¶ç¼–è¯‘ä¸ºæœºå™¨ç ï¼Œå±äºé™æ€ç¼–è¯‘ é¿å…JITé¢„çƒ­ç­‰å¼€é”€ å¯ä»¥æé«˜å¯åŠ¨é€Ÿåº¦ + å‡å°‘å†…å­˜å ç”¨ + å¢å¼ºJavaç¨‹åºå®‰å…¨æ€§ butï¼šæ— æ³•æ”¯æŒJavaåŠ¨æ€ç‰¹æ€§ï¼Œå¦‚åå°„ åŠ¨æ€ä»£ç† åŠ¨æ€åŠ è½½ JNIç­‰ JITï¼šå…·æœ‰æ›´é«˜çš„æé™å¤„ç†èƒ½åŠ›ï¼Œèƒ½å¤Ÿé™ä½è¯·æ±‚çš„æœ€å¤§å»¶è¿Ÿ ","permalink":"https://Sattiluvcat.github.io/en/posts/notes/%E5%85%AB%E8%82%A1--%E6%95%B0%E6%8D%AE%E5%BA%93/","summary":"Mysql Redisç›¸å…³å†…å®¹","title":"å…«è‚¡â€”â€”æ•°æ®åº“"},{"content":"Â Notes Proj0 è¿è¡ŒCommandLineInterface.javaæ—¶æŠ¥é”™ï¼šException in thread \u0026quot;main\u0026quot; java.lang.NullPointerException at java.base/java.io.Reader.ç­‰ å°†resourcesæ–‡ä»¶å¤¹ä¿®æ”¹ä¸ºèµ„æºæ ¹ç›®å½• Proj1 è¿è¡Œsqlite3è½½å…¥dbæ–‡ä»¶å¤±è´¥ cmdä¸­ç›´æ¥è¿è¡Œsqlite3 lahman.db pythonåœ¨cmdä¸­è¿è¡Œæ— ååº”ï¼š æ£€æŸ¥ç¯å¢ƒå˜é‡ï¼ˆå·²æ·»åŠ ï¼‰ è¿è¡Œpy test.pyå³å¯ï¼Œpyä»£è¡¨python3 left joiné€‚åˆå¯¹å³è¡¨ä¸­ä¸å­˜åœ¨çš„ä½†æ˜¯æƒ³åœ¨ç»“æœä¸­æ˜¾ç¤ºçš„æ•°æ®è¿›è¡Œå¤„ç†ï¼ˆå·¦è¡¨ä¸­éœ€å­˜åœ¨ï¼‰ æ±‚å’Œï¼šsum ç»Ÿè®¡æ•°é‡ï¼šcount å­æŸ¥è¯¢ï¼šeg.æŸ¥è¯¢æŸå€¼å¤§äºæŸä¸ªäººè¯¥å€¼çš„åˆ—è¡¨â€”â€”æŸä¸ªäººè¯¥å€¼ä½œä¸ºå­æŸ¥è¯¢éƒ¨åˆ†ï¼Œåœ¨orderå‰æ·»åŠ  and lslq\u0026gt;(select cast(sum(H-H2B-H3B-HR+2*H2B+3*H3B+4*HR) as float)/sum(AB) as ones from batting,people where people.playerID=\u0026#39;mayswi01\u0026#39; group by batting.playerID) order by lslq desc Proj2 ç”¨B+æ ‘ä¸ºå­˜å‚¨çš„æ•°æ®ç¼–å†™index æå‡æŸ¥è¯¢æ•ˆç‡ï¼ˆselect * from tableè¯­å¥ï¼‰\nB+æ ‘â€”â€”æ ¹æ®ç´¢å¼•è¿›è¡ŒæŸ¥æ‰¾ï¼ˆçš„å…¸å‹æ•°æ®ç»“æ„ä¹‹ä¸€ï¼‰â€”â€”ç¬¦åˆç£ç›˜ï¼ˆandÂ·Â·Â·ï¼‰åˆ†é¡µå­˜å‚¨çš„ç‰¹æ€§ ä¸ä½¿ç”¨äºŒåˆ†æŸ¥æ‰¾â€”â€”$log_2N$å±‚ å¯ä»¥ç”¨å¤šå­æ›¿æ¢äºŒå‰æ ‘çš„äºŒå­ æ”¯æŒé¡ºåºæŸ¥æ‰¾ æ’å…¥ç¨éš¾ï¼ˆæº¢å‡ºé¡µï¼‰â€”â€”ISAM = åœ¨æ’åºçš„å †æ–‡ä»¶ä¸­å­˜å‚¨æ•°æ®æ¡ç›® å †æ–‡ä»¶åæœ‰é«˜æ‰‡å‡ºï¼ˆä¿è¯æ ‘çš„é«˜åº¦ä¸è¿‡é«˜ï¼‰çš„é™æ€æ ‘ç´¢å¼•ï¼ˆå…·æœ‰ç´¢å¼•ï¼‰ B+æ ‘ï¼šæ‰€æœ‰æ•°æ®å­˜å‚¨åœ¨å¶å­èŠ‚ç‚¹ä¸Šï¼ˆç›¸æ¯”äºBæ ‘ï¼‰â€”â€”å±‚æ•°çŸ®ä½†å¯ä»¥å®¹çº³å¤§é‡æ•°æ® è‹¥rootå·²æ»¡ ä½†éœ€è¦æ”¾å…¥æ•°æ®æ—¶â€”â€”æ‹†åˆ†rootæˆä¸ºç¬¬äºŒå±‚ï¼Œæ¨ä¸¾å…¶ä¸­ä¸€ä¸ªæ•°æ®æˆä¸ºæ–°rootä¸­çš„æ•°æ® ä¿è¯ï¼ˆå ç”¨ä¸å˜æ€§ï¼‰ï¼šé™¤äº†rootå¤–ï¼Œæ‰€æœ‰èŠ‚ç‚¹è‡³å°‘åŠæ»¡ï¼ˆåˆ é™¤æ“ä½œä¸­ä¸ä¿è¯å ç”¨ä¸å˜æ€§â€”â€”ç›´æ¥åˆ é™¤ï¼‰ æ‰¹é‡æ’å…¥ï¼šå…ˆå¯¹éœ€æ’å…¥çš„æ•°æ®è¿›è¡Œæ’åºï¼Œå¡«å……å¶å­èŠ‚ç‚¹è‡³ï¼ˆeg.å¤§äºåŠæ»¡ï¼‰çŠ¶æ€åï¼Œåˆ›é€ å…¶å¯¹åº”çš„ä¸Šå±‚parentèŠ‚ç‚¹ å‡å°‘IOæ¬¡æ•° \u0026amp; ä¸éœ€éšæœºæ’å…¥ï¼ˆä¾‹å¦‚ï¼šå·¦è¾¹æ’å…¥ç»“æŸå ä¸éœ€å†æ¬¡è®¿é—®ï¼‰ èšç°‡ä¸éèšç°‡â€”â€”èšç°‡å¯¹äºèŒƒå›´æœç´¢éå¸¸é«˜æ•ˆ ä½†å¤§é‡æ’å…¥åæ€§èƒ½ä¼šä¸‹é™ï¼ˆé€€åŒ–ï¼‰ å±€éƒ¨æ€§ä¼˜åŠ¿â€”â€”å¯ä»¥é¡ºåºè®¿é—®å †æ–‡ä»¶ å¤„ç†å˜é•¿é”®â€”â€”ä»¥å­—èŠ‚ä¸ºå•ä½è¿›è¡Œè¡¡é‡ Proj2ï¼šæ³¨æ„å¤„ç†è¾¹ç•Œæƒ…å†µ è‹¥æ‰¹é‡æ·»åŠ æ¡ä»¶éš¾ä»¥åˆ¤æ–­å¯ä»¥å°è¯•ç®€åŒ–ä¸ºé€ä¸ªæ·»åŠ  keys rids rightSibling metadataç­‰æ„ä¹‰ Proj3 LRUï¼ˆleast recently usedæœ€è¿‘æœ€å°‘ä½¿ç”¨é¡µé¢ç½®æ¢ï¼‰+é¡ºåºæ‰«æ = é¡ºåºæ·¹æ²¡ æ—¶é’Ÿç®—æ³•ç±»ä¼¼ MRUï¼ˆmost recently usedï¼‰ buffer pool ç¼“å†²æ± â€”â€”è·³è¿‡æ“ä½œç³»ç»Ÿçš„ç¼“å­˜ç®¡ç† ç”±æ•°æ®åº“ç³»ç»Ÿåˆ¶å®šç®¡ç†ç­–ç•¥ï¼ˆåŒ…æ‹¬é¢„å– MRULRUÂ·Â·Â·ï¼‰ å…³ç³»ä»£æ•°â€”â€”æ“ä½œæ€§æè¿°ï¼ˆdiff to SQLï¼‰ å…³ç³»ä»£æ•° è¿ç®—ç¬¦ï¼š $\\pi$â€”â€”é€‰å–ä¸€åˆ—projection $\\sigma$â€”â€”é€‰å–nè¡Œselection $\\rho$â€”â€”é‡å‘½årenaming $\\cup$â€”â€”å¹¶é›† å»é™¤é‡å¤é¡¹union $-$â€”â€”1ä¸­æœ‰2ä¸­æ— setdifference $\\times$â€”â€”äº¤å‰ç§¯ $\\cap$â€”â€”intersection äº¤é›† $\\bowtie$â€”â€”joins å„ç§å½¢å¼çš„è¿æ¥ $\\pi$â€”â€”é€‰å–ä¸€åˆ—projectionï¼šé€‰æ‹©å•ç‹¬åˆ—ä¼šè¿›è¡Œå»é‡ $\\cup$â€”â€”å¹¶é›† å»é™¤é‡å¤é¡¹unionï¼šå¯¹åº”åˆ—çš„ç±»å‹ç›¸åŒ = UNIONï¼ˆin sqlï¼‰ $-$â€”â€”1ä¸­æœ‰2ä¸­æ— setdifferenceï¼šå¯¹åº”åˆ—çš„ç±»å‹ç›¸åŒ = EXCEPT in sql $\\rho$â€”â€”é‡å‘½årenaming:1-\u0026gt;newname ç¬¬1åˆ—ï¼ˆä½ç½®ï¼‰æ”¹åä¸ºnewname æ’åº\u0026amp;å“ˆå¸Œ åŒç¼“å†²ï¼šè¾“å…¥è¾“å‡ºç¼“å†²åŒº åŒçº¿ç¨‹è¿›è¡ŒIOä¸è®¡ç®— part1å®ç° é‡ç½®ï¼šå·¦å—éå†å®Œåéœ€è¦é‡ç½®å·¦å— å½“å‰å³é¡µé‡ç½® æ•´ä¸ªå³é¡µè®°å½•é‡ç½®â€”â€”æ¯ä¸ªæ–°å·¦å—éœ€è¦ä¸æ‰€æœ‰å³é¡µè®°å½•æ¯”è¾ƒ ä¸è¦å¯¹å³é¡µåšä¸å¿…è¦çš„å»¶é•¿ï¼ˆnext()ï¼‰â€”â€”leftè¡¨ç¤ºå·¦è¡¨ rightè¡¨ç¤ºå³è¡¨ part1 task2â€”â€”å®ç°Grace Hash Joinï¼ˆç»“åˆä¸¤ä¸ªå¤§å‹æ•°æ®åº“â€”â€”æŒ‰è¿æ¥é”®joint keys eg.ç”¨æˆ·idï¼‰ è‹¥å·¦partitionæˆ–å³partitionæ•°é‡å°äºç­‰äºB-2 æ‰§è¡Œbuildandprobe åœ¨GHJä¸­è®°å½•æ ¹æ®å“ˆå¸Œå€¼è¢«åˆ†åŒºã€‚å¦‚æœæ‰€æœ‰è®°å½•éƒ½ç›¸åŒï¼Œä¼šè¢«åˆ†åˆ°åŒä¸€ä¸ªåˆ†åŒºã€‚è¯¥åˆ†åŒºè¶…è¿‡äº†å†…å­˜é™åˆ¶ï¼Œä»è€ŒGHJå¤±è´¥ GHJè¿‡ç¨‹ï¼š åˆ†ç‰‡æˆå°chunkï¼ˆä¸åŒçš„å“ˆå¸Œå‡½æ•°å®ç°ï¼‰ é€‰æ‹©è¾ƒå°çš„æ•°æ®é›†ä½œä¸º build é˜¶æ®µçš„æ•°æ®é›†ï¼Œä»¥å‡å°‘å†…å­˜ä½¿ç”¨ éå† build æ•°æ®é›†ä¸­çš„æ¯ä¸€æ¡è®°å½•ï¼Œæ ¹æ®è¿æ¥é”®è®¡ç®—å“ˆå¸Œå€¼ï¼Œå¹¶å°†è®°å½•æ’å…¥åˆ°å“ˆå¸Œè¡¨ä¸­ï¼Œå“ˆå¸Œè¡¨çš„é”®æ˜¯è¿æ¥é”®çš„å“ˆå¸Œå€¼ï¼Œå€¼æ˜¯è®°å½•æœ¬èº« éå† probe æ•°æ®é›†ä¸­çš„æ¯ä¸€æ¡è®°å½•ï¼Œæ ¹æ®è¿æ¥é”®è®¡ç®—å“ˆå¸Œå€¼ï¼Œå¹¶åœ¨å“ˆå¸Œè¡¨ä¸­æŸ¥æ‰¾åŒ¹é…çš„è®°å½• å¦‚æœæ‰¾åˆ°ï¼Œåˆ™å°† probe è®°å½•å’Œ build è®°å½•è¿æ¥ï¼Œå¹¶å°†ç»“æœæ·»åŠ åˆ°è¾“å‡ºç»“æœé›† task3â€”â€”å¤–éƒ¨å½’å¹¶æ’åºï¼Œå¤„ç†æ— æ³•ä¸€æ¬¡æ€§åŠ è½½åˆ°å†…å­˜ä¸­çš„å¤§æ•°æ®é›†â€”â€”å°†å…¶åˆ†å‰²æˆå°å— ï¼ˆå†…å­˜ä¸­ï¼‰åæ’åº æœ€ååˆå¹¶ï¼ˆå®Œæˆå¤„ç†ï¼‰ å°†å¤šä¸ªå·²æ’åºçš„ Run åˆå¹¶æˆä¸€ä¸ªæ–°çš„å·²æ’åºçš„ Run task4â€”â€”Sort Merge Joinï¼ˆæ’åºåç»“åˆä¸¤ä¸ªå¤§å‹æ•°æ®åº“ï¼‰ ç¡®ä¿æ¯ä¸ª leftRecord éƒ½èƒ½ä¸æ‰€æœ‰å¯èƒ½çš„ rightRecord è¿›è¡Œæ¯”è¾ƒâ€”â€”ç›¸ç­‰æ—¶è¿”å›left+right å½“ leftRecord å’Œ rightRecord ä¸ç›¸ç­‰æ—¶ï¼Œéœ€è¦é‡ç½® rightIterator å¹¶è·å–ä¸‹ä¸€ä¸ª leftRecordï¼Œç„¶åç»§ç»­æ¯”è¾ƒ å› ä¸º rightIterator å¯èƒ½å·²ç»éå†åˆ°æœ«å°¾ï¼Œéœ€è¦é‡ç½®ä»¥ä¾¿ä»å¤´å¼€å§‹ä¸æ–°çš„ leftRecord è¿›è¡Œæ¯”è¾ƒ part2å®ç° å®ç°åŠ¨æ€è§„åˆ’+å·¦æ·±æ ‘ï¼ˆ=æœ€ä¼˜æ€§åŸç†ï¼‰ï¼Œï¼ˆä¼˜åŒ–æŸ¥è¯¢ï¼‰ä»¥æ›´å¥½çš„é¡ºåºå°†è¡¨è”æ¥åœ¨ä¸€èµ·\nå•è¡¨ï¼šè®¡ç®—é¡ºåºæŸ¥è¯¢çš„æ—¶é—´â€”â€”ä»»æ„ç´¢å¼•æŸ¥è¯¢çš„æ—¶é—´â€”â€”é€‰å‡ºæ—¶é—´æœ€çŸ­çš„æ–¹æ³• å¤šè¡¨ï¼š å¤–å±‚å¾ªç¯éå† prevMap ä¸­çš„æ¯ä¸ªè¡¨é›†åˆ å†…å±‚å¾ªç¯éå† this.joinPredicates ä¸­çš„æ¯ä¸ªè¿æ¥è¯ ç¡®ä¿æ‰¾åˆ°æ‰€æœ‰å¯èƒ½çš„è¿æ¥ï¼Œå¹¶è®¡ç®—å‡ºæœ€ä½æˆæœ¬çš„è¿æ¥æ“ä½œ pass1Mapï¼šä¸€ä¸ªæ˜ å°„ï¼Œæ¯ä¸ªè¡¨åæ˜ å°„åˆ°å…¶å¯¹åº”çš„æŸ¥è¯¢æ“ä½œç¬¦ï¼ˆeg.group byï¼‰ çŸ¥è¯†ç‚¹ (é’ˆå¯¹å¤šè¡¨æŸ¥è¯¢çš„æƒ…å†µ)å› ä¸ºåœ¨æ­¤projä¸­åªæœ‰JOINè¿æ¥ç¬¦ éœ€è¦é€‰æ‹©æœ€ä½³çš„è¿æ¥ç®—æ³• è¿‡ç¨‹å¦‚ä¸‹ğŸ‘‡\nå®ç°äº†GHJ, Sort and SMJ ä½†æœ€ç»ˆçš„è¿æ¥ç¬¦åœ¨SNLJ BNLJä¸­é€‰æ‹©ï¼ˆè¡¡é‡æ ‡å‡†ï¼šç£ç›˜IOæ¬¡æ•°ï¼‰ æ“ä½œç¬¦çš„ç»“æœä»¥è¿­ä»£å™¨çš„å½¢å¼ä¼ ç»™ä¸‹ä¸€ä¸ªæ“ä½œç¬¦\nSNLJï¼šç¬›å¡å°”ç§¯â€”â€”forå¾ªç¯æ‰«æé©±åŠ¨è¡¨ forå¾ªç¯æ‰«æè¢«é©±åŠ¨è¡¨ ç»“åˆ åœ¨æœ‰ç´¢å¼•çš„æ¡ä»¶ä¸‹æ€§èƒ½æ›´å¥½\nBNLJï¼šâ€œåŸºäºå—çš„åµŒå¥—å¾ªç¯è¿æ¥â€ é©±åŠ¨è¡¨å–ä¸€å—æ”¾åˆ°join buffer poolï¼Œè¢«é©±åŠ¨è¡¨é€æ¡è·Ÿå—æ¯”è¾ƒï¼Œåˆé€‚çš„æ”¾å…¥ã€‚å‡å°‘ç£ç›˜I/O é’ˆå¯¹å¤šè¡¨æœç´¢ï¼š å…ˆå¾ªç¯æŸ¥æ‰¾æ¯ä¸ªè¡¨æœ€ä½³çš„æœç´¢æ–¹æ³•ï¼ˆé¡ºåºæœç´¢/ç´¢å¼•æœç´¢ï¼‰ åå¾ªç¯ä½¿ç”¨å‰ä¸€è½®çš„ç»“æœå’Œå½“å‰è¡¨è¿›è¡Œè¿æ¥ï¼Œå¹¶é€‰æ‹©æœ€ä½æˆæœ¬çš„è¿æ¥æ–¹æ³• Proj4 äº‹åŠ¡transaction\u0026amp;å¹¶å‘concurrency ä¸²è¡Œè°ƒåº¦â€”â€”ä¸€ä¸ªäº‹åŠ¡å®Œæˆå èµ„æºé‡Šæ”¾ å†²çªå¯ä¸²è¡Œ = å¯ä¸²è¡Œ ä¸¥æ ¼ä¸¤é˜¶æ®µé”â€”â€”çº§è”ä¸­æ­¢æƒ…å†µä¸å­˜åœ¨ åŒ…æ‹¬å…±äº«é” æ’ä»–é” å¤šç²’åº¦é”â€”â€”ä¸åŒçš„é”å¯ä»¥é”ä½é¡µé¢ è¡¨ æ•°æ®å…ƒç»„ç­‰ä¸åŒç²’åº¦â€”â€”æ„å‘é” ä¸ºäº†é”ä½A éœ€è¦è·å¾—Aæ‰€æœ‰ç¥–å…ˆé€‚å½“çš„æ„å‘é”â€”â€”é¿å…æ”¾ç½®å¯èƒ½å¯¼è‡´å†²çªçš„é” part1å®ç° task1 é”çš„æƒé™èŒƒå›´ = åŠ äº†è¿™ç§é”ä¹‹åæ“ä½œè€…çš„æƒé™èŒƒå›´ï¼ˆè¯»å†™é”çš„æƒé™èŒƒå›´\u0026gt;è¯»é”çš„ï¼‰ part2å®ç° task3 resourceName = åˆ†å±‚æ¶æ„ä¸­çš„ä¸€ä¸ªï¼ˆå¯èƒ½æ˜¯æ•°æ®åº“ è¡¨ or é¡µï¼‰ transaction äº‹åŠ¡ ensureSufficientLockHeldç¡®ä¿æŒæœ‰è¶³å¤Ÿçš„é”â€”â€”å¤„ç†æœ€åŸºç¡€çš„è¯·æ±‚é”æƒ…å†µ ç¡®ä¿å½“å‰äº‹åŠ¡æŒæœ‰æ°å½“çš„é” ä¸”å…¶ç¥–å…ˆèƒ½å¤Ÿè·å–æŒ‡å®šçš„è¯·æ±‚é”ç±»å‹ promote å°†äº‹åŠ¡åœ¨ä¸Šä¸‹æ–‡ä¸ŠæŒæœ‰çš„é”ç±»å‹å‡çº§ä¸ºæ›´ä¸¥æ ¼çš„é”ç±»å‹ å°†é”ç±»å‹ä»è¾ƒä¸ä¸¥æ ¼çš„ç±»å‹ï¼ˆä¾‹å¦‚ Sï¼‰æ›´æ”¹ä¸ºæ›´ä¸¥æ ¼çš„ç±»å‹ï¼ˆä¾‹å¦‚ Xï¼‰ï¼Œè€Œä¸é‡Šæ”¾ä»»ä½•é” escalate å°†äº‹åŠ¡åœ¨ä¸Šä¸‹æ–‡çš„æ‰€æœ‰å­çº§ä¸ŠæŒæœ‰çš„é”åˆå¹¶ä¸ºåœ¨ä¸Šä¸‹æ–‡æœ¬èº«ä¸Šçš„å•ä¸ªé” ä½œç”¨ï¼šé‡Šæ”¾æ‰€æœ‰å­çº§é”ï¼Œå¹¶åœ¨ä¸Šä¸‹æ–‡ä¸Šè·å–å•ä¸ªé”ï¼ˆS æˆ– Xï¼‰ å¦‚æœå½“å‰é”ç±»å‹æ˜¯ X æˆ– IXï¼Œåˆ™æ–°çš„é”ç±»å‹ä¸º Xï¼›å¦‚æœå½“å‰é”ç±»å‹æ˜¯ S æˆ– ISï¼Œåˆ™æ–°çš„é”ç±»å‹ä¸º S éœ€è¦ï¼šè·å–äº‹åŠ¡æŒæœ‰çš„æ‰€æœ‰é”ã€æ‰€æœ‰å­çº§é”\u0026ndash;\u0026gt;å¦‚æœå½“å‰é”ç±»å‹ä¸æ–°çš„é”ç±»å‹ä¸åŒï¼Œåˆ™è¿›è¡Œé”å‡çº§ task4ï¼šé‡Šæ”¾æ—¶ç”¨LockContext ä¸ç”¨LockManager\u0026ndash;\u0026gt;å…¶ä¸ä¼šéªŒè¯å¤šç²’åº¦çº¦æŸ ç”¨LockContextå¯¹è±¡æ‰¿æ¥é€šè¿‡LMå¾—åˆ°çš„æ‰€æœ‰é” è€Œårelease åå‘é‡Šæ”¾é”â€”â€”ä»å­çº§åˆ°parentçº§çš„é¡ºåº\u0026ndash;\u0026gt;parentä¸€èˆ¬æ¯”å­çº§æƒé™æ›´å®½æ³› è‹¥parentå…ˆé‡Šæ”¾ å…¶ä»–äº‹åŠ¡å¯èƒ½åœ¨å­çº§é”å®šçš„æƒ…å†µä¸‹è·å¾—parentçº§é”\u0026ndash;\u0026gt;å†²çª List\u0026lt;Lock\u0026gt; locks = lockManager.getLocks(getTransaction()); for (int i = locks.size() - 1; i \u0026gt;= 0; i--) { Lock lock = locks.get(i); LockContext lc = LockContext.fromResourceName(lockManager, lock.name); lc.release(getTransaction()); } çŸ¥è¯†ç‚¹ é‡Šæ”¾é”ï¼šä¸¥æ ¼ä¸¤ç›¸é”â€”â€”åªæœ‰åœ¨äº‹åŠ¡ç»“æŸæ—¶æ‰èƒ½é‡Šæ”¾é”ï¼ˆä¸ä¸¥æ ¼çš„å¯ä»¥éšæ—¶é‡Šæ”¾ï¼‰ é‡Šæ”¾é¡ºåºï¼šä»ä¸‹è‡³ä¸Š è‹¥åå¯èƒ½æ­»é”ï¼ˆè¿åäº†è·å–é”çš„é¡ºåº eg.T1-getAlock getBlock unlockA T2-getAlock T1-wantAlock T2-wantBlock ==\u0026gt;deadlockï¼‰ è·å–é”ï¼šä»ä¸Šè‡³ä¸‹é”ä½ ä¸ç®¡æ˜¯è·å¾—å­çº§è¿˜æ˜¯parentçº§ éƒ½éœ€è¦é€šè¿‡canBeParentLockæ£€éªŒ Proj5 äº‹åŠ¡æ¢å¤â€”â€”Aries Log Records\næäº¤ä¸å¼ºåˆ¶â€”â€”è®°å½•æ“ä½œ æ’¤é”€æœªæäº¤äº‹åŠ¡ï¼ˆåŸåº”åœ¨ç³»ç»Ÿé‡å¯æ—¶abortï¼‰ é‡åšäº‹åŠ¡ï¼ˆå®ƒçš„æ›´æ–°å°šæœªå†™å…¥åˆ°ç£ç›˜ä¸­ï¼‰ æ—¥å¿—åºåˆ—å·LSNâ€”â€”â€œå·²åˆ·æ–°LSNâ€ åˆ°è¾¾ç£ç›˜çš„æœ€åçš„æ—¥å¿— äº‹åŠ¡è¡¨ï¼ˆåŒ…æ‹¬äº‹åŠ¡ID çŠ¶æ€ æœ€åLSNï¼‰ + è„é¡µè¡¨ï¼ˆè®°å½•ä¸ç£ç›˜ä¸åŒæ­¥çš„é¡µé¢ åŒ…æ‹¬é¡µé¢ID æ¢å¤LSNï¼‰ æœ€åLSNâ€”â€”è¯¥äº‹åŠ¡ä½¿ç”¨çš„æ“ä½œçš„æœ€åä¸€ä¸ªæ—¥å¿—è®°å½• æ¢å¤LSNâ€”â€”ç¬¬ä¸€ä¸ªé€ æˆè„é¡µçš„æ—¥å¿—è®°å½• = é¢„å†™æ—¥å¿— + æ¨¡ç³ŠæŸ¥è¯¢ç‚¹fuzzy checkpoint task3 å›æ»šåˆ°ä¿å­˜ç‚¹\u0026ndash;\u0026gt;å¤ç”¨rollback task4 æ¨¡ç³Šæ£€æŸ¥ç‚¹â€”â€”å…ˆæ”¾å…¥ï¼ˆåˆ¤æ–­æ˜¯å¦fitï¼‰å½“ä¸èƒ½æ»¡è¶³æ—¶\u0026ndash;\u0026gt;remove å¹¶æ¸…ç©ºåºåˆ— æœ€åå†æ”¾å…¥ è‹¥å…ˆæ£€æŸ¥åæ”¾å…¥\u0026ndash;\u0026gt;æ–°æ”¾å…¥çš„è¿™ä¸ªrecordçš„å¤§å°ä¸èƒ½ä¿è¯æ»¡è¶³ éå† dirtyPageTable å¹¶å¤åˆ¶æ¡ç›® å¦‚æœå¤åˆ¶å½“å‰è®°å½•ä¼šå¯¼è‡´ç»“æŸæ£€æŸ¥ç‚¹è®°å½•å¤ªå¤§ å°†å…¶è®°å½•åˆ°è®°å½•ä¸­ åˆ·æ–°åˆ°LSN æ¸…ç©ºDPT å°†è¿‡å¤§çš„è®°å½•æ”¾å…¥DPT éå† transaction è¡¨ï¼Œå¹¶å¤åˆ¶ status/lastLSN åŒä¸Šæ“ä½œ è¾“å‡º 1 ä¸ªæœ€ç»ˆç»“æŸæ£€æŸ¥ç‚¹ task5 é‡å¯æ¢å¤\nlamdaè¡¨è¾¾å¼ï¼štransactionTable.computeIfAbsent(transNum, k -\u0026gt; new TransactionTableEntry(newTransaction.apply(transNum))); k-\u0026gt;è¡¨ç¤ºMapä¸­çš„é”® ğŸ‘†tableæ˜¯ä¸€ä¸ªMapå˜é‡ computeIfAbsent å¦‚æœtransNumé”®å­˜åœ¨ å³ç”¨è¯¥é”® è‹¥ä¸å­˜åœ¨ åˆ™ç”¨k-\u0026gt;æŒ‡å‘çš„é”® CLR-è¡¥å¿æ—¥å¿—è®°å½•\u0026ndash;\u0026gt;è®°å½•æ’¤é”€è¿‡ç¨‹çš„æ“ä½œï¼ˆé¿å…æ’¤é”€æ—¶å´©æºƒï¼‰ åœ¨FREE_PAGEæˆ–UNDO_ALLOC_PAGEçŠ¶æ€ è¯æ˜æ›´æ–°å·²åˆ·æ–°åˆ°disk éœ€è¦åˆ é™¤è„é¡µè®°å½• çŸ¥è¯†ç‚¹ å®ç°WALå¼•å…¥LSN è¡¨ç¤ºæ“ä½œé¡ºåºï¼ˆæ—¥å¿—è®°å½•ï¼‰â€”â€”no force\u0026amp;steal no force:ä»…åœ¨éœ€è¦ä»ç¼“å†²æ± ä¸­åˆ é™¤é¡µé¢æ—¶æ‰å†™å›ç£ç›˜\nsteal:å…è®¸åœ¨äº‹åŠ¡å®Œæˆä¹‹å‰å°†ä¿®æ”¹åçš„é¡µé¢å†™å…¥ç£ç›˜ï¼ˆæ€§èƒ½æœ€å¥½ï¼‰\nprevLSNï¼šå­˜å‚¨åŒä¸€äº‹åŠ¡ä¸­çš„æœ€åä¸€ä¸ªæ“ä½œï¼ˆè¯¥äº‹åŠ¡çš„å‰ä¸€æ­¥LSNï¼‰ flushedLSNï¼šè·Ÿè¸ªå·²åˆ·æ–°åˆ°ç£ç›˜çš„æœ€åä¸€æ¡æ—¥å¿—è®°å½•çš„ LSN pageLsnï¼šå­˜å‚¨ä¸Šæ¬¡ä¿®æ”¹æ•°æ®é¡µé¡µé¢çš„æ“ä½œçš„ LSN pageLSNiâ‰¤flushedLSNæ‰èƒ½å°†ç¬¬ié¡µåˆ·å…¥ç£ç›˜ï¼ˆflushedæ­¤æ—¶ä»£è¡¨åˆ·å…¥ç›˜çš„æ—¥å¿—è®°å½•çš„LSNï¼‰ æ’¤é”€ï¼š ï¼ˆæ’¤é”€æ—¶å°†CLRå†™å…¥æ—¥å¿—ï¼‰CLRï¼ˆCompensation Log Recordï¼‰ æ˜¯ä¸€ç§æ–°å‹è®°å½•ï¼Œè¡¨ç¤ºæˆ‘ä»¬æ­£åœ¨æ’¤æ¶ˆç‰¹å®šæ“ä½œï¼Œæœ¬è´¨ä¸Šä¸ UPDATE è®°å½•ç›¸åŒï¼Œä½†å®ƒè¡¨ç¤ºå†™å…¥æ“ä½œæ˜¯ç”±äºä¹‹å‰å‘ç”Ÿäº† abort è€Œå‘ç”Ÿçš„ æ¢å¤çš„æ•°æ®ç»“æ„ï¼šäº‹åŠ¡è¡¨+è„é¡µè¡¨ äº‹åŠ¡è¡¨ï¼šXID çŠ¶æ€ lastLSN è„é¡µè¡¨ï¼šé¡µç  recLSNï¼ˆè„é¡µé¢çš„ç¬¬ä¸€ä¸ªæ“ä½œï¼‰ recLSN \u0026gt; on disk pageLSNP;recLSN â‰¤ in memory pageLSNP è¿™ä¸¤ä¸ªè¡¨éƒ½å­˜å‚¨åœ¨å†…å­˜ä¸­;å› æ­¤ä»å´©æºƒä¸­æ¢å¤æ—¶ï¼Œå¿…é¡»ä½¿ç”¨æ—¥å¿—æ¥é‡å»ºè¡¨ã€‚ç®€åŒ–æ­¤æ“ä½œçš„æ–¹æ³•â€”â€”æ£€æŸ¥ç‚¹ ARIESç®—æ³•ï¼š åˆ†æé˜¶æ®µâ€”â€”æ¢å¤äº‹åŠ¡è¡¨ä¸è„é¡µè¡¨ redoâ€”â€”é‡åšä»¥ä¿è¯æŒä¹…æ€§ undoâ€”â€”æ’¤é”€å´©æºƒæœŸé—´è¿è¡Œçš„äº‹åŠ¡ä¸­çš„æ“ä½œï¼Œç¡®ä¿åŸå­æ€§ ariesç®—æ³•è¯¦è§£ åˆ†æé˜¶æ®µï¼š èƒŒæ™¯ï¼šä¸€ä¸ªé—®é¢˜æ˜¯å®ƒéœ€è¦æ•°æ®åº“æ‰«ææ•´ä¸ªæ—¥å¿—ã€‚åœ¨ç”Ÿäº§æ•°æ®åº“ä¸­ï¼Œè¿™æ˜¯ä¸ç°å®çš„â€”â€”checkpointingåŠ å¿«åˆ†æ ä¸€æ¡ \u0026lt; BEGIN CHECKPOINT \u0026gt; è®°å½•ï¼Œè¯´æ˜æ£€æŸ¥ç‚¹ä½•æ—¶å¼€å§‹ï¼Œ\u0026lt; END CHECKPOINT \u0026gt; è®°å½•ï¼Œè¯´æ˜æˆ‘ä»¬ä½•æ—¶å®Œæˆå°†è¡¨å†™å…¥æ—¥å¿—ã€‚å†™å…¥æ—¥å¿—çš„ table å¯ä»¥æ˜¯ å’Œ ä¹‹é—´ä»»ä½•ç‚¹çš„ table çŠ¶æ€ åªéœ€æ‰«æä¸¤ä¸ªæ£€æŸ¥ç‚¹ä¹‹é—´çš„æ—¥å¿— åŸåˆ™ï¼š å¦‚æœè®°å½•æ˜¯ UPDATE è®°å½•ï¼Œä¸”é¡µé¢ä¸åœ¨ DPT ä¸­ï¼Œå°†é¡µé¢æ·»åŠ åˆ° DPT å¹¶å°† recLSN è®¾ç½®ä¸ºç­‰äº LSN å¦‚æœè®°å½•æ˜¯ END è®°å½•ï¼Œ ä» Xact Table ä¸­åˆ é™¤äº‹åŠ¡ å…¶å®ƒçš„ç›´æ¥åŠ å…¥äº‹åŠ¡è¡¨ï¼ˆrunningä¼šæ”¹ä¸ºabortingï¼‰ redoï¼š ä» DPT ä¸­æœ€å°çš„ recLSNå¼€å§‹æ¢å¤ åŸåˆ™ï¼š(ä¸æ¢å¤çš„æƒ…å†µ) logä»å‰å‘åéå† (LSNè¡¨ç¤ºåœ¨ç£ç›˜çš„logä¸­å½“å‰è¯»åˆ°çš„LSN) recLSN \u0026gt; LSNã€‚è¡¨ç¤ºå¼„è„é¡µé¢çš„ç¬¬ä¸€æ¬¡æ›´æ–°å‘ç”Ÿåœ¨æ­¤æ“ä½œä¹‹åã€‚è¿™æ„å‘³ç€æˆ‘ä»¬å½“å‰æ­£åœ¨è¿›è¡Œçš„æ“ä½œå·²ç»è¿›å…¥ç£ç›˜ï¼Œå¦åˆ™å®ƒå°†æ˜¯ recLSN pageLSN ï¼ˆdiskï¼‰ â‰¥ LSNã€‚è¡¨ç¤ºè¿›å…¥ç£ç›˜çš„é¡µé¢çš„æœ€è¿‘ä¸€æ¬¡æ›´æ–°å‘ç”Ÿåœ¨å½“å‰æ“ä½œä¹‹åï¼ŒåŒæ ·å¦‚ä¸Š è¯¥é¡µé¢ä¸åœ¨ DPT ä¸­ï¼Œæ„å‘³ç€æ‰€æœ‰æ›´æ”¹ï¼ˆä»¥åŠæ­¤æ›´æ”¹ï¼‰éƒ½å·²åˆ·æ–°åˆ°ç£ç›˜ åªé‡åšæ‰€æœ‰ UPDATE å’Œ CLR æ“ä½œâ€”â€”å³å‘ç”Ÿäº†æ›´æ”¹çš„æ“ä½œ undoï¼š åŸåˆ™ï¼šæ’¤æ¶ˆé˜¶æ®µå°†ä»æ—¥å¿—çš„æœ«å°¾å¼€å§‹ï¼Œä¸€ç›´æŒç»­åˆ°æ—¥å¿—çš„å¼€å¤´ã€‚å®ƒæ’¤æ¶ˆåœ¨å´©æºƒæ—¶å¤„äºæ´»åŠ¨çŠ¶æ€ï¼ˆæ­£åœ¨è¿è¡Œæˆ–ä¸­æ­¢ï¼‰çš„æ¯ä¸ªäº‹åŠ¡çš„æ¯ä¸ª UPDATE å¹¶å†™å…¥ CLR è®°å½• æ³¨æ„ï¼šCLR è®°å½•è¿˜æœ‰ä¸€ä¸ªé™„åŠ å­—æ®µ undoNextLSN ã€‚å­˜å‚¨è¦ä¸ºè¯¥äº‹åŠ¡æ’¤æ¶ˆçš„ä¸‹ä¸€ä¸ªæ“ä½œçš„ LSNï¼ˆå³æ­£åœ¨è¢«æ’¤æ¶ˆçš„æ“ä½œçš„prevLSNï¼‰ é‡åˆ°CLRè¯­å¥ï¼šè®°å½•CLR undoNextLSNè®°ä¸ºåŸCLRçš„undoNextLSNæŒ‡å‘çš„è¯­å¥çš„prevLSNï¼ˆä¸æ˜¯å¾ˆæ‡‚ä½†æ˜¯ï¼‰ æ€»ç»“ï¼šé¦–å…ˆé€šè¿‡é‡æ–°åˆ›å»ºäº‹åŠ¡å’Œè„é¡µè¡¨å¹¶redoä»»ä½•æœªåˆ·ç›˜çš„ä¿®æ”¹æ¥é‡å»ºå´©æºƒå‰çš„æ•°æ®åº“çŠ¶æ€ã€‚ç„¶åï¼Œæˆ‘ä»¬ä¸­æ­¢å´©æºƒå‰è¿è¡Œçš„æ‰€æœ‰äº‹åŠ¡ï¼Œå¹¶é€šè¿‡undoæ’¤é”€è¿™äº›äº‹åŠ¡çš„æ‰€æœ‰å½±å“ Proj6 MongoDB\næ–‡æ¡£å‹æ•°æ®åº“â€”â€”NoSQL æ„æ¶ æ•°æ®åº“\u0026ndash;\u0026gt;é›†åˆ\u0026ndash;\u0026gt;æ–‡æ¡£ï¼ˆBinary JSONå½¢å¼å­˜å‚¨ï¼‰ ç›¸å½“äºMysql æ•°æ®åº“\u0026ndash;\u0026gt;table\u0026ndash;\u0026gt;è¡Œ å­—æ®µfeildç›¸å½“äºMysqlçš„åˆ— æ–‡æ¡£é—´ç»“æ„å¯ä»¥ä¸åŒ åŸºæ“ æ’å…¥æ–‡æ¡£ï¼šdb.é›†åˆ.insertOne({bala: \u0026quot;bala\u0026quot;}) æŸ¥è¯¢ï¼šfind(something) å¯ä»¥åœ¨å…¶åæ·»åŠ å„ç§åç¼€ç²¾ç¡®æŸ¥è¯¢ è‹¥è¦æ˜¾ç¤ºç²¾ç¡®çš„å­—æ®µï¼š({æŸ¥è¯¢æ¡ä»¶},{å­—æ®µ:1,å­—æ®µ:0}) 1\u0026ndash;\u0026gt;æ˜¾ç¤º 0\u0026ndash;\u0026gt;ä¸æ˜¾ç¤º æ˜¾ç¤ºæ—¶æ’åºï¼š.sort({å­—æ®µ:1}) 1\u0026ndash;\u0026gt;å‡åº -1\u0026ndash;\u0026gt;é™åº æ˜¾ç¤ºæ—¶è·³è¿‡æŸæ–‡æ¡£ï¼š.skip(åºå·) å¦‚å‡åºæ—¶å¡«1åˆ™è·³è¿‡æœ€å°çš„ orè¿ç®—ç¬¦ï¼š{$or:[{name:\u0026quot;English\u0026quot;},{name:\u0026quot;French\u0026quot;}]}\u0026ndash;\u0026gt;ä¸­æ‹¬å· ","permalink":"https://Sattiluvcat.github.io/en/posts/java/cs186/","summary":"6ä¸ªprojä¸ç›¸å…³çŸ¥è¯†ç‚¹","title":"CS186"},{"content":"Â åŠŸèƒ½å®Œå–„ æ‹¦æˆªå™¨ Utilsä¸­å®ç°æ·»åŠ æ‹¦æˆªå™¨InterceptoråŠŸèƒ½ï¼Œåœ¨configä¸­æ·»åŠ MVCConfigä»¥æ·»åŠ æ‹¦æˆªå™¨å¹¶è®¾ç½®æ’é™¤æ‹¦æˆªçš„åœ°å€ session å­˜å‚¨ç”¨æˆ·åŸºæœ¬ä¿¡æ¯å³å¯\nå¤šå°Tomcatä¸å…±äº«sessionç©ºé—´ï¼ˆå­˜å‚¨å½“å‰ç”¨æˆ·ä¿¡æ¯ï¼‰\u0026ndash;\u0026gt;åˆ‡æ¢ä¸åŒTomcatæ—¶æ•°æ®ä¸¢å¤± éœ€è¦æ•°æ®å…±äº« å†…å­˜å­˜å‚¨ é”®å€¼ ==\u0026gt;Redisæ›¿ä»£ Redis ä¿å­˜ç”¨æˆ·æ—¶ä»¥éšæœºtokenä½œä¸ºkey è®¾ç½®æœ‰æ•ˆæœŸ å¦å¤–ç”¨æˆ·è®¿é—®æ—¶æŒç»­æ›´æ–°æ—¶é•¿\u0026ndash;\u0026gt;åœ¨æ‹¦æˆªå™¨ä¸­è®¾ç½® å–å‡ºHashç±»å‹çš„æ‰€æœ‰å­—æ®µ\u0026ndash;\u0026gt;entries ç¼“å­˜ æ•°æ®äº¤æ¢ç¼“å†²åŒº ä¸´æ—¶å­˜å‚¨æ•°æ® è¯»å†™æ€§èƒ½è¾ƒé«˜\næ³¨æ„ï¼šæ·»åŠ ç¼“å­˜æ—¶æ ¹æ®Redisä¸­ç±»å‹è½¬æ¢å˜é‡ç±»å‹ Redisä½¿ç”¨Stringç±»å‹â€”â€”ä»¥JSONå½¢å¼å­˜å‚¨ï¼Œéœ€è½¬æ¢ ç¼“å­˜æ›´æ–°ç­–ç•¥ å†…å­˜æ·˜æ±° Rediså†…å­˜ä¸è¶³æ—¶è‡ªåŠ¨æ·˜æ±°éƒ¨åˆ†æ•°æ® ä¸€è‡´æ€§å·® æ— ç»´æŠ¤æˆæœ¬ è¶…æ—¶å‰”é™¤ ä¸ºç¼“å­˜æ•°æ®æ·»åŠ TTLæ—¶é—´ ä¸‹æ¬¡æŸ¥è¯¢æ—¶æ›´æ–°ç¼“å­˜ ä¸€è‡´æ€§ä¸€èˆ¬ ä¸»åŠ¨æ›´æ–° Cache Aside \u0026amp; Read/Write Through \u0026amp; Write Back ä¸€è‡´æ€§å¥½ ä¸»åŠ¨æ›´æ–° Cache Aside Pattern æ›´æ–°ç¼“å­˜æ— æ•ˆå†™æ“ä½œè¾ƒå¤šï¼ˆè‹¥æŸ¥è¯¢å¾ˆå°‘ï¼‰â€”â€”\u0026gt;åˆ é™¤ç¼“å­˜ æŸ¥è¯¢æ—¶å†æ›´æ–°ç¼“å­˜ ä¿è¯ç¼“å­˜ä¸æ•°æ®åº“æ“ä½œåŒæ—¶æˆåŠŸ/å¤±è´¥â€”â€”\u0026gt; å•ä½“ç³»ç»Ÿï¼šç¼“å­˜ä¸æ•°æ®åº“å˜ä¸€ä¸ªäº‹åŠ¡ åˆ†å¸ƒå¼ç³»ç»Ÿï¼šTCCç­‰åˆ†å¸ƒå¼äº‹åŠ¡æ–¹æ¡ˆ å…ˆåˆ ç¼“å­˜å†æ”¹æ•°æ®åº“orå…ˆä¿®æ”¹æ•°æ®åº“ï¼ˆçº¿ç¨‹å®‰å…¨æ€§ï¼‰â€”â€”\u0026gt;å…ˆæ”¹æ•°æ®åº“ååˆ ç¼“å­˜ å°è£…æˆäº‹åŠ¡ ç¼“å­˜ç©¿é€ å®¢æˆ·ç«¯è¯·æ±‚çš„æ•°æ®åœ¨ç¼“å­˜å’Œæ•°æ®åº“ä¸­éƒ½ä¸å­˜åœ¨\nç¼“å­˜ç©ºå¯¹è±¡ï¼šåœ¨Redisä¸­ç¼“å­˜é”®å€¼å¯¹null é€ æˆé¢å¤–çš„å†…å­˜æ¶ˆè€—â€”â€”è®¾ç½®TTLè§£å†³ å¯èƒ½é€ æˆçŸ­æœŸä¸ä¸€è‡´ å¸ƒéš†è¿‡æ»¤ï¼šå®¢æˆ·ç«¯åˆ°Redisä¹‹é—´è®¾ç½®å¸ƒéš†è¿‡æ»¤å™¨ åˆ¤æ–­å­˜åœ¨åˆ™æ”¾è¡Œ ä¸å­˜åœ¨åˆ™æ‹’ç»è¯·æ±‚ â‰ˆ æ•°æ®åº“ä¸­æ•°æ®é€šè¿‡Hashè½¬æ¢ååœ¨è¿‡æ»¤å™¨ä¸­ä»¥äºŒè¿›åˆ¶ä½å½¢å¼å­˜å‚¨ ä¼˜ç‚¹ï¼šå†…å­˜å ç”¨è¾ƒå°‘ æ²¡æœ‰å¤šä½™key ç¼ºç‚¹ï¼šå®ç°å¤æ‚ å¯èƒ½è¯¯åˆ¤ï¼ˆåˆ¤ä¸ºå­˜åœ¨ï¼‰ é€‰æ‹©ç¼“å­˜ç©ºå¯¹è±¡\nå…¶å®ƒè§£å†³æ–¹æ¡ˆï¼šå¢åŠ idå¤æ‚åº¦ \u0026amp; åšå¥½æ•°æ®çš„åŸºç¡€æ ¼å¼æ ¡éªŒ \u0026amp; ç”¨æˆ·æƒé™æ ¡éªŒ \u0026amp; çƒ­ç‚¹å‚æ•°é™æµ ç¼“å­˜é›ªå´© åŒä¸€æ—¶æ®µå†…å¤§é‡ç¼“å­˜keyåŒæ—¶å¤±æ•ˆ/RedisæœåŠ¡å®•æœº å¯¼è‡´å¤§é‡è¯·æ±‚åˆ°è¾¾æ•°æ®åº“â€”â€”\u0026gt;å·¨å¤§å‹åŠ›\nç»™ä¸åŒkeyçš„TTLè®¾ç½®éšæœºå€¼ åˆ©ç”¨Redisé›†ç¾¤æé«˜æœåŠ¡çš„å¯ç”¨æ€§ ç¼“å­˜ä¸šåŠ¡æ·»åŠ é™çº§é™æµç­–ç•¥ï¼ˆç‰ºç‰²éƒ¨åˆ†æœåŠ¡ï¼‰ ç»™ä¸šåŠ¡æ·»åŠ å¤šçº§ç¼“å­˜ï¼ˆæµè§ˆå™¨ nginx JVMâ€¦éƒ½è®¾ç½®ç¼“å­˜ï¼‰ ç¼“å­˜å‡»ç©¿ â€œçƒ­ç‚¹keyé—®é¢˜â€ è¢«é«˜å¹¶å‘è®¿é—®\u0026amp;ç¼“å­˜é‡å»ºä¸šåŠ¡ï¼ˆæŸ¥è¯¢æ•°æ®åº“å¹¶æ›´æ–°ç¼“å­˜ï¼‰è¾ƒå¤æ‚çš„keyçªç„¶å¤±æ•ˆ æ— æ•°è¯·æ±‚è®¿é—®ä¼šç»™æ•°æ®åº“å¸¦æ¥å·¨å¤§å†²å‡»\näº’æ–¥é”â€”â€”ï¼ˆæŸ¥è¯¢ç¼“å­˜æœªå‘½ä¸­åï¼‰è·å–äº’æ–¥é”æˆåŠŸåæ‰å¯è¿›è¡Œç¼“å­˜é‡å»ºï¼Œè‹¥è·å–å¤±è´¥ ä¼‘çœ ä¸€ä¼šåé‡è¯• ä¼˜ç‚¹ï¼šæ— é¢å¤–å†…å­˜æ¶ˆè€— \u0026amp; ä¿è¯ä¸€è‡´æ€§ \u0026amp; å®ç°ç®€å• ç¼ºç‚¹ï¼šçº¿ç¨‹éœ€è¦ç­‰å¾… æ€§èƒ½å—å½±å“ \u0026amp; å¯èƒ½æ­»é” é€»è¾‘è¿‡æœŸâ€”â€”å­˜å‚¨çƒ­ç‚¹keyçš„valueæ—¶åœ¨valueä¸­å¢åŠ é€»è¾‘è¿‡æœŸå€¼expireï¼ˆå®é™…ä¸Šä¸è®¾ç½®TTLï¼‰ æ‰‹åŠ¨å›æ”¶ æŸ¥è¯¢ç¼“å­˜ æ£€æŸ¥é€»è¾‘æ—¶é—´æ˜¯å¦å·²è¿‡æœŸ å·²è¿‡æœŸï¼Œè·å–äº’æ–¥é”æˆåŠŸï¼Œå¼€å¯æ–°çº¿ç¨‹æ¥æ›´æ–°expireï¼Œæœ¬çº¿ç¨‹è¿”å›è¿‡æœŸæ•°æ®ï¼Œæ–°çº¿ç¨‹æ›´æ–°å®Œæ¯•é‡Šæ”¾é” å·²è¿‡æœŸï¼Œè·å–äº’æ–¥é”å¤±è´¥ï¼Œè¿”å›è¿‡æœŸæ•°æ® ä¼˜ç‚¹ï¼šçº¿ç¨‹æ— éœ€ç­‰å¾… æ€§èƒ½è¾ƒå¥½ ç¼ºç‚¹ï¼šä¸ä¿è¯ä¸€è‡´æ€§ï¼ˆè¿”å›æ—§æ•°æ®ï¼‰ \u0026amp; æœ‰é¢å¤–å†…å­˜æ¶ˆè€— \u0026amp; å®ç°å¤æ‚ ä½¿ç”¨é€»è¾‘è¿‡æœŸ åˆ›å»ºçº¿ç¨‹æ±  private static final ExecutorService CACHE_REBUILD_EXECUTOR= Executors.newFixedThreadPool(10); ç§’æ€ å…¨å±€ID é’ˆå¯¹ä¼˜æƒ åˆ¸\nè®¢å•è¡¨ä¸ç”¨è‡ªå¢IDï¼šidè§„å¾‹æ€§æ˜æ˜¾ \u0026amp; å—å•è¡¨æ•°æ®é‡é™åˆ¶ åˆ†å¸ƒå¼ç³»ç»Ÿä¸‹ç”Ÿæˆå…¨å±€å”¯ä¸€IDçš„å·¥å…· é«˜å¯ç”¨ é€’å¢æ€§ å®‰å…¨æ€§ é«˜æ€§èƒ½ å”¯ä¸€æ€§ IDç»„æˆï¼šç¬¦å·ä½ + æ—¶é—´æˆ³ï¼ˆ31ä½ï¼‰ + åºåˆ—å·ï¼ˆ32ä½ï¼‰ è®¾ç½®æ¯å¤©ä¸€ä¸ªkey é¿å…è¶…è¿‡ä¸Šé™ è¶…å– äº§ç”Ÿï¼šå¯¹åº“å­˜è¿›è¡Œæ“ä½œå®Œæˆå‰ æœ‰çº¿ç¨‹è®¿é—® å³ä¼šäº§ç”Ÿè¶…å– é”ï¼š æ‚²è§‚é”ï¼šçº¿ç¨‹å®‰å…¨é—®é¢˜ä¸€å®šå‘ç”Ÿï¼Œæ“ä½œæ•°æ®å‰å…ˆè·å–é”eg.Synchronized lock ä¹è§‚é”ï¼šä¸ä¸€å®šå‘ç”Ÿï¼Œåªåœ¨æ›´æ–°æ•°æ®æ—¶åˆ¤æ–­æ˜¯å¦æœ‰å…¶ä»–çº¿ç¨‹å¯¹æ•°æ®è¿›è¡Œäº†ä¿®æ”¹ ä¹è§‚é”ï¼šä¸¤ç§æ–¹æ¡ˆ ç‰ˆæœ¬å·æ³•ï¼šæ•°æ®åº“ä¸­æ·»åŠ versionå­—æ®µï¼Œä¿®æ”¹æ—¶éœ€æ ¡éªŒversionä¸ä¹‹å‰æŸ¥åˆ°çš„æ˜¯å¦ä¸€è‡´ï¼Œä¸€è‡´æ—¶åŒæ—¶æ›´æ–°ç‰ˆæœ¬å· CASæ³•ï¼šç›´æ¥æŠŠåº“å­˜å½“ç‰ˆæœ¬å³å¯ æˆåŠŸç‡è¿‡ä½ ä¸€äººä¸€å• åŠ æ‚²è§‚é”â€”â€”Synchronized å¯¹åŒä¸€ä¸ªç”¨æˆ·åŠ é”ï¼Œinternæ–¹æ³•ä¿è¯åªå¯¹è¯¥å€¼åŠ é” ä¸æ˜¯æ–°åˆ›å»ºå¯¹è±¡ï¼ˆtoStringä¼šæ–°åˆ›å»ºå¯¹è±¡ï¼‰ å½“é”åœ¨äº‹åŠ¡ä¸­æ—¶ï¼Œé”é‡Šæ”¾åäº‹åŠ¡å°šæœªæäº¤ ==\u0026gt; å…¶ä»–çº¿ç¨‹ä»æœ‰å¯èƒ½è®¿é—®åˆ°æœªæ›´æ–°çš„å†…å®¹ é”åœ¨æ–¹æ³•ä¸Šæ—¶ï¼Œä¼šå¯¹æ‰€æœ‰thiså¯¹è±¡éƒ½åŠ é”andÂ·Â·Â·ï¼ŒèŒƒå›´å¤ªå¹¿ é€‰å®šæŠŠé”åŠ åœ¨æ–¹æ³•è°ƒç”¨ä¸Š synchronized (userId.toString().intern()) é”åŠ åœ¨æ–¹æ³•è°ƒç”¨ä¸Šæ—¶ï¼Œthisçš„å¯¹è±¡å¹¶éä»£ç†ï¼ˆImplï¼‰å¯¹è±¡ï¼ŒSpringçš„äº‹åŠ¡ä¼šå¤±æ•ˆï¼Œè§£å†³æ–¹æ³•é€‰æ‹©è·å–ä»£ç†å¯¹è±¡ æ³¨æ„æœ‰å‡ ç§ä½¿Springçš„äº‹åŠ¡å¤±æ•ˆçš„å¯èƒ½ æœ‰å‡ ç§è§£å†³æ–¹æ¡ˆ\nsynchronized (userId.toString().intern()) { IVoucherOrderService proxy = (IVoucherOrderService) AopContext.currentProxy(); return proxy.createVoucherOrder(voucherId); } * ä¸»æ–¹æ³•ä¸­æ·»åŠ æ³¨è§£`@EnableAspectJAutoProxy(exposeProxy = true)` * æ·»åŠ AspectJweaverä¾èµ– é›†ç¾¤è®¾å¤‡è®¿é—® å¤±æ•ˆ æµ‹è¯•æ—¶è®¾ç½®è™šæ‹Ÿæœºè®¾ç½®ï¼ˆVM optionsï¼‰ä¿®æ”¹ä¸ºå¤šä¸ªç«¯å£å· åˆ†å¸ƒå¼é” æ»¡è¶³åˆ†å¸ƒå¼ç³»ç»Ÿ/é›†ç¾¤æ¨¡å¼ä¸‹å¤šè¿›ç¨‹å¯è§\u0026amp;äº’æ–¥çš„é”\nè¦æ±‚ï¼šå¤šè¿›ç¨‹å¯è§ + äº’æ–¥ + é«˜å¯ç”¨ + é«˜æ€§èƒ½ + å®‰å…¨æ€§ + Â·Â·Â· å¯¹æ¯”ï¼šMySql Redis Zookeeper ç»´åº¦ MS R Zk äº’æ–¥ è‡ªèº«çš„äº’æ–¥é” setnxç­‰äº’æ–¥å‘½ä»¤ èŠ‚ç‚¹å”¯ä¸€æ€§ æœ‰åºæ€§å®ç° é«˜å¯ç”¨ å¥½ å¥½ å¥½ é«˜æ€§èƒ½ ä¸€èˆ¬ å¥½ ä¸€èˆ¬ å®‰å…¨æ€§ æ–­å¼€è¿æ¥è‡ªåŠ¨é‡Šæ”¾é” é”è¶…æ—¶æ—¶é—´è®¾ç½® ä¸´æ—¶èŠ‚ç‚¹ æ–­å¼€è¿æ¥åˆ™é‡Šæ”¾ å®ç°ï¼šè®¾ç½®é”çš„åŒæ—¶ä¿è¯äº’æ–¥ï¼ˆè®¾ç½®é”\u0026amp;è®¾ç½®è¿‡æœŸæ—¶é—´ è¯­å¥åˆäºŒä¸ºä¸€ï¼‰ ä¸šåŠ¡å®Œæˆåéœ€æ‰‹åŠ¨é‡Šæ”¾é” SET lock thread1 NX EX 10 é—®é¢˜ï¼šè¯¯åˆ ï¼ˆeg.æŸçº¿ç¨‹ä¸šåŠ¡é˜»å¡ é”è¶…æ—¶é‡Šæ”¾ å…¶ä»–çº¿ç¨‹å³å¯è·å–é” æ­¤ååŸä¸šåŠ¡å†é‡Šæ”¾å³é‡Šæ”¾äº†å…¶å®ƒçº¿ç¨‹çš„é”ï¼‰ è§£å†³ï¼šåˆ é™¤é”æ—¶å¯¹æ¯”valueæ˜¯å¦æ˜¯æœ¬çº¿ç¨‹â€”â€”ä¿®æ”¹é‡Šæ”¾é”é€»è¾‘å³å¯ valueå­˜å‚¨æŸå›ºå®šUUID+çº¿ç¨‹æ ‡è¯† æ–°é—®é¢˜ï¼šåˆ¤æ–­æ ‡è¯†ä¸é‡Šæ”¾é”å¿…åŒæ—¶è¿›è¡Œï¼ˆå¦åˆ™è¿‡ç¨‹ä¸­å‘ç”Ÿé˜»å¡åä¹Ÿä¼šæœ‰é—®é¢˜â€”â€”Javaè‡ªèº«å¯¼è‡´çš„ï¼‰ è§£å†³ï¼šä¿è¯åŸå­æ€§â€”â€”Luaè„šæœ¬ï¼ˆä¸ç”¨Redisçš„äº‹åŠ¡æœºåˆ¶ï¼‰ ä¸€ä¸ªè„šæœ¬ä¸­ç¼–å†™å¤šæ¡å‘½ä»¤ -- ä»1å¼€å§‹è®¡æ•° local key=KEYS[1] -- ékeyçš„éƒ½ç”¨ARGVä¿å­˜ local threadId=ARGV[1] éšæ‚£ï¼šï¼ˆæå°æ¦‚ç‡ï¼‰â€”â€”Redissonè§£å†³ ä¸å¯é‡å…¥â€”â€”åŒä¸ªçº¿ç¨‹ä¸å¯å¤šæ¬¡è·å–åŒä¸€æŠŠé” ä¸å¯é‡è¯• è¶…æ—¶é‡Šæ”¾â€”â€”ä¸šåŠ¡æ‰§è¡Œè€—æ—¶è¾ƒé•¿ é”ä¹Ÿä¼šé‡Šæ”¾ ä¸»ä»ä¸€è‡´æ€§ Redisson è®¾ç½®ï¼šå¼•å…¥ä¾èµ–â€”â€”é…ç½®configâ€”â€”æ³¨å…¥åç›´æ¥ä½¿ç”¨ @Configuration public class RedissonConfig { @Bean public RedissonClient redissonClient() { Config config = new Config(); config.useSingleServer().setAddress(\u0026#34;redis://192.168.balabal:6379\u0026#34;).setPassword(\u0026#34;123456\u0026#34;); return org.redisson.Redisson.create(config); } } å¯é‡å…¥é”åŸç†ğŸ‘‡ï¼šåŒä¸€çº¿ç¨‹å¯ä»¥å¤šæ¬¡è®¿é—®ä¸€ä¸ªé”â€”â€”Redisç”¨Hashç»“æ„ä¿å­˜ï¼Œvalueä¸ºè®¿é—®æ¬¡æ•°ï¼Œå½“æœ€åvalue==0æ—¶é‡Šæ”¾é”ï¼ˆè‹¥é0ï¼Œåˆ™é‡ç½®æœ‰æ•ˆæœŸåç»§ç»­æ‰§è¡Œä¸šåŠ¡â€”â€”ä¸åœ¨æœ€å¤–ä¾§ï¼‰\nLuaè„šæœ¬ç¼–å†™ å¯é‡è¯•ï¼šè®¢é˜…ç­‰åŠŸèƒ½å®ç°â€”â€”ç­‰å¾…ã€å”¤é†’ã€è·å–é”å¤±è´¥ğŸ‘‡\nè¶…æ—¶ç»­çº¦ï¼šwatchDog æ¯éš”ä¸€æ®µæ—¶é—´é‡ç½®è¶…æ—¶æ—¶é—´ï¼ˆleaseTime=-1æ—¶è‡ªåŠ¨è¿›å…¥ï¼‰ğŸ‘‡\nRedissonåˆ†å¸ƒå¼é”è¿‡ç¨‹ğŸ‘‡ï¼ˆè¯»æºç ï¼‰ä¸‹å›¾æ¥è‡ªï¼šé»‘é©¬ç¨‹åºå‘˜Rediså…¥é—¨åˆ°å®æˆ˜æ•™ç¨‹ ä¸»ä»ä¸€è‡´æ€§ï¼ˆä¸»ä»åŒæ­¥æœ‰å»¶æ—¶/åŒæ­¥å¤±è´¥æ—¶ï¼‰â€”â€”è®¾ç½®å¤šNode å¿…é¡»åœ¨æ‰€æœ‰Nodeéƒ½è·å¾—é”ç¨‹åºæ‰è·å¾—é”ï¼ˆä¹Ÿå¯ä»¥ç»§ç»­ç»™Nodeé…SlaveèŠ‚ç‚¹ï¼‰\nå¼‚æ­¥ä¼˜åŒ– ï¼ˆLuaè„šæœ¬ï¼‰Redisè¿›è¡Œåˆ¤æ–­è´­ä¹°æ¡ä»¶ä¸â€œæ‰£å‡åº“å­˜â€ tomcatæ ¹æ®å…¶ä¼ å›çš„ä¿¡æ¯åˆ¤æ–­æ˜¯å¦æ·»åŠ åˆ°é˜»å¡é˜Ÿåˆ—å¹¶è¿”å›è®¢å•id mysqlå¼‚æ­¥ä¸‹å• ä¸¤çº¿ç¨‹è¿›è¡Œ é˜»å¡é˜Ÿåˆ— BlockingQueneâ€”â€”é˜Ÿåˆ—ä¸ºç©ºæ—¶ é˜»å¡è¿›ç¨‹ï¼›é˜Ÿæ»¡æ—¶æ’å…¥ é˜»å¡è¿›ç¨‹ Spring Security é‰´æƒ æƒé™ï¼šè®¿é—® æ‰§è¡Œ æ§åˆ¶ å…±äº« RBAC\u0026ndash;\u0026gt;role-based access control RBAC0ï¼šç”¨æˆ·\u0026ndash;\u0026gt;è§’è‰²\u0026ndash;\u0026gt;è®¸å¯ï¼ˆå‡ä¸ºå¤šå¯¹å¤šï¼‰ == 3+2å¼ è¡¨ï¼ˆå¯¹åº”å…³ç³»è¡¨ï¼‰ RBAC1ï¼šå¼•å…¥è§’è‰²ç»§æ‰¿æœºåˆ¶ï¼ˆè§’è‰²é—´çš„ç­‰çº§å…³ç³»ï¼‰ RBAC2ï¼šåœ¨0çš„åŸºç¡€ä¸Šå¼•å…¥å¯¹è§’è‰²çš„çº¦æŸ\u0026ndash;\u0026gt;ä¸€ä¸ªç”¨æˆ·ä¸èƒ½åŒæ—¶å…·æœ‰ä¸¤ç§ç‰¹å®šçš„æƒé™ RBAC3ï¼šçº¦æŸ+ç»§æ‰¿ æ³¨è§£ eg.PreAuthorize\u0026ndash;\u0026gt;æå‰é‰´æƒéªŒè¯ åŸºäºRBACé‰´æƒæ¨¡å‹æ·»åŠ ç»Ÿä¸€åŠŸèƒ½ \u0026ndash;\u0026gt; AOPï¼ˆåˆ‡é¢ = åˆ‡ç‚¹ é€šçŸ¥ è¿æ¥ç‚¹ Â·Â·Â·ï¼‰ æ‹¦æˆªæŒ‡å®šæ–¹æ³•å¹¶å¢å¼ºï¼Œæ— éœ€ä¾µå…¥ä¸šåŠ¡ä»£ç  æ¨¡å—åŒ– éä¾µå…¥å¼ å¯é‡ç”¨æ€§ æ¾è€¦åˆ æé«˜æ€§èƒ½ä¸å¯æ‹“å±•æ€§ ï¼ˆspring bootï¼‰å¯åŠ¨ç±»æ·»åŠ æ³¨è§£EnableAspectJAutoProxy å®šä¹‰æ¥å£anno æ·»åŠ Target Retentionæ³¨è§£â€”â€”targetçš„æ˜¯method åœ¨runtimeæœ‰æ•ˆè¿è¡Œ åˆ‡é¢ç±»ç¼–å†™ æ·»åŠ Aspect Componentæ³¨è§£â€”â€”åˆ‡é¢ç±»æ–¹æ³•çš„å…·ä½“å®ç° (é…ç½®AOPæ—¶ æŠŠç›®æ ‡ç±»\u0026amp;åˆ‡é¢ç±»éƒ½beanï¼ˆæ·»åŠ æ³¨è§£@Componentäº¤äºˆå®¹å™¨ç®¡ç†ï¼‰) æŒ‡å®špointcutåœ°å€ï¼ˆç›®æ ‡æ–¹æ³•åœ°å€ï¼‰ æ¶ˆæ¯é˜Ÿåˆ— å¾…æ–½å·¥Â·Â·Â·\nå°è£… æ³›å‹ å…¶å®ƒ JMeter è¿è¡Œjmeter.batå³å¯ æ‹†ç®±è£…ç®±é—®é¢˜ Boolean-boolean Integer-intç­‰\nçŸ¥è¯†ç‚¹æ€»ç»“ JWT+Interceptor JWTç»„æˆï¼šHeader Payload Signatureï¼ˆå‰äºŒBase64urlè§£ç åæ˜¯JSONæ ¼å¼ ç­¾åé€šè¿‡å‰äºŒ+å¯†é’¥withç­¾åç®—æ³•å¾—åˆ°ï¼‰ Payload éƒ¨åˆ†é»˜è®¤ä¸åŠ å¯† JWTå¦‚ä½•è¿›è¡Œèº«ä»½éªŒè¯ï¼Ÿ ç”¨æˆ·å‘æœåŠ¡å™¨å‘é€ç”¨æˆ·åã€å¯†ç ä»¥åŠéªŒè¯ç ç”¨äºç™»é™†ç³»ç»Ÿã€‚ å¦‚æœç”¨æˆ·æ ¡éªŒæ­£ç¡®ï¼ŒæœåŠ¡ç«¯è¿”å›å·²ç»ç­¾åçš„ Tokenï¼Œå³ JWT ç”¨æˆ·æ¯æ¬¡å‘åç«¯å‘è¯·æ±‚éƒ½åœ¨ Header ä¸­å¸¦ä¸Š JWT ï¼ˆæ­¤å¤„å¯çœç•¥ï¼‰ç”¨æˆ·ç«¯æœ€å¥½å°†JWTä¿å­˜åˆ°localstorage è€ŒéCookieï¼ˆCSRFé£é™©ï¼‰ æœåŠ¡ç«¯æ£€æŸ¥ JWT å¹¶ä»ä¸­è·å–ç”¨æˆ·ç›¸å…³ä¿¡æ¯ é˜²æ­¢JWTè¢«ç¯¡æ”¹â€”â€”ç­¾åæ¯”å¯¹ åŠ å¼ºå®‰å…¨æ€§æ–¹æ³• Payload è¦åŠ å…¥ exp ï¼ˆJWT çš„è¿‡æœŸæ—¶é—´ï¼‰ï¼Œæ°¸ä¹…æœ‰æ•ˆçš„ JWT ä¸åˆç†ã€‚å¹¶ä¸”ï¼ŒJWT çš„è¿‡æœŸæ—¶é—´ä¸æ˜“è¿‡é•¿ JWT å­˜æ”¾åœ¨ localStorage ä¸­è€Œä¸æ˜¯ Cookie ä¸­ï¼Œé¿å… CSRF é£é™© ä¸è¦å°†éšç§ä¿¡æ¯å­˜æ”¾åœ¨ Payload ä¸­ å¯†é’¥ä¸è¦æ³„éœ²ã€‚JWT å®‰å…¨çš„æ ¸å¿ƒåœ¨äºç­¾åï¼Œç­¾åå®‰å…¨çš„æ ¸å¿ƒåœ¨å¯†é’¥ JWTä¼˜åŠ¿ï¼š æ— çŠ¶æ€ï¼šæœåŠ¡å™¨ä¸éœ€è¦å­˜å‚¨æ¯æ¬¡ä¼šè¯çš„å®¢æˆ·ç«¯ä¿¡æ¯ï¼ˆä¼ æ¥JWTåç”¨åŠ å¯†ç®—æ³•æ¯”å¯¹ç­¾åå³å¯ï¼‰ é¿å…CSRFï¼ˆè·¨ç«™è¯·æ±‚ä¼ªé€ ï¼‰ï¼šCSRF æ”»å‡»ä¾èµ– Cookie ï¼ŒSession è®¤è¯ä¸­ Cookie ä¸­çš„ SessionID æ˜¯ç”±æµè§ˆå™¨å‘é€åˆ°æœåŠ¡ç«¯çš„ï¼Œåªè¦å‘å‡ºè¯·æ±‚ï¼ŒCookie å°±ä¼šè¢«æºå¸¦ï¼ˆèº«ä»½å°±è¢«ç¡®å®šï¼‰ é€‚åˆç§»åŠ¨ç«¯â€”â€”Sessionè®¤è¯éœ€è¦Cookie æ•…ä¸é€‚åˆï¼ˆç§»åŠ¨ç«¯ç‰¹ç‚¹ï¼šæ— çŠ¶æ€ å…¼å®¹æ€§å¼ºï¼ˆcookieè·¨åŸŸé—®é¢˜ï¼‰ å®‰å…¨æ€§å·®ï¼‰ JWTå¸¸è§é—®é¢˜ï¼š æ³¨é”€ç™»å½•åJWTä¾ç„¶æœ‰æ•ˆï¼šå­˜å…¥Redisï¼ˆè¿èƒŒæ— çŠ¶æ€ï¼‰+ ä¿æŒä»¤ç‰Œæœ‰æ•ˆæœŸçŸ­å¹¶ç»å¸¸è½®æ¢ ç»­ç­¾JWTï¼šï¼ˆç”³è¯·ä¸¤ä¸ªjwtï¼‰å®¢æˆ·ç«¯ç™»å½•åï¼Œå°† accessJWT å’Œ refreshJWT ä¿å­˜åœ¨æœ¬åœ°ï¼Œæ¯æ¬¡è®¿é—®å°† accessJWT ä¼ ç»™æœåŠ¡ç«¯ã€‚å¦‚æœæœåŠ¡ç«¯åˆ¤æ–­ accessJWT è¿‡æœŸï¼Œå®¢æˆ·ç«¯å°† refreshJWT ä¼ ç»™æœåŠ¡ç«¯ã€‚å¦‚æœæœ‰æ•ˆï¼ŒæœåŠ¡ç«¯ç”Ÿæˆæ–°çš„ accessJWT ç»™å®¢æˆ·ç«¯ã€‚å¦åˆ™ï¼Œå®¢æˆ·ç«¯é‡æ–°ç™»å½• ä½“ç§¯è¿‡å¤§ï¼šå‡å°‘payloadä¿¡æ¯ + æ¢ç”¨ä¼ ç»Ÿçš„tokenï¼ˆsave in redisï¼‰ Interceptorï¼šå±äºSpring MVCï¼ˆFilterå±äºServlet å¯¹æ‰€æœ‰è®¿é—®éƒ½å¢å¼º æ­¤åªå¯¹SpringMVCè®¿é—®å¢å¼ºï¼‰ åŠ¨æ€æ‹¦æˆªæ–¹æ³•è°ƒç”¨çš„æœºåˆ¶ï¼Œåœ¨SpringMVCä¸­åŠ¨æ€æ‹¦æˆªControlleræ–¹æ³•çš„æ‰§è¡Œ å¼•ç”³ SpringMVCå·¥ä½œæµç¨‹ï¼š å®¢æˆ·ç«¯ï¼ˆæµè§ˆå™¨ï¼‰å‘é€è¯·æ±‚ï¼Œ DispatcherServletæ‹¦æˆªè¯·æ±‚ã€‚ DispatcherServlet æ ¹æ®è¯·æ±‚ä¿¡æ¯è°ƒç”¨ HandlerMapping ã€‚HandlerMapping æ ¹æ® URL å»åŒ¹é…æŸ¥æ‰¾èƒ½å¤„ç†çš„ Handlerï¼ˆä¹Ÿå°±æ˜¯æˆ‘ä»¬å¹³å¸¸è¯´çš„ Controller æ§åˆ¶å™¨ï¼‰ï¼Œå¹¶ä¼šå°†è¯·æ±‚æ¶‰åŠåˆ°çš„æ‹¦æˆªå™¨å’Œ Handler ä¸€èµ·å°è£…ã€‚ DispatcherServlet è°ƒç”¨ HandlerAdapteré€‚é…å™¨æ‰§è¡Œ Handler ã€‚ Handler å®Œæˆå¯¹ç”¨æˆ·è¯·æ±‚çš„å¤„ç†åï¼Œä¼šè¿”å›ä¸€ä¸ª ModelAndView å¯¹è±¡ç»™DispatcherServletï¼Œ ModelAndView é¡¾åæ€ä¹‰ï¼ŒåŒ…å«äº†æ•°æ®æ¨¡å‹ä»¥åŠç›¸åº”çš„è§†å›¾çš„ä¿¡æ¯ã€‚Model æ˜¯è¿”å›çš„æ•°æ®å¯¹è±¡ï¼ŒView æ˜¯ä¸ªé€»è¾‘ä¸Šçš„ Viewã€‚ ViewResolver ä¼šæ ¹æ®é€»è¾‘ View æŸ¥æ‰¾å®é™…çš„ Viewã€‚ DispaterServlet æŠŠè¿”å›çš„ Model ä¼ ç»™ Viewï¼ˆè§†å›¾æ¸²æŸ“ï¼‰ã€‚ æŠŠ View è¿”å›ç»™è¯·æ±‚è€…ï¼ˆæµè§ˆå™¨ï¼‰ Cache Aside Pattern+è¶…æ—¶å‰”é™¤ æ—è·¯ç¼“å­˜â€”â€”é€‚åˆè¯»å¤šå†™å°‘åœºæ™¯\næœåŠ¡ç«¯åŒæ—¶ç»´ç³»DBä¸cacheï¼ˆredisï¼‰ å¹¶ä»¥DBç»“æœä¸ºå‡† å†™ï¼šå…ˆæ›´æ–°DB ååˆ é™¤cache è¯»ï¼šä»cacheä¸­è¯» è¯»ä¸åˆ°ä»DBä¸­è¯»å¹¶æŠŠæ•°æ®å†™åˆ°cacheä¸­ ç¼ºç‚¹ï¼š é¦–æ¬¡è¯·æ±‚æ•°æ®ä¸€å®šä¸åœ¨cacheé‡Œâ€”â€”çƒ­ç‚¹æ•°æ®æå‰æ”¾å…¥cache å†™æ“ä½œé¢‘ç¹æ—¶cacheä¸­æ•°æ®ä¼šè¢«é¢‘ç¹åˆ é™¤ å½±å“ç¼“å­˜å‘½ä¸­ç‡ è¶…æ—¶å‰”é™¤ï¼šå‘redisä¸­æ·»åŠ ç¼“å­˜æ•°æ®çš„æ—¶å€™è®¾ç½®TTLæ—¶é—´ï¼Œåˆ°æœŸåè‡ªåŠ¨åˆ é™¤ç¼“å­˜ï¼Œä¸‹æ¬¡æŸ¥è¯¢æ—¶æ›´æ–°ç¼“å­˜ å¼•ç”³ ä¸‰ç§ç¼“å­˜è¯»å†™ç­–ç•¥ï¼šï¼ˆå…¶å®ƒçš„ï¼‰ è¯»å†™ç©¿é€ï¼šä»¥cacheä¸ºä¸­å¿ƒ å†™ï¼šcacheä¸­ä¸å­˜åœ¨ ç›´æ¥æ›´æ–°DB / cacheä¸­å­˜åœ¨ å…ˆæ›´æ–°cache åcacheæ›´æ–°DB è¯»ï¼šcacheè¯»åˆ°å°±è¿”å› / è¯»ä¸åˆ°å…ˆä»DBåŠ è½½ å†™å…¥åˆ°cacheä¸­åè¿”å› ç¼ºç‚¹ï¼šé¦–æ¬¡è¯·æ±‚ä¸€å®šä¸åœ¨cacheä¸­ å†™å›ï¼šå¼‚æ­¥ç¼“å­˜å†™å…¥ï¼Œä»¥cacheä¸ºä¸­å¿ƒ OSçš„è®¾è®¡ï¼ŒRedisæ²¡æœ‰å¼‚æ­¥æ›´æ–°DBçš„åŠŸèƒ½ï¼Œé€‚åˆå†™å¤šçš„åœºæ™¯\nç±»ä¼¼è¯»å†™ç©¿é€ ä½†åªæ›´æ–°cacheä¸æ›´æ–°DB å¼‚æ­¥æ‰¹é‡æ›´æ–°DB Redissonåˆ†å¸ƒå¼é”+ä¹è§‚é” åˆ†å¸ƒå¼é”ï¼šå¤šè¿›ç¨‹æ¡ä»¶ä¸‹ æ§åˆ¶æŸä¸ªèµ„æºåœ¨åŒä¸€æ—¶åˆ»åªèƒ½è¢«ä¸€ä¸ªåº”ç”¨æ‰€ä½¿ç”¨ï¼ˆçº¿ç¨‹ç”¨synchronizedå³å¯ï¼‰\næºç ï¼ˆçœ‹é—¨ç‹— Luaè„šæœ¬å•¥çš„ï¼‰ åˆ†å¸ƒå¼é”çš„è¦æ±‚ï¼š äº’æ–¥æ€§ï¼šåŒä¸€æ—¶åˆ»åªèƒ½æœ‰ä¸€ä¸ªèŠ‚ç‚¹æŒæœ‰é” å¯é‡å…¥æ€§ï¼šå…è®¸æŒæœ‰é”çš„èŠ‚ç‚¹åœ¨é‡Šæ”¾é”åå†æ¬¡è·å–é” å®‰å…¨æ€§ï¼šç¡®ä¿å³ä½¿èŠ‚ç‚¹å´©æºƒæˆ–ç½‘ç»œæ•…éšœï¼Œé”ä¸ä¼šè¢«æ°¸ä¹…å ç”¨ é«˜æ€§èƒ½ï¼šé”çš„è·å–å’Œé‡Šæ”¾åº”è¯¥æ˜¯é«˜æ•ˆçš„æ“ä½œ Redissonè¿‡ç¨‹ï¼š è·å–é”ï¼ˆLua+è®¢é˜…åŠŸèƒ½ï¼‰ï¼šå½“ä¸€ä¸ªçº¿ç¨‹å°è¯•è·å–é”æ—¶ï¼ŒRedissonä¼šåœ¨Redisä¸­åˆ›å»ºä¸€ä¸ªå­—ç¬¦ä¸²ç±»å‹çš„é”®å€¼å¯¹ï¼Œé”®æ˜¯é”çš„åç§°ï¼Œå€¼æ˜¯çº¿ç¨‹çš„å”¯ä¸€æ ‡è¯†ï¼ˆé€šå¸¸æ˜¯çº¿ç¨‹IDï¼‰ã€‚å¦‚æœè·å–é”æˆåŠŸï¼ŒRedissonä¼šè®¾ç½®ä¸€ä¸ªè¿‡æœŸæ—¶é—´ï¼Œä»¥é˜²æ­¢é”è¢«é•¿æ—¶é—´å ç”¨ã€‚è¿‡æœŸæ—¶é—´é€šå¸¸ä½¿ç”¨éšæœºå€¼ï¼Œä»¥é¿å…é”è¿‡æœŸæ—¶é—´å†²çªã€‚å¦‚æœè·å–é”å¤±è´¥ï¼ŒRedissonä¼šç­‰å¾…ä¸€æ®µæ—¶é—´ï¼Œç„¶åé‡è¯•ã€‚è¿™ä¸ªç­‰å¾…æ—¶é—´é€šå¸¸æ˜¯éšæœºçš„ï¼Œä»¥å‡å°‘é”äº‰ç”¨ é‡Šæ”¾é”ï¼ˆLuaï¼‰ï¼šå½“ä¸€ä¸ªçº¿ç¨‹é‡Šæ”¾é”æ—¶ï¼ŒRedissonä¼šæ£€æŸ¥é”çš„æŒæœ‰è€…æ˜¯å¦ä¸å½“å‰çº¿ç¨‹åŒ¹é…ã€‚å¦‚æœåŒ¹é…ï¼ŒRedissonä¼šåˆ é™¤é”çš„é”®å€¼å¯¹ï¼Œé‡Šæ”¾é”ã€‚å¦‚æœæŒæœ‰é”çš„çº¿ç¨‹åœ¨é”è¿‡æœŸåä»ç„¶æœªé‡Šæ”¾é”ï¼Œå…¶ä»–çº¿ç¨‹å¯ä»¥å°è¯•è·å–é” ä¹è§‚é”\u0026amp;æ‚²è§‚é” æ‚²è§‚é”ï¼šè®¤ä¸ºå…±äº«èµ„æºæ¯æ¬¡è¢«è®¿é—®çš„æ—¶å€™å°±ä¼šå‡ºç°é—®é¢˜\u0026ndash;\u0026gt;å…±äº«èµ„æºæ¯æ¬¡åªç»™ä¸€ä¸ªçº¿ç¨‹ä½¿ç”¨ï¼Œå…¶å®ƒçº¿ç¨‹é˜»å¡ï¼Œç”¨å®Œåå†æŠŠèµ„æºè½¬è®©ç»™å…¶å®ƒçº¿ç¨‹ eg.synchronized ReentrantLock æ˜“å‘ç”Ÿçº¿ç¨‹é˜»å¡ ä¹è§‚é”ï¼šåªåœ¨æäº¤ä¿®æ”¹çš„æ—¶å€™éªŒè¯æ•°æ®æ˜¯å¦è¢«å…¶å®ƒçº¿ç¨‹ä¿®æ”¹è¿‡â€”â€”ç‰ˆæœ¬å·/CASç®—æ³•ï¼ˆeg.AtomicInteger LongAdderï¼‰ å¦‚ä½•å®ç°ï¼Ÿ ç‰ˆæœ¬å·ï¼šæ•°æ®è¡¨ä¸­æ·»åŠ versionå­—æ®µ è¦ä¿®æ”¹æ—¶ï¼Œçº¿ç¨‹Aè¯»å–versionï¼Œæäº¤æ›´æ–°æ—¶ï¼Œæ¯”è¾ƒå½“å‰æ•°æ®ä¸­çš„versionæ˜¯å¦ä¸è‡ªå·±è¯»åˆ°çš„versionçš„å€¼ç›¸åŒï¼Œè‹¥ç›¸åŒåˆ™version++ï¼Œä¸åŒåˆ™é‡è¯•æ›´æ–° CASï¼ˆCompare And Swapï¼‰â€”â€”åŸå­æ“ä½œâ€”â€”ä¸‰ä¸ªæ“ä½œæ•°ï¼š Vï¼šè¦æ›´æ–°çš„å˜é‡å€¼(Var) Eï¼šé¢„æœŸå€¼(Expected) Nï¼šæ‹Ÿå†™å…¥çš„æ–°å€¼(New) ä»…å½“V==Eæ—¶ï¼ŒåŸå­æ‰§è¡Œç”¨Næ›¿ä»£Vï¼Œä¸ç­‰æ—¶è¯´æ˜Vå·²è¢«æ›´æ–°ï¼Œå‘ŠçŸ¥æ­¤çº¿ç¨‹å¹¶å…è®¸é‡è¯• CASå¦‚ä½•å®ç°ï¼šUnsafeç±» ä¾èµ–äºCPUçš„åŸå­æŒ‡ä»¤ ç”±JNIè°ƒç”¨Cppå†…è”æ±‡ç¼–å®ç° (Unsafeç±»çš„CASæ–¹æ³•æ˜¯nativeæ–¹æ³•ï¼Œè¡¨æ˜è¿™äº›æ–¹æ³•ç”±æœ¬åœ°ä»£ç ï¼ˆé€šå¸¸æ˜¯ C æˆ– C++ï¼‰å®ç°ï¼Œç›´æ¥è°ƒç”¨åº•å±‚çš„ç¡¬ä»¶æŒ‡ä»¤æ¥å®ç°åŸå­æ“ä½œã€‚å…·ä½“å®ç°ä¸OS CPUç›¸å…³) åº•å±‚é€šå¸¸æ˜¯whileå¾ªç¯ eg.getAndAddInt\u0026ndash;\u0026gt;è‡ªæ—‹é” // åŸå­åœ°è·å–å¹¶å¢åŠ æ•´æ•°å€¼ public final int getAndAddInt(Object o, long offset, int delta) { int v; do { // ä»¥ volatile æ–¹å¼è·å–å¯¹è±¡ o åœ¨å†…å­˜åç§»é‡ offset å¤„çš„æ•´æ•°å€¼ v = getIntVolatile(o, offset); } while (!compareAndSwapInt(o, offset, v, v + delta)); // è¿”å›æ—§å€¼ return v; } CASç®—æ³•é—®é¢˜ï¼š ABAâ€”â€”åˆæ¬¡è¯»å–ä¸ºA ä¸­é—´å¯èƒ½æœ‰å…¶å®ƒçº¿ç¨‹æŠŠæ•°æ®æ”¹ä¸ºB å‡†å¤‡èµ‹å€¼æ—¶æ£€æŸ¥åˆ°ä»ä¸ºA\u0026ndash;\u0026gt;CASè¯¯ä»¥ä¸ºå…¶æ²¡è¢«ä¿®æ”¹è¿‡ è§£å†³ï¼šå˜é‡å‰æ·»åŠ ç‰ˆæœ¬å·/æ—¶é—´æˆ³\u0026ndash;\u0026gt;JDK 1.5 åçš„ AtomicStampedReference ç±»æ·»åŠ äº† å¾ªç¯æ—¶é—´é•¿å¼€é”€å¤§ï¼ˆcauseè‡ªæ—‹é”ï¼‰ è§£å†³ï¼šè‹¥JVMæ”¯æŒå¤„ç†å™¨çš„pauseæŒ‡ä»¤å¯è§£ å¯å»¶è¿Ÿæµæ°´çº¿æ‰§è¡ŒæŒ‡ä»¤ é¿å…å†…å­˜é¡ºåºå†²çª åªèƒ½ä¿è¯ä¸€ä¸ªå…±äº«å˜é‡çš„åŸå­æ“ä½œ è§£å†³ï¼šjdk1.5åçš„ AtomicStampedReference ç±»è§£å†³äº†ï¼ˆå°è£…ä¸ºä¸€ä¸ªç±»ï¼‰ å¼•ç”³ (CAS) å†…å­˜é¡ºåºå†²çªï¼šå¤šä¸ªCPUåŒæ—¶ä¿®æ”¹åŒä¸ªç¼“å­˜è¡Œçš„ä¸åŒéƒ¨åˆ†å¼•èµ·å…¶ä¸­ä¸€ä¸ªCPUæ“ä½œæ— æ•ˆ è‡ªæ—‹é”å¿«é‡Šæ”¾æ—¶ æŒé”çº¿ç¨‹æœ‰storeå‘½ä»¤ è‡ªæ—‹çº¿ç¨‹ä¼šå‘å‡ºå„è‡ªloadå‘½ä»¤ï¼Œè€Œæ­¤å¤„å¹¶æ²¡ä»»ä½• happen-before æ’åºï¼Œæ‰€ä»¥å¤„ç†å™¨æ˜¯ä¹±åºæ‰§è¡Œã€‚\u0026ndash;\u0026gt;pauseå¯ä»¥å‡å°‘å¹¶è¡Œloadæ•°é‡ Redis+Lua å¼‚æ­¥åœºæ™¯ï¼šRedisè¿›è¡Œåˆ¤æ–­è´­ä¹°æ¡ä»¶ä¸â€œæ‰£å‡åº“å­˜â€ tomcatæ ¹æ®å…¶ä¼ å›çš„ä¿¡æ¯åˆ¤æ–­æ˜¯å¦æ·»åŠ åˆ°é˜»å¡é˜Ÿåˆ—å¹¶è¿”å›è®¢å•id mysqlå¼‚æ­¥ä¸‹å•\nLuaè„šæœ¬åˆ¤æ–­æ˜¯å¦é‡å¤ä¸‹å• æ˜¯å¦æœ‰åº“å­˜ åˆ†åˆ«è¿”å›ä¸åŒçš„æ•°å­— æ¡ä»¶é€šè¿‡çš„åŠ å…¥é˜»å¡é˜Ÿåˆ— ç¬¬äºŒçº¿ç¨‹ï¼šé˜»å¡é˜Ÿåˆ—ä¸­åˆ†åˆ«å¯¹æ¯ä¸ªè®¢å•è¿›è¡Œå¤„ç†ï¼ˆmysqlï¼‰ï¼Œæ­¤æ—¶è·ŸRedissonè”åŠ¨è·å–é”å¯¹mysqlè¿›è¡Œæ›´æ”¹ï¼ˆåˆ›å»ºè®¢å•ï¼‰ æ— è®ºæ˜¯å¦æŠ¥å¼‚å¸¸ éƒ½è¦é‡Šæ”¾é” ","permalink":"https://Sattiluvcat.github.io/en/posts/java/%E7%82%B9%E8%AF%84proj/","summary":"åŸå‹ä¸ºé»‘é©¬ç‚¹è¯„","title":"ç‚¹è¯„Proj"},{"content":"Â è®¡ç®—æœºç½‘ç»œå¾®è¯¾å ‚ï¼ˆæœ‰å­—å¹•æ— èƒŒæ™¯éŸ³ä¹ç‰ˆï¼‰ æ¦‚è¿° æ¦‚å¿µ è®¡ç®—æœºç½‘ç»œ ç”±ç»“ç‚¹node\u0026amp;é“¾è·¯linkæ„æˆ è®¡ç®—æœºç½‘ç»œå¯ç”±äº¤æ¢æœºè¿æ¥ å¤šä¸ªè®¡ç®—æœºç½‘ç»œå¯ç”±è·¯ç”±å™¨è¿æ¥æˆäº’è¿ç½‘ï¼ˆåè®®ä¸å®šï¼‰ å…¨çƒèŒƒå›´çš„äº’è¿ç½‘ = äº’è”ç½‘ï¼ˆç»Ÿä¸€é‡‡ç”¨TCP/IPåè®®ï¼‰ ISP äº’è”ç½‘æœåŠ¡æä¾›å•† ç»„æˆä¸åŠŸèƒ½ ç»„æˆ ç¡¬ä»¶+è½¯ä»¶+åè®® ç¡¬ä»¶ï¼šä¸»æœºï¼ˆend systemç«¯ç³»ç»Ÿï¼‰ é€šä¿¡è®¾å¤‡balabal åè®®ç”±ç¡¬ä»¶è½¯ä»¶å…±åŒå®ç° è¾¹ç¼˜éƒ¨åˆ†+æ ¸å¿ƒéƒ¨åˆ† è¾¹ç¼˜ = ç›´æ¥ä¸ºç”¨æˆ·æœåŠ¡ ï¼ˆä»é€»è¾‘åŠŸèƒ½ï¼‰èµ„æºå­ç½‘+é€šä¿¡å­ç½‘ èµ„æºå­ç½‘ ä¸»è¦æ˜¯ä¸»æœº åŠŸèƒ½ æ•°æ®é€šä¿¡ï¼ˆæœ€åŸºæœ¬æœ€é‡è¦ï¼‰ èµ„æºå…±äº«â€”â€”ç¡¬ä»¶ è½¯ä»¶ æ•°æ® åˆ†å¸ƒå¼å¤„ç†â€”â€”eg.å¤æ‚ä»»åŠ¡å¤šè®¡ç®—æœºå¤„ç† æé«˜å¯é æ€§â€”â€”eg.äº’ä¸ºæ›¿ä»£æœº è´Ÿè½½å‡è¡¡ é€šä¿¡æ–¹å¼ ç”µè·¯äº¤æ¢eg.ç”µè¯ é€šä¿¡æ—¶å§‹ç»ˆå ç”¨ç«¯åˆ°ç«¯çº¿è·¯èµ„æº but é‡Šæ”¾/å»ºç«‹è¿æ¥éœ€è¦é¢å¤–æ—¶é—´å¼€é”€ åˆ©ç”¨ç‡ä½ æŠ¥æ–‡äº¤æ¢eg.ç”µæŠ¥ æ— éœ€æå‰å»ºç«‹è¿æ¥ å­˜å‚¨è½¬å‘ï¼ˆé€šä¿¡çº¿è·¯å¯çµæ´»åˆ†é…ï¼‰ çº¿è·¯åˆ©ç”¨ç‡é«˜ æ”¯æŒå·®é”™æ§åˆ¶ but æŠ¥æ–‡ä¸å®šé•¿ ä¸åˆ©ç®¡ç† + é•¿æŠ¥æ–‡å­˜å‚¨è½¬å‘æ—¶é—´ã€ç¼“å­˜å¼€é”€å¤§ + é•¿æŠ¥æ–‡æ˜“å‡ºé”™ å­˜å‚¨è½¬å‘ = å…ˆå­˜å‚¨åè½¬å‘ åˆ†ç»„äº¤æ¢ï¼ˆç°ä»£ç½‘ç»œé‡‡ç”¨ï¼‰ å®šé•¿â€”â€”æ–¹ä¾¿å­˜å‚¨è½¬å‘ç®¡ç† + è½¬å‘æ—¶é—´æ›´å°‘ï¼ˆç›¸å¯¹æŠ¥æ–‡äº¤æ¢ï¼‰+ä¸æ˜“å‡ºé”™ æ§åˆ¶ä¿¡æ¯å æ¯”å¢åŠ ï¼ˆæŠ¥æ–‡ï¼‰+ å­˜åœ¨å­˜å‚¨è½¬å‘æ—¶å»¶ï¼ˆç”µè·¯äº¤æ¢ï¼‰+ åˆ†æˆå¤šä¸ªåˆ†ç»„ ä¼ è¾“è¿‡ç¨‹ä¸­å¯èƒ½å‡ºé”™ è™šç”µè·¯äº¤æ¢ï¼šè™šæ‹Ÿç”µè·¯å»ºç«‹è¿æ¥ + é€šä¿¡åŒæ–¹ä¸ç‹¬å çº¿è·¯ é€šä¿¡æ–¹å¼æ€§èƒ½å¯¹æ¯” ç”µè·¯äº¤æ¢ å»ºç«‹è¿æ¥åå†è¿›è¡Œæ•°æ®ä¼ é€ æœ€åè¿æ¥é‡Šæ”¾ æŠ¥æ–‡äº¤æ¢ ä¸­é—´èŠ‚ç‚¹éœ€æ¥æ”¶å®Œæ•´æŠ¥æ–‡åå†è¿›è¡Œè§£æä¸è½¬å‘ åˆ†ç»„äº¤æ¢ åˆ†ç»„è¿›è¡ŒæŠ¥æ–‡äº¤æ¢ åˆ†ç±» åˆ†å¸ƒèŒƒå›´ å¹¿åŸŸç½‘WAN + åŸåŸŸç½‘MAN + å±€åŸŸç½‘LAN + ä¸ªåŸŸç½‘PAN WANå¤šé‡‡ç”¨ä»¥å¤ªç½‘ MAN å‡ ä¹å…¨éƒ¨é‡‡ç”¨ä»¥å¤ªç½‘æŠ€æœ¯ï¼ˆåŸåŸŸç½‘å¤šå½’ä¸ºå±€åŸŸç½‘ï¼‰ å±€åŸŸç½‘å¯é€šè¿‡è·¯ç”±å™¨æ¥å…¥å¹¿åŸŸç½‘ ä¸ªåŸŸç½‘ eg.è“ç‰™ Zigbeeç­‰è®¾å¤‡ ä¼ è¾“æŠ€æœ¯ï¼šå¹¿æ’­å¼ç½‘ç»œ \u0026amp; ç‚¹å¯¹ç‚¹ç½‘ç»œ æ‹“æ‰‘ç»“æ„ï¼š æ€»çº¿å½¢ å¹¿æ’­å¼ å­˜åœ¨æ€»çº¿äº‰ç”¨é—®é¢˜ ç¯å½¢ç»“æ„ å¹¿æ’­å¼ ä»¤ç‰Œé¡ºç¯å½¢ä¼ é€’ æœ‰ä»¤ç‰Œæ‰å‘æ•°æ® eg.ä»¤ç‰Œç¯ç½‘ æ˜Ÿå½¢ç»“æ„ ä¸­å¤®è®¾å¤‡å®ç°æ•°æ®ç‚¹å¯¹ç‚¹ä¼ è¾“ eg.ä»¥å¤ªç½‘äº¤æ¢æœºè¿æ¥çš„è®¾å¤‡ ç½‘çŠ¶ç»“æ„ æ•°æ®é€šè¿‡å„ä¸­é—´èŠ‚ç‚¹é€ä¸€å­˜å‚¨è½¬å‘ eg.ç”±manyè·¯ç”±å™¨æ„å»ºçš„å¹¿åŸŸç½‘ ä½¿ç”¨è€…ï¼šå…¬ç”¨ç½‘ \u0026amp; ä¸“ç”¨ç½‘ ä¼ è¾“ä»‹è´¨ï¼šæœ‰çº¿ \u0026amp; æ— çº¿ æ€§èƒ½æŒ‡æ ‡ ä¿¡é“ï¼šå‘æŸä¸€æ–¹å‘å‘é€ä¿¡æ¯çš„é€šé“ï¼ˆä¸€æ¡å‘é€ä¿¡é“+ä¸€æ¡æ¥å—ä¿¡é“ = ä¸€ä¸ªé€šä¿¡çº¿è·¯ï¼‰ é€Ÿç‡ï¼šè¿æ¥åˆ°ç½‘ç»œä¸Šçš„èŠ‚ç‚¹åœ¨ä¿¡é“ä¸Šä¼ è¾“æ•°æ®çš„é€Ÿç‡ å¸¸ç”¨å•ä½ï¼šbit/s bpsï¼ˆä¹Ÿä¼šç”¨B 1B=8bï¼‰ å¸¦å®½ï¼šæŸä¿¡é“èƒ½ä¼ é€çš„æœ€é«˜æ•°æ®ç‡ ååé‡ï¼šå•ä½æ—¶é—´é€šè¿‡æŸç½‘ç»œï¼ˆorä¿¡é“/æ¥å£ï¼‰çš„å®é™…æ•°æ®é‡ æ—¶å»¶ï¼šæ•°æ®ä»ç½‘ç»œ/é“¾è·¯çš„ä¸€ç«¯åˆ°å¦ä¸€ç«¯æ‰€éœ€çš„æ—¶é—´ å‘é€æ—¶å»¶ = ä¼ è¾“æ—¶å»¶ ä¼ æ’­æ—¶å»¶ï¼šç”µç£æ³¢åœ¨ä¿¡é“ä¸­ä¼ æ’­èŠ±çš„æ—¶é—´ æ—¶å»¶å¸¦å®½ç§¯ = ä¼ æ’­æ—¶å»¶ x å¸¦å®½ å¾€è¿”æ—¶å»¶RTT = å‘é€æ–¹å‘é€å®Œæ•°æ®çš„æ—¶é—´åˆ°å®Œå…¨æ¥æ”¶ç¡®è®¤ä¿¡æ¯çš„æ—¶é—´ ä¿¡é“åˆ©ç”¨ç‡ = æœ‰æ•°æ®é€šè¿‡çš„æ—¶é—´/åˆ©ç”¨ä¿¡é“çš„æ€»æ—¶é—´ åˆ©ç”¨ç‡è¿‡ä½ = æµªè´¹å¸¦å®½ è¿‡é«˜ = æ˜“ç½‘ç»œæ‹¥å¡ åˆ†å±‚ç»“æ„ åŒä¸ªåŠŸèƒ½å¯ç”±ä¸åŒå±‚å®ç° ç»“æ„ä¸å›ºå®š\nå¸¸è§è®¡ç½‘ä½“ç³»æœºæ„ï¼š OSIå‚è€ƒæ¨¡å‹ + TCP/IPæ¨¡å‹ + äº”å±‚ç»“æ„ï¼ˆæ•™å­¦ åˆ†å±‚ç»“æ„æ¦‚å¿µï¼šè®¡ç½‘çš„å„å±‚åŠå…¶åè®®çš„é›†åˆ æ¦‚å¿µï¼š å®ä½“ï¼šç¬¬nå±‚çš„æ´»åŠ¨å…ƒç´ ï¼ˆç¡¬ä»¶ è½¯ä»¶ï¼‰ = ç¬¬nå±‚å®ä½“ ä¸åŒæœºå™¨ä¸ŠåŒä¸€å±‚ä¸ºå¯¹ç­‰å±‚ åŒå±‚å®ä½“ä¸ºå¯¹ç­‰å®ä½“ åè®®ï¼ˆç½‘ç»œåè®®Network Protocolï¼‰ï¼šæ§åˆ¶å¯¹ç­‰å®ä½“é—´é€šä¿¡è§„åˆ™çš„é›†åˆ æ°´å¹³ æœåŠ¡ ä¸‹å±‚ä¸ºç´§é‚»çš„ä¸Šå±‚æä¾›çš„åŠŸèƒ½è°ƒç”¨ æ¥å£ï¼ˆæœåŠ¡è®¿é—®ç‚¹SAPï¼‰ å®ä½“é€šè¿‡æ¥å£è¯·æ±‚ä¸‹ä¸€å±‚å®ä½“çš„æœåŠ¡ åè®® æ•°æ®ä¼ è¾“è¿‡ç¨‹ï¼šåè®®æ·»åŠ åœ¨é¦–éƒ¨orå°¾éƒ¨ eg.YSCSåè®®ï¼ˆå‹ç¼©ä¼ è¾“ï¼‰ åè®®æ•°æ®å•å…ƒPDU=æœåŠ¡æ•°æ®å•å…ƒSDU + åè®®æ§åˆ¶ä¿¡æ¯PCI \u0026ndash;\u0026gt; æ•´ä½“ä¸‹ä¸€å±‚çš„SDU åè®®ä¸‰è¦ç´ ï¼šè¯­æ³• è¯­ä¹‰ åŒæ­¥ åŒæ­¥ï¼ˆæ—¶åºï¼‰â€”â€”æ—¶é—´å®ç°é¡ºåºçš„è¯¦ç»†è¯´æ˜ OSIå‚è€ƒæ¨¡å‹ åˆ†å±‚ï¼šï¼ˆå¦‚ä¸‹ï¼‰ åˆ†å±‚ä»»åŠ¡ï¼š ç¬¬0å±‚ï¼šç‰©ç†ä¼ è¾“åª’ä½“ ç‰©ç†å±‚ï¼šç›¸é‚»èŠ‚ç‚¹é—´æ¯”ç‰¹çš„ä¼ è¾“ æ•°æ®é“¾è·¯å±‚ï¼šå·®é”™æ§åˆ¶ + æµé‡æ§åˆ¶ï¼ˆåè°ƒä¸¤èŠ‚ç‚¹çš„é€Ÿç‡ï¼‰ï¼ˆä»¥å¸§ä¸ºå•ä½è¿›è¡Œæ•°æ®ä¼ è¾“ï¼‰ ç½‘ç»œå±‚ï¼ˆæŠŠåˆ†ç»„ä»æºèŠ‚ç‚¹è½¬å‘åˆ°ç›®æ ‡èŠ‚ç‚¹ï¼‰ï¼ˆä»¥åˆ†ç»„ä¸ºå•ä½è¿›è¡Œæ•°æ®ä¼ è¾“ï¼‰ è·¯ç”±é€‰æ‹©ï¼šå†³å®šåˆ†ç»„åˆ°ç›®çš„èŠ‚ç‚¹çš„æœ€ä½³è·¯å¾„ åˆ†ç»„è½¬å‘ï¼šé€‰æ‹©åˆé€‚ç«¯å£è½¬å‘åˆ†ç»„ ç½‘é™…äº’è¿ï¼šå¼‚æ„ç½‘ç»œäº’è”ï¼ˆä¸åŒæ„é€ çš„ç½‘ç»œï¼‰ å…¶ä»–åŠŸèƒ½ åŒ…æ‹¬å·®é”™æ§åˆ¶ æµé‡æ§åˆ¶â€¦ ä¼ è¾“å±‚ï¼ˆç«¯åˆ°ç«¯é€šä¿¡ ç«¯å³ç«¯å£ = è¿›ç¨‹åˆ°è¿›ç¨‹ï¼‰ï¼ˆä»¥æŠ¥æ–‡æ®µsegmentä¸ºå•ä½ï¼‰ å¤ç”¨ä¸åˆ†ç”¨ å‡ ä¸ªé«˜å±‚å®ä½“å¤ç”¨ä¸€æ¡åº•å±‚è¿æ¥ åœ¨æ¥æ”¶ç«¯åˆ†ç”¨ å…¶ä»–åŠŸèƒ½ åŒ…æ‹¬å·®é”™æ§åˆ¶ æµé‡æ§åˆ¶â€¦ ä¼šè¯å±‚ï¼ˆç®¡ç†è¿›ç¨‹é—´ä¼šè¯ï¼‰ è¡¨ç¤ºå±‚ï¼ˆè§£å†³ä¸åŒä¸»æœºä¸Šä¿¡æ¯è¡¨ç¤ºä¸ä¸€è‡´çš„é—®é¢˜ åº”ç”¨å±‚ï¼ˆå®ç°ç‰¹å®šçš„ç½‘ç»œåº”ç”¨ï¼‰ï¼ˆä»¥æŠ¥æ–‡ä¸ºå•ä½è¿›è¡Œæ•°æ®ä¼ è¾“ï¼‰ TCP/IPæ¨¡å‹ åˆ†å±‚ï¼šç½‘ç»œæ¥å£å±‚ï¼ˆâ‰ˆç‰©ç†å±‚+æ•°æ®é“¾è·¯å±‚ï¼‰+ ç½‘ç»œå±‚ + ä¼ è¾“å±‚ + åº”ç”¨å±‚ï¼ˆâ‰ˆelseå±‚ï¼‰ åŸå› ï¼š è¡¨ç¤ºå±‚\u0026amp;ä¼šè¯å±‚å¯ä»¥ä¸ç”¨ï¼ˆéœ€è¦æ—¶å¯åœ¨åº”ç”¨å±‚è¿›è¡Œå¤„ç†ï¼‰ ç½‘ç»œå±‚ä¸‹ä¸»è¦æ˜¯ç¡¬ä»¶éƒ¨åˆ†ï¼ˆå‚å•†å¯è‡ªç”±å‘æŒ¥soåˆå¹¶ï¼‰ ç‰¹ç‚¹ï¼š ç½‘ç»œå±‚ä¸è¿›è¡Œå·®é”™æ§åˆ¶ onlyä¿è¯æœ€å¤§èƒ½åŠ›äº¤ä»˜ ä¼ è¾“å±‚è´Ÿè´£æ•°æ®æ­£ç¡®å¯é æ€§ ç‰©ç†å±‚ ä¸éš”ç¦»å¹¿æ’­åŸŸ å†²çªåŸŸ\né€šä¿¡åŸºç¡€åŸºæœ¬æ¦‚å¿µ ç»¼åˆï¼š ä¿¡æºå‘é€ä¿¡å·ï¼ˆæ•°æ®çš„è½½ä½“ï¼‰åˆ°ä¿¡å®¿ ä¿¡å·ï¼šæ•°å­—ä¿¡å· or æ¨¡æ‹Ÿä¿¡å· ä¿¡å·å€¼ç¦»æ•£ or è¿ç»­ ç å…ƒï¼šæ¯ä¸ªä¿¡å·å°±æ˜¯ä¸€ä¸ªç å…ƒ ä¿¡å·å‘¨æœŸ = ç å…ƒå®½åº¦ è‹¥ä¸€ä¸ªç å…ƒå¯èƒ½æœ‰4ç§çŠ¶æ€ = 4è¿›åˆ¶ç å…ƒ = ä¸€ä¸ªç å…ƒæºå¸¦2bitæ•°æ® é€Ÿç‡ï¼šæ³¢ç‰¹ç‡ + æ¯”ç‰¹ç‡ æ³¢ç‰¹ç‡ï¼šç å…ƒ/ç§’ = æ³¢ç‰¹Baud æ¯”ç‰¹ç‡ï¼šæ¯”ç‰¹/ç§’ ä¿¡é“çš„æé™å®¹é‡ å™ªå£°ï¼šå¯¹ä¿¡å·äº§ç”Ÿå¹²æ‰° å¥ˆå¥æ–¯ç‰¹å®šç† æ— å™ªå£°ï¼ˆç†æƒ³ï¼‰ä½é€šä¿¡é“\næé™æ³¢ç‰¹ç‡ = 2Wï¼ˆå•ä½ï¼šæ³¢ç‰¹ï¼‰ Wä¸ºä¿¡é“é¢‘ç‡å¸¦å®½ï¼ˆå•ä½ï¼šHzï¼‰ è¯´æ˜ï¼š è‹¥æ³¢ç‰¹ç‡è¿‡é«˜ = å¯¼è‡´ç é—´ä¸²æ‰°ï¼ˆæ¥æ”¶æ–¹æ— æ³•è¯†åˆ«ç å…ƒï¼‰ ç¼ºç‚¹ï¼šå¹¶æœªå¯¹ç å…ƒå¯ä»¥æºå¸¦å¤šå°‘æ¯”ç‰¹åšè§£é‡Š é¦™å†œå®šç† æœ‰å™ªå£° å¸¦å®½æœ‰é™\næé™æ¯”ç‰¹ç‡ = $Wlog_2(1+S/N)$ï¼ˆæ­¤å¤„ä¿¡å™ªæ¯”æ— å•ä½ï¼‰ $S/N$ ä¿¡å™ªæ¯” = ä¿¡å·åŠŸç‡/å™ªå£°åŠŸç‡ ä»¥dBä¸ºå•ä½è¡¨ç¤ºä¸º$10log_{10}S/N$ ç»“åˆNyquistå¯çŸ¥ï¼Œå¸¦å®½ã€ä¿¡å™ªæ¯”ç¡®å®šçš„ä¿¡é“ä¸Šï¼Œä¸€ä¸ªç å…ƒå¯æºå¸¦çš„æ¯”ç‰¹æ•°æœ‰ä¸Šé™ ç¼–ç ä¸è°ƒåˆ¶ æ¦‚å¿µ ä¿¡æº\u0026ndash;\u0026gt;å˜æ¢å™¨\u0026ndash;\u0026gt;ä¿¡é“\u0026ndash;\u0026gt;åå˜æ¢å™¨\u0026ndash;\u0026gt;ä¿¡å®¿ å˜æ¢å™¨ï¼šå°†äºŒè¿›åˆ¶æ•°æ®è½¬æ¢ä¸ºä¿¡å· è½¬æ¢ä¸ºæ•°å­—ä¿¡å· = ç¼–ç  è½¬æ¢ä¸ºæ¨¡æ‹Ÿä¿¡å· = è°ƒåˆ¶ï¼ˆeg.å…‰çŒ«ï¼‰ åå˜æ¢å™¨ï¼šå°†ä¿¡å·è½¬æ¢ä¸ºäºŒè¿›åˆ¶æ•°æ® æ•°å­—ä¿¡å·è½¬æ¢ = è§£ç  æ¨¡æ‹Ÿä¿¡å·è½¬æ¢ = è§£è°ƒ ç¼–ç  æ–¹æ³• ä¸å½’é›¶ç¼–ç NRZâ€”â€”ä½ç”µå¹³ï¼ˆè¡¨ç¤ºï¼‰0ï¼Œé«˜ç”µå¹³ï¼ˆè¡¨ç¤ºï¼‰1ï¼Œä¸­é—´ä¸è·³å˜ å½’é›¶ç¼–ç RZâ€”â€”ä½ç”µå¹³ï¼ˆè¡¨ç¤ºï¼‰0ï¼Œé«˜ç”µå¹³ï¼ˆè¡¨ç¤ºï¼‰1ï¼Œä¸­é—´å½’é›¶ åå‘éå½’é›¶NRZIâ€”â€”é‡0è·³å˜ï¼Œé‡1ä¸è·³å˜ï¼Œä¸­é—´ä¸è·³å˜ï¼ˆçœ‹èµ·ç‚¹å†³å®š0/1ï¼‰ æ›¼å½»æ–¯ç‰¹ç¼–ç â€”â€”é‡0ä¸Š/è·³ï¼Œé‡1ä¸‹/ä¸Šè·³ï¼Œä¸­é—´ä¼šè·³å˜ï¼ˆçœ‹ä¸­é—´ï¼‰ å·®åˆ†æ›¼å½»æ–¯ç‰¹â€”â€”é‡0è·³å˜ï¼Œé‡1ä¸è·³å˜ï¼Œä¸­é—´ä¼šè·³å˜ï¼ˆçœ‹èµ·ç‚¹ï¼‰ ç‰¹ç‚¹ è‡ªåŒæ­¥èƒ½åŠ›â€”â€”ä¿¡æºä¿¡å®¿å¯ä»¥æ ¹æ®ä¿¡å·å®ç°èŠ‚å¥åŒæ­¥ï¼ˆçŸ¥é“æ–­ç‚¹åœ¨å“ªï¼‰ 1æ—  3å¢åŠ å†—ä½™ä½æ—¶å¯æ”¯æŒè‡ªåŒæ­¥ æµªè´¹å¸¦å®½â€”â€”æ¯ä¸ªä¿¡å·ï¼ˆ0/1ï¼‰ä¸­é—´éœ€è¦å˜åŒ–æ—¶å°±ä¼šæµªè´¹å¸¦å®½ 2 4 5æµªè´¹ 3æµªè´¹ä¸€ç‚¹ æŠ—å¹²æ‰°èƒ½åŠ› 1 2 3å¼± è°ƒåˆ¶ è°ƒåˆ¶æ–¹æ³• è°ƒå¹…AMå¹…ç§»é”®æ§â€”â€”è°ƒæ•´æ­£å¼¦æ³¢æŒ¯å¹… è°ƒé¢‘FMé¢‘ç§»é”®æ§â€”â€”è°ƒæ•´æ­£å¼¦æ³¢é¢‘ç‡ è°ƒç›¸PMç›¸ç§»é”®æ§â€”â€”è°ƒæ•´æ­£å¼¦æ³¢ç›¸ä½ æ­£äº¤å¹…åº¦è°ƒåˆ¶QAMâ€”â€”mç§å¹…å€¼ nç§ç›¸ä½å¤åˆ QAM-32æŒ‡è°ƒåˆ¶å‡º32ç§ä¿¡å· = æ¯ä¸ªç å…ƒå¯ä»¥æºå¸¦32bitä¿¡å· ä¼ è¾“ä»‹è´¨ æœ‰çº¿å¸¸ç”¨ä¼ è¾“ä»‹è´¨ åŒç»çº¿ï¼šä¸¤å¯¼çº¿ç»åˆè€Œæˆ æœ‰å±è”½å±‚ = å±è”½åŒç»çº¿STP æ— å±è”½å±‚ / éå±è”½åŒç»çº¿UTP æŠ—å¹²æ‰°èƒ½åŠ›è¾ƒå¥½ï¼ˆç»åˆ\u0026amp;å±è”½å±‚ï¼‰ å±€åŸŸç½‘ç½‘çº¿ åŒè½´ç”µç¼†ï¼šå†…å¯¼ä½“\u0026amp;å¤–å¯¼ä½“å±è”½å±‚ å†…å¯¼ä½“è¶Šç²— ç”µé˜»è¶Šä½ ä¿¡å·è¡°å‡è¶Šå°‘ æŠ—å¹²æ‰°èƒ½åŠ›å¥½ï¼ˆå±è”½å±‚ï¼‰ æ—©æœŸå±€åŸŸç½‘ å…‰çº¤ï¼šçº¤èŠ¯ï¼ˆé«˜æŠ˜å°„ç‡ï¼‰\u0026amp;åŒ…å±‚ï¼ˆä½æŠ˜å°„ç‡ï¼‰= å•æ¨¡å…‰çº¤ï¼ˆä¸€æ¡å…‰çº¿ä¼ è¾“ï¼‰/ å¤šæ¨¡å…‰çº¤ï¼ˆå¤šæ¡å…‰çº¿ï¼‰ å•æ¨¡å…‰çº¤é€‚åˆé•¿è·ç¦» å¤šæ¨¡å…‰çº¤é€‚åˆçŸ­è·ç¦» æŠ—å¹²æ‰°èƒ½åŠ›éå¸¸å¥½ ä¿¡å·ä¼ è¾“æŸè€—å°ï¼ˆä¸­ç»§å™¨å°‘ï¼‰ å‘½åè§„åˆ™ ä»¥å¤ªç½‘Foræœ‰çº¿ä¼ è¾“ä»‹è´¨\né€Ÿåº¦+Base+ä»‹è´¨ä¿¡æ¯ BasebandåŸºå¸¦ä¼ è¾“ ä¼ è¾“æ•°å­—ä¿¡å·é‡‡ç”¨æ›¼å½»æ–¯ç‰¹ç¼–å· æ— çº¿ä¼ è¾“ä»‹è´¨ æ— çº¿ç”µæ³¢ï¼ˆé•¿æ³¢ï¼‰â€”â€”ç©¿é€èƒ½åŠ›å¼ºï¼ˆç»•å°„æ€§å¥½ï¼‰ ä¼ è¾“è·ç¦»é•¿ ä¿¡å·æŒ‡å‘æ€§å¼± æ‰‹æœºä¿¡å· WiFi å¾®æ³¢é€šä¿¡ï¼ˆçŸ­æ³¢ï¼‰â€”â€”é¢‘ç‡å¸¦å®½é«˜ ä¿¡å·æŒ‡å‘æ€§å¼º ä¿å¯†æ€§å·® ç‰©ç†å±‚æ¥å£ç‰¹æ€§ æœºæ¢°ç‰¹æ€§ + ç”µæ°”ç‰¹æ€§ + åŠŸèƒ½ç‰¹æ€§ + è¿‡ç¨‹ï¼ˆè§„ç¨‹ï¼‰ç‰¹æ€§ ç‰©ç†å±‚è®¾å¤‡ ä¸­ç»§å™¨Repeater ä¼ è¾“è·ç¦»å¤ªé•¿ æ•°å­—ä¿¡å·ä¼šå¤±çœŸ\nonlyä¸¤ç«¯å£ ä¸€ä¸ªæ¥æ”¶ä¿¡å· \u0026ndash;\u0026gt; æ•´å½¢å†ç”Ÿ \u0026ndash;\u0026gt; å¦ä¸€ç«¯å£ ä»…æ”¯æŒåŠåŒå·¥é€šä¿¡ï¼ˆä¸€æ¬¡åªèƒ½å¤„ç†ä¸€ä¸ªæ–¹å‘ï¼‰ ä¸¤ä¸ªç«¯å£å¯¹åº”ä¸¤ä¸ªç½‘æ®µ é›†çº¿å™¨hub å¤šç«¯å£ä¸­ç»§å™¨\nå„èŠ‚ç‚¹ä¸å¯åŒæ—¶å‘é€æ•°æ® å†²çªåŸŸï¼šè‹¥ä¸¤ä¸»æœºåŒæ—¶å‘é€æ•°æ®ä¼šå†²çª åˆ™å…¶å¤„äºåŒä¸ªå†²çªåŸŸ åœ¨å‘æ•°æ®å‰éœ€ä¿¡é“äº‰ç”¨ éƒ½ä¸èƒ½æ— é™ä¸²æ¥ æ•°æ®é“¾è·¯å±‚ éš”ç¦»å†²çªåŸŸï¼ˆeg.ç½‘æ¡¥ï¼‰\næ¦‚è¿° æ¦‚å¿µ é“¾è·¯Linkï¼šä»ä¸€ä¸ªç»“ç‚¹åˆ°ç›¸é‚»ç»“ç‚¹çš„ä¸€æ®µç‰©ç†çº¿è·¯ æ•°æ®é“¾è·¯ï¼šé“¾è·¯ + å®ç°é€šä¿¡åè®®çš„è½¯ç¡¬ä»¶ ä»¥å¸§ä¸ºå•ä½ä¼ è¾“å¤„ç†æ•°æ® ä¸‰ä¸ªé—®é¢˜ å°è£…æˆå¸§ï¼šä¸ºç½‘ç»œå±‚åè®®æ•°æ®å•å…ƒæ·»åŠ å¸§å¤´å¸§å°¾ï¼ˆæˆä¸ºå¸§ï¼‰ å·®é”™æ£€æµ‹ï¼šå‘é€æ–¹å°†æ£€é”™ç å°è£…åœ¨å¸§å°¾ æ£€æµ‹æ˜¯å¦æœ‰è¯¯ç  æ£€é”™ç æ ¹æ®å‘é€å†…å®¹ æ£€é”™ç®—æ³•è€Œä¸åŒ å¯é ä¼ è¾“ï¼šå³ä½¿æ£€å‡ºé”™è¯¯ï¼Œå‘é€æ–¹ä¹Ÿèƒ½ä¿è¯æ¥æ”¶æ–¹å¾—åˆ°æ­£ç¡®ä¿¡æ¯ å°è£…æˆå¸§ å¸§å¤´å¸§å°¾ ä½œç”¨ï¼šå¸§å®šç•Œ + Â·Â·Â· è®©æ¥å—å±‚ç¡®å®šä¸€å¸§çš„èµ·å§‹ç‚¹ æœ‰çš„åè®®ä¸é€šè¿‡å¸§å¤´å¸§å°¾æä¾›å¸§å®šç•ŒåŠŸèƒ½ ä»¥å¤ªç½‘V2çš„MACå¸§é€šè¿‡å¸§é—´é—´éš”å®ç° é€æ˜ä¼ è¾“ å®šä¹‰ï¼šæ•°æ®é“¾è·¯å±‚å¯¹ä¸Šå±‚äº¤ä»˜çš„ä¼ è¾“æ•°æ®æ²¡æœ‰ä»»ä½•é™åˆ¶ å®ç°ï¼šé¢å‘å­—èŠ‚çš„ç‰©ç†é“¾è·¯ä½¿ç”¨å­—èŠ‚å¡«å……æ–¹æ³•å®ç° \u0026amp; é¢å‘æ¯”ç‰¹çš„ç‰©ç†é“¾è·¯ä½¿ç”¨æ¯”ç‰¹å¡«å……æ–¹æ³•å®ç° åœ¨ç‰¹æ®Šå­—ç¬¦å‰æ·»åŠ è½¬ä¹‰å­—ç¬¦ æ¯”ç‰¹æµä¸­å¯é‡‡ç”¨é›¶æ¯”ç‰¹å¡«å……æ³• å¸§çš„é•¿åº¦ ä¸ºæé«˜è¿è¾“æ•ˆç‡ åº”ä½¿å¸§çš„æ•°æ®éƒ¨åˆ†é•¿äº› æ¯ç§æ•°æ®é“¾è·¯å±‚åè®®éƒ½è§„å®šäº†ğŸ‘†çš„é•¿åº¦ä¸Šé™MTUï¼ˆæœ€å¤§ä¼ é€å•å…ƒMaximum Transfer Unitï¼‰ å·®é”™æ£€æµ‹ ç›¸å…³æ¦‚å¿µ æ¯”ç‰¹å·®é”™ï¼šæ¯”ç‰¹åœ¨ä¼ è¾“è¿‡ç¨‹ä¸­ 0å¯èƒ½å˜ä¸º1Â·Â·Â· è¯¯ç ç‡BERï¼šä¸€æ®µæ—¶é—´å†… ä¼ è¾“é”™çš„æ¯”ç‰¹å æ€»æ¯”ç‰¹æ•°çš„æ¯”ä¾‹ æ ¡éªŒæ–¹æ³• å¥‡/å¶æ ¡éªŒï¼šæ·»åŠ 1ä½å¥‡å¶æ ¡éªŒä½ ä½¿æ‰€æœ‰æ•°æ®ä¸­ï¼ˆåŒ…æ‹¬å…¶è‡ªå·±ï¼‰1çš„ä¸ªæ•°ä¸ºå¥‡/å¶ æ¼æ£€ç‡é«˜ å¾ªç¯å†—ä½™æ ¡éªŒCRCï¼šçº¦å®šä¸€ä¸ªç”Ÿæˆå¤šé¡¹å¼ å‘é€æ–¹åŸºäºæ•°æ®ä¸å¤šé¡¹å¼è®¡ç®—å¾—å†—ä½™ç  æ¥æ”¶æ–¹é€šè¿‡å…¶è®¡ç®— ç”Ÿæˆå¤šé¡¹å¼å„é¡¹ç³»æ•°æ„æˆæ¯”ç‰¹ä¸²eg.$1x^4+0x^3+1x^2+1x^1+0*x^0$ å¯¹åº”$10110$ ç‰¹ç‚¹ åªèƒ½æ£€æµ‹ ä¸èƒ½å®šä½ï¼ˆå®šä½å¼€é”€å¤§ ä¸é‡‡ç”¨ï¼‰ CRCç¡¬ä»¶å®ç°å®¹æ˜“ å¯é ä¼ è¾“ æ¦‚å¿µ ä¼ è¾“å·®é”™åŒ…æ‹¬æ¯”ç‰¹å·®é”™ åˆ†ç»„ä¸¢å¤± åˆ†ç»„å¤±åº åˆ†ç»„é‡å¤ï¼ˆä¸€èˆ¬å‡ºç°åœ¨æ•°æ®é“¾è·¯å±‚ä¸Šå±‚ï¼‰Â·Â·Â· å¯é ä¼ è¾“æœåŠ¡å„å±‚å‡å¯é€‰æ‹©å®ç° ä¸å±€é™äºæ­¤å±‚ å®ç°æœºåˆ¶ å¯è¢«åº”ç”¨åˆ°å„å±‚åè®®ä¸­\nåœæ­¢-ç­‰å¾…åè®®SW å±äºè‡ªåŠ¨è¯·æ±‚é‡ä¼ ARQ Automatic Repeat reQuest\nåŸºæœ¬è¿‡ç¨‹ï¼šå‘é€æ–¹å‘é€åˆ†ç»„\u0026ndash;\u0026gt;æ¥æ”¶æ–¹æ ¡éªŒæ­£ç¡®ç»™å‘é€æ–¹å‘é€ACKæ¥æ”¶ä¿¡å·\u0026ndash;\u0026gt;æ¥æ”¶æ–¹å†æ¬¡å‘é€ã€‚è‹¥æ ¡éªŒé”™è¯¯ æ¥æ”¶æ–¹è¿”å›NAKå¦è®¤ä¿¡å· å‘é€æ–¹é‡ä¼  æ”¹è¿›ï¼š è¶…æ—¶é‡ä¼ ï¼šè®¾å®šè¶…æ—¶è®¡æ—¶å™¨ è‹¥åˆ°è¾¾é‡ä¼ æ—¶é—´å‘é€æ–¹æœªæ¥æ”¶åˆ°ä¿¡å·åˆ™é‡ä¼  è®¾å®šé‡ä¼ æ—¶é—´ç•¥å¤§äºå¹³å‡å¾€è¿”æ—¶é—´ æ•°æ®é“¾è·¯å±‚ç‚¹å¯¹ç‚¹å¾€è¿”æ—¶é—´è¾ƒä¸ºç¡®å®šâ€”â€”é‡ä¼ æ—¶é—´è¾ƒå¥½è®¾å®š è®¾ç½®ç¼–å·ï¼šé¿å…åˆ†ç»„é‡å¤ï¼ˆæ¥æ”¶æ–¹è¿”å›ä¿¡å·ä¸¢å¤±åé‡ä¼ åŸæ•°æ®ï¼‰ åªéœ€ä¿è¯ä¸ä¸Šæ¬¡å‘é€çš„æ•°æ®ä¸åŒâ€”â€”ä¸€ä¸ªæ¯”ç‰¹å³å¯ ï¼ˆé¿å…ç¡®è®¤åˆ†ç»„è¿Ÿåˆ°ï¼‰æ¥æ”¶ç«¯è¿”å›ä¿¡å·è¿›è¡Œç¼–å·â€”â€”ä¸å‘é€æ–¹çš„ç¼–å·ä¸€è‡´ æ•°æ®é“¾è·¯å±‚ä¸€èˆ¬ä¸ä¼šå‡ºç° ä¿¡é“åˆ©ç”¨ç‡$U$ï¼šå¾€è¿”æ—¶å»¶$RTT$è¿œå¤§äºæ•°æ®å¸§å‘é€æ—¶å»¶$T_D$æ—¶ï¼Œä¿¡é“åˆ©ç”¨ç‡éå¸¸ä½ å›é€€Nå¸§åè®®GBN åˆåæ»‘åŠ¨çª—å£åè®®\nåŸºæœ¬è¿‡ç¨‹ï¼šå‘é€æ–¹è®¾ç½®å‘é€çª—å£ï¼ŒåŒæ—¶å°†çª—å£å†…çš„æ‰€æœ‰åˆ†ç»„å‘é€ï¼ˆéœ€ç¼–åºå·ï¼‰\u0026ndash;\u0026gt;æ¥æ”¶æ–¹æ¥æ”¶åˆ°åå‘é€æˆåŠŸæ¥æ”¶ä¿¡æ¯\u0026ndash;\u0026gt;æ¥æ”¶çª—å£æ»‘åŠ¨æŒ‰åºå·æ¥æ”¶\u0026ndash;\u0026gt;å‘é€æ–¹æ”¶åˆ°ç¡®è®¤å å‘é€çª—å£å‘å‰æ»‘åŠ¨ å‘é€çª—å£å°ºå¯¸çš„å–å€¼èŒƒå›´ï¼šå°äºç­‰äºåºå·ï¼ˆeg.0~7 åˆ™æœ€å¤§ä¸º7ï¼‰ è‹¥ç­‰äº8 æ¥æ”¶æ–¹æ— æ³•åˆ†è¾¨æ–°æ—§æ•°æ®åˆ†ç»„ æ¥æ”¶æ–¹çª—å£å°ºå¯¸=1 å·®é”™ï¼šå‘é€çš„ä¿¡æ¯ä¸­æŸåˆ†ç»„é”™è¯¯ï¼Œæ•´ä¸ªçª—å£çš„æ•°æ®ç”±äºä¸èƒ½åŒ¹é…è¢«æ¥æ”¶æ–¹ä¸¢å¼ƒ\u0026ndash;\u0026gt;å‘é€æ–¹ä¹Ÿé‡ä¼ æœªè¢«æ¥æ”¶çš„å¸§eg.ä»æœ‰è¯¯ç çš„å¸§å¼€å§‹ï¼ˆå‘ç”Ÿè¶…æ—¶é‡ä¼ æ—¶ï¼‰==\u0026gt;å›é€€Nå¸§ ä¼˜åŒ–ï¼š ç´¯è®¡ç¡®è®¤ï¼šæ¥æ”¶æ–¹å¯ä»¥åœ¨æ”¶åˆ°å‡ ä¸ªæ•°æ®åˆ†ç»„åå¯¹æŒ‰åºåˆ°è¾¾çš„æœ€åä¸€ä¸ªåˆ†ç»„å‘é€ç¡®è®¤$ACK_n$ï¼Œè¡¨ç¤ºnå‰çš„éƒ½æ¥æ”¶äº† å‘é€æ–¹æ”¶åˆ°å¤šä¸ªé‡å¤ç¡®è®¤æ—¶ å¯åœ¨é‡ä¼ è®¡æ—¶å™¨è¶…æ—¶å‰å¼€å§‹é‡ä¼  é€‰æ‹©é‡ä¼ åè®®SR ä¸èƒ½å†è¿›è¡Œç´¯è®¡ç¡®è®¤ éœ€è¦é€ä¸€ç¡®è®¤ å®ç°å‘é€æ–¹ä»…é‡ä¼ é”™è¯¯åˆ†ç»„\nåŸºæœ¬è¦æ±‚ï¼šå‘é€çª—å£å°ºå¯¸$W_T\u0026lt;=2^{n-1}$ \u0026amp; æ¥æ”¶çª—å£å°ºå¯¸è°ƒæ•´ ä¸€èˆ¬è®¾ç½®ä¸å‘é€çª—å£å°ºå¯¸ç›¸åŒï¼ˆæˆ–å°äºï¼‰ è‹¥å‘é€æ–¹å¤§äºï¼Œeg.å‘é€æ–¹è®¾ç½®ä¸º5ï¼ˆæœ€å¤§ä¸º4ï¼‰æ¥æ”¶æ–¹0å·ä¸¢å¤±ï¼Œå‘é€æ–¹å‘åæ»‘åˆ°5 6 7 0å·ï¼Œåˆ™0å·æ··æ·† è¿‡ç¨‹ï¼šå‘é€æ–¹æ”¶åˆ°æœªæŒ‰åºåˆ°è¾¾çš„ç¡®è®¤åˆ†ç»„ä¿¡å·æ—¶ï¼Œå¯¹å…¶è¿›è¡Œè®°å½•ï¼Œé¿å…è¶…æ—¶é‡å‘ï¼Œä¸”ä¸å¯æ•´ä½“å‘å‰æ»‘åŠ¨ï¼ˆå¿…å¡åœ¨æœªæ”¶åˆ°ç¡®è®¤çš„ä¿¡å·ä¹‹åï¼‰ ç‚¹å¯¹ç‚¹åè®®PPP æœ€å¹¿æ³›çš„ç‚¹å¯¹ç‚¹æ•°æ®é“¾è·¯å±‚åè®®\nä¸ºä¼ è¾“çš„å„ç§æ•°æ®æŠ¥æä¾›æ ‡å‡†æ–¹æ³•ï¼šå°è£…æˆå¸§+é“¾è·¯æ§åˆ¶åè®®LCP+ä¸€å¥—ç½‘ç»œæ§åˆ¶åè®®NCPs NCPsæ¯ä¸ªåè®®æ”¯æŒä¸åŒçš„ç½‘ç»œå±‚åè®® å¸§æ ¼å¼ 0x7Eåå…­è¿›åˆ¶==\u0026gt;01111110äºŒè¿›åˆ¶ é€æ˜ä¼ è¾“å®ç°ï¼š é¢å‘å­—èŠ‚çš„å¼‚æ­¥é“¾è·¯â€”â€”æ’å…¥è½¬ä¹‰å­—ç¬¦çš„å­—èŠ‚å¡«å……æ³• é¢å‘æ¯”ç‰¹çš„åŒæ­¥é“¾è·¯â€”â€”æ’å…¥0çš„æ¯”ç‰¹å¡«å……æ³• å·®é”™æ£€æµ‹ï¼šå¯¹æ¯ä¸ªæ”¶åˆ°çš„PPPå¸§è¿›è¡ŒCRCæ£€éªŒ ä¸é€šè¿‡çš„å¸§ä¸¢å¼ƒ å‘ä¸Šä¸æä¾›å¯é ä¼ è¾“ åª’ä½“æ¥å…¥æ§åˆ¶MAC Medium Access Control\nåŸºæœ¬æ¦‚å¿µï¼šå…±äº«ä¿¡é“éœ€åè°ƒå¤šä¸ªå‘é€ä¸æ¥æ”¶ç«™ç‚¹å¯¹ä¸€ä¸ªå…±äº«ä¼ è¾“åª’ä½“çš„å ç”¨ ç±»å‹ï¼šé™æ€åˆ’åˆ†ä¿¡é“ / åŠ¨æ€æ¥å…¥æ§åˆ¶ é™æ€å¤šåœ¨ç‰©ç†å±‚ä¸­åº”ç”¨ åŠ¨æ€åŒ…æ‹¬å—æ§æ¥å…¥ï¼ˆä»¥ä¸‹ä¸¤åˆ†ç±»ï¼‰ä¸éšæœºæ¥å…¥eg.å…±äº«å¼ä»¥å¤ªç½‘ é›†ä¸­æ§åˆ¶ï¼šä¸»ç«™è½®è¯¢ åˆ†æ•£æ§åˆ¶ï¼šä»¤ç‰Œè½®æµ é™æ€åˆ’åˆ†ä¿¡é“ ä¿¡é“å¤ç”¨ï¼šä¸€æ¡ç‰©ç†çº¿è·¯åŒæ—¶ä¼ è¾“å¤šè·¯ç”¨æˆ·ä¿¡å· å¸¸è§å¤ç”¨æŠ€æœ¯ï¼š é¢‘åˆ†å¤ç”¨FDMï¼šå ç”¨ä¸åŒçš„é¢‘å¸¦èµ„æº æ—¶åˆ†å¤ç”¨TDMï¼šå ç”¨ä¸åŒæ—¶éš™ æ¯ä¸ªæ—¶éš™å‘¨æœŸå‡ºç° æ³¢åˆ†å¤ç”¨WDMï¼šå ç”¨ä¸åŒæ³¢é•¿ ç åˆ†å¤ç”¨CDMï¼šï¼ˆå¤šç”¨äºå¤šå€æ¥å…¥ ç åˆ†å¤šå€CDMAï¼‰å„ç”¨æˆ·å¯åŒæ—¶åœ¨åŒæ ·çš„é¢‘å¸¦ä¸Šé€šä¿¡ ä½¿ç”¨ä¸åŒç å‹ æ¯ä¸ªæ¯”ç‰¹æ—¶é—´è¢«åˆ’åˆ†ä¸ºmä¸ªçŸ­é—´éš”ï¼ˆç ç‰‡Chipï¼‰ æ¯ä¸ªç«™è¢«æŒ‡æ´¾å”¯ä¸€çš„m bitç ç‰‡åºåˆ— è‹¥è¦å‘é€æ¯”ç‰¹1 åˆ™å‘é€è‡ªå·±çš„ç ç‰‡åºåˆ— 0 åˆ™å‘é€ç ç‰‡åºåˆ—åç  æ¯ä¸ªç«™çš„ç ç‰‡åºåˆ—å¿…ç›¸äº’æ­£äº¤ä¸”ä¸åŒ==\u0026gt;æ¥æ”¶ç«™å¯¹æ”¶åˆ°çš„å åŠ ä¿¡å·ä¸å„ç«™çš„ç ç‰‡åºåˆ—ç›¸ä¹˜ï¼Œå¾—åˆ°-1åˆ™è¯¥ç«™å‘é€äº†0ï¼Œå¾—+1åˆ™å‘é€äº†1ï¼Œå…¶å®ƒåˆ™æœªå‘é€ åŠ¨æ€æ¥å…¥æ§åˆ¶â€”â€”éšæœºæ¥å…¥ CSMA/CD ï¼ˆæ—©æœŸä»¥å¤ªç½‘ï¼‰è½½æ³¢ç›‘å¬å¤šå€æ¥å…¥/ç¢°æ’æ£€æµ‹ å¤šå€æ¥å…¥MAï¼šå¤šç«™è¿æ¥åœ¨ä¸€æ¡æ€»çº¿ä¸Š ç«äº‰ä½¿ç”¨ è½½æ³¢ç›‘å¬CSï¼šæ¯ä¸ªç«™å‘é€å¸§å‰å…ˆæ£€æµ‹æ€»çº¿ä¸Šæ˜¯å¦æœ‰å…¶ä»–ç«™ç‚¹åœ¨å‘é€ï¼Œè‹¥æœ‰96æ¯”ç‰¹æ—¶é—´ç©ºé—²ï¼Œåˆ™å‘é€ CDï¼šæ¯ä¸ªæ­£åœ¨å‘é€å¸§çš„ç«™è¾¹å‘é€è¾¹æ£€æµ‹ç¢°æ’ï¼Œè‹¥å‘ç”Ÿåˆ™ç«‹å³åœæ­¢å‘é€ï¼Œè¿‡æ®µæ—¶é—´ç»§ç»­ äº‰ç”¨æœŸï¼šä¸»æœºæœ€å¤šç»è¿‡å¤šä¹…å¯æ£€æµ‹åˆ°æœ¬æ¬¡å‘é€æ˜¯å¦é­å—ç¢°æ’ æœ€å°å¸§é•¿ï¼šè‹¥è¿‡å°ï¼Œå‘é€æ–¹ä¸çŸ¥å‘ç”Ÿäº†ç¢°æ’ æœ€å¤§å¸§é•¿ï¼šè‹¥è¿‡å¤§ï¼Œå…¶å®ƒä¸»æœºé•¿æ—¶é—´æ— æ³•å‘é€ä¿¡å·ï¼Œæ¥æ”¶ç«¯ä¹Ÿå¯èƒ½æº¢å‡º æˆªæ–­äºŒè¿›åˆ¶æŒ‡æ•°é€€é¿ç®—æ³•ï¼šé€€é¿æ—¶é—´ = åŸºæœ¬é€€é¿æ—¶é—´ï¼ˆäº‰ç”¨æœŸï¼‰ x éšæœºæ•°r rä»0,1,â€¦,$2^k-1$ä¸­éšæœºå–ï¼Œ$k=min[é‡ä¼ æ¬¡æ•°,10]$ é€€é¿æ—¶é—´éšé‡ä¼ æ¬¡æ•°å¢åŠ è€Œå¢å¤§ï¼ˆåŠ¨æ€é€€é¿ï¼‰ å¯å‡å°å‘ç”Ÿç¢°æ’çš„æ¦‚ç‡ ä¿¡é“åˆ©ç”¨ç‡â€”â€”$S=\\frac{T_0}{T_0+\\tau}$ $T_0$ä¸ºå‘é€æˆåŠŸæ—¶é—´ $2\\tau$ä¸ºäº‰ç”¨æœŸ CSMA/CA ï¼ˆæ— çº¿ï¼‰CA ç¢°æ’é¿å…\nå¸§é—´é—´éš”ï¼šï¼ˆ802.11æ ‡å‡†è§„å®šï¼‰æ‰€æœ‰ç«™ç‚¹å¿…é¡»åœ¨æŒç»­æ£€æµ‹åˆ°ä¿¡é“ç©ºé—²ä¸€æ®µæŒ‡å®šæ—¶é—´åæ‰èƒ½å‘é€å¸§ çŸ­å¸§é—´é—´éš”SIFSï¼šåˆ†éš”å¼€å±äºä¸€æ¬¡å¯¹è¯çš„å„å¸§ DCFå¸§é—´é—´éš”DIFSï¼šåœ¨DCFæ–¹å¼ä¸­ç”¨æ¥å‘é€æ•°æ®å¸§ \u0026amp; ç®¡ç†å¸§ ç›¸å…³é—®é¢˜ä¸è§£ç­”ï¼š whyï¼šæºç«™æ£€æµ‹åˆ°ç©ºé—²åè¿˜è¦ç­‰å¾…DIFSï¼Ÿ è®©ä¼˜å…ˆçº§æ›´é«˜çš„å¸§ï¼ˆå…¶ä»–ç«™ä¸Šï¼‰å…ˆå‘é€ whyï¼šç›®çš„ç«™æ­£ç¡®æ¥æ”¶æ•°æ®å¸§åè¿˜è¦ç­‰å¾…SIFSï¼Ÿ å®Œæˆä»æ¥æ”¶åˆ°å‘é€çš„çŠ¶æ€åˆ‡æ¢ whyï¼šå…¶ä»–ç«™è¦é€€é¿éšæœºæ—¶é—´ï¼Ÿ é¿å…åŒæ—¶å‘é€ ä½¿ç”¨é€€é¿ç®—æ³•çš„æƒ…å†µï¼š å‘é€æ•°æ®å¸§ä¹‹å‰æ£€æµ‹åˆ°ä¿¡é“å¿™ æ¯æ¬¡é‡ä¼ æ•°æ®å¸§ æ¯æ¬¡æˆåŠŸå‘é€åè¦è¿ç»­å‘é€ä¸‹ä¸€å¸§ï¼ˆé¿å…ä¸€ä¸ªç«™ç‚¹é•¿æ—¶é—´å ç”¨ä¿¡é“ï¼‰ é€€é¿ç®—æ³•ï¼šç«™ç‚¹ä¸ºé€€é¿è®¡æ—¶å™¨è®¾ç½®ä¸€ä¸ªéšæœºçš„é€€é¿æ—¶é—´ï¼Œè®¡åˆ°é›¶å¼€å§‹å‘é€ï¼Œè‹¥ä¿¡é“è½¬å¿™åˆ™å†»ç»“ç­‰å…¶è½¬é—²åç»è¿‡DIFSåç»§ç»­è®¡æ•° è¿›è¡Œç¬¬iæ¬¡é€€é¿æ—¶ï¼Œé€€é¿æ—¶é—´åœ¨0,1,â€¦,$2^{2+i}+1$ä¸­éšæœºé€‰æ‹©å¹¶ä¹˜åŸºæœ¬é€€é¿æ—¶é—´ åŸºæœ¬é€€é¿æ—¶é—´ = ä¸€ä¸ªæ—¶éš™çš„é•¿åº¦ ç¬¬å…­æ¬¡é€€é¿å ä¸å†å¢åŠ ï¼ˆè¾¾åˆ°255ï¼‰ å‡å°‘é€‰æ‹©ç›¸åŒé€€é¿æ—¶é—´çš„æ¦‚ç‡ å…è®¸å¯¹ä¿¡é“è¿›è¡Œé¢„çº¦ å‘é€æ•°æ®å¸§å‰å‘é€çŸ­æ§åˆ¶å¸§ = è¯·æ±‚å‘é€RTS RTSç¢°æ’åˆ™æ‰§è¡Œé€€é¿ç®—æ³•é‡ä¼ RTS ç›®çš„ç«™æ”¶åˆ°ä¸”ç©ºé—² å‘é€å“åº”æ§åˆ¶å¸§ = å…è®¸å‘é€CTS å‘é€ç«™æ”¶åˆ°å¹¶ç­‰å¾…SIFSåå¯å‘é€ å…¶ä»–ç«™æ”¶åˆ°CTSåæ¨è¿Ÿæ¥å…¥ è™šæ‹Ÿè½½æ³¢ç›‘å¬ï¼šç›‘å¬åˆ°RTS/CTS/æ•°æ®å¸§ï¼Œå³å¯çŸ¥é“ä¿¡é“è¢«å ç”¨çš„æŒç»­æ—¶é—´ å‡å°‘éšè”½ç«™å¸¦æ¥çš„ç¢°æ’é—®é¢˜ MACåœ°å€ IPåœ°å€ ARPåè®® MACåœ°å€æ˜¯ä»¥å¤ªç½‘çš„MACå­å±‚ä½¿ç”¨çš„åœ°å€â€”â€”æ•°æ®é“¾è·¯å±‚ä¸­ IPåœ°å€æ˜¯TCP/IPä½“ç³»ç»“æ„ç½‘é™…å±‚ä½¿ç”¨çš„åœ°å€ ARPåè®®å±äºTCP/IPçš„ç½‘é™…å±‚ å¯ä»¥é€šè¿‡IPåœ°å€è·å–åˆ°MACåœ°å€\nMACåœ°å€ é“¾è·¯å±‚é¦–éƒ¨å°è£…\nï¼ˆå¤šä¸ªä¸»æœºåœ¨åŒä¸ªå¹¿æ’­ä¿¡é“ä¸Šï¼‰éœ€è¦å”¯ä¸€çš„æ•°æ®é“¾è·¯å±‚åœ°å€ æ¯ä¸ªå¸§ä¸­éœ€æºå¸¦æ ‡è¯†å‘é€ä¸»æœºå’Œæ¥æ”¶ä¸»æœºçš„åœ°å€â€”â€”MACåœ°å€ ä¸€èˆ¬è¢«å›ºåŒ–åœ¨ç¡¬ä»¶ä¸Š = â€œç¡¬ä»¶åœ°å€â€ = â€œç‰©ç†åœ°å€â€ï¼ˆwinç³»ç»Ÿä¸­ï¼‰ä½†ä¸å±äºç‰©ç†å±‚ æ¯ä¸ªç½‘ç»œé€‚é…å™¨éƒ½æœ‰ä¸€ä¸ªå…¨çƒå”¯ä¸€çš„MACåœ°å€â€”â€”å¯¹å„æ¥å£çš„å”¯ä¸€æ ‡è¯†ï¼ˆè€Œéè®¾å¤‡ï¼‰ ï¼ˆIEEE 802å±€åŸŸç½‘ï¼‰MACåœ°å€æ ¼å¼ï¼šç»„ç»‡å”¯ä¸€æ ‡è¯†ç¬¦OUIï¼ˆä¸‰å­—èŠ‚ï¼‰ + ç½‘ç»œæ¥å£æ ‡è¯†ç¬¦ï¼ˆä¸‰å­—èŠ‚ï¼‰ OUIç”±æ³¨å†Œç®¡ç†ç»“æ„åˆ†é… å3å­—èŠ‚ç”±å‚å•†åˆ†é… é€šå¸¸å°†æ¯4ä¸ªæ¯”ç‰¹ç”¨ä¸€ä¸ª16è¿›åˆ¶æ•°è¡¨ç¤º = 12ä¸ªçš„16è¿›åˆ¶æ•° MACåœ°å€çš„ç¬¬1å­—èŠ‚çš„b0ä½ï¼ˆç¬¬0ä½ï¼‰å–0è¡¨ç¤ºå•æ’­åœ°å€ å–1è¡¨ç¤ºå¤šæ’­åœ°å€ MACåœ°å€çš„ç¬¬1å­—èŠ‚çš„b1ä½ï¼ˆç¬¬1ä½ï¼‰å–0è¡¨ç¤ºå…¨çƒç®¡ç† å–1è¡¨ç¤ºæœ¬åœ°ç®¡ç† MACåœ°å€ç±»å‹ğŸ‘†ï¼š å…¨çƒ+å•æ’­ï¼šå‚å•†ç”Ÿäº§ç½‘ç»œè®¾å¤‡æ—¶å›ºåŒ– å…¨çƒ+å¤šæ’­ï¼šæ ‡å‡†ç½‘ç»œè®¾å¤‡æ”¯æŒçš„ æœ¬åœ°+å•æ’­ï¼šç½‘ç»œç®¡ç†å‘˜åˆ†é… è¦†ç›–å…¨çƒå•æ’­ æœ¬åœ°+å¤šæ’­ï¼šç”¨æˆ·é…ç½®ä¸»æœºè½¯ä»¶ è¡¨æ˜å…¶å¯¹å¤šæ’­ç»„çš„ä»å±å…³ç³» åœ°å€å‘é€é¡ºåºï¼šç¬¬ä¸€å­—èŠ‚-\u0026gt;ç¬¬å…­å­—èŠ‚ b0-\u0026gt;b7 å•æ’­/å¹¿æ’­/å¤šæ’­MACåœ°å€ï¼šæ¥æ”¶æ–¹åœ°å€ï¼ˆå¹¿æ’­å¡«å…¨F å¤šæ’­å¡«å¤šæ’­ç»„åœ°å€ï¼‰ è‹¥å¤šæ’­ç»„åœ°å€åœ¨æ¥æ”¶æ–¹çš„å¤šæ’­ç»„åˆ—è¡¨ä¸­ åˆ™æ¥æ”¶ IPåœ°å€ä½œç”¨ï¼ˆç½‘ç»œå±‚ï¼‰ è‹¥è¦æ¥å…¥å› ç‰¹ç½‘ = IPåœ°å€+MACåœ°å€ / è‹¥ä¸æ¥å…¥ åªéœ€MACåœ°å€\nç»„æˆï¼šç½‘ç»œç¼–å·+ä¸»æœºç¼–å· ä¸»æœºç¼–å·ï¼šæ ‡è¯†åŒä¸€ç½‘ç»œä¸Šä¸åŒä¸»æœº/è·¯ç”±å™¨å„æ¥å£ æ•°æ®åŒ…è½¬å‘è¿‡ç¨‹ï¼š æ¯ä¸ªé“¾è·¯ç»“æŸ ç›®çš„MACåœ°å€ä¸æºMACåœ°å€éƒ½ä¼šæ”¹å˜ IPåœ°å€å§‹ç»ˆå¦‚ä¸€ æ¯ä¸ªè®¾å¤‡åªçŸ¥ä¸‹ä¸€è®¾å¤‡çš„IPåœ°å€ ä¸çŸ¥MACåœ°å€â€”â€”åœ°å€æ€æ ·è½¬å˜ï¼ŸARPåè®® ARPåè®® å¹¿æ’­\nå°è£…åœ¨MACå¸§ä¸­ æ‰€æœ‰ä¸»æœºæ£€æŸ¥æ˜¯å¦è¯·æ±‚çš„æ˜¯è‡ªå·±çš„MACåœ°å€ è‹¥å¦åˆ™å¿½ç•¥ è‹¥æ˜¯ï¼Œï¼ˆæ·»åŠ åˆ°è‡ªå·±çš„ARPé«˜é€Ÿç¼“å­˜ï¼‰åˆ™å•æ’­å‘é€è‡ªå·±çš„MACåœ°å€ åŸè¯·æ±‚ç«¯å°†å…¶ä¿å­˜åˆ°è‡ªå·±çš„ARPé«˜é€Ÿç¼“å­˜ä¸­ ARPåªèƒ½åœ¨ä¸€ä¸ªç½‘ç»œ/ä¸€ä¸ªé“¾è·¯ä¸­ä½¿ç”¨ ä¸å¯è·¨ç½‘ç»œ é›†çº¿å™¨ä¸äº¤æ¢æœº é›†çº¿å™¨ï¼šé€»è¾‘ä¸Šä»æ˜¯æ€»çº¿ç½‘ + åªåœ¨ç‰©ç†å±‚å·¥ä½œï¼ˆä¸è¿›è¡Œç¢°æ’æ£€æµ‹ï¼‰+ ä¸€èˆ¬æœ‰å°‘é‡çš„å®¹é”™èƒ½åŠ› é›†çº¿å™¨HUBåœ¨ç‰©ç†å±‚æ‰©å±•ä»¥å¤ªç½‘ï¼šé›†çº¿å™¨è¿æ¥å…¶å®ƒé›†çº¿å™¨ ä»¥å¤ªç½‘äº¤æ¢æœºï¼šå¤šæ¥å£ï¼ˆå…¨ä¸€èˆ¬åŒå·¥ï¼‰+ èƒ½åŒæ—¶è”é€šå¤šå¯¹æ¥å£ + å·¥ä½œåœ¨æ•°æ®é“¾è·¯å±‚ï¼ˆåŒ…æ‹¬ç‰©ç†å±‚ï¼‰ å¸§äº¤æ¢è¡¨ï¼ˆè‡ªå­¦ä¹ ç®—æ³•å»ºç«‹ï¼‰ï¼šæŸ¥æ‰¾å¸§çš„ç›®çš„MACåœ°å€å¯¹åº”çš„æ¥å£å· å¸§çš„è½¬å‘æ–¹å¼ï¼šå­˜å‚¨è½¬å‘ \u0026amp; ç›´é€šäº¤æ¢ï¼ˆåŸºäºç¡¬ä»¶çš„äº¤æ¢çŸ©é˜µï¼‰ å¯¹æ¯”ï¼šé›†çº¿å™¨ä¼šæ‰©å¤§å†²çªåŸŸ äº¤æ¢æœºä¼šéš”ç¦»å†²çªåŸŸ ä»¥å¤ªç½‘äº¤æ¢æœºè‡ªå­¦ä¹ \u0026amp;è½¬å‘å¸§ è‡ªå­¦ä¹ ï¼šç›²ç›®æ³›æ´ªï¼ˆå‘ç»™æ‰€æœ‰æ¥å£ï¼‰â€”â€”è®°å½•æ¥æ”¶æ¥å£çš„å·ï¼ˆåŠå…¶MACï¼‰ä¸å‘é€çš„æ¥å£å·ï¼ˆåŠå…¶MACï¼‰ åˆ°æœŸè‡ªåŠ¨åˆ é™¤è®°å½• ä»¥å¤ªç½‘äº¤æ¢æœºç”Ÿæˆæ ‘åè®®STP æå‡ä»¥å¤ªç½‘å¯é æ€§ï¼šæ·»åŠ å†—ä½™é“¾è·¯ï¼ˆè´Ÿé¢æ•ˆåº”ï¼šç½‘ç»œç¯è·¯ï¼ˆé—®é¢˜ğŸ‘‡ï¼‰ å¹¿æ’­é£æš´â€”â€”å¤§é‡æ¶ˆè€—ç½‘ç»œèµ„æº æ— æ³•æ­£å¸¸è½¬å‘å…¶ä»–æ•°æ®å¸§ ä¸»æœºæ”¶åˆ°é‡å¤çš„å¹¿æ’­å¸§ å¸§äº¤æ¢è¡¨åå¤æŒ¯è¡ï¼ˆåŒä¸€MACåœ°å€ä½†æ¥å£ä¸€ç›´å˜åŒ–ï¼‰ ï¼ˆæ”¹è‰¯ï¼‰ç”Ÿæˆæ ‘åè®®STPâ€”â€”è‡ªåŠ¨è®¡ç®—å¹¶æ„å»ºä¸€ä¸ªé€»è¾‘ä¸Šæ²¡æœ‰ç¯è·¯çš„ç½‘ç»œâ€”â€”æ ‘å½¢ ç½‘ç»œç‰©ç†æ‹“æ‰‘å‘ç”Ÿå˜åŒ–æ—¶ï¼Œç”Ÿæˆæ ‘éœ€é‡æ–°è®¡ç®— VLANè™šæ‹Ÿå±€åŸŸç½‘ å¤šä¸ªä»¥å¤ªç½‘äº¤æ¢æœºäº’è¿èµ·æ¥çš„äº¤æ¢å¼ä»¥å¤ªç½‘ æ‰€æœ‰ç«™ç‚¹å±äºåŒä¸€å¹¿æ’­åŸŸ\nå¹¿æ’­åŸŸè¿‡å¤§å¼Šç«¯ï¼šå¹¿æ’­é£æš´ + éš¾ä»¥ç®¡ç†ç»´æŠ¤ + æ½œåœ¨çš„å®‰å…¨é—®é¢˜ åˆ†å‰²å¹¿æ’­åŸŸæ–¹æ³•ï¼šè·¯ç”±å™¨éš”ç¦»ï¼ˆå·¥ä½œåœ¨ç½‘ç»œå±‚ï¼‰ / VLAN VLANï¼šå°†è®¾å¤‡åˆ’åˆ†ä¸ºä¸ç‰©ç†ä½ç½®æ— å…³çš„é€»è¾‘ç»„çš„æŠ€æœ¯ VLANå®ç°æœºåˆ¶ IEEE 802.1Qå¸§â€”â€”åœ¨MACå¸§ä¸­æºMACåœ°å€åæ’å…¥4å­—èŠ‚VLANæ ‡è®° äº¤æ¢æœºæ”¶åˆ°æ™®é€šçš„ä»¥å¤ªç½‘å¸§æ—¶ æ’å…¥æ ‡è®° = â€œæ‰“æ ‡ç­¾â€ è½¬å‘æ—¶ å¯èƒ½åˆ é™¤ = â€œå»æ ‡ç­¾â€ äº¤æ¢æœºç«¯å£ç±»å‹ï¼šï¼ˆäº¤æ¢æœºå„ç«¯å£çš„ç¼ºçœVLAN ID ğŸ‘‡ç§°ä¸ºPVIDï¼‰ Accessâ€”â€”ä¸€èˆ¬è¿æ¥ç”¨æˆ·è®¡ç®—æœº åªèƒ½å±äºä¸€ä¸ªVLAN PVIDä¸ç«¯å£æ‰€å±VLANçš„IDåŒ è‹¥å¸§ä¸­VIDä¸ç«¯å£PVIDåŒ åˆ™å»æ ‡ç­¾å¹¶è½¬å‘ å¦åˆ™ä¸è½¬ Trunkâ€”â€”äº¤æ¢æœºé—´/äº¤æ¢æœºä¸è·¯ç”±å™¨é—´çš„äº’è¿ å¯ä»¥å±äºå¤šä¸ªVLAN ç”¨æˆ·å¯è®¾ç½®å…¶PVIDå€¼ å‘é€ï¼šå¯¹VID=PVIDçš„å¸§â€”â€”å»æ ‡ç­¾åè½¬å‘ / ä¸ç­‰çš„å¸§â€”â€”ç›´æ¥è½¬å‘ æ¥æ”¶ï¼šæ¥æ”¶æœªæ‰“æ ‡ç­¾çš„å¸§ æ ¹æ®æ¥æ”¶å¸§çš„é‚£ä¸ªç«¯å£çš„VLANæ‰“æ ‡ç­¾ Hybridâ€”â€”Trunk Accessèƒ½ç”¨çš„åœ°æ–¹éƒ½èƒ½ç”¨ å…¶å®ƒä¸trunkç±»ä¼¼ é™¤å‘é€å¤„ç†æ–¹æ³•ï¼šæŸ¥çœ‹å¸§çš„VIDæ˜¯å¦åœ¨ç«¯å£çš„å»æ ‡ç­¾åˆ—è¡¨ä¸­ï¼ˆå…¶ä½™åŒğŸ‘†ï¼‰ åº”ç”¨å¦‚ä¸‹ğŸ‘‡ ç½‘ç»œå±‚ å®ç°ç½‘ç»œäº’è¿ï¼ˆè·¯ç”±å™¨ï¼‰â€”â€”æ•°æ®åŒ…ä¼ è¾“\nä¸‰ä¸ªé—®é¢˜ï¼šå‘è¿è¾“å±‚æä¾›çš„æœåŠ¡ + ç½‘ç»œå±‚å¯»å€ + è·¯ç”±é€‰æ‹© TCP/IPåè®®æ ˆçš„ç½‘ç»œå±‚ä½¿ç”¨ç½‘é™…åè®®IP so è¢«ç§°ä¸ºç½‘é™…å±‚ æä¾›çš„æœåŠ¡ é¢å‘è¿æ¥çš„è™šç”µè·¯æœåŠ¡ å¯é é€šä¿¡ç”±ç½‘ç»œä¿è¯ å¿…å»ºç«‹ç½‘ç»œå±‚çš„è¿æ¥ï¼ˆè™šç”µè·¯VCï¼‰â€”â€”é€šä¿¡åŒæ–¹æ²¿å·²å»ºç«‹çš„è™šç”µè·¯å‘é€åˆ†ç»„ ç›®çš„ä¸»æœºåœ°å€åœ¨å»ºç«‹åä¸å†éœ€è¦ åœ¨åˆ†ç»„é¦–éƒ¨æºå¸¦VCç¼–å·å³å¯ å­˜å‚¨è½¬å‘æ–¹å¼ é€šä¿¡ç»“æŸå é‡Šæ”¾VC æ— è¿æ¥çš„æ•°æ®æŠ¥æœåŠ¡ å› ç‰¹ç½‘ä½¿ç”¨â€”â€”ç½‘ç»œé€ ä»·ä½\nå¯é é€šä¿¡ç”±ç”¨æˆ·ä¸»æœºä¿è¯ ä¸éœ€å»ºç«‹ç½‘ç»œå±‚è¿æ¥ æ¯ä¸ªåˆ†ç»„å¯èµ°ä¸åŒè·¯å¾„ æ¯ä¸ªåˆ†ç»„é¦–éƒ¨éœ€æºå¸¦ç›®çš„ä¸»æœºçš„å®Œæ•´åœ°å€ ç›‘æµ‹åˆ°æ‹¥å¡æ—¶å¯åˆç†ä¸¢å¼ƒIPåˆ†ç»„\nIPv4åœ°å€ æ¦‚è¿° å› ç‰¹ç½‘ä¸Šæ¯ä¸ªä¸»æœº/è·¯ç”±å™¨çš„æ¯ä¸ªæ¥å£åˆ†é…å…¨ä¸–ç•Œuniqueçš„32bitæ ‡è¯†ç¬¦\nå‘å±•ï¼šåˆ†ç±»ç¼–å€\u0026ndash;\u0026gt;åˆ’åˆ†å­ç½‘\u0026ndash;\u0026gt;æ— åˆ†ç±»ç¼–å€ è¡¨ç¤ºæ–¹æ³•ï¼šç‚¹åˆ†åè¿›åˆ¶è¡¨ç¤ºæ–¹æ³•â€”â€”æ¯8bitåˆ†ä¸ºä¸€ç»„ ç”¨.éš”å¼€ åˆ†ç±»ç¼–å€ äº”ç±»åœ°å€ğŸ‘† ABCç±»å¯åˆ†é…ç»™ä¸»æœº/è·¯ç”±å™¨çš„å„æ¥å£ ä¸»æœºå·å…¨0 = ç½‘ç»œåœ°å€ ä¸èƒ½åˆ†é…ç»™ä¸»æœºï¼ˆÂ·Â·Â·ï¼‰ ä¸»æœºå·å…¨1 = å¹¿æ’­åœ°å€ ä¸èƒ½åˆ†é…Â·Â·Â·â€”â€”è¯¥ç½‘ç»œä¸Šæ‰€æœ‰åœ°å€éƒ½å¯æ”¶åˆ°ç›®çš„åœ°å€ä¸ºå¹¿æ’­åœ°å€çš„ä¿¡æ¯ Aç±»ï¼šæœ€å°ç½‘ç»œå·0ä¿ç•™ä¸æŒ‡æ´¾ æœ€å¤§ç½‘ç»œå·127ä½œä¸ºæœ¬åœ°ç¯å›æµ‹è¯•åœ°å€ä¸æŒ‡æ´¾ æœ€å°æœ¬åœ°ç¯å›æµ‹è¯•åœ°å€ï¼š127.0.0.1 ï¼ˆä¸»æœºå·ä¸èƒ½å…¨0å…¨1ï¼‰ Bç±»ï¼šæœ€å°ç½‘ç»œå·128.0ï¼ˆé™¤é¦–ä½å…¨0ï¼‰æœ€å¤§ç½‘ç»œå·191.255ï¼ˆé™¤äºŒä½å…¨1ï¼‰ Cç±»ï¼šç±»ä¼¼Bç±»ğŸ‘† ç½‘ç»œå·èŒƒå›´192~223 åˆ’åˆ†å­ç½‘ å­ç½‘æ©ç â€”â€”è¡¨æ˜IPåœ°å€çš„ä¸»æœºå·ä¸­æœ‰å‡ ä¸ªæ¯”ç‰¹è¢«å€Ÿèµ°ä½œä¸ºå­ç½‘å· è¿ç»­1 = ç½‘ç»œå·ï¼ˆä¸å˜ï¼‰+å­ç½‘å·ï¼ˆå åŸæ¥ä¸»æœºå·çš„ä½ç½®ï¼‰ è¿ç»­0 = ä¸»æœºå· è¿ç®—å³å¾—æ‰€åœ¨å­ç½‘çš„ç½‘ç»œåœ°å€ é»˜è®¤çš„å­ç½‘æ©ç ï¼šæœªåˆ’åˆ†å­ç½‘æ—¶ä½¿ç”¨çš„å­ç½‘æ©ç  eg.255.0.0.0ï¼ˆAç±»ï¼‰ æ— åˆ†ç±»ç¼–å€ æ— åˆ†ç±»åŸŸé—´è·¯ç”±é€‰æ‹©CIDR\nç¼–å†™æ–¹æ³•ï¼šæ–œçº¿è®°æ³• eg.128.14.35.7/20 20è¡¨ç¤ºç½‘ç»œå‰ç¼€æ‰€å çš„æ¯”ç‰¹æ•°ï¼ˆåé¢çš„æ˜¯ä¸»æœºç¼–å·ï¼‰ å°†ç½‘ç»œå‰ç¼€éƒ½ç›¸åŒçš„è¿ç»­çš„IPåœ°å€ç»„æˆCIDRåœ°å€å— èšåˆCç±»ç½‘æ•°é‡ = åœ°å€æ•°é‡ / Cç±»ç½‘å‰ç¼€æ•°é‡ $2^8$ ä¸»æœºå·ä¾ç„¶ä¸å¯å…¨0å…¨1\nè·¯ç”±èšåˆï¼ˆæ„é€ è¶…ç½‘ï¼‰â€”â€”eg. ä¸€ä¸ªè·¯ç”±å¯ä»¥ä¿å­˜å…¶è¿æ¥çš„ç½‘ç»œçš„åœ°å€çš„å…±åŒå‰ç¼€ å‘é€ç»™å…¶ä»–è·¯ç”± = è·¯ç”±èšåˆåçš„ç›®çš„ç½‘ç»œåœ°å€ï¼ˆä¸»æœºå·è®¾ä¸º0ï¼‰ IPv4åœ°å€çš„åº”ç”¨è§„åˆ’ å®šé•¿çš„å­ç½‘æ©ç FLSMï¼šç”¨åŒä¸ªå­ç½‘æ©ç åˆ’åˆ†å­ç½‘ æ¯ä¸ªå­ç½‘éœ€è¦çš„IPåœ°å€æ•°é‡ä¸åŒæ—¶ ä¼šé€ æˆæµªè´¹ å˜é•¿çš„å­ç½‘æ©ç VLSMï¼šä¸åŒå­ç½‘æ©ç åˆ’åˆ†â€”â€”æ¯ä¸ªå­ç½‘åˆ†é…çš„IPåœ°å€æ•°é‡ä¸åŒ èµ·ç‚¹ä½ç½®é€‰æ‹©å­ç½‘ä¸­å—æ•°é‡ï¼ˆåˆæ­¥åˆ†é…çš„åœ°å€æ•°é‡eg.6å°ä¸»æœº+1è·¯ç”±å™¨åœ°å€+1å¹¿æ’­1ç½‘ç»œ=9 åˆ™é€‰16ï¼‰çš„æ•´æ•°å€ å¯ä»¥ä»ä¸»æœºå¤šçš„å­ç½‘å¼€å§‹åˆ† IPæ•°æ®æŠ¥çš„è½¬å‘ä¸å‘é€ =ä¸»æœºå‘é€+è·¯ç”±å™¨è½¬å‘ ä»¥ä¸‹å¿½ç•¥ARPä¸ä»¥å¤ªç½‘äº¤æ¢æœºçš„å·¥ä½œè¿‡ç¨‹\næ•°æ®æŠ¥ä¼ é€’æ–¹å¼ï¼šç›´æ¥äº¤ä»˜ï¼ˆä»¥å¤ªç½‘äº¤æ¢æœºå¯äº¤ä»˜ï¼‰ \u0026amp; é—´æ¥äº¤ä»˜ï¼ˆéœ€è·¯ç”±å™¨ä¸­è½¬ï¼‰ ä¸»æœºå‘é€è¿‡ç¨‹ï¼šä¸»æœºAå°†è‡ªå·±çš„IPä¸å­ç½‘æ©ç åš\u0026amp;è¿ç®—ï¼Œå¾—åˆ°ç½‘ç»œåœ°å€â€”-\u0026gt;å°†ç›®æ ‡IPä¸å­ç½‘æ©ç \u0026amp; è‹¥ç½‘ç»œåœ°å€ä¸åŒ\u0026ndash;\u0026gt;éœ€è¦è·¯ç”±å™¨è½¬å‘ï¼ˆä¸åœ¨åŒä¸€å­ç½‘ï¼‰ howä¸»æœºçŸ¥é“è·¯ç”±å™¨ï¼Ÿ ç»™æ¯ä¸ªä¸»æœºè®¾ç½®é»˜è®¤ç½‘å…³ å³å¯¹åº”è·¯ç”±å™¨çš„IPåœ°å€ è·¯ç”±å™¨è½¬å‘è¿‡ç¨‹ï¼šæ£€æŸ¥IPæ•°æ®åŒ…é¦–éƒ¨æ˜¯å¦å‡ºé”™ï¼ˆå·®é”™æ ¡éªŒï¼‰ï¼ˆé”™åˆ™ä¸¢å¼ƒå¹¶é€šçŸ¥æºä¸»æœºï¼‰\u0026ndash;\u0026gt;æ ¹æ®æ•°æ®æŠ¥çš„ç›®çš„åœ°å€åœ¨è·¯ç”±è¡¨ä¸­æŸ¥æ‰¾åŒ¹é…æ¡ç›®ï¼ˆä¸è·¯ç”±æ¡ç›®ä¸­çš„åœ°å€æ©ç \u0026amp;ï¼Œæ£€æŸ¥ç½‘ç»œå·æ˜¯å¦åŒ¹é…ï¼‰\u0026ndash;\u0026gt;è½¬å‘ è‹¥ä¸åŒ¹é…åˆ™ä¸¢å¼ƒå¹¶é€šçŸ¥æºä¸»æœº é‡‡ç”¨æœ€é•¿å‰ç¼€åŒ¹é… æ³¨æ„ï¼šå¹¿æ’­æ•°æ®æŠ¥è·¯ç”±å™¨ä¸ä¼šè½¬å‘ï¼ˆéš”ç¦»å¹¿æ’­åŸŸï¼‰ é™æ€è·¯ç”±é…ç½®åŠè·¯ç”±ç¯è·¯é—®é¢˜ é™æ€è·¯ç”±é…ç½®ï¼šäººå·¥é…ç½®è·¯ç”±è¡¨ï¼ˆæŒ‡å®šç›®çš„ç½‘ç»œåœ°å€ä¸ä¸‹ä¸€è·³çš„æ¥å£ï¼‰ ä¸èƒ½åŠæ—¶é€‚åº”ç½‘ç»œçŠ¶æ€ï¼ˆæ‹“æ‰‘ æµé‡ç­‰ï¼‰çš„å˜åŒ– å¯èƒ½å¯¼è‡´è·¯ç”±ç¯è·¯çš„åŸå› ï¼š é…ç½®é”™è¯¯ èšåˆäº†ä¸å­˜åœ¨çš„ç½‘ç»œ ç½‘ç»œæ•…éšœ ç‰¹æ®Šæ¦‚å¿µ é»˜è®¤è·¯ç”±ï¼šå…·æœ‰ç›¸åŒä¸‹ä¸€è·³çš„ä¸åŒç›®çš„ç½‘ç»œçš„è·¯ç”±æ¡ç›® å¯ä»¥å°†ç›®çš„ç½‘ç»œå†™ä½œ0.0.0.0/0ï¼ˆé™æ€ï¼‰ å…¶å®ƒçš„æ‰€æœ‰ç›®çš„ç½‘ç»œéƒ½è½¬å‘æ­¤æ¥å£ ç‰¹å®šä¸»æœºè·¯ç”±ï¼šè®¾ç½®ç›®çš„ç½‘ç»œåœ°å€ä¸ºç›®çš„ä¸»æœºçš„IP å­ç½‘æ©ç æœ‰32ä½1ï¼ˆé™æ€ï¼‰ ä¸‹ä¸€è·³è¿˜æ˜¯åœ¨ç‰¹å®šä¸»æœºè¿æ¥çš„è·¯ç”±å™¨æ¥å£ å¯èƒ½çš„è·¯ç”±ç¯è·¯ é…ç½®é”™è¯¯ï¼ˆé…ç½®äº†å¾ªç¯çš„ä¸‹ä¸€è·³æ¥å£ï¼‰ï¼šIPæ•°æ®æŠ¥é¦–éƒ¨è®¾ç½®ç”Ÿå­˜æ—¶é—´TTL è¿›å…¥è·¯ç”±å™¨åå‡ä¸€ è‹¥æŸæ¬¡è¿›å…¥åTTL=0 åˆ™ä¸¢å¼ƒ èšåˆä¸å­˜åœ¨çš„ç½‘ç»œï¼ˆæœ¬åº”å°†é”™è¯¯IPä¸¢å¼ƒï¼‰ï¼šå¯æ·»åŠ é’ˆå¯¹ä¸å­˜åœ¨çš„ç½‘ç»œçš„é»‘æ´è·¯ç”± å³ä¸‹ä¸€è·³è®¾ç½®ä¸ºnull0 ç½‘ç»œæ•…éšœï¼ˆæŸIPåœ°å€çš„ç½‘ç»œå‡ºç°æ•…éšœ è·¯ç”±å™¨è‡ªåŠ¨ä¸¢å¼ƒå¯¹åº”è·¯ç”±è¡¨æ¡ç›®ï¼‰ï¼šæ·»åŠ é’ˆå¯¹è¯¥ç½‘ç»œçš„é»‘æ´è·¯ç”± è·¯ç”±é€‰æ‹©åè®® æ¦‚è¿° é™æ€è·¯ç”±é€‰æ‹©ï¼šäººå·¥é…ç½®â€”â€”å°è§„æ¨¡ç½‘ç»œ ä¸èƒ½åŠæ—¶é€‚åº”ç½‘ç»œçŠ¶æ€å˜åŒ– åŠ¨æ€è·¯ç”±é€‰æ‹©ï¼šè‡ªåŠ¨è·å–è·¯ç”±ä¿¡æ¯ï¼ˆbyè·¯ç”±é€‰æ‹©åè®®ï¼‰ ç‰¹ç‚¹ä¸ğŸ‘†å å› ç‰¹ç½‘è·¯ç”±é€‰æ‹©åè®®ç‰¹ç‚¹ï¼šè‡ªé€‚åº”ï¼ˆåŠ¨æ€ï¼‰ + åˆ†å¸ƒå¼ï¼ˆè·¯ç”±å™¨é—´äº¤æ¢è·¯ç”±ä¿¡æ¯ï¼‰ + åˆ†å±‚æ¬¡ï¼ˆå› ç‰¹ç½‘åˆ’åˆ†ä¸ºè®¸å¤šè¾ƒå°çš„è‡ªæ²»ç³»ç»ŸASï¼‰ å› ç‰¹ç½‘çš„åˆ†å±‚æ¬¡è·¯ç”±é€‰æ‹©åè®®ï¼šï¼ˆç½‘å…³ = è·¯ç”±ï¼‰ è‡ªæ²»ç³»ç»Ÿå†…éƒ¨é‡‡ç”¨å†…éƒ¨ç½‘å…³åè®®IGP ASé—´é‡‡ç”¨å¤–éƒ¨ç½‘å…³åè®®EGP å¸¸è§çš„å†…éƒ¨ç½‘å…³åè®®ï¼š è·¯ç”±ä¿¡æ¯åè®®RIPâ€”â€”åŸºäºè·ç¦»å‘é‡ å†…éƒ¨ç½‘å…³è·¯ç”±åè®®IGRPâ€”â€”åŸºäºè·ç¦»å‘é‡ å¢å¼ºå‹å†…éƒ¨ç½‘å…³è·¯ç”±åè®®EIGRPâ€”â€”ç»“åˆè·ç¦»å‘é‡ä¸é“¾è·¯ å¼€æ”¾å¼æœ€çŸ­è·¯å¾„ä¼˜å…ˆOSPFâ€”â€”åŸºäºé“¾è·¯ ä¸­é—´ç³»ç»Ÿåˆ°ä¸­é—´ç³»ç»ŸIS-ISâ€”â€”åŸºäºé“¾è·¯ å¸¸è§EGPï¼šè¾¹ç•Œç½‘å…³åè®®BGP è·¯ç”±å™¨åŸºæœ¬ç»“æ„ï¼šè·¯ç”±é€‰æ‹©éƒ¨åˆ†ï¼ˆå‘¨æœŸæ€§ä¸å…¶å®ƒè·¯ç”±å™¨äº¤æµå¹¶æ›´æ–°ï¼‰ + åˆ†ç»„è½¬å‘éƒ¨åˆ† è½¬å‘è¡¨fromè·¯ç”±è¡¨ è·¯ç”±æŠ¥æ–‡å¯æ›´æ–°è·¯ç”±è¡¨ å…·æœ‰è¾“å…¥è¾“å‡ºç¼“å†²åŒº RIP æœ€å…ˆå¾—åˆ°å¹¿æ³›ä½¿ç”¨çš„IGP ç”¨UDPåè®®ç›´æ¥å°è£…æŠ¥æ–‡ åç”±IPåè®®å°è£…\nè¦æ±‚ï¼šASå†…æ¯ä¸ªè·¯ç”±å™¨ç»´æŠ¤è‡ªå·±åˆ°å…¶å®ƒæ¯ä¸ªç½‘ç»œçš„è·ç¦»è®°å½•â€”â€”è·ç¦»å‘é‡D-Vï¼ˆä¸€ç»„è·ç¦»ï¼‰ ç”¨è·³æ•°Hop Countä½œä¸ºåº¦é‡ ç›´è¿ç½‘ç»œ\u0026ndash;è·¯ç”±å™¨ = 1ï¼›éç›´è¿ç½‘ç»œ\u0026ndash;è·¯ç”±å™¨ = ç»è¿‡çš„è·¯ç”±å™¨æ•°+1 ä¸€æ¡è·¯å¾„æœ€å¤š15ä¸ªè·¯ç”±å™¨ = åªé€‚ç”¨å°å‹äº’è¿ç½‘ ç‰¹ç‚¹ï¼š è‹¥æœ‰å¤šæ¡è·ç¦»ç›¸ç­‰çš„è·¯ç”± å¯è¿›è¡Œç­‰ä»·è´Ÿè½½å‡è¡¡ åŒ…å«è¦ç‚¹ï¼šä»…ä¸ç›¸é‚»è·¯ç”±å™¨äº¤æ¢ä¿¡æ¯ + äº¤æ¢è·¯ç”±è¡¨ + å‘¨æœŸæ€§äº¤æ¢ åŸºæœ¬å·¥ä½œè¿‡ç¨‹ = è·¯å¾„è§„åˆ’ï¼ˆæ”¶æ•›åˆ™æ‰¾åˆ°æœ€çŸ­è·¯å¾„ï¼‰\næ›´æ–°è§„åˆ™ï¼šåˆ¤æ–­åˆ°è¾¾ç½‘ç»œæ˜¯å¦æ›´æ–°\u0026ndash;\u0026gt;ä¸‹ä¸€è·³æ˜¯å¦ç›¸åŒ\u0026ndash;\u0026gt;ç›¸åŒæ—¶æ›´æ–°æ¶ˆæ¯ ä¸åŒæ—¶æ¯”è¾ƒè·¯å¾„é•¿çŸ­ ç­‰äºæ—¶æ·»åŠ åšè´Ÿè½½å‡è¡¡ é—®é¢˜ï¼šâ€œåæ¶ˆæ¯ä¼ å¾—æ…¢â€ï¼ˆå‘ç”Ÿæ•…éšœåğŸ‘‡ï¼‰ = è·¯ç”±ç¯è·¯/è·ç¦»æ— ç©·è®¡æ•°é—®é¢˜ D-Vç®—æ³•å›ºæœ‰é—®é¢˜ å‡å°‘é—®é¢˜çš„æªæ–½ï¼šé™åˆ¶æœ€å¤§è·¯å¾„è·ç¦» è·¯ç”±è¡¨å‘ç”Ÿå˜åŒ–æ—¶å°±å‘é€æ›´æ–°æŠ¥æ–‡ï¼ˆè§¦å‘æ›´æ–°ï¼‰ ä¸è®©åŒä¸€è·¯ç”±ä¿¡æ¯é€šè¿‡æ­¤æ¥å£åå‘ä¼ é€ï¼ˆæ°´å¹³åˆ†å‰²ï¼‰ OSPF é‡‡ç”¨Dijkstraæå‡ºçš„SPFï¼ˆæœ€çŸ­è·¯å¾„ç®—æ³•ï¼‰ åŸºäºé“¾è·¯ + ä¸ä¼šäº§ç”Ÿè·¯ç”±ç¯è·¯ + ä¸é™åˆ¶ç½‘ç»œè§„æ¨¡ æ”¶æ•›å¿« å®ç°ï¼š é€šè¿‡äº¤äº’é—®å€™ï¼ˆHelloï¼‰åˆ†ç»„ ç»´æŠ¤é‚»å±…å…³ç³» å°è£…åœ¨IPæ•°æ®æŠ¥ä¸­ å‘å¾€ç»„æ’­åœ°å€224.0.0.5 æ¯ä¸ªè·¯ç”±å™¨äº§ç”ŸLSAé“¾è·¯çŠ¶æ€é€šå‘Š åŒ…æ‹¬ç›´è¿ç½‘ç»œé“¾è·¯çŠ¶æ€ä¿¡æ¯ \u0026amp; é‚»å±…è·¯ç”±å™¨çš„ è¢«å°è£…åœ¨é“¾è·¯çŠ¶æ€æ›´æ–°åˆ†ç»„LSUä¸­ æ´ªæ³›æ³•å‘é€ æ¯ä¸ªè·¯ç”±å™¨ç”¨LSDBé“¾è·¯çŠ¶æ€æ•°æ®åº“å­˜å‚¨LSA é€šè¿‡æ´ªæ³›æ³• æœ€ç»ˆæ‰€æœ‰è·¯ç”±å™¨çš„LSDBä¸€è‡´ åŸºäºLSDBè¿›è¡ŒSPFè®¡ç®— æ„å»ºè·¯ç”±è¡¨ äº”ç§åˆ†ç»„ç±»å‹ï¼šHello æ•°æ®åº“æè¿° é“¾è·¯çŠ¶æ€è¯·æ±‚ é“¾è·¯çŠ¶æ€æ›´æ–° é“¾è·¯çŠ¶æ€ç¡®è®¤ å‘¨æœŸæ—¶é—´/æ›´æ–°ä¿¡æ¯/å›åº”å…¶å®ƒè·¯ç”±å™¨è¯·æ±‚æ—¶ å‘é€é“¾è·¯çŠ¶æ€æ›´æ–°åˆ†ç»„ å¤šç‚¹æ¥å…¥ç½‘ç»œä¸­ï¼šé€‰ä¸¾æŒ‡å®šè·¯ç”±å™¨DR \u0026amp; å¤‡ç”¨çš„æŒ‡å®šè·¯ç”±å™¨BDR æ‰€æœ‰çš„éDR BDRåªä¸å…¶å»ºç«‹é‚»å±…å…³ç³» å°†ä¸€ä¸ªASåˆ’åˆ†ä¸ºè‹¥å¹²çš„åŒºåŸŸ æœ‰è‡ªå·±çš„æ ‡è¯†ç¬¦ æ‰€æœ‰æ¥å£åœ¨åŒºåŸŸå†… = åŒºåŸŸå†…è·¯ç”±å™¨IR åŒºåŸŸè¾¹ç•Œè·¯ç”±å™¨ABR ä¸å…¶ä»–åŒºåŸŸè”é€šï¼ˆä¸¤æ¥å£ ä¸€å¯¹å¤–ä¸€å¯¹å†…ï¼‰ ä¸»å¹²è·¯ç”±å™¨BBR ä¸»å¹²åŒºåŸŸå†…çš„è·¯ç”±å™¨ è‡ªæ²»ç³»ç»Ÿè¾¹ç•Œè·¯ç”±å™¨ASBR ä¸å…¶å®ƒè‡ªæ²»ç³»ç»Ÿäº¤æ¢ä¿¡æ¯ BGP è‡ªæ²»ç³»ç»Ÿå†…åº¦é‡é‡‡ç”¨çš„ä»£ä»·ä¸åŒ æ•…è‡ªæ²»ç³»ç»Ÿé—´ä¸å¯ç”¨ä»£ä»·ä½œä¸ºåº¦é‡\næ¯ä¸ªASéœ€æœ‰è‡³å°‘ä¸€ä¸ªBGPå‘è¨€äºº ä¸åŒASçš„å‘è¨€äººäº¤æ¢è·¯ç”±ä¿¡æ¯å‰éœ€å»ºç«‹TCPè¿æ¥ ç«¯å£å·179 äº¤æ¢BGPæŠ¥æ–‡ä»¥å»ºç«‹BGPä¼šè¯ ä»¥æ­¤äº¤æ¢è·¯ç”±ä¿¡æ¯ äº¤æ¢ç½‘ç»œå¯è¾¾æ€§ä¿¡æ¯ åæ‰¾å‡ºåˆ°è¾¾å„ASè¾ƒå¥½çš„è·¯ç”±â€”â€”æ— ç¯è¿é€šå›¾ å››ç§æŠ¥æ–‡ï¼ˆBGP-4ï¼‰ï¼šæ‰“å¼€ æ›´æ–° ä¿æ´» é€šçŸ¥ IPv4æ•°æ®æŠ¥é¦–éƒ¨æ ¼å¼ IPæ•°æ®æŠ¥\nå›ºå®šéƒ¨åˆ†20å­—èŠ‚ + å¯å˜éƒ¨åˆ†40å­—èŠ‚ å›ºå®šéƒ¨åˆ†ä¸­æ¯ä¸ªåŒºåŸŸéƒ½ä»¥4å­—èŠ‚ä¸ºå•ä½ï¼ˆè¦ä¹ˆ4è¦ä¹ˆ8è¦ä¹ˆÂ·Â·Â·Â·ï¼‰ è§£é‡Šï¼š ç‰ˆæœ¬ï¼šé€šä¿¡åŒæ–¹é‡‡ç”¨çš„IPåè®®ç‰ˆæœ¬å¿…ç›¸åŒ é¦–éƒ¨é•¿åº¦ï¼šæœ€å°å–å€¼ä¸º5ï¼ˆä»…æœ‰20å­—èŠ‚å›ºå®šéƒ¨åˆ†ï¼‰ æœ€å¤§15ï¼ˆ20å›ºå®š+40å¯å˜ï¼‰ å¯é€‰å­—æ®µï¼šé•¿åº¦1å­—èŠ‚~40å­—èŠ‚ å¡«å……å­—æ®µï¼šç¡®ä¿é¦–éƒ¨é•¿åº¦ä¸º4å­—èŠ‚çš„æ•´æ•°å€ åŒºåˆ†æœåŠ¡ï¼šåŒºåˆ†ä¸åŒç­‰çº§çš„æœåŠ¡è´¨é‡ æ€»é•¿åº¦ = é¦–éƒ¨ + æ•°æ®è½½è· è§£é‡Šï¼šæ ¹æ®ä»¥å¤ªç½‘MTUå°†æ•°æ®è½½è·åˆ†ç‰‡ä»¥å°è£…æˆå¸§ æ ‡è¯†ï¼šåŒä¸€æ•°æ®æŠ¥çš„å„åˆ†ç‰‡åº”å…·ç›¸åŒæ ‡è¯† æ ‡å¿—ï¼š3bit DFä½ï¼ˆ1ä¸è®¸åˆ†ç‰‡ 0å…è®¸åˆ†ç‰‡ï¼‰ MFä½ï¼ˆ1åè¿˜æœ‰åˆ†ç‰‡ 0æ­¤ä¸ºæœ€ååˆ†ç‰‡ï¼‰ ä¿ç•™ä½ï¼ˆå¿…ä¸º0ï¼‰ ç‰‡åç§»ï¼šåˆ†ç‰‡æ•°æ®æŠ¥çš„æ•°æ®è½½è·ç›¸å¯¹åŸæ•°æ®æŠ¥åç§»çš„å•ä½ï¼ˆä»¥8å­—èŠ‚ä¸ºå•ä½è¡¨ç¤º eg.åç§»32ä¸ªå­—èŠ‚åˆ™åœ¨æ­¤å†™4ï¼‰ è§£é‡Šï¼š ç”Ÿå­˜æ—¶é—´TTLï¼šåŸæ¥ä»¥ç§’ä¸ºå•ä½ ç°åœ¨ä»¥è·³æ•°ä¸ºå•ä½ ï¼ˆè·¯ç”±å™¨è½¬å‘æ—¶å‡ä¸€è‹¥ä¸º0åˆ™ä¸¢å¼ƒ åè®®ï¼šæŒ‡æ˜æ•°æ®éƒ¨åˆ†æ˜¯å“ªç§åè®®å•å…ƒï¼ˆICMP-1 IGMP-2 TCP-6 UDP-17 IPv6-41 OSPF-89ï¼‰ é¦–éƒ¨æ£€éªŒå’Œï¼šå·®é”™æ£€æŸ¥ æ¯”CRCç®€å• = â€œå› ç‰¹ç½‘æ£€éªŒå’Œâ€ IPv4æ‰€æœ‰è·¯ç”±å™¨éƒ½è¦æ£€æŸ¥ IPv6ä¸å†æ£€æŸ¥ ç½‘é™…æ§åˆ¶æŠ¥æ–‡åè®®ICMP æ›´æœ‰æ•ˆåœ°è½¬å‘IPæ•°æ®æŠ¥ æé«˜äº¤ä»˜æˆåŠŸåœ°æœºä¼š\nç‰¹ç‚¹ï¼šä¸»æœº/è·¯ç”±å™¨ç”¨ICMPå‘é€å·®é”™æŠ¥å‘ŠæŠ¥æ–‡\u0026amp;è¯¢é—®æŠ¥æ–‡ + è¢«å°è£…åœ¨IPæ•°æ®æŠ¥ä¸­ å·®é”™æŠ¥å‘ŠæŠ¥æ–‡ ç»ˆç‚¹ä¸å¯è¾¾ï¼šä¸èƒ½äº¤ä»˜æ•°æ®æŠ¥ å‘æºç‚¹å‘é€ æºç‚¹æŠ‘åˆ¶ï¼šè·¯ç”±å™¨/ä¸»æœºç”±äºæ‹¥å¡ä¸¢å¼ƒæ•°æ®æŠ¥ å‘æºç‚¹å‘é€ï¼ˆæºç‚¹å‘é€é€Ÿç‡æ”¾æ…¢ï¼‰ æ—¶é—´è¶…è¿‡ï¼šTTL ä¸¢å¼ƒæ—¶å‘æºç‚¹å‘é€ åˆ†ç‰‡ä¸å®Œæ•´æ—¶ å…¨éƒ¨ä¸¢å¼ƒ å‚æ•°é—®é¢˜ï¼šé¦–éƒ¨ä¸­æ£€éªŒä¸å­—æ®µå‘ç°è¯¯ç  æ”¹å˜è·¯ç”±ï¼ˆé‡å®šå‘ï¼‰ï¼šè·¯ç”±å™¨å°†æ”¹å˜è·¯ç”±æŠ¥æ–‡å‘é€ç»™ä¸»æœº ä¸å‘é€çš„æƒ…å†µï¼šå¯¹ICMPå·®é”™æŠ¥æ–‡ä¸å‘ ç¬¬ä¸€ä¸ªåˆ†ç‰‡çš„åç»­æŠ¥ç‰‡ å…·æœ‰å¤šæ’­åœ°å€çš„æ•°æ®æŠ¥ ç‰¹æ®Šåœ°å€ï¼ˆ127.0.0.0ç­‰ï¼‰ è¯¢é—®æŠ¥æ–‡ å›é€è¯·æ±‚ä¸å›ç­”â€”â€”æµ‹è¯•ç›®çš„ç«™æ˜¯å¦å¯è¾¾ï¼ˆæ”¶åˆ°çš„ä¸»æœºå¿…é¡»å›ç­”ï¼‰ æ—¶é—´æˆ³è¯·æ±‚å’Œå›ç­”â€”â€”æ—¶é’ŸåŒæ­¥ æµ‹é‡æ—¶é—´ åº”ç”¨ åˆ†ç»„ç½‘é—´æ¢æµ‹PINGï¼ˆpacket Internet groperï¼‰ åº”ç”¨å±‚ç›´æ¥ä½¿ç”¨ç½‘é™…å±‚çš„ICMP ä¸é€šè¿‡è¿è¾“å±‚çš„TCP or UDP è·Ÿè¸ªè·¯ç”±traceroute æµ‹è¯•IPæ•°æ®æŠ¥ä»æºä¸»æœºåˆ°ç›®çš„ä¸»æœºç»è¿‡å“ªäº›è·¯ç”±å™¨ï¼ˆåŸç†ï¼šæ—¶é—´è¶…è¿‡å·®é”™æŠ¥å‘Šï¼‰ åº”ç”¨å±‚ç›´æ¥ä½¿ç”¨ç½‘é™…å±‚çš„ICMP ä¸é€šè¿‡è¿è¾“å±‚çš„TCP or UDP Unixä¸­åœ¨è¿è¾“å±‚ä½¿ç”¨UDP è™šæ‹Ÿä¸“ç”¨ç½‘VPNç½‘ç»œåœ°å€è½¬æ¢NAT VPN virtual private network VPNä¸­å„ä¸»æœºåˆ†é…çš„åœ°å€æ˜¯æŸæœºæ„å¯è‡ªç”±åˆ†é…çš„ä¸“å±åœ°å€ï¼ˆIPv4åœ°å€ç´§ç¼ºï¼‰ â€œIPéš§é“æŠ€æœ¯â€ åˆ†ç±»ï¼šå†…è”ç½‘VPN \u0026amp; å¤–è”ç½‘VPN NAT network address translation ä½¿ç”¨å†…éƒ¨ä¸“ç”¨åœ°å€çš„ä¸“ç”¨ç½‘ç»œç”¨æˆ·å…±äº«å°‘é‡å¤–éƒ¨å…¨çƒåœ°å€ä»¥è®¿é—®å› ç‰¹ç½‘ è¿‡ç¨‹ï¼šNATè·¯ç”±å™¨ä¸ºå‘é€ç«¯åˆ†é…ä¸€ä¸ªå…¨çƒIPåœ°å€ å¹¶ä¿®æ”¹æ•°æ®æŠ¥çš„æºåœ°å€ å¹¶è®°å½•å†…å¤–ç½‘åœ°å€å¯¹åº”å…³ç³» å¯ä»¥å°†è¿è¾“å±‚ç«¯å£å·ä¸IPä¸€èµ·è½¬æ¢=ä¸€ä¸ªå…¨çƒIPåœ°å€å¯ä½¿å¤šä¸ªï¼ˆå†…éƒ¨ï¼‰ä¸»æœºä¸å¤–é€šä¿¡ IPåœ°å€åŒ ç«¯å£å·ä¸åŒ ç½‘ç»œåœ°å€æºç«¯å£å·è½¬æ¢NAPT elseï¼šå¤–ç½‘ä¸»æœºä¸èƒ½é¦–å…ˆå‘èµ·é€šä¿¡ï¼ˆNATå±è”½äº†å†…ç½‘ä¸»æœºçš„ç½‘ç»œåœ°å€ï¼‰â€”â€”NATç©¿è¶ŠæŠ€æœ¯ è¿è¾“å±‚ è¿è¾“å±‚æ¦‚è¿° æä¾›é¢å‘è¿æ¥çš„TCP \u0026amp; æ— è¿æ¥çš„UDP è¿è¾“åº”ç”¨è¿›ç¨‹ ä¸åŒè¿›ç¨‹ç”¨ä¸åŒç«¯å£æ¥æ”¶ï¼ˆéç‰©ç†æ„ä¹‰ä¸Šçš„ç«¯å£ï¼‰ è¿è¾“å±‚ç«¯å£å· å¤ç”¨ åˆ†ç”¨ ç«¯å£å· éœ€ç”¨ç»Ÿä¸€æ–¹æ³•å¯¹TCP/IPä½“ç³»çš„åº”ç”¨è¿›ç¨‹æ ‡è¯†â€”â€”ç«¯å£å·åŒºåˆ†ï¼ˆ16æ¯”ç‰¹ï¼‰ ç«¯å£å·åªå…·æœ‰æœ¬åœ°æ„ä¹‰â€”â€”æœ¬è®¡ç®—æœºåº”ç”¨å±‚çš„å„è¿›ç¨‹ ç†ŸçŸ¥ç«¯å£å· ç™»è®°ç«¯å£å· çŸ­æš‚ç«¯å£å· å‘é€æ–¹å¤ç”¨ æ¥æ”¶æ–¹åˆ†ç”¨ åº”ç”¨æŠ¥æ–‡ï¼ˆä¸åŒç«¯å£ï¼‰\u0026ndash;\u0026gt;UDPå¤ç”¨/TCPå¤ç”¨\u0026ndash;\u0026gt;ç”¨æˆ·æ•°æ®æŠ¥ï¼ˆUDPå°è£…ï¼‰/æŠ¥æ–‡æ®µï¼ˆTCPå°è£…ï¼‰\u0026ndash;\u0026gt;IPå¤ç”¨ æˆä¸ºIPæ•°æ®æŠ¥\u0026ndash;\u0026gt;æ¥æ”¶æ–¹å¯¹IPåˆ†ç”¨æˆç”¨æˆ·æ•°æ®æŠ¥/æŠ¥æ–‡æ®µ\u0026ndash;\u0026gt;åˆ†ç”¨æˆåº”ç”¨æŠ¥æ–‡ åº”ç”¨å±‚çš„ä¸åŒåè®®åœ¨è¿è¾“å±‚ä½¿ç”¨ä¸åŒåè®®çš„ä¸åŒç«¯å£å·ï¼ˆeg.http-\u0026gt;TCP 80 https-\u0026gt;TCP 443ï¼‰ åœ¨ç½‘ç»œå±‚éƒ½ä½¿ç”¨IPåè®® UDP TCPå¯¹æ¯” UDP ç”¨æˆ·æ•°æ®æŠ¥åè®®â€”â€”æ— è¿æ¥ï¼ˆè¿‡ç¨‹ï¼‰ æ”¯æŒå•æ’­å¤šæ’­å¹¿æ’­ å¯¹åº”ç”¨å±‚æŠ¥æ–‡ä¸åˆå¹¶ä¸æ‹†åˆ† è¯¯ç  ä¸¢å¤±ä¸å¤„ç† æ•°æ®æŠ¥é¦–éƒ¨ä»…8å­—èŠ‚ TCP ä¼ è¾“æ§åˆ¶åè®®â€”â€”ä¸‰æŠ¥æ–‡æ¡æ‰‹å»ºç«‹è¿æ¥ å››æŠ¥æ–‡æŒ¥æ‰‹é‡Šæ”¾è¿æ¥ ä»…æ”¯æŒå•æ’­ é¢å‘å­—èŠ‚æµ ä¸ä¿è¯ä¼ è¾“çš„æ•°æ®å¤§å°å®Œå…¨ä¸€è‡´ï¼ˆäº¤ä»˜æ—¶ä¸æ£€æŸ¥ä¼ è¾“äº†å¤šå°‘æ•°æ®ï¼‰ ä¸ä¼šè¯¯ç  ä¸¢å¤±ç­‰ TCPæµé‡æ§åˆ¶ è®©å‘é€æ–¹å‘é€é€Ÿç‡ä¸è¿‡å¿« æ¥å¾—åŠæ¥æ”¶â€”â€”æ»‘åŠ¨çª—å£å®ç°\næ™®é€šçš„æ»‘åŠ¨çª—å£ç®—æ³•ï¼ˆç±»å¸§ï¼‰ æ¥æ”¶æ–¹å‘é€ACK ack=nè¡¨ç¤ºnä¹‹å‰çš„æ•°æ®å·²æ”¶åˆ° è®¾ç½®é›¶çª—å£æŒç»­è®¡æ—¶å™¨â€”â€”åˆ°æ—¶æ—¶å‘æ¥æ”¶æ–¹å‘é€é›¶çª—å£æ¢æµ‹æŠ¥æ–‡æ®µ å¾—åˆ°çª—å£å¤§å° TCPæ‹¥å¡æ§åˆ¶ ç†æƒ³çš„æ‹¥å¡æ§åˆ¶â€”â€”ç½‘ç»œååé‡=è¾“å…¥è´Ÿè½½ è¾“å…¥è´Ÿè½½è¿‡é«˜ ååé‡ä¸å˜ æ— æ‹¥å¡æ§åˆ¶æ—¶ è¾“å…¥è´Ÿè½½è¿‡å¤§ååé‡åè€Œå‡å° æ–¹æ³• ç»´æŠ¤æ‹¥å¡çª—å£å˜é‡â€”â€”è¶…æ—¶é‡ä¼ æ—¶åˆ¤å®šä¸ºç½‘ç»œæ‹¥å¡ å‘é€æ–¹å°†æ‹¥å¡çª—å£ä½œä¸ºå‘é€çª—å£\nç»´æŠ¤æ…¢å¼€å§‹é—¨é™ssthreshçŠ¶æ€å˜é‡â€”â€”å¤§äºæ‹¥å¡çª—å£æ—¶ é‡‡ç”¨æ…¢å¼€å§‹ç®—æ³• å°äºæ—¶é‡‡ç”¨æ‹¥å¡é¿å…ç®—æ³• ç­‰äºæ—¶å‡å¯ä½¿ç”¨ ä¸æ‹¥å¡æ—¶æ‹¥å¡çª—å£å¢å¤§ æ‹¥å¡æ—¶å‡å° æ…¢å¼€å§‹ç®—æ³•ï¼šæ¯æ¥åˆ°ä¸€ä¸ªç¡®è®¤ æŒ‡æ•°çº§å¢å¤§çª—å£ æ‹¥å¡é¿å…ç®—æ³•ï¼šçª—å£åªåŠ ä¸€ è‹¥è¶…æ—¶é‡ä¼ â€”â€”æ…¢å¼€å§‹é—¨é™è®¾ä¸ºä¸€åŠ çª—å£è®¾ç½®ä¸º1 å¿«é‡ä¼ ç®—æ³•ï¼šï¼ˆå°½å¿«é‡ä¼ ï¼‰å‘é€æ–¹æ”¶åˆ°ä¸‰ä¸ªè¿ç»­çš„é‡å¤ç¡®è®¤å°±é‡ä¼  æ¥æ”¶æ–¹ç«‹å³å‘é€ç¡®è®¤ æ”¶åˆ°å¤±åºæŠ¥æ–‡æ®µç«‹å³å‘å‡ºé‡å¤ç¡®è®¤ éƒ¨åˆ†ä¸¢å¤±ä¸ä¼šè®¤ä¸ºæ˜¯æ‹¥å¡\nå¿«æ¢å¤ç®—æ³•ï¼šæ”¶åˆ°3ä¸ªé‡å¤ç¡®è®¤åæ‰§è¡Œ å‘é€æ–¹å°†æ…¢å¼€å§‹é—¨é™ä¸æ‹¥å¡çª—å£è°ƒæ•´ä¸ºå½“å‰çª—å£çš„ä¸€åŠ æ‰§è¡Œæ‹¥å¡é¿å… TCPè¶…æ—¶é‡ä¼ æ—¶é—´çš„é€‰æ‹© ç•¥å¤§äºå¾€è¿”æ—¶é—´\nåˆ©ç”¨æ¯æ¬¡çš„å¾€è¿”æ—¶é—´RTTæ ·æœ¬ è®¡ç®—åŠ æƒå¹³å‡å¾€è¿”æ—¶é—´ğŸ‘‡ è¶…æ—¶é‡ä¼ æ—¶é—´RTOï¼š$RTO=RTT_S+4*RTT_D$ $RTT_D$ RTTåå·®çš„åŠ æƒå¹³å‡ğŸ‘‡ ï¼ˆé’ˆå¯¹è¶…æ—¶é‡ä¼ æ—¶æµ‹ä¸å‡†RTTé—®é¢˜ï¼‰Karnæå‡ºä¸é‡‡ç”¨è¶…æ—¶é‡ä¼ çš„RTTæ ·æœ¬ æ—¶å»¶çªç„¶å¢å¤§â€”â€”ä¿®æ­£ï¼šå‡ºç°è¶…æ—¶é‡ä¼ æ—¶$RTO$å˜ä¸ºåŸæ¥2å€ TCPå¯é ä¼ è¾“å®ç° ä»¥å­—èŠ‚ä¸ºå•ä½çš„æ»‘åŠ¨çª—å£å®ç°â€”â€”ç±»ä¼¼æŠ¥æ–‡æ®µï¼ˆä¸èµ˜è¿°ï¼‰\nå‘é€æ–¹çª—å£å¤§å°æ ¹æ®æ¥æ”¶æ–¹ç¡®å®š ä½†åŒæ—¶åˆ»ä¸ä¸€å®šæ€»ä¸€æ ·å¤§ TCPæœªæ˜ç¡®è§„å®šå¦‚ä½•å¤„ç†ä¸æŒ‰åºåˆ°è¾¾çš„æ•°æ® é€šå¸¸å…ˆä¸´æ—¶å­˜æ”¾ æ”¶åˆ°ç¼ºå¤±çš„æ•°æ®æ—¶å†æŒ‰åºäº¤ä»˜ï¼ˆåº”ç”¨è¿›ç¨‹ï¼‰ æ¥æ”¶æ–¹å¿…é¡»æœ‰ç´¯è®¡ç¡®è®¤\u0026amp;ç¨å¾…ç¡®è®¤ å…¨åŒå·¥é€šä¿¡ TCPè¿è¾“è¿æ¥ç®¡ç†â€”â€”è¿æ¥å»ºç«‹ è§£å†³çš„é—®é¢˜ï¼šç¡®çŸ¥å¯¹æ–¹å­˜åœ¨ + åå•†å‚æ•° + åˆ†é…è¿è¾“çš„å®ä½“èµ„æº å…·ä½“è¿‡ç¨‹ ä¸‰æŠ¥æ–‡æ¡æ‰‹\nTCPæœåŠ¡å™¨è¢«åŠ¨ç­‰å¾…TCPå®¢æˆ·çš„è¿æ¥è¯·æ±‚ å®¢æˆ·ä¸»åŠ¨å‘èµ·è¿æ¥è¯·æ±‚ è¿‡ç¨‹ï¼š TCPæœåŠ¡å™¨åˆ›å»ºä¼ è¾“æ§åˆ¶å— ä»å…³é—­çŠ¶æ€è¿›å…¥ç›‘å¬çŠ¶æ€â€”â€”è¢«åŠ¨æ‰“å¼€è¿æ¥ å®¢æˆ·åˆ›å»ºä¼ è¾“æ§åˆ¶å— å‘æœåŠ¡å™¨å‘é€è¿æ¥è¯·æ±‚æŠ¥æ–‡æ®µ è¿›å…¥åŒæ­¥å·²å‘é€çŠ¶æ€ SYN=1 seq=x è¡¨ç¤ºå…¶ä¸ºè¿æ¥è¯·æ±‚æŠ¥æ–‡æ®µ ä¸èƒ½æºå¸¦æ•°æ®â€”â€”ä¸»åŠ¨æ‰“å¼€è¿æ¥ æœåŠ¡å™¨å‘é€å¯¹TCPè¿æ¥è¯·æ±‚çš„ç¡®è®¤ è¿›å…¥åŒæ­¥å·²æ¥å—çŠ¶æ€ SYN=1 ACK=1 ack=x+1 seq=y ä¹Ÿä¸èƒ½æºå¸¦æ•°æ® å®¢æˆ·å‘é€å¯¹ç¡®è®¤çš„ç¡®è®¤ è¿›å…¥è¿æ¥å·²å»ºç«‹çŠ¶æ€ï¼ˆæ•°æ®loadéƒ¨åˆ†å¯ä»¥æºå¸¦è¯·æ±‚å†…å®¹ï¼‰ ACK=1 seq=x+1 ack=y+1 æœåŠ¡å™¨æ¥æ”¶å è¿›å…¥è¿æ¥å·²å»ºç«‹çŠ¶æ€ å®¢æˆ·ä¸æœåŠ¡å™¨çš„seqç”±å„è‡ªå†³å®š ä½†ackåºå·ä¸å¯¹æ–¹çš„seqæœ‰å…³ï¼ˆ+1ï¼‰ ä¸èƒ½ä¸¤æ¡æ‰‹çš„åŸå› ï¼šé¿å…å¤±æ•ˆçš„è¿æ¥è¯·æ±‚æŠ¥æ–‡æ®µä¼ è¾“åˆ°æœåŠ¡å™¨ï¼ˆæœåŠ¡å™¨ç›´æ¥å¼€å¯è¿æ¥å·²å»ºç«‹çŠ¶æ€ ä½†å®¢æˆ·ä¸ä¼šç†ç¬ æµªè´¹èµ„æºï¼‰ è¿æ¥é‡Šæ”¾ å››æŠ¥æ–‡æŒ¥æ‰‹\nè¿‡ç¨‹ï¼š å®¢æˆ·å‘é€è¿æ¥é‡Šæ”¾æŠ¥æ–‡æ®µ è¿›å…¥ç»ˆæ­¢ç­‰å¾…1çŠ¶æ€â€”â€”ä¸»åŠ¨å…³é—­ FIN=1 ACK=1 seq=u ack=v seqæ˜¯å®¢æˆ·å‘é€çš„æœ€åå­—èŠ‚åºå·+1 ackæ˜¯å®¢æˆ·æ”¶åˆ°çš„ï¼ˆæœåŠ¡å™¨å‘é€çš„ï¼‰æœ€åå­—èŠ‚åºå·+1 æœåŠ¡å™¨å‘é€æ™®é€šç¡®è®¤æŠ¥æ–‡æ®µ è¿›å…¥å…³é—­ç­‰å¾…çŠ¶æ€ å¹¶é€šçŸ¥ä¸Šå±‚åº”ç”¨ ACK=1 seq=v ack=u+1 â€”â€”æ­¤æ—¶è¿›å…¥åŠå…³é—­çŠ¶æ€ å®¢æˆ·ä¸å‘é€åªæ¥å— æœåŠ¡å™¨ç»§ç»­å‘é€æ²¡æœ‰å‘å®Œçš„æ•°æ® æœåŠ¡å™¨å‘é€è¿æ¥é‡Šæ”¾æŠ¥æ–‡æ®µ è¿›å…¥æœ€åç¡®è®¤çŠ¶æ€ï¼ˆåº”ç”¨æ•°æ®å‘å®Œ è®©å…¶å…³é—­ï¼‰â€”â€”è¢«åŠ¨å…³é—­ FIN=1 ACK=1 seq=w ack=u+1 seqè¡¨ç¤ºæœåŠ¡å™¨è‡ªå·±å‘é€çš„æœ€åæ•°æ® ackæ˜¯å¯¹å®¢æˆ·å‘æ¥çš„ä¿¡æ¯çš„é‡å¤ç¡®è®¤ å®¢æˆ·å‘é€æ™®é€šç¡®è®¤æŠ¥æ–‡æ®µ è¿›å…¥æ—¶é—´ç­‰å¾…çŠ¶æ€ ACK=1 seq=u+1 ack=w+1 seqè¦æ¶ˆè€—ä¸€ä¸ªåºå· æœåŠ¡å™¨æ¥æ”¶åè¿›å…¥å…³é—­çŠ¶æ€ å®¢æˆ·å‘é€åç»è¿‡2MSLæ—¶é—´è¿›å…¥å…³é—­çŠ¶æ€ MSLâ€”â€”æœ€é•¿æŠ¥æ–‡æ®µå¯¿å‘½ è‹¥å®¢æˆ·ç›´æ¥å…³é—­ ç¡®è®¤æŠ¥æ–‡æ®µè‹¥é—å¤± æœåŠ¡å™¨æ— æ³•å…³é—­ ä¿æ´»è®¡æ—¶å™¨ï¼šæœåŠ¡å™¨æ¯æ”¶åˆ°ä¸€æ¬¡å®¢æˆ·æ•°æ®å°±é‡é‡å¯ä¿æ´»è®¡æ—¶å™¨â€”â€”è‹¥ä¿æ´»å‘¨æœŸå†…æœªæ”¶åˆ° åˆ™å‘é€æ¢æµ‹æŠ¥æ–‡æ®µâ€”â€”è¿ç»­å‘é€æ¢æµ‹ä¸å›å¤ åˆ™æœåŠ¡å™¨å…³é—­è¿æ¥ TCPæŠ¥æ–‡æ®µé¦–éƒ¨æ ¼å¼ å›ºå®šé¦–éƒ¨20å­—èŠ‚ + æ‰©å±•ï¼ˆå¯å˜ï¼‰é¦–éƒ¨æœ€å¤§40å­—èŠ‚ ç»„æˆï¼š æºç«¯å£â€”â€”16bit æ ‡ç¤º å‘é€ æŠ¥æ–‡æ®µçš„ åº”ç”¨è¿›ç¨‹ ç«¯å£å· ç›®çš„ç«¯å£â€”â€”16bit æ¥æ”¶æŠ¥æ–‡æ®µçš„åº”ç”¨è¿›ç¨‹ç«¯å£å· åºå·â€”â€”32bit æœ¬æŠ¥æ–‡æ®µæ•°æ®loadçš„ç¬¬ä¸€ä¸ªå­—èŠ‚åºå· ç¡®è®¤å·â€”â€”32bit è‹¥ä¸ºn è¡¨ç¤ºn-1å·åŠä»¥å‰çš„æ•°æ®éƒ½æ¥æ”¶ éœ€è¦nå·æ•°æ® *ACKä½ä¸º1æ—¶æ‰æœ‰æ•ˆ æ•°æ®åç§»â€”â€”æ•°æ®loadèµ·å§‹å¤„åˆ°æŠ¥æ–‡æ®µèµ·å§‹å¤„æœ‰å¤šè¿œ = TCPæŠ¥æ–‡æ®µé¦–éƒ¨é•¿åº¦ï¼ˆä»¥4å­—èŠ‚ä¸ºå•ä½ï¼‰ çª—å£â€”â€”å‘é€æ–¹çš„æ¥æ”¶çª—å£å¤§å° æµé‡æ§åˆ¶ æ ¡éªŒå’Œâ€”â€”æ£€æŸ¥é¦–éƒ¨ä¸æ•°æ®loadï¼ˆè®¡ç®—æ—¶è¦åœ¨æŠ¥æ–‡æ®µå‰åŠ 12å­—èŠ‚ä¼ªé¦–éƒ¨ï¼‰ SYNåŒæ­¥æ ‡å¿—ä½ ç»ˆæ­¢æ ‡å¿—ä½FIN å¤ä½æ ‡å¿—ä½RSTï¼ˆå¤ä½TCPè¿æ¥ï¼‰â€”â€”å–1æ—¶ è¡¨ç¤ºTCPè¿æ¥å‡ºç°å¼‚å¸¸ éœ€é‡æ–°å»ºç«‹è¿æ¥ å¯ç”¨æ¥æ‹’ç»éæ³•æŠ¥æ–‡æ®µ æ‹’ç»æ‰“å¼€TCPè¿æ¥ æ¨é€æ ‡å¿—ä½PSHï¼šè‹¥ä¸º1 è¯¥æŠ¥æ–‡æ®µä¼šå°½å¿«ä¸Šäº¤åº”ç”¨è¿›ç¨‹ ç´§æ€¥åŠŸèƒ½ï¼šç´§æ€¥æ ‡å¿—ä½URGï¼ˆå–1æœ‰æ•ˆï¼‰+ç´§æ€¥æŒ‡é’ˆï¼ˆæŒ‡æ˜ç´§æ€¥æ•°æ®é•¿åº¦ï¼‰ = ç´§æ€¥æ•°æ®æ”¾åˆ°å‘é€ç¼“å­˜æœ€å‰ ç«‹åˆ»å°è£…åå‘é€â€”â€”æ¥æ”¶ç¼“å­˜ä¸­åŒ æ‰©å±•é¦–éƒ¨ï¼šé€‰é¡¹éƒ¨åˆ†å¯æ·»åŠ å¾ˆå¤šé€‰é¡¹ğŸ‘‡ å¡«å……éƒ¨åˆ†å°†ä¿è¯é¦–éƒ¨èƒ½è¢«4æ•´é™¤ åº”ç”¨å±‚ æ¦‚è¿° æœ€é¡¶å±‚\nå„å±‚åº”ç”¨ å®¢æˆ·/æœåŠ¡å™¨æ–¹å¼ä¸å¯¹ç­‰æ–¹å¼ C/Sæ–¹å¼ä¸P2Pæ–¹å¼ client/server \u0026amp; peer to peer\nC/S å®¢æˆ·è®¡ç®—æœº\u0026amp;æœåŠ¡å™¨è®¡ç®—æœº\nå®¢æˆ·è¯·æ±‚æœåŠ¡ æœåŠ¡å™¨æä¾›æœåŠ¡ æœåŠ¡å™¨å§‹ç»ˆè¿è¡Œ ç­‰å¾…è¯·æ±‚ \u0026amp; å…·æœ‰å›ºå®šç«¯å£å· \u0026amp; è¿è¡ŒæœåŠ¡å™¨çš„ä¸»æœºå…·æœ‰å›ºå®šçš„IPåœ°å€ æœåŠ¡é›†ä¸­å‹â€”â€”ä¼šå‡ºç°æœåŠ¡å™¨è·Ÿä¸ä¸Šå®¢æˆ·æœºè¯·æ±‚çš„æƒ…å†µâ€”â€”ä½¿ç”¨è®¡ç®—æœºç¾¤é›†ï¼ˆæœåŠ¡å™¨åœºï¼‰æ„å»ºè™šæ‹ŸæœåŠ¡å™¨ P2P å¯¹ç­‰æ–¹äº’ä¸ºè¯·æ±‚ä¸æœåŠ¡æ–¹ åŒæ–¹ç›´æ¥é€šä¿¡â€”â€”æœåŠ¡åˆ†æ•£å‹ å¯æ‰©å±•æ€§ï¼ˆè§„æ¨¡å¢å¤§ æ€§èƒ½ä¸é™ä½ï¼‰ åŠ¨æ€ä¸»æœºé…ç½®åè®®DHCP é€šè¿‡DHCPè‡ªåŠ¨è·å–ç½‘ç»œé…ç½®ä¿¡æ¯ C/Sç±»å‹\nç”¨UDPç”¨æˆ·æ•°æ®æŠ¥ä¼ è¾“â€”â€”è®¡ç®—æœºåŠ å…¥æ–°ç½‘ç»œæ—¶å¯è‡ªåŠ¨è·å–ç½‘ç»œé…ç½®ä¿¡æ¯ ä¸»è¦è¿‡ç¨‹ï¼šå®¢æˆ·å¯»æ‰¾DHCPæœåŠ¡å™¨ï¼ˆå¹¿æ’­ï¼‰â€”â€”æœåŠ¡å™¨æä¾›IPåœ°å€ç§Ÿç”¨â€”â€”å®¢æˆ·æ¥æ”¶ç§Ÿçº¦â€”â€”æœåŠ¡å™¨ç¡®è®¤ç§Ÿçº¦â€”â€”å®¢æˆ·å¯¹IPåœ°å€ç»­çº¦â€”â€”å®¢æˆ·éšæ—¶è§£é™¤ç§Ÿçº¦ å®¢æˆ·æœªè·å¾—IPåœ°å€æ—¶ ä½¿ç”¨0.0.0.0 æŒ‘é€‰åœ°å€æ—¶ ä½¿ç”¨ARPç¡®ä¿æŒ‘é€‰çš„åœ°å€æœªè¢«å ç”¨ ä½¿ç”¨å‰ å®¢æˆ·ç”¨ARPæ£€æŸ¥ DHCPä¸­ç»§ä»£ç†ï¼šç»™ä¸å®¢æˆ·ä¸»æœºç›´æ¥ç›¸è¿çš„è·¯ç”±å™¨é…ç½®DHCPæœåŠ¡å™¨çš„IPåœ°å€ ä½¿å…¶æˆä¸ºä¸­ç»§ä»£ç†â€”â€”å°†å¯»æ‰¾çš„æ•°æ®æŠ¥å•æ’­ç»™æœåŠ¡å™¨ å¦åˆ™ä¼šä¸¢å¼ƒå®¢æˆ·çš„å¯»æ‰¾DHCPæœåŠ¡å™¨æ•°æ®æŠ¥ åŸŸåç³»ç»ŸDNS åŸŸåä¾¿äºè®°å¿† ä½†éœ€ç”¨IPåœ°å€è¿›è¡Œè®¿é—® = DNSå¯¹åŸŸåè§£ææˆç›®æ ‡æœåŠ¡å™¨çš„IPåœ°å€\né‡‡ç”¨å±‚æ¬¡ç»“æ„çš„å‘½åæ ‘ä½œä¸ºåŸŸå ä½¿ç”¨åˆ†å¸ƒå¼çš„åŸŸåç³»ç»Ÿ==\u0026gt;å¤§å¤šåŸŸååœ¨æœ¬åœ°è§£æ UDPå°è£… å±‚æ¬¡æ ‘çŠ¶ç»“æ„çš„åŸŸåç³»ç»Ÿ eg.Â·Â·Â·.ä¸‰çº§åŸŸå.äºŒçº§åŸŸå.é¡¶çº§åŸŸå ä¸åŒºåˆ†å¤§å°å†™ å®Œæ•´åŸŸåä¸è¶…è¿‡255å­—ç¬¦ ç‰¹ç‚¹ï¼šå„çº§åŸŸåç”±ä¸Šçº§åŸŸåç®¡ç† åˆ†ç±»ï¼š é¡¶çº§åŸŸåTLDåˆ†ç±»ï¼šå›½å®¶ é€šç”¨ï¼ˆcom govç­‰ï¼‰ åå‘åŸŸï¼ˆIPåœ°å€åå‘è§£æä¸ºåŸŸåï¼‰ è½¬æ¢ï¼šåˆ†å¸ƒåœ¨å„åœ°çš„åŸŸåæœåŠ¡å™¨å®ç°è½¬æ¢ æ ¹åŸŸåæœåŠ¡å™¨ é¡¶çº§åŸŸåæœåŠ¡å™¨ æƒé™åŸŸåæœåŠ¡å™¨ï¼ˆäºŒçº§ä¸‰çº§ç­‰ï¼‰ æœ¬åœ°åŸŸåæœåŠ¡å™¨ï¼ˆé»˜è®¤Â·Â·Â·ï¼‰ æƒé™åŸŸåæœåŠ¡å™¨â€”â€”ç®¡ç†æŸä¸ªåŒºçš„åŸŸå æœ¬åœ°â€”â€”ä»£ç†ä½œç”¨ è½¬å‘æŠ¥æ–‡åˆ°å…¶å®ƒåŸŸåæœåŠ¡å™¨çš„ç­‰çº§ç»“æ„ è§£æè¿‡ç¨‹ï¼šé€’å½’æŸ¥è¯¢ / è¿­ä»£æŸ¥è¯¢ é€’å½’ï¼šä¸»æœº-\u0026gt;æœ¬åœ°-\u0026gt;æ ¹-\u0026gt;é¡¶çº§-\u0026gt;æƒé™-\u0026gt;åå‘å› è¿­ä»£ï¼šä¸»æœº-\u0026gt;æœ¬åœ°-\u0026gt;è¿”å›é¡¶çº§åœ°å€ ä¸»æœº-\u0026gt;é¡¶çº§Â·Â·Â· ä¸»æœº-\u0026gt;æƒé™ ä¸»æœºåˆ°æœ¬åœ°é‡‡ç”¨é€’å½’ å…¶ä½™é‡‡ç”¨è¿­ä»£ é«˜é€Ÿç¼“å­˜ï¼šå­˜æ”¾æœ€è¿‘æŸ¥è¯¢è¿‡çš„åŸŸåä¸IPåœ°å€â€”â€”ä¸ºæ¯ä¸ªé¡¹ç›®è®¾ç½®è®¡æ—¶å™¨ è¶…æ—¶é¡¹åˆ é™¤â€”â€”ä¸éœ€DNSæŸ¥è¯¢ æ–‡ä»¶ä¼ é€åè®®FTP C/Sæ–¹å¼ å¯ç”¨ftp://balabalåŸŸåè®¿é—®\næä¾›äº¤äº’å¼è®¿é—® å…è®¸å®¢æˆ·æŒ‡æ˜æ–‡ä»¶ç±»å‹ä¸æ ¼å¼ å­˜å–æƒé™ å±è”½ç³»ç»Ÿç»†èŠ‚ é€‚åˆåœ¨å¼‚æ„ç½‘ç»œä»»æ„è®¡ç®—æœºé—´å‘é€æ–‡ä»¶ å·¥ä½œåŸç†ï¼š å®¢æˆ·ä¸FTPæœåŠ¡å™¨å»ºç«‹ä¼ é€æ§åˆ¶å‘½ä»¤çš„TCPè¿æ¥ï¼ˆFTPç«¯å£å·20ï¼‰ ï¼ˆå®¢æˆ·å‘ŠçŸ¥ï¼‰æœåŠ¡å™¨å‘èµ·ä¼ é€æ–‡ä»¶çš„TCPè¿æ¥â€”â€”ä¸»åŠ¨æ¨¡å¼ï¼ˆæ•°æ®è¿æ¥ï¼‰ï¼ˆç«¯å£å·21ï¼‰ å®¢æˆ·å‘èµ·ä¼ é€æ–‡ä»¶çš„TCPè¿æ¥â€”â€”è¢«åŠ¨æ¨¡å¼ï¼ˆæ•°æ®è¿æ¥ï¼‰ï¼ˆFTPéšæœºç«¯å£å·ï¼‰ ç”µå­é‚®ä»¶ C/S\nç»„æˆï¼šç”¨æˆ·ä»£ç†ï¼ˆemailå®¢æˆ·ç«¯è½¯ä»¶ï¼‰ + é‚®ä»¶æœåŠ¡å™¨ + ç”µå­é‚®ä»¶æ‰€éœ€åè®®ï¼ˆåŒ…æ‹¬å‘é€ä¸æ¥æ”¶åè®®ï¼‰ æœåŠ¡å™¨å‘ç”¨æˆ·å‘é€â€”â€”POP3åè®®ï¼ˆå…¶å®ƒä¸ºSMTPï¼‰ å…¨éƒ¨å»ºç«‹TCPè¿æ¥ å¸¸ç”¨çš„å‘é€åè®®â€”â€”SMTP å¸¸ç”¨çš„æ¥å—åè®®â€”â€”POP3 SMTP å‘é€æ–¹å‘¨æœŸæ€§æ‰«æé‚®ä»¶ç¼“å­˜ å»ºç«‹TCPè¿æ¥ï¼ˆç«¯å£å·25ï¼‰ å‘é€14æ¡SMTPå‘½ä»¤ æ¥æ”¶æ–¹è¿”å›21ç§SMTPåº”ç­” é’ˆå¯¹å‘é€æ–¹åœ°å€ æ¥æ”¶æ–¹åœ°å€ é‚®ä»¶å†…å®¹ ç»“æŸç¬¦ç­‰éƒ½éœ€äº¤äº’ ç”µå­é‚®ä»¶å‘é€ æ ¼å¼ï¼šä¿¡å°+å†…å®¹ï¼ˆé¦–éƒ¨+ä¸»ä½“ï¼‰ SMTPåªèƒ½ä¼ é€ASCIIç æ•°æ®â€”â€”MIMEå¤šç”¨é€”å› ç‰¹ç½‘é‚®ä»¶æ‰©å±• å‘é€æ–¹éASCIIå†…å®¹ç»è¿‡MIMEè½¬è¯‘ä¸ºASCIIåç»™SMTP æ¥æ”¶æ–¹åŒ MIMEå¢åŠ äº†é‚®ä»¶é¦–éƒ¨å­—æ®µ å†…å®¹æ ¼å¼ ä¼ é€ç¼–ç ç­‰ ä¹Ÿåº”ç”¨äºHTTP æ¥æ”¶ å¸¸ç”¨è¯»å–åè®®ï¼šPOPé‚®å±€åè®® IMAPå› ç‰¹ç½‘é‚®ä»¶è®¿é—®åè®®â€”â€”TCP ç«¯å£POP110\u0026amp;IMAP143 IMAP4å…è®¸ç”¨æˆ·æ“æ§é‚®ä»¶æœåŠ¡å™¨ä¸­çš„é‚®ç®±â€”â€”è”æœºåè®® ä¸‡ç»´ç½‘email ä½¿ç”¨HTTPåè®®ä¸é‚®ä»¶æœåŠ¡å™¨äº¤äº’ ä¸‡ç»´ç½‘WWW è¿è¡Œåœ¨å› ç‰¹ç½‘ä¸Šçš„åˆ†å¸ƒå¼åº”ç”¨ åˆ©ç”¨è¶…é“¾æ¥å°†ä¸åŒç½‘ç«™çš„ç½‘é¡µé“¾æ¥\nä½¿ç”¨ç»Ÿä¸€èµ„æºå®šä½ç¬¦URLæŒ‡æ˜ä½ç½® æ ¼å¼ï¼š\u0026lt;åè®®\u0026gt;://\u0026lt;ä¸»æœº\u0026gt;:\u0026lt;ç«¯å£\u0026gt;/\u0026lt;è·¯å¾„\u0026gt; ä¸‡ç»´ç½‘æ–‡æ¡£ï¼šHTML+CSS+JavaScriptâ€”â€”é€šè¿‡æµè§ˆå™¨æ¸²æŸ“ htmlè¶…æ–‡æœ¬æ ‡è®°è¯­è¨€â€”â€”ç½‘é¡µç»“æ„ä¸å†…å®¹ csså±‚å æ ·å¼è¡¨â€”â€”å®¡ç¾ jsè„šæœ¬â€”â€”æ§åˆ¶ç½‘é¡µè¡Œä¸º HTTP HTTPè¶…æ–‡æœ¬ä¼ è¾“åè®®â€”â€”å®šä¹‰æœåŠ¡å™¨æ€æ ·è¯·æ±‚WWWæ–‡æ¡£ \u0026amp; æœåŠ¡å™¨æ€æ ·ä¼ å›æµè§ˆå™¨ HTTP/1.0é‡‡ç”¨éæŒç»­é“¾æ¥ æ¯æ¬¡è¯·æ±‚æ–‡ä»¶éƒ½éœ€å»ºç«‹TCP 1.1é‡‡ç”¨æŒç»­è¿æ¥ éæµæ°´çº¿æ–¹å¼â€”â€”æ”¶åˆ°ä¸€ä¸ªè¯·æ±‚çš„å“åº”åæ‰å‘é€ä¸‹ä¸€ä¸ªè¯·æ±‚ æµæ°´çº¿ï¼šæ”¶åˆ°å“åº”å‰ å¯ä¸æ–­å‘é€è¯·æ±‚ è¯·æ±‚æŠ¥æ–‡æ ¼å¼ğŸ‘‡ï¼šï¼ˆé¢å‘æ–‡æœ¬ æ¯ä¸ªå­—æ®µéƒ½æ˜¯ASCIIç ä¸² é•¿åº¦ä¸ç¡®å®šï¼‰ æŠ¥æ–‡æ ¼å¼ï¼šçŠ¶æ€ç 202â€”â€”æ­£å¸¸ 400â€”â€”è¯·æ±‚é”™è¯¯ cookieâ€”â€”è®°å½•ç”¨æˆ·ä¿¡æ¯ï¼ˆæµè§ˆå™¨ä¸wwwæœåŠ¡å™¨å»ºç«‹TCPï¼‰ åœ¨æœåŠ¡å™¨ä¸ºç”¨æˆ·ç”Ÿæˆå”¯ä¸€çš„cookieè¯†åˆ«ç  ç»™æµè§ˆå™¨è¿”å›è¯†åˆ«ç  else ç¼“å­˜ä¸ä»£ç†æœåŠ¡å™¨â€”â€”webç¼“å­˜ï¼ˆå®¢æˆ·æœº ä¸­é—´ç³»ç»Ÿï¼ˆä»£ç†æœåŠ¡å™¨ï¼‰ä¸Šéƒ½å¯ï¼‰ æœ€è¿‘çš„è¯·æ±‚ä¸å“åº”æš‚å­˜åœ¨disk ","permalink":"https://Sattiluvcat.github.io/en/posts/notes/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/","summary":"æ‰€æœ‰å›¾ç‰‡æ¥è‡ªï¼šè®¡ç®—æœºç½‘ç»œå¾®è¯¾å ‚ï¼ˆæœ‰å­—å¹•æ— èƒŒæ™¯éŸ³ä¹ç‰ˆï¼‰ï¼Œé“¾æ¥è§æ–‡ç« ","title":"è®¡ç®—æœºç½‘ç»œ"},{"content":"Â Bi-RRT åŸç† åŸºæœ¬åè¯ çŠ¶æ€ç©ºé—´ï¼šç³»ç»Ÿå…¨éƒ¨å¯èƒ½çŠ¶æ€çš„é›†åˆ RRTåŸç† RRT(Rapidly exploring Random Tree å¿«é€Ÿéšæœºæœç´¢æ ‘)æ˜¯ä¸€ç§å…¨å±€è§„åˆ’ç®—æ³•\nå·²çŸ¥ï¼š\nåˆå§‹çŠ¶æ€ï¼ˆèµ·ç‚¹ä½ç½®ï¼‰$q_{start}$ ç›®æ ‡çŠ¶æ€ï¼ˆç»ˆç‚¹ä½ç½®ï¼‰$q_{goal}$ æœç´¢æ­¥é•¿ ${\\rho}$ ç³»ç»ŸçŠ¶æ€ç©ºé—´ $C$ è‡ªç”±çŠ¶æ€ç©ºé—´ $C_{free}$ $C_{free}{\\subset}C$ï¼Œæ˜¯ $C$ ä¸­ä¸ä¼šå‘ç”Ÿç¢°æ’çš„çŠ¶æ€é›†åˆ ç›®æ ‡çŠ¶æ€ç©ºé—´ $C_{goal}$ æœ‰ $k$ ä¸ªèŠ‚ç‚¹çš„å¿«é€Ÿéšæœºæœç´¢æ ‘ $T_k$ è¿‡ç¨‹ï¼š\nç”Ÿæˆéšæœºç‚¹ï¼šåœ¨è‡ªç”±çŠ¶æ€ç©ºé—´ $C_{free}$ ä¸­éšæœºé‡‡ä¸€ä¸ªçŠ¶æ€ç‚¹ $q_{rand}$ï¼ŒåŒæ—¶ä¿è¯ $q_{rand}{\\notin}T_k$ æŸ¥æ‰¾æœ€è¿‘ç‚¹ï¼šéå†ç°æœ‰çš„éšæœºæœç´¢æ ‘ $T_k$ å¯»æ‰¾ä¸ $q_{rand}$ æœ€è¿‘çš„èŠ‚ç‚¹ $q_{near}$ï¼Œæ»¡è¶³ï¼š$DIS(q_{near},q_{rand})\u0026lt;=DIS(q_i,q_{rand})$ï¼Œå…¶ä¸­ $q_{rand}{\\in}T_k$ è®¡ç®—æ–°èŠ‚ç‚¹ï¼šä» $q_{near}$ å‘ $q_{rand}$ æ–¹å‘æ‹“å±•è·ç¦» ${\\rho}$ å¾—åˆ° $q_{new}$ï¼Œæ£€æŸ¥è¯¥è·¯å¾„æ˜¯å¦ä¼šå‘ç”Ÿç¢°æ’ã€‚ è‹¥ä¼šå‘ç”Ÿç¢°æ’ï¼Œè¿”å›1. ä¸ä¼šå‘ç”Ÿç¢°æ’ï¼Œåˆ™å°† $q_{new}$ æ·»åŠ åˆ° $T_k$ ä¸­ è®¡ç®—å…¬å¼ï¼š $$q_{\\text {new }}=q_{\\text {near }}+\\varepsilon \\frac{q_{\\text {rand }}-q_{\\text {near }}}{\\left|q_{\\text {rand }}-q_{\\text {near }}\\right|}$$ åˆ°è¾¾æ£€æŸ¥ï¼šè‹¥èŠ‚ç‚¹ $q_{new}$ å®ç° $DIS(q_{new},q_{goal})\u0026lt;{\\rho}$ï¼Œè¯æ˜å·²ç»åˆ°è¾¾ç»ˆç‚¹ï¼Œæ·»åŠ  $q_{goal}$ åˆ° $T_k$ ï¼Œæœç´¢ç»“æŸã€‚è‹¥ $DIS(q_{new},q_{goal})\u0026gt;{\\rho}$ï¼Œè¿”å›1. å¾—åˆ°è·¯å¾„ï¼šä» $q_{goal}$ å¼€å§‹åå‘å›æº¯äº²èŠ‚ç‚¹ç›´åˆ° $q_{start}$ï¼Œå½¢æˆå®Œæ•´è·¯å¾„ $L$ graph LR ç”Ÿæˆéšæœºç‚¹--\u0026gt;ç”Ÿæˆæ–°èŠ‚ç‚¹ ç”Ÿæˆæ–°èŠ‚ç‚¹--\u0026gt;ç¢°æ’æ£€æŸ¥ ç”Ÿæˆæ–°èŠ‚ç‚¹-----\u0026gt;åˆ°è¾¾æ£€æŸ¥ åˆ°è¾¾æ£€æŸ¥--\u0026gt;|ä¸æˆåŠŸ|é‡æ–°ç”Ÿæˆéšæœºç‚¹ ç¢°æ’æ£€æŸ¥---\u0026gt;|ä¸æˆåŠŸ|é‡æ–°ç”Ÿæˆéšæœºç‚¹ ç¢°æ’æ£€æŸ¥--\u0026gt;|æˆåŠŸ|æ‰©å±•æ ‘ æ‰©å±•æ ‘--\u0026gt;é‡æ–°ç”Ÿæˆéšæœºç‚¹ åˆ°è¾¾æ£€æŸ¥---\u0026gt;|æˆåŠŸ|ç»“æŸ Bi-RRTåŸç† ä»èµ·ç‚¹ã€ç»ˆç‚¹åŒæ—¶å¼€å§‹éšæœºæœç´¢æ ‘çš„æ„å»º\nå¦å¤–å·²çŸ¥ï¼š\nä»èµ·ç‚¹å¼€å§‹æ„å»ºçš„éšæœºæœç´¢æ ‘çš„æ–°èŠ‚ç‚¹ä¸º $q_{new-start}$ ä»ç»ˆç‚¹å¼€å§‹æ„å»ºçš„éšæœºæœç´¢æ ‘çš„æ–°èŠ‚ç‚¹ä¸º $q_{new-goal}$ ä»èµ·ç‚¹å¼€å§‹æ„å»ºçš„éšæœºæœç´¢æ ‘ä¸º $T_{k-start}$ ä»ç»ˆç‚¹å¼€å§‹æ„å»ºçš„éšæœºæœç´¢æ ‘ä¸º $T_{k-goal}$ å°†ä¸Šæ–‡RRTæ„å»ºè¿‡ç¨‹çš„4.åˆ°è¾¾æ£€æŸ¥ä¿®æ”¹ä¸ºå¦‚ä¸‹æ£€æŸ¥:\nè‹¥èŠ‚ç‚¹ $q_{new-start}$ å®ç° $DIS(q_{new-start},q_{new-goal})\u0026lt;{\\rho}$ï¼Œ è¯æ˜å·²ç»åˆ°è¾¾ç»ˆç‚¹ï¼Œæ·»åŠ  $q_{new-goal}$ åˆ° $T_{k-goal}$ ï¼Œæœç´¢ç»“æŸã€‚è‹¥ $DIS(q_{new-start},q_{new-goal})\u0026gt;{\\rho}$ï¼Œè¿”å›1. å°†ä¸Šæ–‡RRTæ„å»ºè¿‡ç¨‹çš„5.å¾—åˆ°è·¯å¾„ä¿®æ”¹ä¸ºå¦‚ä¸‹è¿‡ç¨‹:\nä» $q_{new-goal}$ å¼€å§‹åŒæ—¶å‘èµ·ç‚¹ã€ç»ˆç‚¹å›æº¯äº²èŠ‚ç‚¹ç›´åˆ° $q_{start}$ ä¸ $q_{goal}$ï¼Œå½¢æˆå®Œæ•´è·¯å¾„ RRT-ConnectåŸç† ä¸Bi-RRTå¤§è‡´ç›¸åŒ\nç›¸å¯¹äºBi-RRTï¼ŒRRT-Connectè™½ç„¶ä¹Ÿæ˜¯èµ·ç»ˆç‚¹åŒæ—¶å¼€å§‹ä¸¤æ¡è·¯å¾„ï¼Œä½†æ˜¯ä»èµ·ç‚¹æ–¹å‘ç”Ÿæˆéšæœºç‚¹ï¼Œ ç”¨ç»ˆç‚¹çš„éšæœºæœç´¢æ ‘å‘å…¶è¿›è¡Œæ‹“å±•ï¼Œåä¹‹äº¦ç„¶ åˆ†æ å‡ºå…¥ ï¼ˆç”Ÿæˆéšæœºç‚¹ï¼‰ç¨‹åºå®é™…åœ¨ $C$ ä¸­éšæœºé‡‡æ ·ï¼Œä¹Ÿæœªé¿å…å…¶åœ¨ $T_k$ ä¸­ï¼›å¯èƒ½é€ æˆå†—ä½™ï¼Œåœ¨ç‹­çª„å¤æ‚ç¯å¢ƒä¸­å¯èƒ½ä¼šå¯¼è‡´æ”¶æ•›é€Ÿåº¦å‡æ…¢ å…¶ä»–é—®é¢˜ ï¼ˆç”Ÿæˆéšæœºç‚¹ï¼‰åœ¨æ•´ä¸ªè‡ªç”±çŠ¶æ€ç©ºé—´ä»»ä½•ä½ç½®ä»¥ç›¸åŒæ¦‚ç‡ç”Ÿæˆéšæœºç‚¹ï¼Œç¼ºå°‘å¯¹ç›®æ ‡ç‚¹çš„æŒ‡å‘æ€§ ï¼ˆè®¡ç®—æ–°èŠ‚ç‚¹ï¼‰ä»»ä½•èŠ‚ç‚¹çš„æ‹“å±•è·ç¦»éƒ½ç›¸åŒï¼Œç¼ºå°‘ç©ºé—´æ•æ„Ÿæ€§ eg.åœ¨ç©ºæ—·ä½ç½®å¯ä»¥é€‚å½“å¢é•¿æ‹“å±•è·ç¦» ï¼ˆè®¡ç®—æ–°èŠ‚ç‚¹ï¼‰é‡åˆ°éšœç¢æ—¶å›é€€åˆ°1.ç”Ÿæˆéšæœºç‚¹ï¼Œå¯ä»¥è€ƒè™‘ä¸å›é€€ï¼Œé€šè¿‡æ›´æ¢æ–¹å‘é¿éšœ ï¼ˆåˆ°è¾¾æ£€æŸ¥ï¼‰ç”¨ $DIS(q_{new},q_{goal})\u0026lt;{\\rho}$ è¿›è¡Œåˆ°è¾¾æ£€æŸ¥ï¼Œå¯èƒ½åœ¨ç»ˆç‚¹ é™„è¿‘éœ€è¦ä¸åŒçš„æ ‡å‡† æ”¹è¿›ç‚¹ ï¼ˆç”Ÿæˆéšæœºç‚¹ï¼‰å¼•å…¥äººå·¥åŠ¿åœº/å…¶ä»–æ–¹æ³•æé«˜éšæœºç‚¹æŒ‡å‘æ€§ \u0026amp; åœ¨è‡ªç”±çŠ¶æ€ç©ºé—´ä¸­ç”Ÿæˆéšæœºç‚¹ ï¼ˆæŸ¥æ‰¾æœ€è¿‘ç‚¹ï¼‰æœ€è¿‘ç‚¹çš„åº¦é‡æ–¹å¼åœ¨åŸºç¡€ç®—æ³•ä¸­æ˜¯æœ€åŸºç¡€çš„å‡ ä½•è·ç¦»ï¼Œå¯ä»¥æ›´æ”¹åº¦é‡æ–¹å¼ å‰ªæå¤„ç†â€”â€”ç”Ÿæˆçš„è·¯å¾„æœ‰è¾ƒå¤šæŠ˜è§’ä¸ç´¯èµ˜è·¯å¾„ï¼Œå¯è¿›è¡Œå‰ªæå¤„ç† å¯¹å¾—åˆ°çš„è·¯å¾„ $L$ï¼Œä» $q_{goal}$ï¼ˆè§†ä¸ºå½“å‰èµ·å§‹ç‚¹ $q_{now}$ï¼‰å¼€å§‹åˆ†åˆ«ä¸å…¶åçš„èŠ‚ç‚¹è¿æ¥å¹¶è¿›è¡Œç¢°æ’æ£€æŸ¥ è‹¥åœ¨è¿æ¥ $q_{now}$ ä¸æŸèŠ‚ç‚¹ $q_{collision}$ æ—¶å‘ç”Ÿç¢°æ’ï¼Œå›é€€åˆ° $q_{collision}$ çš„äº²èŠ‚ç‚¹ $q_{no-collision-near}$ï¼Œ å¹¶è¿æ¥ $q_{now}$ ä¸ $q_{no-collision-near}$ å½¢æˆæ–°è·¯å¾„çš„ä¸€éƒ¨åˆ† ä» $q_{no-collision}$ å¼€å§‹é‡å¤3.1.ï¼Œç›´åˆ°æŸä¸ª $q_{now}$ è¿æ¥åˆ° $q_{goal}$ ï¼ˆåˆ°è¾¾æ£€æŸ¥ï¼‰æ ¹æ®å®ä¾‹å¯¹åˆ°è¾¾æ£€æŸ¥ç²¾åº¦è¿›è¡Œä¿®æ”¹ è·¯å¾„æŠ˜è§’å¤šï¼Œå¯é€šè¿‡æ ·æ¡æ›²çº¿å¯¹è·¯å¾„è¿›è¡Œå…‰é¡º \u0026amp; ç”Ÿæˆè·¯å¾„æ—¶è¿›è¡Œè½¬è§’ä¼˜åŒ– æºç ä¸­è½¬è§’é€šè¿‡è§’åº¦å¸¸é‡è¿›è¡Œç®€å•çº¦æŸï¼Œå¯è€ƒè™‘ç»“åˆè¿åŠ¨æ–¹ç¨‹ å®ç° ç”Ÿæˆéšæœºç‚¹ def get_random_node(x_min, x_max, y_min, y_max, goal_point=None): # æ­¤å¤„åœ¨ç›®æ ‡ç‚¹æ–¹å‘å¢åŠ ç”Ÿæˆæ¦‚ç‡ if goal_point is not None and random.random() \u0026lt;= 0.2: x = goal_point[0] y = goal_point[1] else: x = random.uniform(x_min, x_max) y = random.uniform(y_min, y_max) rnd_node = Node(x, y) return rnd_node æŸ¥æ‰¾æœ€è¿‘ç‚¹ def get_nearest_node_index(node_list, rnd_node): dlist = [] # éå†éšæœºæœç´¢æ ‘ for node in node_list: dis = calc_p2p_dis(node, rnd_node) dlist.append(dis) minind = dlist.index(min(dlist)) # è¿”å›è·ç¦»æœ€è¿‘çš„ç‚¹ return minind è®¡ç®—æ–°èŠ‚ç‚¹ def generate_new_node(nearest_node, random_node, extend_length): new_node = Node(nearest_node.x, nearest_node.y) d = math.sqrt((random_node.x - nearest_node.x) ** 2 + (random_node.y - nearest_node.y) ** 2) if extend_length \u0026gt; d: extend_length = d dx = random_node.x - nearest_node.x dy = random_node.y - nearest_node.y if dx * dx + dy * dy == 0: return random_node # æ–°èŠ‚ç‚¹è®¡ç®—å…¬å¼ new_node.x += extend_length / math.sqrt(dx * dx + dy * dy) * dx new_node.y += extend_length / math.sqrt(dx * dx + dy * dy) * dy # å»ºç«‹èŠ‚ç‚¹çš„è¿æ¥ï¼ˆäº²èŠ‚ç‚¹ï¼‰ new_node.parent = nearest_node return new_node ç¢°æ’æ£€æŸ¥ï¼ˆåœ†å½¢/çŸ©å½¢éšœç¢ç‰©ï¼‰ def check_collision(node1, node2, obstacleList): for [ox, oy, size] in obstacleList: round = Node(ox, oy) # å¢åŠ éšœç¢ç‰©çš„åŠå¾„ä¸ºsize_new é¿å…å®é™…æƒ…å†µä¸‹çš„ç¢°æ’ size_new = size if node2 is None: return False if calc_p2p_dis(node1, round) \u0026lt;= size_new: return True # å‘ç”Ÿç¢°æ’ if calc_p2p_dis(node2, round) \u0026lt;= size_new: return True # è‹¥ç‚¹çº¿è·å°äºâ€œåŠå¾„â€ä¸”è¯¥çº¿æ®µå¯èƒ½å‡ºç°åœ¨åœ†å†… if calc_p2l_dis(node1, node2, round) \u0026lt;= size_new and calc_triangle_deg(node1, round, node2) \u0026lt;= 90 and \\ calc_triangle_deg(node2, round, node1) \u0026lt;= 90: return True elif len(obstacle) == 4: # çŸ©å½¢éšœç¢ç‰©ç”¨å†…ç½®å‡½æ•°åˆ¤æ–­ rect_shape = box(obstacle[0], obstacle[1], obstacle[2], obstacle[3]) if not isinstance(node1, list): line = LineString([(node1.x, node1.y), (node2.x, node2.y)]) else: line = LineString([(node1[0], node1[1]), (node2[0], node2[1])]) if line.intersects(rect_shape): return True return False # ä¸ç¢°æ’ Bi-RRTåˆ°è¾¾æ£€æŸ¥ä¸è·¯å¾„ç”Ÿæˆ # æ¯æ¬¡ç”Ÿæˆä¸€è½®ï¼ˆä¸¤ä¸ªï¼‰æ–°èŠ‚ç‚¹åéƒ½å¯¹æ•´ä¸ªè·¯å¾„è¿›è¡Œéå†ï¼Œæ£€æŸ¥ä¸¤ä¸ªè·¯å¾„ä¸­å¯å¦å„æœ‰ä¸€ä¸ªç‚¹ç›¸è¿ç”Ÿæˆè·¯å¾„ for node1 in node_list1: for node2 in node_list2: if calc_p2p_dis(node1, node2) \u0026lt;= extend_length and \\ check_collision(node1, node2, obs_list) == False: # ç”Ÿæˆä»èµ·ç‚¹åˆ°ç›¸äº¤ç‚¹çš„è·¯å¾„ path1 = [] node = node1 while node is not None: path1.append([node.x, node.y]) node = node.parent path1.reverse() # åè½¬è·¯å¾„ï¼Œä½¿å…¶ä»èµ·ç‚¹å¼€å§‹ # ç”Ÿæˆä»ç»ˆç‚¹åˆ°ç›¸äº¤ç‚¹çš„è·¯å¾„ path2 = [] node = node2 while node is not None: path2.append([node.x, node.y]) node = node.parent # åˆå¹¶ä¸¤æ¡è·¯å¾„ path = path1 + path2 æ­¤å¤„å¯ä»¥ä¼˜åŒ–ä¸ºåªç”¨æ–°ç”Ÿæˆçš„ç‚¹æ¥è¯•éªŒèƒ½å¦è¿ä¸Šï¼ˆå·²å®Œæˆ ä¸ä¸Šæ–‡ç¨‹åºç±»ä¼¼ çœç•¥ï¼‰\nå‰ªæ def prune_path(path, obs_list): pruned_path = [path[0]] i = 0 while i \u0026lt; len(path) - 1: found = False # ä»ç»ˆç‚¹å¼€å§‹éªŒè¯ æ‰¾åˆ°ç¬¬ä¸€ä¸ªä¸ç¢°æ’çš„ï¼ˆåä¹‹æœ‰æ¼æ´ for j in range(len(path) - 1, i, -1): if not check_collision(path[i], path[j], obs_list): pruned_path.append(path[j]) # æ›´æ–°èµ·ç‚¹ i = j found = True break if not found: # ç¡®ä¿è·¯å¾„å‰è¿› i += 1 if pruned_path[-1] != path[-1]: pruned_path.append(path[-1]) return pruned_path æ•ˆæœ å•å‘RRT\u0026amp;ä¸å‰ªæ\nå•å‘RRT\u0026amp;å‰ªæ\nåŒå‘RRT\u0026amp;å‰ªæ\né€‚ç”¨ åŸºäºéšæœºé‡‡æ ·çš„æ ‘å½¢è·¯å¾„è§„åˆ’ç®—æ³•\né€‚ç”¨äºéå‡¸é«˜ç»´çŠ¶æ€ç©ºé—´ \u0026amp; åŠ¨æ€ç¯å¢ƒ å¯ä»¥å¿«é€Ÿç”Ÿæˆå¯è¡Œè·¯å¾„ å®¹æ˜“å¤„ç†åŒ…å«éšœç¢ç‰©ã€å·®åˆ†è¿åŠ¨çº¦æŸçš„åœºæ™¯ å·®åˆ†è¿åŠ¨çº¦æŸâ€”â€”æ¯ä¸ªçº¦æŸæ¡ä»¶ç”±å…¶ä¸­ä¸¤ä¸ªå˜é‡ä½œå·®æ„æˆ éœ€å¾—å‡ºæ»¡è¶³æ‰€æœ‰çº¦æŸæ¡ä»¶çš„è§£ æ— éœ€æ¢¯åº¦ä¿¡æ¯ é€‚ç”¨æœªçŸ¥ç¯å¢ƒï¼ˆç›®æ ‡å‡½æ•°æœªçŸ¥ï¼‰ Bi-RRT* åŸç† åœ¨Bi-RRTçš„åŸºç¡€ä¸Šå¢åŠ é‡å†™ï¼ˆrewriteï¼‰ä¸é‡å¸ƒçº¿ï¼ˆrewireï¼‰åŠŸèƒ½\nå¦å¤–å·²çŸ¥ï¼š\nç”Ÿæˆçš„éšæœºç‚¹ $q_{rand}$ éšæœºæœç´¢æ ‘ä¸Šè·ç¦»éšæœºç‚¹æœ€è¿‘çš„æ ‘èŠ‚ç‚¹ $q_{near}$ ä»æ ‘èŠ‚ç‚¹å»¶ä¼¸å‡ºæ¥çš„æ–°èŠ‚ç‚¹ $q_{new}$ é‡å†™æ“ä½œæœç´¢èŒƒå›´ $R_{write}$ é‡å¸ƒçº¿æ“ä½œæœç´¢èŒƒå›´ $R_{wire}$ éšæœºæœç´¢æ ‘ä¸Šæ¯ä¸ªèŠ‚ç‚¹ $q$ å…³è”çš„æˆæœ¬ $C(q)$ï¼Œå®šä¹‰ä¸ºï¼š $$C(q)=C(q_{parent})+DIS(q_{parent},q)$$ è¿‡ç¨‹ï¼š\né‡å†™Rewrite æ½œåœ¨äº²èŠ‚ç‚¹é›†åˆï¼šåœ¨Bi-RRTæ–¹æ³•çš„æ­¥éª¤3.è®¡ç®—æ–°èŠ‚ç‚¹ç¡®è®¤ $q_{new}$ æœ‰æ•ˆæ€§åï¼Œåœ¨ä»¥ $q_{new}$ ä¸ºåœ†å¿ƒï¼Œ $R_{write}$ ä¸ºåŠå¾„çš„èŒƒå›´å†…å¯»æ‰¾éšæœºæœç´¢æ ‘ $T_k$ ä¸Šæ‰€æœ‰èŠ‚ç‚¹ï¼Œå¹¶å°†èŠ‚ç‚¹é›†åˆè§†ä¸º $q_{new}$ æ½œåœ¨çš„äº²èŠ‚ç‚¹é›†åˆ $Q_{near}$ æ›´æ–°äº²èŠ‚ç‚¹ï¼šè®¡ç®—é€šè¿‡ $Q_{near}$ ä¸­æ¯ä¸ªäº²èŠ‚ç‚¹åˆ° $q_{new}$ çš„æˆæœ¬ $C(Q_{new})$ é€‰æ‹©æˆæœ¬æœ€å°çš„èŠ‚ç‚¹ä¸º $q_{new}$ çš„æ–°äº²èŠ‚ç‚¹ï¼Œæ›´æ–° $T_k$ã€‚å³æ»¡è¶³ï¼š $$C\\left(q_{\\text {new }}\\right)=\\min \\left{C\\left(q_{\\text {near }}\\right)+\\operatorname{DIS}\\left(q_{\\text {near }}, q_{\\text {new }}\\right) \\mid q_{\\text {near }} \\in Q_{\\text {near }}\\right}$$ é‡å¸ƒçº¿Rewire è®¡ç®—æˆæœ¬ï¼šé‡å†™Rewriteçš„2.æ“ä½œåï¼Œä»¥ $q_{new}$ ä¸ºåœ†å¿ƒï¼Œ $R_{wire}$ ä¸ºåŠå¾„çš„èŒƒå›´å†…å¯»æ‰¾éšæœºæœç´¢æ ‘ $T_k$ ä¸Šæ‰€æœ‰èŠ‚ç‚¹ $Q_{near}\u0026rsquo;$ï¼Œé€ä¸ªæ¯”è¾ƒå°†è¿™äº›èŠ‚ç‚¹çš„äº²èŠ‚ç‚¹è®¾ç½®ä¸º $q_{new}$ çš„æˆæœ¬ä¸åŸæˆæœ¬ $C(q_{near}\u0026rsquo;)$ æ›´æ–°äº²èŠ‚ç‚¹ï¼šæ»¡è¶³ä¸‹å¼æ—¶å°† $q_{near}\u0026rsquo;$ çš„äº²èŠ‚ç‚¹æ›´æ–°ä¸º $q_{new}$ï¼š $$C(q_{new})+DIS(q_{new},q_{near}\u0026rsquo;)\u0026lt;C(q_{near}\u0026rsquo;) \\mid q_{{near}}\u0026rsquo; \\in Q_{{near}}\u0026rsquo;$$ ç»§ç»­Bi-RRTçš„4. 5.æ­¥éª¤ åˆ†æ ä¼˜åŒ– ç›¸æ¯”Bi-RRTï¼Œä»¥æ¯ä¸ªæ–°èŠ‚ç‚¹ä¸ºä¸­å¿ƒï¼Œåœ¨å°åŒºåŸŸå†…æ›´æ–°äº²èŠ‚ç‚¹é€‰æ‹©æœ€ä¼˜æƒ…å†µï¼ˆä»¥æ–°èŠ‚ç‚¹ä¸ºä¸»è¦ä¼˜åŒ–å¯¹è±¡ï¼‰ï¼Œæ”¾å¤§åˆ°å…¨è·¯å¾„å®ç°æ•´ä½“ä¼˜åŒ– æ”¹è¿›æ–¹æ¡ˆ æ›´æ–°æˆæœ¬å‡½æ•°å®šä¹‰ï¼Œå¯ä»¥å¼•å…¥å¤–éƒ¨å˜é‡å¯¹æˆæœ¬è¿›è¡ŒæŠŠæ§ æœç´¢åŒºåŸŸèŒƒå›´å¤§å°å¯æ›´æ–°ï¼Œæœç´¢åŒºåŸŸå½¢çŠ¶ç­‰ä¹Ÿå¯æ ¹æ®å®é™…éœ€è¦å…·ä½“è°ƒæ•´ RRTç®—æ³•å¯¹éšœç¢ç‰©çš„åŠ¨æ€ã€é™æ€å¹¶æ— è¦æ±‚ï¼Œåªé€šè¿‡é¿ç¢°å‡½æ•°è¿›è¡Œéšœç¢ç‰©åˆ¤æ–­ï¼ˆå…¶ä»–æ—¶å€™æ— å½±å“ï¼‰ï¼Œå¯ä»¥å¼•å…¥åŠ¨éšœç¢è¿›è¡Œè¯•éªŒ å®ç° é‡å†™Rewrite\ndef rewrite_index(node_new, node_list, obstacle_list): r = 8 # æœç´¢èŒƒå›´ min_cost = float(\u0026#39;inf\u0026#39;) min_node_index = None for i, node in enumerate(node_list): # ç¡®å®šæ½œåœ¨äº²èŠ‚ç‚¹é›†åˆ if calc_p2p_dis(node_new, node) \u0026lt; r and not check_collision(node_new, node, obstacle_list): # è®¡ç®—æˆæœ¬å‡½æ•° potential_cost = node.cost + calc_p2p_dis(node_new, node) # æ ¹æ®æˆæœ¬å‡½æ•°æ›´æ–°äº²èŠ‚ç‚¹ç´¢å¼• if potential_cost \u0026lt; min_cost: min_cost = potential_cost min_node_index = i return min_node_index é‡å¸ƒçº¿Rewire\ndef rewire(node_new, node_list, obstacle_list): r = 30 # æœç´¢èŒƒå›´ for node in node_list: # æ’é™¤node_newçš„äº²èŠ‚ç‚¹ if node != node_new.parent and calc_p2p_dis(node_new, node) \u0026lt; r: potential_cost = node_new.cost + calc_p2p_dis(node, node_new) # æ ¹æ®æˆæœ¬å‡½æ•°æ›´æ–°äº²èŠ‚ç‚¹ if potential_cost \u0026lt; node.cost and check_collision(node, node_new, obstacle_list) is False: # if potential_cost \u0026lt; node.cost: node.parent = node_new node.cost = potential_cost æ•ˆæœ Bi-RRT*\nç›¸è¾ƒBi-RRTï¼Œè·¯å¾„æŠ˜è§’å‡å°‘ï¼Œä¼˜åŒ–æ•ˆæœè¾ƒä¸ºæ˜æ˜¾ Bi-RRT*åŠ å‰ªæ\nç›¸è¾ƒBi-RRTåŠ å‰ªæï¼Œæ˜æ˜¾å‡å°‘è·¯å¾„èŠ‚ç‚¹ï¼Œè·¯å¾„æ›´ç®€å• é€‚ç”¨ è§£å†³RRTéš¾ä»¥æ±‚è§£æœ€ä¼˜çš„å¯è¡Œè·¯å¾„çš„é—®é¢˜\nå¼•å…¥è·¯å¾„æˆæœ¬ é€šè¿‡æœ€å°åŒ–è·¯å¾„æˆæœ¬æå‡è·¯å¾„è´¨é‡ æ¸è¿›åœ°å‘å…¨å±€æœ€ä¼˜è§£æ”¶æ•› Bi-RRT*+DWA DWAåŸç† å¼•å…¥æœºå™¨äººè¿åŠ¨æ–¹ç¨‹ ç›¸å½“äºå¯¹æœºå™¨äººè¿åŠ¨è·¯å¾„çš„æ¨¡æ‹Ÿ\nå·²çŸ¥å˜é‡ å‡è®¾ä¸ºå…¨å‘ç§»åŠ¨æœºå™¨äºº æœºå™¨äººç§»åŠ¨é€Ÿåº¦ï¼š$v_x, v_y$ é€Ÿåº¦ç©ºé—´ï¼š$v, \\omega$ï¼Œä»¥ä¸‹åˆ—å‡ºå¯èƒ½é™åˆ¶é€Ÿåº¦çš„å› ç´ ï¼š è‡ªèº«èƒ½åˆ°è¾¾çš„æ‰€æœ‰çŸ¢é‡é€Ÿåº¦ï¼š $$ V_{\\mathrm{s}}=\\left{(v, \\omega) \\mid v \\in\\left[v_{\\min }, v_{\\max }\\right] \\wedge \\omega \\in\\left[\\omega_{\\min }, \\omega_{\\max }\\right]\\right} $$ å—ç”µæœºæ€§èƒ½å½±å“â€”â€”è®¾å®šåŠ é€Ÿåº¦çš„æœ€å¤§æœ€å°å€¼ï¼ˆåŒ…æ‹¬åˆ¹è½¦ï¼‰ååœ¨ä¸€å®šæ—¶é—´å†…èƒ½åˆ°è¾¾çš„é€Ÿåº¦ï¼š $$V_d=\\left{(v, \\omega) \\mid v \\in\\left[v_c-\\dot{v}_b \\Delta t, v_c+\\dot{v}_a \\Delta t\\right] \\wedge \\omega \\in\\left[\\omega_c-\\dot{\\omega}_b \\Delta t, \\omega_c+\\dot{\\omega}_a \\Delta t\\right]\\right}$$ éšœç¢ï¼š $$V_a=\\left{(v, \\omega) \\mid v \\leq \\sqrt{2 \\operatorname{dist}(v, \\omega) \\dot{v}_b} \\wedge \\omega \\leq \\sqrt{2 \\operatorname{dist}(v, \\omega) \\dot{\\omega}_b}\\right}$$ è¯„ä»·å‡½æ•°ï¼š $$G(v, \\omega)=\\sigma(\\alpha * \\operatorname{heading}(v, \\omega)+\\beta * \\operatorname{dist}(v, \\omega)+\\gamma * \\operatorname{vel}(v, \\omega))$$ $heading(v,\\omega)$ æ–¹ä½è§’è¯„ä»·å‡½æ•°â€”â€”è½¨è¿¹æœ«ç«¯æœå‘ä¸ç›®æ ‡ç‚¹é—´çš„è§’åº¦å·®è· $dist(v,\\omega)$ è·ç¦»è¯„ä»·å‡½æ•°â€”â€”è·¯å¾„æœ«ç«¯ä¸æœ€è¿‘éšœç¢ç‰©çš„è·ç¦» $velocity(v,\\omega)$ å½“å‰æœºå™¨äººçš„çº¿é€Ÿåº¦ $\\alpha \\beta \\gamma \\sigma$ä¸ºæƒé‡ç³»æ•° åŸç† é€Ÿåº¦ç©ºé—´åŠ¨æ€çª—å£ï¼šåœ¨å—é™åˆ¶çš„é€Ÿåº¦ç©ºé—´å†…è¿›è¡Œé‡‡æ ·ï¼Œé€‰æ‹©ä¸åŒçš„$v,\\omega$ åœ¨ä¸€å®šæ—¶é—´æ®µå†…æ ¹æ®è¿åŠ¨å­¦æ¨¡å‹å¯ç”Ÿæˆå¤šç§è½¨è¿¹ è¯„ä»·å‡½æ•°é€‰æ‹©è·¯å¾„ï¼šé€šè¿‡è¯„ä»·å‡½æ•°å¯¹æ‰€æœ‰å¯èƒ½è½¨è¿¹æ‰“åˆ† é€‰æ‹©æœ€ä¼˜è·¯å¾„ Bi-RRT*+DWAåŸç† æ ¹æ®å·²çŸ¥éšœç¢ç‰©é€šè¿‡Bi-RRT*æ–¹æ³•ç”Ÿæˆè·¯å¾„ æœºå™¨äººæ²¿è·¯å¾„å¼€å§‹è¿åŠ¨ï¼Œé€‰æ‹©$\\Delta t$ï¼Œå¯¹æœºå™¨äººå‰æ–¹$\\Delta L$é•¿åº¦çš„è·¯å¾„è¿›è¡Œç¢°æ’æ£€æµ‹ è‹¥ç¢°æ’æ£€æµ‹é€šè¿‡ï¼Œä¸é‡‡ç”¨DWAæ–¹æ³•ï¼›è‹¥ä¸èƒ½é€šè¿‡ï¼Œè¿›å…¥DWAçŠ¶æ€è¿›è¡ŒåŠ¨æ€éšœç¢ç‰©é¿ç¢° DWAé¿ç¢°çŠ¶æ€ä¸‹ï¼Œä»¥æœ€è¿‘çš„è·¯å¾„ç‚¹ä¸ºgoalï¼Œå¹¶ä¸æ–­æ›´æ–°ï¼Œç›´åˆ°è¿›å…¥åˆ°è¾¾åŸŸ åˆ†æ å‰ªæåçš„è·¯å¾„è¿›è¡Œdwaä¼˜åŒ–æ•ˆæœæ›´å¥½ å¦åˆ™æ¯ä¸ªç›®æ ‡ç‚¹å¯»æ‰¾çš„è€—æ—¶é•¿\nè¿åŠ¨æ–¹ç¨‹ï¼šä»¥ä¸Šæœºå™¨äººè¿åŠ¨æ–¹ç¨‹éœ€è¦ç”¨æ°´ä¸‹æœºå™¨äººçš„è¿åŠ¨æ–¹ç¨‹è¿›è¡Œä¼˜åŒ–ï¼Œå½±å“é€Ÿåº¦ã€è§’é€Ÿåº¦çš„å› ç´ å¯ä»¥æ ¹æ®æ°´ä¸‹æœºå™¨äººçš„è½¬è§’é™åˆ¶ã€è¿åŠ¨é™åˆ¶ç­‰è¿›è¡Œé™å®š éšœç¢ç‰©é™å®šæ¡ä»¶ï¼šé€Ÿåº¦é™å®šä¸­ï¼Œå—éšœç¢ç‰©å½±å“çš„é™å®šæ–¹ç¨‹ç°åœ¨é‡‡ç”¨æœ€ç®€å•çš„$x=\\frac{1}{2}av^2$ï¼Œå¯ä»¥æ ¹æ®å®é™…æƒ…å†µè¿›è¡Œä¼˜åŒ–ï¼Œä¹Ÿå¯ä»¥è€ƒè™‘ç»“åˆcheck-collisionå‡½æ•° è¯„ä»·å‡½æ•°ï¼šè¯„ä»·å‡½æ•°æš‚æ—¶é€‰æ‹©æ–¹ä½è§’ã€ä¸æœ€è¿‘éšœç¢ç‰©çš„è·ç¦»ä¸çº¿é€Ÿåº¦ä¸‰æ–¹é¢è¿›è¡Œè¯„ä»·ï¼Œå¯ä»¥è€ƒè™‘å¼•å…¥å…¶å®ƒç‰©ç†é‡å¹¶å¯¹æƒé‡ç³»æ•°é€šè¿‡ç›¸å…³å…¬å¼ç­‰è¿›è¡Œä¼˜åŒ– ç®—æ³•ç»“åˆï¼šä¸¤ç®—æ³•å¯ä»¥é€šè¿‡å…¶å®ƒæ–¹æ³•è¿›è¡Œç»“åˆ ä¹Ÿå¯ä»¥æ ¹æ®å…¶å®ƒç‰©ç†é‡çš„è¯„ä»·ï¼ˆå¦‚ä¸éšœç¢ç‰©çš„è·ç¦»ï¼‰å†³å®šå½“å‰æƒ…å†µæ˜¯å¦å¼•å…¥DWA/é€€å‡ºDWA å‚æ•°ä¼˜åŒ–ï¼šæ ¹æ®æœºå™¨äººå®é™…æƒ…å†µè°ƒæ•´ç›¸å…³å‚æ•°ï¼ˆå¦‚æœ€å¤§é€Ÿåº¦ç­‰ï¼‰ å®ç° è®¡ç®—åŠ¨æ€çª—å£\nVs = [self.config[\u0026#39;min_speed\u0026#39;], self.config[\u0026#39;max_speed\u0026#39;], -self.config[\u0026#39;max_yawrate\u0026#39;], self.config[\u0026#39;max_yawrate\u0026#39;]] Vd = [x[3] - self.config[\u0026#39;max_accel\u0026#39;] * self.config[\u0026#39;dt\u0026#39;], x[3] + self.config[\u0026#39;max_accel\u0026#39;] * self.config[\u0026#39;dt\u0026#39;], x[4] - self.config[\u0026#39;max_dyawrate\u0026#39;] * self.config[\u0026#39;dt\u0026#39;], x[4] + self.config[\u0026#39;max_dyawrate\u0026#39;] * self.config[\u0026#39;dt\u0026#39;]] dw = [max(Vs[0], Vd[0]), min(Vs[1], Vd[1]), max(Vs[2], Vd[2]), min(Vs[3], Vd[3])] return dw è¯„ä¼°å‡½æ•°è®¡ç®—å¹¶é€‰å‡ºæœ€ä¼˜è·¯å¾„\nx_init = x[:] min_cost = float(\u0026#34;inf\u0026#34;) best_u = [0.0, 0.0] best_trajectory = np.array(x) # evaluate all trajectory with sampled input in dynamic window for v in np.arange(dw[0], dw[1], self.config[\u0026#39;v_reso\u0026#39;]): for y in np.arange(dw[2], dw[3], self.config[\u0026#39;yawrate_reso\u0026#39;]): trajectory = self.calc_trajectory(x_init, v, y) to_goal_cost = self.calc_to_goal_cost(trajectory, goal) speed_cost = self.config[\u0026#39;speed_cost_gain\u0026#39;] * (self.config[\u0026#39;max_speed\u0026#39;] - trajectory[-1, 3]) ob_cost = self.calc_obstacle_cost(trajectory, obstacles) final_cost = to_goal_cost + speed_cost + ob_cost if min_cost \u0026gt;= final_cost: min_cost = final_cost best_u = [v, y] best_trajectory = trajectory return best_u, best_trajectory è¿åŠ¨å­¦æ–¹ç¨‹\nx[2] += u[1] * self.config[\u0026#39;dt\u0026#39;] x[0] += u[0] * np.cos(x[2]) * self.config[\u0026#39;dt\u0026#39;] x[1] += u[0] * np.sin(x[2]) * self.config[\u0026#39;dt\u0026#39;] x[3] = u[0] x[4] = u[1] return x æ•ˆæœ é¿éšœ å®Œæ•´è§„åˆ’ ","permalink":"https://Sattiluvcat.github.io/en/posts/else/bi-rrt/","summary":"å…³äºBi-RRTçš„æ”¹è¿›ï¼ŒåŒ…æ‹¬ä¸DWAç»“åˆçš„æ–¹æ³•","title":"Bi-RRTåŠæ”¹è‰¯"},{"content":"Â æ¦‚è¦ äº§å“åŸå‹ï¼šå±•ç¤ºé¡¹ç›®çš„ä¸šåŠ¡åŠŸèƒ½\næŠ€æœ¯é€‰å‹ï¼š å‰ç«¯å·²å®Œæˆ çŸ¥è¯†ç‚¹ JavaScript ä¸‰ç§å˜é‡ï¼švarâ€”â€”å…¨å±€\u0026amp;å¯å˜ letâ€”â€”å±€éƒ¨\u0026amp;å”¯ä¸€ constâ€”â€”å…¨å±€\u0026amp;ä¸å¯å˜ ç‰¹æ®Šè¿ç®—ç¬¦ï¼š==ä¸åŒç±»å‹è¿›è¡Œç±»å‹è½¬æ¢åå†æ¯”è¾ƒ ===ï¼ˆå…¨ç­‰ï¼‰ä¸è¿›è¡Œç±»å‹è½¬æ¢å³æ¯”è¾ƒï¼ˆä¸åŒç±»å‹å¿…æŠ¥é”™ï¼‰ ç±»å‹è½¬æ¢ï¼š é™¤0ä¸NaNè½¬æ¢ä¸ºfalseå¤–å…¶å®ƒå…¨ä¸ºtrue é™¤ç©ºå­—ç¬¦ä¸²è½¬ä¸ºfalseå¤–å‡ä¸ºtrue parseIntè½¬æ¢ä¸ºintç±»å‹ JSONæ ¼å¼ï¼šå…ˆå±æ€§åå‡½æ•° elseâ€”â€”XHR xml http request Maven javaé¡¹ç›®ç®¡ç†ä¸æ„å»º åŸºäºé¡¹ç›®å¯¹è±¡æ¨¡å‹POM\nä½œç”¨ ä¾èµ–ç®¡ç†ï¼šç®¡ç†é¡¹ç›®ä¾èµ–çš„èµ„æºâ€”â€”jaråŒ… é¿å…ç‰ˆæœ¬å†²çª pom.xmlä¸­é…ç½®ä¾èµ–ä¿¡æ¯dependencyï¼ˆä¼šæŒ‡æ˜å­˜å‚¨åœ°å€ï¼‰ maven_repoä½œä¸ºæœ¬åœ°ä»“åº“å¯æŸ¥çœ‹å·²æœ‰çš„ä¾èµ–ä¿¡æ¯ ä¸­å¤®ä»“åº“ ç»Ÿä¸€é¡¹ç›®ç»“æ„ï¼šä¸åŒIDEä¸‹é¡¹ç›®ç»“æ„éƒ½æ ‡å‡†ç»Ÿä¸€ é¡¹ç›®æ„å»ºï¼šè·¨å¹³å°eg.Linux-Windowsè‡ªåŠ¨åŒ–é¡¹ç›®æ„å»º ç¼–è¯‘ã€æµ‹è¯•ç­‰åŠŸèƒ½åœ¨mavenä¸­å·²é›†æˆä¸ºæ’ä»¶ æµç¨‹ åˆ›å»ºmavenæ¨¡å—\nåæ ‡ï¼šç»„ç»‡ågroupId-æ¨¡å—åartifactId-ç‰ˆæœ¬å·version â€”â€”å”¯ä¸€å®šä¹‰èµ„æºä½ç½® ç»„ç»‡åï¼šé€šå¸¸åŸŸååå†™ æ¨¡å—åï¼šé€šå¸¸é¡¹ç›®åç§° ç¼–è¯‘åäº§ç”Ÿtargetæ–‡ä»¶å¤¹ å­˜æ”¾å­—èŠ‚ç  å¯¼å…¥Mavené¡¹ç›®â€”â€”å³ä¾§æ Mavené¡¹æ·»åŠ å¯¹åº”é¡¹ç›®çš„pom.xml ä¾èµ–ç®¡ç† ä¾èµ–é…ç½®â€”â€”dependencyæŒ‡æ˜ç»„ç»‡å æ¨¡å—å ç‰ˆæœ¬ ä¾èµ–ä¼ é€’â€”â€”ç›´æ¥/é—´æ¥ä¾èµ– å¯é€šè¿‡exclusionæ’é™¤è¢«ä¼ é€’æ¥çš„ä¾èµ– ä¾èµ–èŒƒå›´â€”â€”é»˜è®¤åœ¨ä¸»ç¨‹åºmainã€æµ‹è¯•ç¨‹åºtestã€å‚ä¸æ‰“åŒ…è¿è¡ŒpackageèŒƒå›´å†…å‡æœ‰æ•ˆ å¯é€šè¿‡scopeæŒ‡å®šèŒƒå›´ï¼ˆä¸åæ ‡å¹¶åˆ—ï¼‰eg.test/providedï¼ˆä¸»+æµ‹ï¼‰/runtimeï¼ˆæµ‹+åŒ…ï¼‰ ç”Ÿå‘½å‘¨æœŸâ€”â€”ä¸‰å¥— åŒä¸€å¥—ç”Ÿå‘½å‘¨æœŸä¸­ æœ‰å…ˆåé¡ºåº åœ¨å‰çš„å…ˆè¿è¡Œ clean æ¸…ç† default æ ¸å¿ƒå·¥ä½œï¼ˆè°ƒè¯• æµ‹è¯•ç­‰ï¼‰ site ç”ŸæˆæŠ¥å‘Š å‘å¸ƒç«™ç‚¹ åˆ†æ¨¡å—å¼€å‘ å°†å·¥å…·ç±»ã€å®ä½“ç±»ç­‰æ‹†åˆ†ä¸ºå•ç‹¬çš„æ¨¡å—â€”â€”éœ€è¦è°ƒç”¨æ—¶å¼•å…¥è¯¥æ¨¡å— ç»§æ‰¿ä¸èšåˆ ç»§æ‰¿ï¼šå®šä¹‰parentå·¥ç¨‹â€”â€”å¼•å…¥å…¬å…±ä¾èµ– å­å·¥ç¨‹ä½¿ç”¨parent parentå·¥ç¨‹è®¾ç½®æ‰“åŒ…æ–¹å¼ï¼ˆä½¿ç”¨ï¼‰packagingä¸ºpom åªèƒ½å•ç»§æ‰¿ ä½†å¯ä»¥å¤šå±‚ç»§æ‰¿ ç»§æ‰¿â€”â€”ç‰ˆæœ¬é”å®šï¼šparentå·¥ç¨‹ä¸­é”å®šä¾èµ–çš„ç‰ˆæœ¬ï¼ˆä½†å¹¶ä¸å¼•å…¥ï¼‰ éœ€è¦å¼•å…¥ä¾èµ–çš„å­å·¥ç¨‹æ— éœ€æŒ‡å®šç‰ˆæœ¬å· è¿ç”¨dependencyManagementè¿›è¡Œç‰ˆæœ¬æŒ‡å®šï¼ˆç¡®å®šåæ ‡ï¼‰ parentå·¥ç¨‹ä¸­å¯ä»¥ç”¨ï¼š(æ–¹ä¾¿åœ¨ç»Ÿä¸€ä½ç½®æŸ¥çœ‹) \u0026lt;something.version\u0026gt;*.*.**\u0026lt;/something.version\u0026gt; å®šä¹‰ç‰ˆæœ¬ somethingä¸‹\u0026lt;version\u0026gt;${something.version}\u0026lt;/version\u0026gt;è°ƒç”¨ èšåˆï¼šé—®é¢˜â€”â€”æ‹†åˆ†å‡ºæ¥çš„ç±»åœ¨mainæ‰“åŒ…å‰éœ€è¦å…¨éƒ¨å…ˆinstallåˆ°æœ¬åœ° è§£å†³ï¼šåˆ›å»ºèšåˆå·¥ç¨‹ï¼ˆ= parentå·¥ç¨‹ï¼‰â€”â€”ä¸åŒ…å«ä¸šåŠ¡åŠŸèƒ½ åªæœ‰ä¸€ä¸ªpom modules \u0026amp; moduleå…³é”®å­—æŒ‡å®šæ‰€æœ‰éœ€è¦ä¸€èµ·æ‰“åŒ…çš„æ¨¡å— æŒ‡å®šé¡ºåºæ— å½±å“ æ ¼å¼ï¼š\u0026lt;module\u0026gt;../tlias-utils\u0026lt;/module\u0026gt; ç§æœ å±€åŸŸç½‘å†…çš„ä»“åº“\næ­¥éª¤ï¼šmavenâ€”â€”confâ€”â€”settings.xml\nseversæ ‡ç­¾é…ç½®ç§æœè®¿é—®ç”¨æˆ·\u0026amp;å¯†ç  \u0026lt;server\u0026gt; \u0026lt;!-- è¿˜æœ‰maven-snapshotsä¹Ÿéœ€è¦é…ç½® --\u0026gt; \u0026lt;id\u0026gt;maven-releases\u0026lt;/id\u0026gt; \u0026lt;username\u0026gt;satti\u0026lt;/username\u0026gt; \u0026lt;password\u0026gt;something\u0026lt;/password\u0026gt; \u0026lt;/server\u0026gt; mirrors\u0026amp;profilesæ ‡ç­¾é…ç½®è¿æ¥ç§æœè®¿é—®åœ°å€ \u0026lt;mirror\u0026gt; \u0026lt;!-- è‹¥é…ç½®è¿‡aliyuné•œåƒ éœ€å…ˆå°†å…¶å»æ‰ --\u0026gt; \u0026lt;id\u0026gt;maven-public\u0026lt;/id\u0026gt; \u0026lt;mirrorOf\u0026gt;*\u0026lt;/mirrorOf\u0026gt; \u0026lt;url\u0026gt;http://192.***.***.***:****/repository/maven-public\u0026lt;/url\u0026gt; \u0026lt;/mirror\u0026gt; \u0026lt;profile\u0026gt; \u0026lt;id\u0026gt;allow-snapshots\u0026lt;/id\u0026gt; \u0026lt;activation\u0026gt; \u0026lt;activeByDefault\u0026gt;true\u0026lt;/activeByDefault\u0026gt; \u0026lt;/activation\u0026gt; \u0026lt;repositories\u0026gt; \u0026lt;repository\u0026gt; \u0026lt;id\u0026gt;maven-public\u0026lt;/id\u0026gt; \u0026lt;url\u0026gt;http://192.***.***.***:****/repository/maven-public/\u0026lt;/url\u0026gt; \u0026lt;releases\u0026gt; \u0026lt;enabled\u0026gt;true\u0026lt;/enabled\u0026gt; \u0026lt;/releases\u0026gt; \u0026lt;snapshots\u0026gt; \u0026lt;enabled\u0026gt;true\u0026lt;/enabled\u0026gt; \u0026lt;/snapshots\u0026gt; \u0026lt;/repository\u0026gt; \u0026lt;/repositories\u0026gt; \u0026lt;/profile\u0026gt; pomæ–‡ä»¶ä¸­é…ç½®ä¸Šä¼ urlåœ°å€ \u0026lt;distributionManagement\u0026gt; \u0026lt;!-- releaseç‰ˆæœ¬çš„å‘å¸ƒåœ°å€--\u0026gt; \u0026lt;repository\u0026gt; \u0026lt;id\u0026gt;maven-releases\u0026lt;/id\u0026gt; \u0026lt;url\u0026gt;http://192.***.***.***:****/repository/maven-releases/\u0026lt;/url\u0026gt; \u0026lt;/repository\u0026gt; \u0026lt;!-- snapshoté¢†æœ¬çš„å‘å¸ƒåœ°å€: --\u0026gt; \u0026lt;snapshotRepository\u0026gt; \u0026lt;id\u0026gt;maven-snapshots\u0026lt;/id\u0026gt; \u0026lt;url\u0026gt;http://192.***.***.***:****/repository/maven-snapshots/\u0026lt;/url\u0026gt; \u0026lt;/snapshotRepository\u0026gt; \u0026lt;/distributionManagement\u0026gt; é€šè¿‡ç”Ÿå‘½å‘¨æœŸdeployä¸Šä¼ åˆ°ç§æœ ä¹‹åå¯ä»¥ç›´æ¥ä»ç§æœä¸­ä¸‹è½½ä¾èµ–ï¼ˆä¹‹å‰ä¸Šä¼ çš„æ¨¡å—ï¼‰ SpringBoot è‡ªåŠ¨è¿›è¡Œè¯·æ±‚å“åº”ï¼š@RequestMappingå³å¯ ä¿è¯å½¢å‚ä¸åœ¨PostManä¸­çš„å®šä¹‰åç§°ç›¸åŒ ä¸å¯ä¿è¯çš„å˜é‡å‰æ·»åŠ @RequestParam(name=\u0026quot;\u0026quot;,require=false)å‰ç¼€ require=falseè¡¨ç¤ºä¸ä¸€å®šéœ€è¦æ­¤å˜é‡ ä¼ é€’å‚æ•°è¿‡å¤šæ—¶å¯å°†å…¶å°è£…åˆ°æŸå®ä½“ç±»ä¸­â€”â€”å½¢å‚ä¸ºè¯¥ç±» è‡ªåŠ¨è¿›è¡Œç±»å‹è½¬æ¢ SpringBootWeb åŸºæœ¬å†…å®¹ SpringBootApplicatonå¯åŠ¨ç±»â€”â€”é€šè¿‡å…¶è¿è¡Œæ•´ä¸ªç¨‹åº é…ç½®æ–‡ä»¶ï¼šmainâ€”â€”resourceâ€”â€”application.properties å®ç° è¯·æ±‚å¤„ç†ç±» ç±»å‰æ³¨æ˜@RestController å¤„ç†è¯·æ±‚çš„æ–¹æ³•å‰æ³¨æ˜@RequestMapping(\u0026quot;/something\u0026quot;) httpåè®® Hyper Text Transfer Protocolè¶…æ–‡æœ¬ä¼ è¾“åè®® è§„å®šæµè§ˆå™¨vsæœåŠ¡å™¨çš„æ•°æ®ä¼ è¾“è§„åˆ™\nç‰¹ç‚¹ï¼š åŸºäºTCPåè®®â€”â€”å®‰å…¨ åŸºäºè¯·æ±‚-å“åº”æ¨¡å‹â€”â€”ä¸€æ¬¡è¯·æ±‚å¾—ä¸€æ¬¡å“åº” æ— çŠ¶æ€åè®®â€”â€”æ¯æ¬¡è¯·æ±‚ç›¸äº’ç‹¬ç«‹ï¼ˆå¤šæ¬¡è¯·æ±‚ä¸èƒ½å…±äº«æ•°æ® but å¿«ï¼‰ è¯·æ±‚åè®®ï¼šè¯·æ±‚è¡Œ + è¯·æ±‚å¤´ï¼ˆ+ è¯·æ±‚ä½“ï¼‰ è¯·æ±‚è¡Œï¼ˆç¬¬ä¸€è¡Œï¼‰ = è¯·æ±‚æ–¹å¼ + èµ„æºè·¯å¾„ + åè®® è¯·æ±‚å¤´ï¼š(æ ¼å¼key: value) å¸¸ç”¨ï¼šHostï¼ˆä¸»æœºåï¼‰User-Agentï¼ˆæµè§ˆå™¨ç‰ˆæœ¬ï¼‰ è¯·æ±‚å‚æ•°ï¼ˆJSONæ ¼å¼ï¼‰â€”â€”GETå­˜æ”¾åœ¨è¯·æ±‚è¡Œä¸­ POSTåœ¨è¯·æ±‚ä½“ä¸­ å“åº”åè®®ï¼šå“åº”è¡Œ + å“åº”å¤´ï¼ˆ+ å“åº”ä½“ï¼‰ å“åº”è¡Œï¼šåè®® + å“åº”çŠ¶æ€ç  + æè¿° çŠ¶æ€ç ï¼š1**â€”â€”å“åº”ä¸­ 2**â€”â€”æˆåŠŸ 3**â€”â€”é‡å®šå‘ 4**â€”â€”å®¢æˆ·ç«¯é”™è¯¯ 5**â€”â€”æœåŠ¡å™¨é”™è¯¯ å®¢æˆ·ç«¯é”™è¯¯â€”â€”eg.è¯·æ±‚ä¸å­˜åœ¨çš„èµ„æº404/æœªè¢«æˆæƒ403/è¯­æ³•é”™è¯¯400 æœåŠ¡å™¨é”™è¯¯â€”â€”eg.ç¨‹åºæŠ›å‡ºå¼‚å¸¸ å“åº”å¤´ï¼š(æ ¼å¼key: value) eg.Content-Encodingå“åº”å‹ç¼©ç®—æ³• å¦‚gzip å“åº”ä½“ï¼šå­˜æ”¾è¯·æ±‚å‚æ•° åè®®è§£æ TomCat è½»é‡çº§webæœåŠ¡å™¨\nwebæœåŠ¡å™¨ï¼šå¯¹httpåè®®æ“ä½œè¿›è¡Œå°è£… \u0026amp; éƒ¨ç½²webé¡¹ç›® å¯¹å¤–æä¾›ç½‘ä¸Šä¿¡æ¯æµè§ˆæœåŠ¡ å®‰è£…ç›®å½•ï¼š binâ€”â€”å¯æ‰§è¡Œæ–‡ä»¶ workâ€”â€”å·¥ä½œç›®å½• libâ€”â€”ä¾èµ–çš„jaråŒ… webappsâ€”â€”éƒ¨ç½²é¡¹ç›® ç¨‹åºç®€å•è§£æ starterâ€”â€”èµ·æ­¥ä¾èµ– springbootæœ‰å†…åµŒtomcat è¯·æ±‚å“åº” æ¶æ„ï¼š BS Browser/Server æµè§ˆå™¨/æœåŠ¡å™¨æ¶æ„ CS Client/Server å®¢æˆ·ç«¯/æœåŠ¡å™¨æ¶æ„ï¼ˆéœ€å®‰è£…ï¼‰ postmanâ€”â€”æ¥å£æµ‹è¯• ç»Ÿä¸€æ¥å£ï¼ˆè¿”å›å€¼ï¼‰ å¯¹æ‰€æœ‰ç±»å‹éƒ½é€‚é… ä¸»é¢˜å†…å®¹åŒ…æ‹¬codeï¼ˆå“åº”ç ï¼‰+msg+dataï¼ˆè¿”å›æ•°æ®ï¼‰ public static Result success(Object data){ //å¤–éƒ¨å®šä¹‰code msg dataï¼ˆObjectç±»å‹ï¼‰ return new Result(1,\u0026#34;success\u0026#34;,data); } åˆ†å±‚è§£è€¦ webå¼€å‘ä¸‰å±‚æ¶æ„ controlleræ§åˆ¶å±‚â€”â€”æ¥æ”¶å‰ç«¯è¯·æ±‚å¹¶å¤„ç†å“åº” serviceä¸šåŠ¡é€»è¾‘å±‚â€”â€”å…·ä½“é€»è¾‘ daoæ•°æ®è®¿é—®å±‚ï¼ˆdata access objectæŒä¹…å±‚ï¼‰â€”â€”æ•°æ®å¢åˆ æ”¹æŸ¥ å†…èšâ€”â€”æ¨¡å—å†…éƒ¨åŠŸèƒ½è”ç³» è€¦åˆâ€”â€”æ¨¡å—é—´ä¾èµ–/å…³è”ï¼ˆé«˜å†…èšä½è€¦åˆï¼‰ IOC\u0026amp;DIâ€”â€”ç±»ä¸Šæ·»åŠ æ³¨è§£@Componentï¼ˆæ³¨å†ŒBeanï¼‰ æ§åˆ¶å™¨ç±»æ”¹ä¸º@Controller ä¸šåŠ¡ç±»å‰æ”¹ä¸º@Service æ•°æ®è®¿é—®ç±»æ”¹ä¸º@Repository IOCå®¹å™¨æä¾›è¯¥ç±»çš„beanå¯¹è±¡å¹¶èµ‹å€¼ DIï¼šåœ¨ç±»å†…éƒ¨å¯¹è±¡å‰æ·»åŠ @Autowiredä¾èµ–æ³¨å…¥â€”â€”ä½¿ç”¨Bean ä¼šè¯ ç”¨æˆ·è®¿é—®webï¼šä¼šè¯å¼€å§‹ æŸæ–¹æ–­è¿ï¼šä¼šè¯ç»“æŸ ä¸€æ¬¡ä¼šè¯å¯ä»¥åŒ…æ‹¬å¤šæ¬¡è¯·æ±‚å“åº” ä¼šè¯è·Ÿè¸ªï¼šè¿½è¸ªè¯·æ±‚æ¥è‡ªåŒä¸€æµè§ˆå™¨ï¼ˆä»¥ä¾¿åœ¨åŒä¸€ä¼šè¯çš„å¤šæ¬¡è¯·æ±‚é—´å…±äº«æ•°æ®ï¼‰\nä¼šè¯è·Ÿè¸ªæ–¹æ¡ˆï¼šå®¢æˆ·ç«¯Cookie æœåŠ¡ç«¯Session ä»¤ç‰Œ Cookieï¼ˆHTTPåè®®æ”¯æŒï¼‰ç§»åŠ¨ç«¯æ— æ³•ç”¨ \u0026amp; ç”¨æˆ·å¯ç¦ç”¨ \u0026amp; ä¸èƒ½è·¨åŸŸ è·¨åŸŸâ€”â€”åè®® IP ç«¯å£ Session æœåŠ¡å™¨é›†ç¾¤æ—¶æ— æ³•ç›´æ¥ç”¨ \u0026amp; Cookieçš„ç¼ºç‚¹ ä»¤ç‰Œâ€”â€”åä¸Šè¿°ç¼ºç‚¹ but éœ€è¦è‡ªå·±å®ç° JSON Web Token(JWT)â€”â€”jsonæ ¼å¼ä¼ è¾“ Header + Payloadæœ‰æ•ˆè½½è·ï¼ˆè‡ªå®šä¹‰å†…å®¹ï¼‰ + Signatureæ•°å­—ç­¾åï¼ˆé˜²æ­¢Tokenè¢«ç¯¡æ”¹ï¼‰ Header\u0026amp;Payloadï¼šBase64ç¼–ç ï¼ˆA-Z a-z 0-9 + /ï¼‰â€”â€”è¡¨ç¤ºäºŒè¿›åˆ¶ï¼ˆå¯è§£ç ï¼‰ Signatureï¼šç™»å½•æˆåŠŸåç”Ÿæˆä»¤ç‰Œ åç»­è¯·æ±‚éƒ½é¡»æºå¸¦ å¯è®¾å®šæœ‰æ•ˆæœŸ Filterè¿‡æ»¤å™¨ æ‹¦æˆªèµ„æºè¯·æ±‚ ä¸€èˆ¬å®Œæˆç™»å½•æ ¡éªŒ ç»Ÿä¸€ç¼–ç å¤„ç† æ•æ„Ÿå­—ç¬¦å¤„ç†ç­‰\nå®ç°ï¼š åˆ›å»ºFilterç±»ï¼ˆimmport javax.servlet.*ï¼‰æ·»åŠ æ³¨è§£@WebFilter(urlPatterns=\u0026quot;/bal\u0026quot;) initï¼ˆè°ƒç”¨ä¸€æ¬¡ï¼‰ doFilter destroyï¼ˆè°ƒç”¨ä¸€æ¬¡ï¼‰æ–¹æ³• éœ€è¦å¼€å¯ï¼šæ·»åŠ æ³¨è§£@ServletComponentScan doFilteræ·»åŠ æ”¾è¡ŒåŠŸèƒ½ chain.doFilter(request,response)â€”â€”æ”¾è¡Œåˆ°ä¸‹ä¸€ä¸ªè¿‡æ»¤å™¨ å…¶åæ·»åŠ æ”¾è¡Œåçš„é€»è¾‘ Bean å£°æ˜Beanå¯¹è±¡æœªæŒ‡å®šåç§°â€”â€”é»˜è®¤ä¸ºç±»çš„é¦–å­—æ¯å°å†™ï¼ˆè·å¾—Objectå¯¹è±¡ï¼‰ ä½œç”¨åŸŸï¼šå•ä¾‹â€”â€”singletonï¼ˆå¯åŠ¨æ—¶åˆ›å»ºä¸€ä¸ªï¼‰ éå•ä¾‹â€”â€”prototypeï¼ˆåŒååªåˆ›å»ºä¸€æ¬¡å®ä¾‹ï¼‰ èµ·æ­¥ä¾èµ– è‡ªåŠ¨é…ç½® èµ·æ­¥ä¾èµ–â€”â€”ä¾é mavençš„ä¾èµ–ä¼ é€’ è‡ªåŠ¨é…ç½®ï¼ˆæŸäº›é…ç½®ç±»ã€beanå¯¹è±¡è‡ªåŠ¨å­˜å…¥IOCå®¹å™¨ï¼ˆä¸éœ€è¦å£°æ˜å¯¹è±¡ï¼‰ï¼‰ SpringBootApplicationæ‰«æå½“å‰åŒ…ä¸å­åŒ…æ£€æŸ¥ç±»çš„è°ƒç”¨ï¼ˆä¸åŒåŒ…ä¸‹è‡ªå®šä¹‰ç±»ä¸èƒ½æ³¨å…¥ï¼‰ @ComponentScan(balabal)ç»„ä»¶æ‰«æ @Immportå¯¼å…¥ è‡ªåŠ¨é…ç½®åŸç†ï¼šï¼ˆæºç è·Ÿè¸ªAutoConfiguration.Importsï¼‰æ·»åŠ Conditionalæ³¨è§£ï¼ˆæœ‰å¤šä¸ªå­æ³¨è§£ï¼‰ SpringBootè¿›è¡Œæ¡ä»¶è£…é… Ctrlç‚¹æ–¹æ³•æŸ¥çœ‹æºç  Mybatis æŒä¹…å±‚æ¡†æ¶ï¼ˆæ•°æ®åº“æ“ä½œï¼‰ ç®€åŒ–JDBCï¼ˆå¯¹æ•°æ®åº“è¿›è¡Œæ“ä½œçš„è§„èŒƒï¼‰å¼€å‘\nä½¿ç”¨ï¼š å®šä¹‰æ¥å£ç±» æ·»åŠ æ³¨è§£@Mapper å†…éƒ¨å®ç°Mysqlæ“ä½œï¼ˆä½¿ç”¨æ³¨è§£@Delete/Selectç­‰ï¼‰ ä½¿ç”¨æ—¶éœ€è¦æ³¨å…¥ è¿è¡Œæ—¶ä¼šè‡ªåŠ¨ç”Ÿæˆæ¥å£çš„å®ç°ç±»å¯¹è±¡ï¼ˆä»£ç†å¯¹è±¡ï¼‰ å¹¶äº¤ç»™IOCå®¹å™¨ é€šè¿‡#{balabal}ä¼ é€’æ–¹æ³•ä¸­çš„å‚æ•° è‹¥éœ€æ‹¼æ¥ï¼ˆeg.æ¨¡ç³ŠåŒ¹é…ï¼‰ç”¨concat('%','balabal','%') è°ƒç”¨ï¼ˆå®šä¹‰è¯¥ç±»å‹å˜é‡ï¼‰æ—¶æ·»åŠ æ³¨è§£@Autowired @Autowired private EmpDao empDao; JDBCâ€”â€”ä½¿ç”¨Javaæ“ä½œå…³ç³»å‹æ•°æ®åº“ æ•°æ®åº“è¿æ¥æ± â€”â€”åˆ†é…ç®¡ç†æ•°æ®åº“è¿æ¥ï¼ˆSpringBooté»˜è®¤Hikariï¼‰ å…è®¸é‡å¤ä½¿ç”¨ç°æœ‰çš„æ•°æ®åº“è¿æ¥ï¼ˆä¸é‡æ–°å»ºç«‹ï¼‰â€”â€”èµ„æºé‡ç”¨ æå‡ç³»ç»Ÿå“åº”é€Ÿåº¦ é‡Šæ”¾ç©ºé—²æ—¶é—´è¿‡é•¿ï¼ˆè¢«å ç”¨ä½†æœªä¸æ•°æ®åº“è¿æ¥ï¼‰çš„è¿æ¥â€”â€”é¿å…è¿æ¥æ³„éœ² lombokâ€”â€”é€šè¿‡æ³¨è§£è‡ªåŠ¨ç”Ÿæˆæ„é€ å™¨ç­‰æ–¹æ³•ã€æ—¥å¿—å˜é‡ @Data=@Getter/Setter/ToString/EqualsAndHashCode @NoArgsConstructoræ— å‚ @AllArgsConstructoré™¤staticä¿®é¥°çš„å­—æ®µå¤–å¸¦å„å‚æ„é€ æ–¹æ³• å¢åˆ æ”¹æŸ¥ï¼šå®šä¹‰public int delete/insertç­‰è¿”å›æ­¤æ“ä½œä¼šå½±å“çš„è®°å½•æ•°ï¼ˆç”¨voidåˆ™å¿½ç•¥ï¼‰ å¢ï¼ˆä¸»é”®è¿”å›ï¼‰æ·»åŠ æ³¨è§£@Options(keyProperty=\u0026quot;id\u0026quot;,useGeneratedKeys=true)å°†ç”Ÿæˆçš„ä¸»é”®èµ‹å€¼ç»™empï¼ˆå®šä¹‰çš„ç±»çš„å¯¹è±¡ï¼‰çš„id æŸ¥ å®ä½“ç±»å±æ€§åä¸SQLå­—æ®µåç›¸åŒæ—¶ mybatisä¼šè‡ªåŠ¨å°è£… å¯ç»™å­—æ®µåèµ·åˆ«å/mybatisé©¼å³°å‘½åæ˜ å°„å¼€å…³ é…ç½®æ—¥å¿—ä¿¡æ¯ï¼šapplication.propertiesä¸­æ·»åŠ mybatis.configuration.log-impl=StdOutImpl é¢„ç¼–è¯‘SQLâ€”â€”ç¼“å­˜è¯­æ³•æ£€æŸ¥ã€ä¼˜åŒ–SQLã€ç¼–è¯‘SQLè¿‡ç¨‹ï¼Œï¼ˆæ¡ä»¶ä¸€å®šæ—¶ï¼‰ç›´æ¥æ‰§è¡Œ ç”¨å ä½ç¬¦å®šä¹‰ï¼ˆä¹‹åä¼ å‚ï¼‰ é¿å…SQLæ³¨å…¥â€”â€”é€šè¿‡è¾“å…¥å½±å“é¢„å®šçš„SQLè¯­å¥ xmlæ˜ å°„æ–‡ä»¶â€”â€”å®šä¹‰æ¯”è¾ƒå¤æ‚çš„SQLè¯­å¥ï¼ˆè®©ä»£ç æ›´ç®€æ´ï¼‰ æ˜ å°„é…ç½®æ–‡ä»¶åä¸Mapperæ¥å£åä¸€è‡´ï¼Œä¸”æ”¾åœ¨ç›¸åŒçš„åŒ…ä¸‹(åŒåŒ…åŒå) æ˜ å°„é…ç½®æ–‡ä»¶çš„namespaceå±æ€§ä¸Mapperæ¥å£çš„å…¨ç±»åä¸€è‡´ XMLæ˜ å°„æ–‡ä»¶ä¸­sqlè¯­å¥çš„idä¸Mapperæ¥å£ä¸­çš„æ–¹æ³•åä¸€è‡´ SDK Software Development Kitè½¯ä»¶å¼€å‘å·¥å…·åŒ… äº‹åŠ¡ç®¡ç†\u0026amp;AOP äº‹åŠ¡ æ³¨è§£@Transactional ä»¥æ–¹æ³•ä¸ºå•ä½ä½œä¸ºäº‹åŠ¡ï¼ˆå¤šåœ¨å¤šæ¬¡æ‰§è¡Œæ•°æ®ä¿®æ”¹çš„æ–¹æ³•ä¸Šåº”ç”¨ï¼‰ å‘ç”ŸRuntimeErrorå¼‚å¸¸å³å›æ»šï¼ˆé»˜è®¤ï¼‰ é€šè¿‡rollbackFor=æŒ‡å®šå¼‚å¸¸ç±»å‹ ä¼ æ’­è¡Œä¸ºPropogationæŒ‡å®š åœ¨å¯åŠ¨ç±»ä¸­éœ€è¦æ·»åŠ å…è®¸æ³¨è§£å¼€å¯äº‹åŠ¡çš„æ³¨è§£ğŸ˜‹ AOP é¢å‘åˆ‡é¢ç¼–ç¨‹â€”â€”åŠ¨æ€ä»£ç†ï¼ˆä¸»æµï¼‰ eg.è®¡ç®—æ¯ä¸ªæ–¹æ³•çš„æ‰§è¡Œè€—æ—¶\nå£°æ˜AOPç±»@Aspect eg.åŒ…è£…éœ€è¦è®¡ç®—è€—æ—¶çš„æ–¹æ³• æ—¶é—´é€šè¿‡logè¾“å‡º è¿”å›åŸæ–¹æ³•è¿è¡Œçš„ç»“æœObject AOPç±»ä¸­æ–¹æ³•æ·»åŠ æ³¨è§£@Around(\u0026quot;\u0026quot;)å£°æ˜è¿ç”¨åœ¨å“ªäº›æ–¹æ³•ä¸Šï¼ˆè¿˜æœ‰å…¶å®ƒé€šçŸ¥ç±»å‹ï¼‰ Apache POI Javaä¸­æ“ä½œms officeè½¯ä»¶\nå†™å…¥\nè¯»å–\nè¯­æ³•è¡¥å…… try-finally å¯ç”¨ä½œè®°å½•æ—¥å¿—ï¼ˆfinallyéƒ¨åˆ†ï¼‰ else ç”¨HashMapæ‰¿æ¥éœ€è¦æŸ¥æ‰¾çš„æ¡ä»¶ æ•°æ®åº“æŸ¥è¯¢æ—¶ç›´æ¥æ“ä½œmapï¼ˆMyBatisï¼‰ å–ä»Šå¤©çš„æœ€æ—©æ—¶åˆ»ï¼šLocalDateTime begin = LocalDateTime.now().with(LocalTime.MIN); åç«¯ é¡¹ç›®ç»“æ„Base sky-pojoä¸­å­˜æ”¾Entityï¼ˆå®ä½“ ä¸æ•°æ®åº“ä¸­çš„è¡¨å¯¹åº”ï¼‰ã€DTOï¼ˆæ•°æ®ä¼ è¾“å¯¹è±¡ å„å±‚é—´ä¼ è¾“æ•°æ®ï¼‰ã€ VOï¼ˆè§†å›¾å¯¹è±¡ å‰ç«¯å±•ç¤ºæ•°æ®ï¼‰ã€POJOï¼ˆæ™®é€šjavaå¯¹è±¡ ä»…å±æ€§\u0026amp;å¯¹åº”çš„getter setterï¼‰ ä¸€èˆ¬ç”¨VOä¼ å›å‰ç«¯ DTOæ¥æ”¶å‰ç«¯æ•°æ® sky-commonâ€”â€”com.skyâ€”â€”exceptionä¸‹å­˜æ”¾å¼‚å¸¸ç±» æŠ¥é”™é›†é”¦ åˆå§‹ç‰ˆæœ¬ç¼–è¯‘ï¼šâ€œæ‰¾ä¸åˆ°ç¬¦å·â€ jdkç‰ˆæœ¬ä¸åŒ¹é…ï¼šè®¾ç½®ä¸­ä¿®æ”¹ä¸ºjdk18 \u0026amp; å°†mavenâ€”â€”è¿è¡Œç¨‹åºâ€”â€”JREç‰ˆæœ¬æ›´æ–° \u0026amp; é¡¹ç›®ç»“æ„SDKç‰ˆæœ¬æ›´æ–° ç‚¹å‡»ç™»å½•æ²¡ååº” nginxå¯åŠ¨ çŸ¥è¯†ç‚¹ å‰åç«¯è”è°ƒ å‰ç«¯è¯·æ±‚å¦‚ä½•ä¼ è¾“åˆ°åç«¯ï¼Ÿ Nginxåå‘ä»£ç†â€”â€”å‰ç«¯å‘å‡ºåŠ¨æ€è¯·æ±‚Nginxè½¬å‘åˆ°åç«¯æœåŠ¡å™¨Tomcat ä¼˜ç‚¹ï¼šæé«˜è®¿é—®é€Ÿåº¦\u0026amp;è´Ÿè½½å‡è¡¡ï¼ˆå¤§é‡çš„è¯·æ±‚æŒ‰æŒ‡å®šæ–¹å¼å‡è¡¡åˆ†é…ç»™æ¯å°æœåŠ¡å™¨ï¼‰\u0026amp;ä¿è¯åç«¯æœåŠ¡å®‰å…¨ è´Ÿè½½å‡è¡¡ç­–ç•¥ï¼šweight/ip_hash/least_conn/â€¦ # å¤„ç†ç®¡ç†ç«¯å‘é€çš„è¯·æ±‚ location /api/ { proxy_pass http://localhost:8080/admin/; # åå‘ä»£ç† #proxy_pass http://webservers/admin/; # è´Ÿè½½å‡è¡¡ } Swagger ç”Ÿæˆæ¥å£æ–‡æ¡£\u0026amp;åœ¨çº¿æ¥å£è°ƒè¯•â€”â€”Knife4jå°è£… å¼€å‘é˜¶æ®µ\næ‰«æåŒ…â€”â€”è®¾ç½®é™æ€èµ„æºæ˜ å°„ è®¿é—®åœ°å€ å¸¸ç”¨æ³¨è§£â€”â€”æ·»åŠ å‚æ•°è¯´æ˜ æ³¨è§£ è¯´æ˜ @Api forç±» å¯¹ç±»çš„è¯´æ˜ @ApiModel forç±» VOç­‰ @ApiModelProperty forå±æ€§ @ApiOperation foræ–¹æ³• åŠŸèƒ½å®Œå–„ ç™»å½•åŠŸèƒ½ MD5åŠ å¯†â€”â€”å¯†ç æ•£åˆ—å‡½æ•° ä¸èƒ½è§£å¯†ï¼ˆåªèƒ½åŠ å¯†åæ¯”è¾ƒç»“æœï¼‰\næ•°æ®åº“ä¿å­˜åŠ å¯†åçš„å¯†ç ï¼Œç”¨æˆ·ç™»å½•æ—¶å°†è¾“å…¥çš„å¯†ç è¿›è¡ŒåŠ å¯†åæ¯”è¾ƒ å‘˜å·¥\u0026amp;åˆ†ç±»ç®¡ç† çº¦å®šï¼šç”¨æˆ·ç«¯å‘å‡ºè¯·æ±‚ä»¥/userä¸ºå‰ç¼€ ç®¡ç†ç«¯ä¸º/admin\nè‹¥å‰ç«¯æ•°æ®ä¸å®ä½“ç±»ä¸­å¯¹åº”å±æ€§å·®åˆ«è¾ƒå¤§æ—¶ ç”¨DTOå°è£…better æ–¹æ³•ä¸Šæ³¨è§£â€”â€”@PostMappingPostç±»å‹è¯·æ±‚å“åº” controllerè®¾ç½®æ–°æ–¹æ³• è°ƒç”¨serviceä¸­å®šä¹‰çš„å‡½æ•° åœ¨serviceå¯¹åº”çš„å®ç°ç±»ä¸­å®ç°åŠŸèƒ½ å°†æ•°æ®ä¿å­˜åˆ°å¯¹åº”çš„æŒä¹…å±‚mapperï¼ˆæ•°æ®åº“æ“ä½œï¼‰ æµ‹è¯•ï¼šä¸€èˆ¬é‡‡ç”¨æ¥å£æ–‡æ¡£æµ‹è¯•ï¼ˆæµ‹è¯•æ—¶æ£€æŸ¥tokenæœ‰æ•ˆæœŸç­‰ï¼‰ åŠŸèƒ½ï¼š å¢ï¼šè®¾ç½®Employeeå¯¹è±¡æ‰¿æ¥ä¼ æ¥çš„å‚æ•° è‹¥å±æ€§åä¸€è‡´ï¼Œå¯ç›´æ¥è¿›è¡Œå±æ€§æ‹·è´`BeanUtils.copyProperties(employeeDTO,employee); è§„èŒƒè®¾ç½®egï¼šemployee.setStatus(StatusConstant.ENABLE); æŸ¥â€”â€”xml ä¼ å‡ºtotalï¼ˆæ€»è®°å½•æ•°ï¼‰ recordï¼ˆæŸ¥è¯¢åˆ°çš„è®°å½•ä¿¡æ¯ï¼‰ select * from employee \u0026lt;where\u0026gt; \u0026lt;if test=\u0026#34;name!=null and name!=\u0026#39;\u0026#39;\u0026#34;\u0026gt; and name like concat(\u0026#39;%\u0026#39;,#{name},\u0026#39;%\u0026#39;) \u0026lt;/if\u0026gt; \u0026lt;/where\u0026gt; æ”¹ï¼ˆçŠ¶æ€ä¿®æ”¹ï¼‰ é€šè¿‡è·¯å¾„å‚æ•°ä¼ å‚ï¼š/employee/status/{status} æ¥æ”¶ï¼ˆLongç­‰ç±»å‹ï¼‰å‚æ•°çš„å˜é‡æ·»åŠ æ³¨è§£@PathVariable ä¿®æ”¹ä¿¡æ¯ = æ˜¾ç¤ºå·²æœ‰+ä¿®æ”¹ è¦ç”¨å¯¹è±¡è°ƒç”¨æ–¹æ³•ï¼ï¼ˆä¸æ˜¯ç±»åï¼‰ é™æ€æ–¹æ³•å¯ä»¥ç›´æ¥ç”¨ç±»åè°ƒç”¨\nå®Œå–„ï¼š æŠ¥é”™ä¿¡æ¯å¤„ç†(è¿”å›msg)ï¼šæ•è·å¼‚å¸¸å¹¶åˆ¤æ–­æ˜¯å¦å«æœ‰æŸäº›ç‰¹å®šå­—å¥ï¼ˆè‡ªè®¾ï¼‰GlobalExceptionHandlerä¸­æ·»åŠ åŒåæ–¹æ³• ThreadLocalåº”ç”¨â€”â€”ä¸ºæ¯ä¸ªçº¿ç¨‹æä¾›å•ç‹¬çš„å­˜å‚¨ç©ºé—´ å®ç°çº¿ç¨‹éš”ç¦»ï¼ˆå€¼ï¼‰ å®šä¹‰ä¸€ä¸ªç±»å­˜å‚¨ä½¿ç”¨åˆ°ThreadLocalçš„æ–¹æ³• æ—¥æœŸç»Ÿä¸€æ ¼å¼ å…¬å…±å­—æ®µè‡ªåŠ¨å¡«å……â€”â€”AOPæ–¹æ³• å®šä¹‰æ¥å£ç±»ï¼ˆå¯¹å¤–ï¼‰ä¸åˆ‡é¢ç±»ï¼ˆå…·ä½“å®ç°ï¼‰ ç”¨Objectç±»å‹æ‰¿æ¥ä¼ å…¥çš„å‚æ•° ç”¨Method setCreateTime = obj.getClass().getDeclaredMethod(\u0026quot;æ–¹æ³•å\u0026quot;, LocalDateTime.class)è°ƒç”¨æ–¹æ³• æ–¹æ³•åå¯è®¾ç½®å¸¸é‡é¿å…å‡ºé”™ é€šè¿‡invokeåå°„è¿›è¡Œèµ‹å€¼ eg.setCreateTime.invoke(entity,now); trickï¼š å«@builderæ³¨è§£çš„ç±»å¯ä»¥å¦‚ä¸‹èµ‹å€¼ Employee employee=Employee.builder() .id(id).status(status) .build(); æ·»åŠ é…ç½®å±æ€§ç±»ï¼ˆæ³¨è§£@ConfigurationPropertieså®šä¹‰å¯èƒ½ç”¨åˆ°çš„å±æ€§ï¼‰ è‹¥éœ€ä½¿ç”¨ä¸»é”®å€¼ åœ¨æ’å…¥è¯­å¥ä¸­éœ€æ³¨æ˜useGeneratedKeys=\u0026quot;true\u0026quot; èœå“ç®¡ç† æ·»åŠ DishVOç±» å¢åŠ åˆ†ç±»å˜é‡ï¼ˆå¯ç›´æ¥è¿”å›å‰ç«¯ï¼‰ åœ¨serviceå®ç°å±‚ä¸­è¿›è¡Œäº‹åŠ¡ç®¡ç† xmlä¸­foreachåŸºæœ¬è¯­æ³•ï¼šä¼ å…¥æ•°æ®å½¢å¦‚(1,2,3) éœ€è¦æå–1 2 3 select setmeal_id from setmeal_dish where dish_id in \u0026lt;foreach collection=\u0026#34;dishIds\u0026#34; item=\u0026#34;dishId\u0026#34; separator=\u0026#34;,\u0026#34; open=\u0026#34;(\u0026#34; close=\u0026#34;)\u0026#34;\u0026gt; #{dishId} \u0026lt;/foreach\u0026gt; è¥ä¸šçŠ¶æ€ 1å‚æ•° é¿å…åˆ›å»ºæ–°è¡¨/ç±»\nåŸºäºRediså­—ç¬¦ä¸²å­˜å‚¨ ç”¨æˆ·ç«¯ä¸ç®¡ç†ç«¯æœ‰åŒåç±»æ—¶ é€šè¿‡RestController(\u0026quot;åå­—\u0026quot;)è®¾ç½®Beanåä»¥åŒºåˆ† Swaggerä¸­è®¾ç½®ä¸åŒåˆ†ç»„â€”â€”docketè®¾ç½®groupNameåˆ†å¼€ç”¨æˆ·ç«¯\u0026amp;å•†å®¶ç«¯ï¼ˆéƒ½è¦åŠ @Beanï¼‰ ç”¨æˆ·ç™»å½• ç”Ÿæˆjwtä»¤ç‰Œå¹¶æ ¡éªŒ ç‰¹æ®Š mapperå±‚mysqlè¯­å¥ä¸­ åä¸€ä¸ªidå˜é‡ä¸setmealIdå˜é‡çš„å€¼ç›¸åŒ ä½†åç§°æ²¿ç”¨ç±»ä¸­åç§° @Delete(\u0026#34;delete from setmeal where id=#{id}\u0026#34;) void delete(Long setmealId); æ¥æ”¶ï¼ˆLongç­‰ç±»å‹ï¼‰å‚æ•°çš„å˜é‡æ·»åŠ æ³¨è§£@PathVariable ç¼“å­˜ä¿¡æ¯ å‡å°‘æ•°æ®åº“æŸ¥è¯¢æ“ä½œâ€”â€”Redis\né€»è¾‘ï¼šæ¯ä¸ªåˆ†ç±»ä¸‹çš„èœå“ä¿å­˜ä¸€ä»½ç¼“å­˜æ•°æ®â€”â€”ä¿å­˜ä¸€å¯¹keyvalue æ³¨æ„ä¿®æ”¹ä¿¡æ¯åéœ€è¦é‡å»ºç¼“å­˜ Spring Cache åŸºäºæ³¨è§£çš„ç¼“å­˜åŠŸèƒ½ ä»…æä¾›ä¸€å±‚æŠ½è±¡ åº•å±‚å¯ä»¥åˆ‡æ¢ä¸åŒçš„ç¼“å­˜å®ç°ï¼ˆRedis EHCacheç­‰ï¼‰ @EnableCaching å¼€å¯ç¼“å­˜æ³¨è§£ åŠ åœ¨å¯åŠ¨ç±»ä¸Š @Cacheable æ–¹æ³•æ‰§è¡Œå‰æŸ¥è¯¢æœ‰å¦ç¼“å­˜ æœ‰åˆ™è¿”å›æ— åˆ™è°ƒç”¨æ–¹æ³•å¹¶æ·»åŠ  @CachePut æ·»åŠ æ•°æ®åˆ°ç¼“å­˜ @CacheEvict åˆ é™¤næ¡ç¼“å­˜æ•°æ® Spring Cacheè¯­æ³•ï¼šSpring EL å¦‚@CachePut(cacheNames=\u0026quot;ä¸€ä¸ªåå­—\u0026quot;,key=\u0026quot;#å½¢å‚.è¦å–çš„å½¢å‚çš„ä¿¡æ¯ï¼ˆå¦‚idï¼‰\u0026quot;) å¦‚key=#result.æŸ resultå³ä¸ºå½“å‰æ–¹æ³•çš„è¿”å›å€¼ å¦‚key=#p0 ä¼ å…¥çš„ç¬¬ä¸€ä¸ªå‚æ•°ï¼ˆç¬¬äºŒä¸ªå³ç”¨p1ï¼‰ a0ç›¸åŒæ•ˆæœ æœ€åç”Ÿæˆçš„keyçš„æ ¼å¼å¦‚ï¼šä¸€ä¸ªåå­—::1 åˆ é™¤è¯­æ³•ï¼š@CacheEvictè°ƒç”¨ AllEntries=true è´­ç‰©è½¦ è®¾ç½®å†—ä½™å­—æ®µ å¦‚å›¾ç‰‡/åç§°ç­‰ å‡å°‘å¯¹å¤šä¸ªæ•°æ®åº“çš„è®¿é—® è¶…æ—¶è®¢å•å¤„ç† Spring Taskå®šæ—¶ä»»åŠ¡+WebSocket ç»Ÿè®¡ Aoache Echart å¯ä»¥ç”¨streamè¯»å–Listä¸­æŸä¿¡æ¯ï¼Œeg.Listä¸­å­˜å‚¨DTOï¼Œåˆ†åˆ«è¯»å–å‡ºnumå’Œnumberå»ºç«‹æ–°List åœ¨mysqlä¸­æŸ¥è¯¢å¾—åˆ°çš„ç»“æœåç§°éœ€ä¸DTOä¸­å˜é‡åç›¸åŒï¼Œå¦åˆ™ä¸èƒ½å­˜å‚¨ List\u0026lt;GoodsSalesDTO\u0026gt; goodsSalesDTOList=orderMapper.getTop10(beginTime,endTime); List\u0026lt;String\u0026gt; list = goodsSalesDTOList.stream().map(GoodsSalesDTO::getName).collect(Collectors.toList()); String name = StringUtils.join(list, \u0026#34;,\u0026#34;); çŸ¥è¯†ç‚¹ HttpClient å‘é€è¯·æ±‚ è¿›è¡Œå“åº”\nä½¿ç”¨ï¼š GETï¼šåˆ›å»ºhttpclientå¯¹è±¡\u0026ndash;\u0026gt;åˆ›å»ºè¯·æ±‚å¯¹è±¡\u0026ndash;\u0026gt;é€šè¿‡httpClientå‘é€è¯·æ±‚å¹¶é€šè¿‡CloseableHttpResponseæ¥æ”¶\u0026ndash;\u0026gt;æ˜¾ç¤ºæ¥æ”¶åˆ°çš„ä¿¡æ¯ï¼ˆçŠ¶æ€ç  å“åº”ä½“ï¼‰\u0026ndash;\u0026gt;å…³é—­responseä¸httpClientèµ„æº POSTï¼šéœ€è¦æä¾›è¯·æ±‚ä½“ SpringTask æŒ‰çº¦å®šçš„æ—¶é—´è‡ªåŠ¨æ‰§è¡Œâ€”â€”å®šæ—¶ä»»åŠ¡æ¡†æ¶ cronè¡¨è¾¾å¼ï¼šï¼ˆå¯ç”Ÿæˆï¼‰ æ™®é€šï¼š0 0 9 12 10 ? 2024â€”â€”2024å¹´10æœˆ12æ—¥ æ˜ŸæœŸï¼Ÿçœç•¥ 9ç‚¹ ä½¿ç”¨ï¼šå¯¼å…¥spring-contextåæ ‡â€”â€”å¯åŠ¨ç±»æ·»åŠ æ³¨è§£@EnableSchedulingâ€”â€”è‡ªå®šä¹‰å®šæ—¶ä»»åŠ¡ç±» æ·»åŠ æ³¨è§£@Componentâ€”â€”æ–¹æ³•ä¸Šæ·»åŠ æ³¨è§£@Scheduled(cron=\u0026quot;ä¸€äº›\u0026quot;) æ— è¿”å›å€¼ WebSocket å®ç°æµè§ˆå™¨ä¸æœåŠ¡å™¨çš„å…¨åŒå·¥é€šä¿¡ ä¸€æ¬¡æ¡æ‰‹åˆ›å»ºæŒä¹…æ€§è¿æ¥å¹¶åŒå‘é€šä¿¡ ä½¿ç”¨ï¼šwebsocket.htmlä½œä¸ºå®¢æˆ·ç«¯â€”â€”å¯¼å…¥mavenåæ ‡â€”â€”å¯¼å…¥æœåŠ¡ç«¯ç»„ä»¶WebSocketServerâ€”â€”å¯¼å…¥é…ç½®ç±» ","permalink":"https://Sattiluvcat.github.io/en/posts/java/%E5%A4%96%E5%8D%96proj/","summary":"åŸå‹ä¸ºè‹ç©¹å¤–å–","title":"å¤–å–Proj"},{"content":"Â ç‹é“è®¡ç®—æœºè€ƒç ” æ“ä½œç³»ç»Ÿ æ“ä½œç³»ç»Ÿ å®šä¹‰ ç³»ç»Ÿèµ„æºçš„ç®¡ç†è€…\u0026amp;æä¾›æ–¹ä¾¿çš„æ¥å£ä¸ç¯å¢ƒ\u0026amp;æœ€æ¥è¿‘ç¡¬ä»¶çš„è½¯ä»¶\nåŠŸèƒ½ï¼šå¤„ç†æœº(CPU)ç®¡ç†\u0026amp;å­˜å‚¨å™¨ç®¡ç†\u0026amp;æ–‡ä»¶ç®¡ç†\u0026amp;è®¾å¤‡ç®¡ç† ç¨‹åºè¿è¡Œ å°†ç›¸å…³æ•°æ®ä»ç£ç›˜æ”¾å…¥å†…å­˜ = å­˜å‚¨å™¨ è¿›ç¨‹è¢«CPUç®¡ç† = å¤„ç†æœº æ¥å£\u0026amp;ç¯å¢ƒ flowchart LR æ¥å£--\u0026gt;GUI æ¥å£--\u0026gt;ç¨‹åºæ¥å£ ç”¨æˆ·æ¥å£--\u0026gt;ç¨‹åºæ¥å£ ç”¨æˆ·æ¥å£--\u0026gt;è„±æœºå‘½ä»¤æ¥å£ æ¥å£--\u0026gt;å‘½ä»¤æ¥å£ å‘½ä»¤æ¥å£--\u0026gt;è„±æœºå‘½ä»¤æ¥å£ å‘½ä»¤æ¥å£--\u0026gt;è”æœºå‘½ä»¤æ¥å£ è”æœºå‘½ä»¤æ¥å£---äº¤äº’å¼å‘½ä»¤æ¥å£ äº¤äº’å¼å‘½ä»¤æ¥å£--\u0026gt;cmd æ‰¹å¤„ç†--\u0026gt;.bat è„±æœºå‘½ä»¤æ¥å£---æ‰¹å¤„ç† GUI å›¾å½¢åŒ–ç”¨æˆ·æ¥å£ ç¡¬ä»¶æ‹“å±• æ— è½¯ä»¶æ”¯æŒçš„è®¡ç®—æœº = è£¸æœº è¦†ç›–äº†è½¯ä»¶ = æ‰©å……æœºå™¨ï¼ˆè™šæ‹Ÿæœºï¼‰ å››ä¸ªç‰¹å¾ å¹¶å‘ å…±äº« æ˜¯æœ€åŸºæœ¬çš„ç‰¹å¾ äº’ä¸ºå­˜åœ¨æ¡ä»¶\nå¹¶å‘ å®è§‚ä¸ŠåŒæ—¶å‘ç”Ÿ å¾®è§‚ä¸Šäº¤æ›¿ï¼ˆ= åŒæ—¶æ®µå‘ç”Ÿï¼‰\nå•æ ¸CPUåŒä¸€æ—¶åˆ»åªèƒ½æ‰§è¡Œä¸€ä¸ªç¨‹åº=å¹¶å‘ å¤šæ ¸å¯ä»¥å®ç°å¹¶è¡Œï¼ˆåŒä¸€æ—¶åˆ»è¿›è¡Œå¤šä¸ªç¨‹åºï¼‰ å…±äº« èµ„æºå…±äº« ç³»ç»Ÿèµ„æºå¯ä¾›å†…å­˜ä¸­å¤šä¸ªå¹¶å‘è¿›ç¨‹å…±åŒä½¿ç”¨ ä¸¤ç§èµ„æºå…±äº«æ–¹å¼ï¼š\näº’æ–¥å…±äº« ä¸€æ—¶æ®µä¸€è¿›ç¨‹ eg.æ‘„åƒå¤´ åŒæ—¶å…±äº« ä¸€æ—¶æ®µå¤šè¿›ç¨‹ è™šæ‹Ÿ ç‰©ç†å®ä½“å˜ä¸ºé€»è¾‘ä¸Šçš„å¯¹åº”ç‰©\nflowchart LR è™šæ‹ŸæŠ€æœ¯--\u0026gt;ç©ºåˆ†å¤ç”¨æŠ€æœ¯ è™šæ‹ŸæŠ€æœ¯--\u0026gt;æ—¶åˆ†å¤ç”¨æŠ€æœ¯ ç©ºåˆ†å¤ç”¨æŠ€æœ¯--\u0026gt;eg.è™šæ‹Ÿå­˜å‚¨å™¨ æ—¶åˆ†å¤ç”¨æŠ€æœ¯--\u0026gt;eg.è™šæ‹Ÿå¤„ç†å™¨ æ²¡æœ‰å¹¶å‘æ€§ è™šæ‹Ÿæ€§ = ä¸å­˜åœ¨ å¼‚æ­¥æ€§ å¤šä¸ªç¨‹åºå¹¶å‘ èµ„æºæœ‰é™æ—¶è¿›ç¨‹æ‰§è¡Œä»¥æœªçŸ¥é€Ÿåº¦æ¨è¿›\næ²¡æœ‰å¹¶å‘æ€§ å¼‚æ­¥æ€§ = ä¸å­˜åœ¨ å‘å±•ä¸åˆ†ç±» flowchart TB subgraph æ‰‹å·¥æ“ä½œ ç¼ºç‚¹1--\u0026gt;ç‹¬å å…¨æœº ç¼ºç‚¹1--\u0026gt;èµ„æºåˆ©ç”¨ç‡ä½ èµ„æºåˆ©ç”¨ç‡ä½--\u0026gt;è®¡ç®—æœºå¿«\u0026amp;äººå·¥æ…¢ end æ‰‹å·¥æ“ä½œ--\u0026gt;æ‰¹å¤„ç†é˜¶æ®µ subgraph æ‰¹å¤„ç†é˜¶æ®µ subgraph å•é“æ‰¹å¤„ç†ç³»ç»Ÿ ä¸»è¦ç»“æ„--\u0026gt;ç£å¸¦\u0026amp;ç›‘ç£ç¨‹åº ç¼ºç‚¹2--\u0026gt;å†…å­˜ä¸­ä»…èƒ½è¿è¡Œä¸€é“ç¨‹åº end å•é“æ‰¹å¤„ç†ç³»ç»Ÿ--\u0026gt;å¤šé“æ‰¹å¤„ç†ç³»ç»Ÿ subgraph å¤šé“æ‰¹å¤„ç†ç³»ç»Ÿ è¾“å…¥è®¡ç®—è¾“å‡ºé”™å³°è¿è¡Œ ç¼ºç‚¹3--\u0026gt;è¿è¡Œè¿‡ç¨‹æ—¶ä¸èƒ½è°ƒè¯• end end æ‰¹å¤„ç†é˜¶æ®µ--\u0026gt;åˆ†æ—¶æ“ä½œç³»ç»Ÿ subgraph åˆ†æ—¶æ“ä½œç³»ç»Ÿ ç‰¹ç‚¹--\u0026gt;ä»¥æ—¶é—´ç‰‡ä¸ºå•ä½è½®æµæœåŠ¡ç”¨æˆ· ä¼˜ç‚¹--\u0026gt;åŠæ—¶å“åº”è§£å†³äººæœºäº¤äº’é—®é¢˜ ç¼ºç‚¹4--\u0026gt;ä¸èƒ½ä¼˜å…ˆå¤„ç†ç´§æ€¥ä»»åŠ¡ end åˆ†æ—¶æ“ä½œç³»ç»Ÿ--\u0026gt;å®æ—¶æ“ä½œç³»ç»Ÿ subgraph å®æ—¶æ“ä½œç³»ç»Ÿ åœ¨ä¸¥æ ¼æ—¶é™å†…å¤„ç†äº‹ä»¶---å¯ä»¥ä¼˜å…ˆå“åº” ç‰¹ç‚¹1--\u0026gt;åŠæ—¶æ€§\u0026amp;å¯é æ€§ åˆ†ç±»--\u0026gt;ç¡¬å®æ—¶ç³»ç»Ÿ ç¡¬å®æ—¶ç³»ç»Ÿ---ä¸¥æ ¼æ—¶é™ åˆ†ç±»--\u0026gt;è½¯å®æ—¶ç³»ç»Ÿ è½¯å®æ—¶ç³»ç»Ÿ---å¶å°”æ¥å—è¿Ÿæ» end å®æ—¶æ“ä½œç³»ç»Ÿ--\u0026gt;ç½‘ç»œæ“ä½œç³»ç»Ÿ å®æ—¶æ“ä½œç³»ç»Ÿ--\u0026gt;åˆ†å¸ƒå¼æ“ä½œç³»ç»Ÿ å®æ—¶æ“ä½œç³»ç»Ÿ--\u0026gt;ä¸ªäººè®¡ç®—æœºæ“ä½œç³»ç»Ÿ subgraph ä¸é‡è¦ ç½‘ç»œæ“ä½œç³»ç»Ÿ åˆ†å¸ƒå¼æ“ä½œç³»ç»Ÿ ä¸ªäººè®¡ç®—æœºæ“ä½œç³»ç»Ÿ end è¿è¡Œæœºåˆ¶ æŒ‡ä»¤ = æœºå™¨æŒ‡ä»¤ écmd\nä¸¤ç§ flowchart LR å†…æ ¸ç¨‹åºKernal--\u0026gt;ç‰¹æƒæŒ‡ä»¤ åº”ç”¨ç¨‹åº--\u0026gt;éç‰¹æƒæŒ‡ä»¤ ç‰¹æƒæŒ‡ä»¤--\u0026gt;å†…æ ¸æ€ éç‰¹æƒæŒ‡ä»¤--\u0026gt;ç”¨æˆ·æ€ å†…æ ¸ç¨‹åº = æœ€æ¥è¿‘ç¡¬ä»¶çš„éƒ¨åˆ† ç‰¹æƒæŒ‡ä»¤ = ç®¡ç†è€…æ“ä½œ å†…æ ¸æ€/ç”¨æˆ·æ€ = CPUçŠ¶æ€ï¼ˆç”¨PSWå­˜å‚¨çŠ¶æ€ï¼‰ PSW ç¨‹åºçŠ¶æ€å­—å¯„å­˜å™¨ å†…æ ¸æ€=æ ¸å¿ƒæ€=ç®¡æ€ ç”¨æˆ·æ€=ç›®æ€ åˆ‡æ¢çŠ¶æ€ï¼š\nå†…æ ¸åˆ°ç”¨æˆ·ï¼šç‰¹æƒæŒ‡ä»¤ä¿®æ”¹PSW ç”¨æˆ·åˆ°å†…æ ¸ï¼šè§¦å‘ä¸­æ–­ ç¡¬ä»¶è‡ªåŠ¨å®Œæˆ ä¸­æ–­ä¸å¼‚å¸¸ ä¸­æ–­ä½œç”¨ å”¯ä¸€è®©CPUä»ç”¨æˆ·æ€å˜ä¸ºå†…æ ¸æ€çš„é€”å¾„ = ä¿éšœå¹¶å‘\nä¸­æ–­ç±»å‹ å†…ä¸­æ–­ï¼ˆå¼‚å¸¸ï¼‰ï¼šä¸­æ–­ä¿¡å·æ¥è‡ªCPUå†…éƒ¨ å½“å‰æ‰§è¡ŒæŒ‡ä»¤\næŒ‡ä»¤è‡ªèº«éæ³•/é‡åˆ°ç‰¹æƒæŒ‡ä»¤ eg.trapç¨‹åºå¼•å‘/faulté”™è¯¯æ¡ä»¶ Kernalå¯èƒ½ä¿®è¡¥/abortè‡´å‘½é”™è¯¯ å¤–ä¸­æ–­ï¼ˆä¸­æ–­ï¼‰ï¼šä¸å½“å‰æŒ‡ä»¤æ— å…³ eg.æ—¶é’Ÿä¸­æ–­ eg.I/Oä¸­æ–­ åŸºæœ¬åŸç† CPUæ£€æµ‹åˆ°ä¸­æ–­åæŸ¥è¯¢ä¸­æ–­å‘é‡è¡¨ æ‰¾åˆ°ä¸­æ–­å¤„ç†ç¨‹åºçš„å†…å­˜ä½ç½®\nç³»ç»Ÿè°ƒç”¨ ä¸€ç»„ç³»ç»Ÿè°ƒç”¨ç»„æˆç¨‹åºæ¥å£\nåº”ç”¨ç¨‹åºé€šå¸¸é€šè¿‡åº“å‡½æ•°è¿›è¡Œç³»ç»Ÿè°ƒç”¨ æœ‰äº›åº“å‡½æ•°ä¸è°ƒç”¨ æœ‰äº›è¯­è¨€ç›´æ¥è¿›è¡Œç³»ç»Ÿè°ƒç”¨ eg.æ±‡ç¼–è¯­è¨€ å‘ç³»ç»Ÿå†…æ ¸æå‡ºè¯·æ±‚å¯¹å…±äº«èµ„æºè¿›è¡Œæ“ä½œ å³ç³»ç»Ÿè°ƒç”¨ å‘å‡ºtrapæŒ‡ä»¤æå‡ºè¯·æ±‚ï¼ˆç”¨æˆ·æ€ï¼‰ æ‰§è¡Œtrapåå¼•å‘å†…ä¸­æ–­è¿›å…¥æ ¸å¿ƒæ€ ä½“ç³»ç»“æ„ å¤§/å®å†…æ ¸æ“ä½œç³»ç»Ÿï¼šæ‰€æœ‰å†…æ ¸åŠŸèƒ½ï¼ˆLinux UNIXç­‰ï¼‰\neg.è¿›ç¨‹ å­˜å‚¨ è®¾å¤‡ + å¾®å†…æ ¸éƒ¨åˆ† æ€§èƒ½é«˜ å†…æ ¸ä»£ç åºå¤§ ç»“æ„æ··ä¹± å¾®å†…æ ¸æ“ä½œç³»ç»Ÿï¼šä¸ç¡¬ä»¶å…³ç³»æœ€ç´§å¯†çš„åŠŸèƒ½ï¼ˆWindows NTï¼‰ eg.æ—¶é’Ÿç®¡ç† ä¸­æ–­å¤„ç† åŸè¯­ï¼ˆè®¾å¤‡é©±åŠ¨ CPUåˆ‡æ¢ï¼‰ ä¼˜ç¼ºç‚¹åä¹‹ å¼•å¯¼ è¿‡ç¨‹ CPUä»ä¸»å­˜ï¼ˆ = RAM + ROMï¼ˆBIOSï¼‰ï¼‰æ‰§è¡ŒROMå¼•å¯¼ç¨‹åº å°†ç£ç›˜ä¸­ä¸»å¼•å¯¼è®°å½•ï¼ˆMBRï¼‰è¯»å…¥å†…å­˜ æ‰§è¡Œç£ç›˜å¼•å¯¼ç¨‹åº æ‰«æåˆ†åŒºè¡¨ ä»æ´»åŠ¨åˆ†åŒºï¼ˆä¸»åˆ†åŒºï¼‰è¯»å…¥åˆ†åŒºå¼•å¯¼è®°å½•ï¼ˆPBRï¼‰ æ‰§è¡Œç¨‹åº ä¸»åˆ†åŒºå³å®‰è£…äº†æ“ä½œç³»ç»Ÿçš„åˆ†åŒº ä»æ ¹ç›®å½•æ‰¾åˆ°å¯åŠ¨ç®¡ç†å™¨å¹¶æ‰§è¡Œ å®Œæˆå¼€æœºğŸ¥³ è™šæ‹Ÿæœº Virtual Machine (VMware \u0026amp; Virtual Box)\nè™šæ‹Ÿæœºç®¡ç†ç¨‹åºï¼ˆVMM monitorï¼‰\nç¬¬ä¸€ç±»VMM è¿è¡Œåœ¨ç¡¬ä»¶ä¸Šï¼ˆCPU ç£ç›˜ å†…å­˜è¿›è¡Œåˆ’åˆ†ï¼‰ ç”¨æˆ·ç©ºé—´åˆ†ä¸ºè™šæ‹Ÿç”¨æˆ·æ€\u0026amp;è™šæ‹Ÿå†…æ ¸æ€ï¼ˆä½†å®é™…å‡ä¸ºç”¨æˆ·æ€ï¼‰ è‹¥æ‰§è¡Œç‰¹æƒæŒ‡ä»¤ ç”±å†…æ ¸ä¸­çš„VMMè¿›è¡Œè™šæ‹Ÿæ‰§è¡Œ ç¬¬äºŒç±»VMM è¿è¡Œåœ¨å®¿ä¸»æ“ä½œç³»ç»Ÿï¼ˆHost OSï¼‰ä¸Šï¼ˆå¦‚Vmwareï¼‰ VMMå¤§éƒ¨åœ¨ç”¨æˆ·æ€ VMé©±åŠ¨éƒ¨åˆ†åœ¨å†…æ ¸æ€ å¯¹æ¯”ï¼šç¬¬ä¸€ç±»æ€§èƒ½æ›´å¥½ å¯å®¹çº³æ›´å¤šè™šæ‹Ÿæœº è¿è¡Œåœ¨æœ€é«˜ç‰¹æƒçº§(Ring 0) ä½†å¯è¿ç§»æ€§ä¸å¼º ç¬¬äºŒç±»åä¹‹ è¿›ç¨‹ç®¡ç† è¿›ç¨‹åŸºç¡€çŸ¥è¯† åŸºæœ¬ å®šä¹‰ ç¨‹åºï¼šé™æ€ = æŒ‡ä»¤é›†åˆ è¿›ç¨‹ï¼šåŠ¨æ€ = ç¨‹åºçš„æ‰§è¡Œè¿‡ç¨‹\nè¿›ç¨‹ç»„æˆ PCBï¼ˆProcess Control Blockï¼‰è¿›ç¨‹æ§åˆ¶å— Foræ“ä½œç³»ç»Ÿ\nè¿›ç¨‹å­˜åœ¨å”¯ä¸€æ ‡å¿— ä¿å­˜ï¼šPID UID \u0026amp; è¿›ç¨‹æ§åˆ¶ä¸ç®¡ç†ä¿¡æ¯ \u0026amp; èµ„æºåˆ†é…æ¸…å• \u0026amp; å¤„ç†æœºä¿¡æ¯ PIDï¼ˆè¿›ç¨‹ID å”¯ä¸€ä¸é‡å¤ï¼‰ ç¨‹åºæ®µï¼šç¨‹åºä»£ç  Forè¿›ç¨‹\nç¨‹åºè¿è¡Œï¼šç¨‹åº-\u0026gt;ç¡¬ç›˜ï¼ˆexeï¼‰-\u0026gt;å†…å­˜PCB-\u0026gt;CPUå–å‡ºæŒ‡ä»¤ æ•°æ®æ®µï¼šè¿è¡Œè¿‡ç¨‹ä¸­äº§ç”Ÿçš„æ•°æ® Forè¿›ç¨‹ è¿›ç¨‹å®ä½“ï¼ˆè¿›ç¨‹æ˜ åƒï¼‰=PCB+ç¨‹åºæ®µ+æ•°æ®æ®µ é™æ€ è¿›ç¨‹ è¿›ç¨‹å®ä½“çš„è¿è¡Œè¿‡ç¨‹ åŠ¨æ€ ç‰¹å¾ åŠ¨æ€æ€§ï¼šæœ€åŸºæœ¬çš„ç‰¹å¾ å¹¶å‘æ€§ï¼šå†…å­˜ä¸­æœ‰å¤šä¸ªè¿›ç¨‹å®ä½“ ç‹¬ç«‹æ€§ï¼šè·å¾—èµ„æºçš„åŸºæœ¬å•ä½ å¼‚æ­¥æ€§ ç»“æ„æ€§ï¼šæ¯ä¸ªè¿›ç¨‹éƒ½æœ‰ä¸€ä¸ªPCB\nçŠ¶æ€ä¸è½¬æ¢ åˆ›å»ºæ€ å°±ç»ªæ€ è¿è¡Œæ€ é˜»å¡æ€ ç»ˆæ­¢æ€\nå°±ç»ªæ€â€”â€”ç­‰å¾…å¤„ç†æœºè°ƒåº¦ è¿è¡Œæ€â€”â€”å ç”¨æ•´ä¸ªCPUè¿è¡Œ é˜»å¡æ€â€”â€”è¿è¡Œæ€è¿›ç¨‹è¯·æ±‚ç­‰å¾…æŸäº‹ä»¶å‘ç”Ÿ ä¸‹CPUï¼ˆè¿›ç¨‹ä¸»åŠ¨ï¼‰ äº‹ä»¶å‘ç”Ÿåæ”¹ä¸ºå°±ç»ªæ€ï¼ˆè¢«åŠ¨ï¼‰ è¿›ç¨‹çš„ç»„ç»‡ é“¾å¼ï¼šé˜Ÿåˆ—æŒ‡é’ˆ ç´¢å¼•ï¼šç´¢å¼•è¡¨æŒ‡é’ˆ\nè¿›ç¨‹æ§åˆ¶ å®ç°è¿›ç¨‹çŠ¶æ€è½¬æ¢\nåŸè¯­å®ç°â€”â€”å…·åŸå­æ€§ = ä¸å¯ä¸­æ–­\nç‰¹æƒæŒ‡ä»¤ å…³ä¸­æ–­æŒ‡ä»¤\u0026amp;å¼€ä¸­æ–­æŒ‡ä»¤å®ç°åŸå­æ€§ å…³ä¸­æ–­å¼€å¯â€”â€”ä¸å†æ£€æŸ¥ä¸­æ–­ä¿¡å· åˆ›å»º/æ’¤é”€è¿›ç¨‹æ—¶ä½¿ç”¨çš„åŸè¯­ï¼šPCBæ›´æ–°â€”â€”èµ„æºåˆ†é…â€”â€”åˆé€‚çš„é˜Ÿåˆ—\nç”³è¯·ç©ºç™½PCBâ€”â€”æ‰¾åˆ°å¯¹åº”PCB ä¸ºæ–°è¿›ç¨‹åˆ†é…èµ„æºâ€”â€”è‹¥è¿è¡Œ å‰¥å¤ºCPUå¹¶åˆ†é… åˆå§‹åŒ–PCBâ€”â€”ç»ˆæ­¢æ‰€æœ‰å­è¿›ç¨‹ PCBæ’å…¥å°±ç»ªé˜Ÿåˆ—â€”â€”èµ„æºå½’è¿˜å¹¶åˆ é™¤PCB é˜»å¡/å”¤é†’åŸè¯­â€”â€”æˆå¯¹ä½¿ç”¨ï¼ˆå› ä½•é˜»å¡å¿…å› ä½•å”¤é†’ï¼‰\nåˆ‡æ¢è¿›ç¨‹çš„åŸè¯­ï¼šå°†ç°è¡Œè¿è¡Œç¯å¢ƒå­˜å…¥PCB\nè¿›ç¨‹é€šä¿¡IPC ä¸¤è¿›ç¨‹é—´çš„æ•°æ®äº¤äº’ ä¸åŒè¿›ç¨‹çš„å†…å­˜åœ°å€ä¸é‡å  é€šä¿¡éœ€è¦æ“ä½œç³»ç»Ÿæ”¯æŒ\nå…±äº«å­˜å‚¨ è®¾å®šå…±äº«å­˜å‚¨åŒº æ˜ å°„åˆ°è¿›ç¨‹çš„è™šæ‹Ÿåœ°å€ç©ºé—´\näº’æ–¥è®¿é—® ç”±è¿›ç¨‹è‡ªå·±å®ç° åŸºäºå­˜å‚¨åŒºï¼šçµæ´»æ€§é«˜ é«˜çº§é€šä¿¡ åŸºäºæ•°æ®ç»“æ„ï¼šä½çº§é€šä¿¡ æ¶ˆæ¯ä¼ é€’ æ¶ˆæ¯åŒ…æ‹¬æ¶ˆæ¯å¤´\u0026amp;æ¶ˆæ¯ä½“ æ“ä½œå‡ç”±åŸè¯­å®Œæˆ\nç›´æ¥é€šä¿¡ï¼šä¸¤è¿›ç¨‹æ˜ç¡®æ¶ˆæ¯çš„æ¥æ”¶æ–¹ä¸å‘é€æ–¹ åœ¨å†…å­˜ä¸­å­˜å‚¨å‘é€äº†çš„æ¶ˆæ¯ å½¢æˆæ¶ˆæ¯é˜Ÿåˆ— é—´æ¥é€šä¿¡ï¼šå‘åˆ°å†…å­˜ä¸­çš„ä¿¡ç®± å¦ä¸€è¿›ç¨‹ä»ä¿¡ç®±è¯»å– ä¿¡ç®±å…¬ç”¨ ç®¡é“é€šä¿¡ æŸæ—¶æ®µå†…å•å‘ä¼ è¾“ï¼ˆåŠåŒå·¥é€šä¿¡ï¼‰ I/Oè¿›ç¨‹ä¸å›ºå®šæ•°é‡\nä¸€ç§å…±äº«æ–‡ä»¶pipe å†…å­˜ä¸­ä¸€ä¸ªå¤§å°å›ºå®šçš„å†…å­˜ç¼“å†²åŒº é˜Ÿåˆ— å…ˆè¿›å…ˆå‡º çº¿ç¨‹ä¸å¤šçº¿ç¨‹ åŒä¸ªè¿›ç¨‹ä¸­å¯èƒ½æœ‰å¤šä¸ªçº¿ç¨‹ ç¨‹åºæ‰§è¡Œçš„æœ€å°å•ä½ï¼ˆç›¸å½“äºå°è¿›ç¨‹ï¼‰\næå‡å¹¶å‘åº¦ ä¸ç”¨åˆ‡æ¢è¿›ç¨‹ï¼ˆåŒè¿›ç¨‹å†…çº¿ç¨‹åˆ‡æ¢ï¼‰ç³»ç»Ÿå¼€é”€å° æ¯ä¸ªçº¿ç¨‹æœ‰è‡ªå·±çš„çº¿ç¨‹IDä¸TCBçº¿ç¨‹æ§åˆ¶å— å‡ ä¹ä¸æ‹¥æœ‰ç³»ç»Ÿèµ„æºï¼ˆæ¥è‡ªæ‰€å±çš„è¿›ç¨‹ï¼‰ é€šä¿¡æ–¹ä¾¿ åŒè¿›ç¨‹å†…ä¸éœ€ç³»ç»Ÿå¹²é¢„ çº¿ç¨‹å®ç°æ–¹å¼ ç”¨æˆ·çº§çº¿ç¨‹ï¼ˆæ—©æœŸï¼‰â€”â€”ç”±çº¿ç¨‹åº“å®ç°\u0026amp;ç®¡ç† ç¨‹åºå®ç° ä¸æ“ä½œç³»ç»Ÿæ— å…³ å¹¶å‘ç¨‹åº¦å¾ˆä½ï¼ˆé˜»å¡ï¼‰ å†…æ ¸çº§çº¿ç¨‹ï¼ˆKTLï¼‰ è¿›ç¨‹ä¸å¯¹åº”çš„å†…æ ¸çº§çº¿ç¨‹éƒ½åœ¨å†…æ ¸æ€çš„æ“ä½œç³»ç»Ÿ å†…æ ¸çº§çº¿ç¨‹ä¸€ä¸€ç®¡ç†ç”¨æˆ·çº§çº¿ç¨‹ çº¿ç¨‹åˆ‡æ¢ç®¡ç†æˆæœ¬æ›´é«˜ å¤šçº¿ç¨‹æ¨¡å‹ ä¸€å¯¹ä¸€ï¼šä¸€å†…æ ¸ä¸€ç”¨æˆ· å¤šå¯¹ä¸€ï¼šä¸€å†…æ ¸å¤šç”¨æˆ·ï¼ˆé€€åŒ–ï¼‰ å¤šå¯¹å¤šï¼šå¤šå†…æ ¸å¤šç”¨æˆ·ï¼ˆå†…æ ¸æ›´å°‘ï¼‰ çº¿ç¨‹çŠ¶æ€ä¸è½¬æ¢ å°±ç»ªâ€”â€”è¿è¡Œâ€”â€”é˜»å¡ çº¿ç¨‹ç»„ç»‡ä¸æ§åˆ¶ TCB(â‰ˆPCB)=çº¿ç¨‹æ ‡è¯†ç¬¦ï¼ˆTIDï¼‰+ç¨‹åºè®¡æ•°å™¨PC+å…¶ä»–å¯„å­˜å™¨+å †æ ˆæŒ‡é’ˆ+çº¿ç¨‹è¿è¡ŒçŠ¶æ€+ä¼˜å…ˆçº§ è°ƒåº¦æ—¶ä¿å­˜PC+å…¶ä»–å¯„å­˜å™¨+å †æ ˆæŒ‡é’ˆ è°ƒåº¦ å¤„ç†æœºè°ƒåº¦ ç¡®å®šå¤„ç†ä»»åŠ¡çš„å…ˆåé¡ºåº\nä¸‰ä¸ªå±‚æ¬¡ é«˜çº§è°ƒåº¦ï¼ˆä½œä¸šè°ƒåº¦ï¼‰â€”â€”ä»å¤–å­˜è°ƒå…¥å†…å­˜å¼€å§‹ä»»åŠ¡ ä½çº§è°ƒåº¦ï¼ˆè¿›ç¨‹è°ƒåº¦ï¼‰â€”â€”æœ€åŸºæœ¬ å¿«é€Ÿ å†…å­˜åˆ°CPU ä¸­çº§è°ƒåº¦ï¼ˆå†…å­˜è°ƒåº¦ï¼‰â€”â€”ä»å¤–å­˜è°ƒåˆ°å†…å­˜ ä»æŒ‚èµ·é˜Ÿåˆ—è°ƒå›å†…å­˜ï¼ˆå†…å­˜ä¸è¶³ï¼‰ è¿›ç¨‹è°ƒåº¦æ—¶æœº ä¸èƒ½è°ƒåº¦çš„eg.å¤„ç†ä¸­æ–­ åŸè¯­ å¤„äºå†…æ ¸ç¨‹åºä¸´ç•ŒåŒºï¼ˆæ“ä½œç³»ç»Ÿå†…ï¼‰ å¯è°ƒåº¦egåŒ…æ‹¬ä¸»åŠ¨ä¸è¢«åŠ¨ æ–¹å¼ï¼š éæŠ¢å æ–¹å¼â€”â€”åä¹‹ æŠ¢å æ–¹å¼â€”â€”æ›´ç´§æ€¥çš„ä»»åŠ¡ä¼˜å…ˆæ‰§è¡Œ å½“å‰ä»»åŠ¡ä¸­æ­¢ é€‚ç”¨åˆ†æ—¶ã€å®æ—¶æ“ä½œç³»ç»Ÿ åŒ…æ‹¬ï¼šé€‰æ‹©è¿›ç¨‹+è¿›ç¨‹åˆ‡æ¢ è°ƒåº¦å™¨ï¼ˆè°ƒåº¦ç¨‹åºï¼‰schedulerä¸é—²é€›è¿›ç¨‹idle è§¦å‘è°ƒåº¦å™¨eg.åˆ›å»ºæ–°è¿›ç¨‹+è¿›ç¨‹é€€å‡º+è¿›ç¨‹é˜»å¡+I/Oä¸­æ–­ï¼ˆmaybeå”¤é†’é˜»å¡è¿›ç¨‹ï¼‰ æŠ¢å å¼è°ƒåº¦ï¼šæ—¶é’Ÿä¸­æ–­è§¦å‘ éæŠ¢å å¼ï¼šonlyé˜»å¡/é€€å‡ºæ‰è§¦å‘ é—²é€›è¿›ç¨‹idleâ€”â€”ä¼˜å…ˆçº§æœ€ä½ å ä¸€ä¸ªå®Œæ•´çš„æŒ‡ä»¤å‘¨æœŸï¼ˆæé†’ä½œç”¨ï¼‰ è°ƒåº¦ç®—æ³•è¯„ä»·æŒ‡æ ‡ CPUåˆ©ç”¨ç‡=åˆ©ç”¨æ—¶é—´/æ€»æ—¶é—´ ç³»ç»Ÿååé‡=å•ä½æ—¶é—´å†…å®Œæˆä½œä¸šçš„æ•°é‡ å‘¨è½¬æ—¶é—´=ä½œä¸šæäº¤è‡³ç³»ç»Ÿ-\u0026gt;ä½œä¸šå®Œæˆçš„æ—¶é—´ å¹³å‡å‘¨è½¬æ—¶é—´=å„ä½œä¸šå‘¨è½¬æ—¶é—´å’Œ/ä½œä¸šæ•° å¸¦æƒå‘¨è½¬æ—¶é—´=å‘¨è½¬æ—¶é—´/å®é™…è¿è¡Œæ—¶é—´ï¼ˆ\u0026gt;=1ï¼‰ å¹³å‡å¸¦æƒå‘¨è½¬æ—¶é—´=å¸¦æƒå’Œ/ä½œä¸šæ•° ç­‰å¾…æ—¶é—´=ç­‰å¾…å¤„ç†æœºçŠ¶æ€æ—¶é—´å’Œ forè¿›ç¨‹ï¼šç­‰å¾…è¢«æœåŠ¡çš„æ—¶é—´ forä½œä¸šï¼šå»ºç«‹è¿›ç¨‹åçš„ç­‰å¾…æ—¶é—´+ä½œä¸šåœ¨å¤–å­˜åå¤‡é˜Ÿåˆ—çš„ç­‰å¾…æ—¶é—´ å“åº”æ—¶é—´=æäº¤è¯·æ±‚-\u0026gt;é¦–æ¬¡å“åº”çš„æ—¶é—´ è°ƒåº¦ç®—æ³• å…ˆæ¥å…ˆæœåŠ¡FCFS first come first serve éæŠ¢å å¼ å…¬å¹³ but é•¿ä½œä¸šæœ‰åˆ© çŸ­ä½œä¸šä¸åˆ© ä¸ä¼šé¥¥é¥¿ï¼ˆé•¿æœŸå¾—ä¸åˆ°æœåŠ¡ï¼‰ çŸ­ä½œä¸šä¼˜å…ˆSJF shortest job firstâ€”â€”å½“å‰å·²åˆ°è¾¾ è¿è¡Œæ—¶é—´æœ€çŸ­ =çŸ­è¿›ç¨‹ä¼˜å…ˆ éæŠ¢å ï¼ˆæŠ¢å ç‰ˆä¸ºæœ€çŸ­å‰©ä½™æ—¶é—´ä¼˜å…ˆç®—æ³•SRNT æ–°è¾¾åˆ°è¿›ç¨‹/è¿›ç¨‹å®Œæˆæ—¶ å‰©ä½™æ—¶é—´æœ€çŸ­è€…æŠ¢å å½“å‰è¿›ç¨‹ SRNTå¹³å‡ç­‰å¾…æ—¶é—´ã€å¹³å‡å‘¨è½¬æ—¶é—´æœ€å°‘ è‹¥æ‰€æœ‰è¿›ç¨‹å‡ ä¹åŒæ—¶åˆ°è¾¾ SJFå¹³å‡ç­‰å¾…æ—¶é—´ã€å¹³å‡å‘¨è½¬æ—¶é—´æœ€å°‘ æ—¶é—´çŸ­ but ä¸å…¬å¹³ é•¿ä½œä¸šä¸åˆ© ä¼šé¥¥é¥¿ maybeé¥¿æ­» é«˜å“åº”æ¯”ä¼˜å…ˆHRRN highest response ratio nextâ€”â€”æ¯æ¬¡è°ƒåº¦æ—¶å…ˆè®¡ç®—å“åº”æ¯” å“åº”æ¯”åŒå…ˆæ¥å…ˆæœåŠ¡ å“åº”æ¯”=(ç­‰å¾…æ—¶é—´+è¦æ±‚æœåŠ¡æ—¶é—´)/è¦æ±‚æœåŠ¡æ—¶é—´ éæŠ¢å å¼ è€ƒè™‘äº†è¦æ±‚æœåŠ¡æ—¶é—´ ä¸ä¼šé¥¥é¥¿\nï¼ˆé€‚ç”¨äºäº¤äº’å¼ç³»ç»Ÿçš„è°ƒåº¦ç®—æ³•ğŸ‘‡ï¼‰ æ—¶é—´ç‰‡è½®è½¬RR round-robinâ€”â€”æ ¹æ®åˆ°è¾¾é¡ºåºè½®æµæ‰§è¡Œä¸€ä¸ªæ—¶é—´ç‰‡ onlyç”¨äºè¿›ç¨‹è°ƒåº¦ å¯æŠ¢å å¼â€”â€”æ—¶é’Ÿä¸­æ–­ å…¬å¹³ but åˆ‡æ¢é¢‘ç¹\u0026amp;ä¸åŒºåˆ†ç´§æ€¥ç¨‹åº¦ æ—¶é—´ç‰‡è¿‡å¤§â€”â€”å¢å¤§è¿›ç¨‹å“åº”æ—¶é—´ è¿‡å°â€”â€”è¿›ç¨‹åˆ‡æ¢è¿‡äºé¢‘ç¹ ä¸ä¼šé¥¥é¥¿ ä¼˜å…ˆçº§â€”â€”è®¾ç½®ä¼˜å…ˆçº§ï¼šç³»ç»Ÿ\u0026gt;ç”¨æˆ· å‰å°\u0026gt;åå° æ›´åå¥½I/Oå‹ï¼ˆI/Oå¯ä»¥å’ŒCPUå¹¶è¡Œå·¥ä½œï¼‰ ä¹Ÿå¯ç”¨äºI/O éæŠ¢å  æœ‰æŠ¢å å¼ç‰ˆæœ¬ è€ƒè™‘ä¼˜å…ˆçº§ but å¯èƒ½å¯¼è‡´é¥¥é¥¿ å¤šçº§åé¦ˆé˜Ÿåˆ—â€”â€”è®¾ç½®å¤šçº§å°±ç»ªé˜Ÿåˆ— ä¼˜å…ˆçº§ä»é«˜åˆ°ä½ æ—¶é—´ç‰‡ä»å°åˆ°å¤§ è§„åˆ™ï¼š æ–°è¿›ç¨‹å…ˆè¿›ç¬¬1çº§é˜Ÿåˆ— FCFSåˆ†é…æ—¶é—´ç‰‡ æ—¶é—´ç‰‡ç”¨å®Œè¿˜æœªç»“æŸ åˆ™è¿›å…¥ä¸‹çº§é˜Ÿå°¾ï¼ˆæœ€ä¸‹çº§çš„å°±è¿›å…¥æœ¬çº§é˜Ÿå°¾ï¼‰ kçº§é˜Ÿåˆ—ä¸ºç©ºæ—¶ å†ä¸ºk+1çº§åˆ†é…æ—¶é—´ç‰‡ è¢«æŠ¢å çš„è¿›ç¨‹è¿›å…¥æ­¤é˜Ÿé˜Ÿå°¾ ç”¨äºè¿›ç¨‹è°ƒåº¦ æŠ¢å å¼ï¼ˆæœ‰éæŠ¢å å¼ç‰ˆæœ¬ï¼‰ ç›¸å¯¹å…¬å¹³ å“åº”å¿« çŸ­è¿›ç¨‹å®Œæˆè¾ƒå¿« é¿å…ç”¨æˆ·ä½œå‡ çµæ´»è°ƒæ•´åå¥½ç¨‹åº¦ maybeé¥¥é¥¿ å¤šçº§é˜Ÿåˆ—â€”â€”æŒ‰è¿›ç¨‹ç±»å‹è®¾ç½®ä¸åŒä¼˜å…ˆçº§ é˜Ÿåˆ—é—´å¯é‡‡å–å›ºå®šä¼˜å…ˆçº§/æ—¶é—´ç‰‡åˆ’åˆ† å„é˜Ÿåˆ—å¯é‡‡ç”¨ä¸åŒè°ƒåº¦ç­–ç•¥ è¿›ç¨‹åŒæ­¥ äº’æ–¥ç­‰ è¿›ç¨‹åŒæ­¥ä¸äº’æ–¥ è¿›ç¨‹åŒæ­¥â€”â€”è¿›ç¨‹çš„æ¬¡åºï¼ˆå¯¹æŠ—å¼‚æ­¥æ€§â€”â€”æœªçŸ¥é€Ÿåº¦ï¼‰ è¿›ç¨‹äº’æ–¥â€”â€”ä¸´ç•Œèµ„æºï¼ˆä¸€æ—¶æ®µä¸€ç¨‹åºè®¿é—®ï¼‰äº’æ–¥ è¿›å…¥åŒºï¼ˆæ£€æŸ¥å¯å¦è¿›å…¥ è®¾ç½®æ­£åœ¨è®¿é—®æ ‡å¿—ï¼‰â€”â€”ä¸´ç•ŒåŒºâ€”â€”é€€å‡ºåŒºï¼ˆè§£é™¤æ ‡å¿—ï¼‰â€”â€”å‰©ä½™åŒº ä¸´ç•ŒåŒºç©ºé—²åˆ™è®©è¿› å¿™åˆ™ç­‰å¾… æœ‰é™ç­‰å¾…â€”â€”èƒ½åœ¨æœ‰é™æ—¶é—´å†…è¿›å…¥ä¸´ç•ŒåŒº è®©æƒç­‰å¾… è¿›ç¨‹äº’æ–¥çš„è½¯ä»¶å®ç° å•æ ‡å¿—æ³•â€”â€”ä¸€ä¸ªflag=å…è®¸è¿›å…¥ä¸´ç•ŒåŒºçš„è¿›ç¨‹å· ç©ºé—²è®©è¿›ä¸ç¬¦ åŒæ ‡å¿—å…ˆæ£€æŸ¥æ³•â€”â€”è¿›ç¨‹æ•°ä¸ªflag è¡¨è¾¾æœ¬è¿›ç¨‹æ˜¯å¦è¿›å…¥ä¸´ç•ŒåŒº å¿™åˆ™ç­‰å¾…ä¸ç¬¦ï¼ˆæ£€æŸ¥ä¸ä¸Šé”ä¸æ˜¯åŒæ—¶å‘ç”Ÿï¼‰ åŒæ ‡å¿—åæ£€æŸ¥æ³•â€”â€”å…ˆä¸Šé”åæ£€æŸ¥ ç©ºé—²è®©è¿› æœ‰é™ç­‰å¾…ä¸ç¬¦ Petersonâ€”â€”è‡ªå·±flagä¸ºtrue \u0026amp; ä¸Šå…¶å®ƒé” \u0026amp; è‹¥å…¶å®ƒflagä¸ºtrueä¸”ä¸Šé”åˆ™è‡ªå·±whileç©ºå¾ªç¯ç­‰å¾… è¿›ç¨‹äº’æ–¥ç¡¬ä»¶å®ç° ä¸­æ–­å±è”½â€”â€”å¼€/å…³ä¸­æ–­æŒ‡ä»¤å®ç° ç®€å•é«˜æ•ˆ but ä¸é€‚ç”¨å¤šå¤„ç†æœºï¼ˆonlyå•å¤„ç†æœºï¼‰\u0026amp;ç‰¹æƒæŒ‡ä»¤ TSæŒ‡ä»¤ TestAndSetLockâ€”â€”æ‰§è¡Œè¿‡ç¨‹ä¸å…è®¸ä¸­æ–­ è®©æƒç­‰å¾…ä¸ç¬¦â€”â€”æ— æ³•è¿›å…¥çš„ç¨‹åºä¼šå ç”¨CPUå¹¶å¾ªç¯TSLæŒ‡ä»¤ SWAPæŒ‡ä»¤ï¼ˆå³XCHGï¼‰â€”â€”ç±»TSLæŒ‡ä»¤ äº’æ–¥é” ä¸»è¦ç¼ºç‚¹ï¼šå¿™ç­‰ éœ€è¦è¿ç»­å¾ªç¯å¿™ç­‰çš„äº’æ–¥é” = è‡ªæ—‹é” é€‚ç”¨å¤šå¤„ç†æœºç³»ç»Ÿ ä¿¡å·é‡æœºåˆ¶ ç”¨æˆ·è¿›ç¨‹ç”¨ä¸€å¯¹åŸè¯­å¯¹ä¿¡å·é‡æ“ä½œ\nä¿¡å·é‡ï¼šå˜é‡ï¼ˆæ•´æ•°/è®°å½•å‹å˜é‡ï¼‰ æ•´å‹ä¿¡å·é‡â€”â€”ä»…åˆå§‹åŒ–ã€Pã€Væ“ä½œ å­˜åœ¨å¿™ç­‰ è®°å½•å‹ä¿¡å·é‡â€”â€”çµæ´»ä½¿ç”¨é˜»å¡æ€ å°±ç»ªæ€ç­‰ valueè¡¨ç¤ºèµ„æºçš„å‰©ä½™æ•°é‡ éµå¾ªè®©æƒç­‰å¾… ä¸€å¯¹åŸè¯­ï¼šwait(S) signal(S) ç®€ç§°ä¸ºPã€Væ“ä½œ å¿…æˆå¯¹å‡ºç° ä¿¡å·é‡æœºåˆ¶åº”ç”¨ å®ç°è¿›ç¨‹äº’æ–¥â€”â€”valueå®šä¸ºäº’æ–¥ä¿¡å·é‡mutexï¼ˆè¿›å…¥ä¸´ç•ŒåŒºçš„åé¢ï¼‰ åˆå€¼ä¸º1 è¿›ç¨‹åŒæ­¥â€”â€”ä¿è¯æ“ä½œé¡ºåºâ€”â€”è®¾ç½®åŒæ­¥ä¿¡å·é‡S åˆå€¼0ï¼ˆåäº’æ–¥ä¹‹é“è€Œè¡Œä¹‹ï¼‰ å…ˆVï¼ˆè¿›ç¨‹ä¸€ç»“æŸåï¼‰åPï¼ˆè¿›ç¨‹äºŒå¼€å§‹å‰ï¼‰â€”â€”Vé‡Šæ”¾èµ„æº Pè·å–èµ„æº å‰é©±å…³ç³» PVä¾‹é¢˜ ç”Ÿäº§è€…æ¶ˆè´¹è€…é—®é¢˜ bgï¼šç”Ÿäº§è€…ç”Ÿäº§ä¸€ä¸ªäº§å“æ”¾å…¥ç¼“å†²åŒº æ¶ˆè´¹è€…æ¯æ¬¡å–å‡ºä¸€ä¸ªäº§å“ ç¼“å†²åŒºæœ‰å¤§å°é™åˆ¶ä¸”ä¸ºä¸´ç•Œèµ„æº PVå…³ç³»ï¼šç¼“å†²åŒºç©ºå¦â€”â€”åŒæ­¥ä¿¡å·é‡ï¼ˆåˆå€¼ä¸ºnï¼‰ æ»¡å¦â€”â€”åŒæ­¥ä¿¡å·é‡ï¼ˆåˆå€¼ä¸º0ï¼‰ è®¿é—®â€”â€”äº’æ–¥ä¿¡å·é‡ Pæ“ä½œï¼šäº’æ–¥ä¿¡å·alwaysåœ¨åŒæ­¥ä¿¡å·åï¼ˆä¸ç©º/æ»¡æ‰è®¿é—®ï¼‰ Vï¼šwhatever å¤šç”Ÿäº§å¤šæ¶ˆè´¹è€… bgï¼šç”Ÿäº§è€…Aç”Ÿäº§a æ¶ˆè´¹è€…Cåªè¦c BDåŒç† ç¼“å†²åŒºä»…èƒ½æ”¾æœ‰é™æ•°é‡ PVï¼šäº’æ–¥â€”â€”è®¿é—® åŒæ­¥â€”â€”å‡ ä¸ªa/bï¼ˆForæ¶ˆè´¹è€…ï¼‰ åŒæ­¥â€”â€”è¿˜å¯ä»¥æ”¾å¤šå°‘ï¼ˆForç”Ÿäº§è€…ï¼‰ å…±4ä¸ª è‹¥ç¼“å†²åŒºå¤§å°ä¸º1 maybeå¯ä»¥ä¸åŠ äº’æ–¥ä¿¡å·é‡ å¸çƒŸè€… bgï¼š3ä¸ªæŠ½çƒŸè€…å’Œ1ä¸ªä¾›åº”è€… å·çƒŸéœ€è¦3ç§ææ–™ ä¸€æŠ½çƒŸè€…æœ‰1ç§ ä¾›åº”è€…æ¯æ¬¡ä¾›åº”2ç§ 1å¯¹åº”æŠ½çƒŸè€…æ‹¿èµ° PVï¼šäº’æ–¥â€”â€”è®¿é—® åŒæ­¥â€”â€”1 2 3æ˜¯å¦å·å¥½ å¯ä»¥çœç•¥äº’æ–¥ è¯»è€…-å†™è€… bgï¼šå…±äº«ä¸€ä¸ªæ–‡ä»¶ å¯ä»¥å¤šä¸ªè¯» ä¸€ä¸ªå†™åˆ™å…¶å®ƒå‡ä¸å¯ å†™æ—¶è®©å·²æœ‰çš„è¯»ä¸å†™å…¨éƒ¨é€€å‡º PVï¼šäº’æ–¥â€”â€”è®°å½•è¯»è¿›ç¨‹ä¸ªæ•°ï¼ˆäº’æ–¥è®¿é—®è®¡æ•°å™¨ï¼‰ äº’æ–¥â€”â€”å†™é” è¯»å†™é”ç­‰ å“²å­¦å®¶è¿›é¤ bgï¼šåœ†æ¡Œ æ¯äººä¸¤è¾¹å„æœ‰ä¸€åªç­·å­ å“²å­¦å®¶è¦ä¹ˆæ€è€ƒè¦ä¹ˆè¿›é£Ÿï¼ˆéœ€è¦ä¸¤åªç­·å­ï¼‰ PVï¼šå¯¹ç­·å­è®¾ç½®äº’æ–¥ æ— é™åˆ¶ä¼šæ­»é”â€”â€”é™åˆ¶æœ€å¤šå››äººè¿›é¤/â€¦ ç®¡ç¨‹ ä¿¡å·é‡æœºåˆ¶â€”â€”ç¼–å†™ç¨‹åºå›°éš¾æ˜“å‡ºé”™ =\u0026gt; å¼•å…¥ç®¡ç¨‹æ›¿ä»£PV\nç»„æˆâ‰ˆç±»ï¼ˆè¿‡ç¨‹â‰ˆJavaä¸­çš„æ–¹æ³•ï¼‰ ç‰¹å¾ï¼šç®¡åŸå†…çš„æ•°æ®åªèƒ½è¢«å…¶å†…éƒ¨çš„è¿‡ç¨‹è®¿é—® + åªæœ‰é€šè¿‡ç®¡ç¨‹çš„è¿‡ç¨‹æ‰èƒ½è®¿é—®å†…éƒ¨çš„å…±äº«æ•°æ® + æ¯æ¬¡ä»…æœ‰ä¸€ä¸ªè¿›ç¨‹åœ¨ç®¡ç¨‹å†…æ‰§è¡Œè¿‡ç¨‹ Javaä¸­çš„ç±»ä¼¼æœºåˆ¶ï¼šsynchronized è¢«å…¶ ä¿®é¥°çš„å‡½æ•°åœ¨åŒä¸€æ—¶æ®µå†…åªèƒ½è¢«ä¸€ä¸ªçº¿ç¨‹è°ƒç”¨ æ­»é” æ¦‚è¿° æ¦‚å¿µ æ­»é”ï¼šå„è¿›ç¨‹äº’ç›¸ç­‰å¾…å¯¹æ–¹çš„èµ„æº = éƒ½é˜»å¡ ç®¡ç†è€…çš„é—®é¢˜ é¥¥é¥¿ï¼šé•¿æœŸå¾—ä¸åˆ°èµ„æº æŸè¿›ç¨‹æ— æ³•æ¨è¿› ç®¡ç†è€…çš„é—®é¢˜ æ­»å¾ªç¯ï¼šè¿›ç¨‹æ‰§è¡Œæ—¶è·³ä¸å‡ºå¾ªç¯ æ¡ä»¶ äº’æ–¥â€”â€”èµ„æºä½¿ç”¨äº’æ–¥ ä¸å‰¥å¤ºâ€”â€”å…¶ä»–è¿›ç¨‹ä¸èƒ½å¼ºè¡Œå¤ºèµ°èµ„æº è¯·æ±‚å’Œä¿æŒâ€”â€”å·²ç»ä¿æŒäº†è‡³å°‘ä¸€ä¸ªèµ„æº ä½†è¿˜æœ‰è¯·æ±‚ å¾ªç¯ç­‰å¾…â€”â€”èµ„æºçš„å¾ªç¯ç­‰å¾…é“¾ å¾ªç¯ç­‰å¾…æ—¶ä¸ä¸€å®šä¼šå‘ç”Ÿæ­»é” å‘ç”Ÿæ­»é”çš„æƒ…å†µ èµ„æºç«äº‰ è¿›ç¨‹æ¨è¿›é¡ºåºéæ³•ï¼ˆè¯·æ±‚ä¸é‡Šæ”¾çš„é¡ºåºä¸å½“ï¼‰ ä¿¡å·é‡ä½¿ç”¨ä¸å½“ = ä¸å¯å‰¥å¤ºçš„èµ„æºåˆ†é…ä¸åˆç†\nå¤„ç†ç­–ç•¥ é¢„é˜²ï¼ˆç ´åå½¢æˆæ¡ä»¶ï¼‰ + é¿å…ï¼ˆé˜²æ­¢è¿›å…¥ä¸å®‰å…¨çŠ¶æ€ï¼‰ + æ£€æµ‹ä¸è§£é™¤\né¢„é˜²æ­»é”ï¼ˆé™æ€ç­–ç•¥ï¼‰ äº’æ–¥æ¡ä»¶ç ´åâ€”â€”æ”¹ä¸ºå…±äº«èµ„æº eg.SPOOLingæŠ€æœ¯ é€‚ç”¨èŒƒå›´çª„ ä¸å‰¥å¤ºç ´åâ€”â€”è¯·æ±‚æ— æ³•æ»¡è¶³æ—¶é‡Šæ”¾æ‰€æœ‰èµ„æº/æ“ä½œç³»ç»Ÿå°†èµ„æºå¼ºè¡Œå‰¥å¤º å¤æ‚+é™ä½ååé‡+maybeé¥¥é¥¿+åªé€‚ç”¨æ˜“ä¿å­˜å›å¤èµ„æº è¯·æ±‚ä¿æŒç ´åâ€”â€”é™æ€åˆ†é…æ–¹æ³•ï¼ˆè¿è¡Œå‰ç”³è¯·æ‰€æœ‰èµ„æº ä¸æ»¡è¶³åˆ™ä¸è¿è¡Œ è¿è¡Œåä¸è¯·æ±‚ï¼‰ èµ„æºåˆ©ç”¨ç‡ä½ maybeé¥¥é¥¿ å¾ªç¯ç­‰å¾…ç ´åâ€”â€”é¡ºåºèµ„æºåˆ†é…æ³•ï¼ˆèµ„æºç¼–å· æ¯ä¸ªè¿›ç¨‹æŒ‰ç¼–å·é€’å¢è¯·æ±‚èµ„æº åŒå·ä¸€æ¬¡ç”³è¯·å®Œï¼‰ éš¾æ–°å¢èµ„æº+èµ„æºæµªè´¹+ç¼–ç¨‹éº»çƒ¦ é¿å…æ­»é”ï¼ˆåŠ¨æ€ç­–ç•¥ï¼‰ å®‰å…¨åºåˆ—ï¼šæŒ‰æ­¤åºåˆ—åˆ†é…èµ„æºåˆ™æ¯ä¸ªè¿›ç¨‹éƒ½èƒ½å®Œæˆ å®‰å…¨ = ä¸€å®šä¸æ­»é” ä¸å®‰å…¨ = ä¸ä¸€å®šæ­»é” é“¶è¡Œå®¶ç®—æ³•ï¼šè¿›ç¨‹ç”³è¯·æ—¶ é¢„åˆ¤åˆ†é…ä¼šå¦å¯¼è‡´ä¸å®‰å…¨ ä¼šåˆ™é˜»å¡è¯¥è¿›ç¨‹ å®‰å…¨æ€§ç®—æ³•ï¼šæ ¹æ®èµ„æºåˆ†é…å¾ªç¯æ‰¾å®‰å…¨åºåˆ— nä¸ªè¿›ç¨‹ mç§èµ„æº = n*mçŸ©é˜µ =\u0026gt;æœ€å¤§éœ€æ±‚çŸ©é˜µMax n*mçš„åˆ†é…çŸ©é˜µAllocation æœ€å¤šè¿˜éœ€è¦å¤šå°‘èµ„æºNeed é•¿mçš„ä¸€ç»´æ•°ç»„Availableè¡¨ç¤ºè¿˜æœ‰å¤šå°‘å¯ç”¨èµ„æº é•¿mçš„ä¸€ç»´æ•°ç»„Requestè¡¨ç¤ºæœ¬æ¬¡ç”³è¯·çš„å„ç§èµ„æº\nä¸æ–­é‡å¤ä¸Šè¿°æ­¥éª¤ æ£€æµ‹ä¸è§£é™¤ æ£€æµ‹ï¼šä¿å­˜èµ„æºçš„è¯·æ±‚ä¸åˆ†é…ä¿¡æ¯ï¼ˆæ•°æ®ç»“æ„ï¼‰+æ£€æµ‹æ˜¯å¦æ­»é”ï¼ˆç®—æ³•ï¼‰ ä¸¤ç§è¾¹ï¼šè¯·æ±‚ä¸åˆ†é… æœ€ç»ˆèƒ½æ¶ˆé™¤æ‰€æœ‰è¾¹ = â€œå¯å®Œå…¨ç®€åŒ–â€ = ä¸€å®šæ²¡æœ‰æ­»é” æ­»é”å®šç†ï¼šè‹¥ä¸èƒ½æ¶ˆé™¤ = å‘ç”Ÿæ­»é” è¿˜è¿ç€çš„è¾¹ = å¤„äºæ­»é”[^2]: æš‚æ—¶æŒ‚åˆ°å¤–å­˜ è§£é™¤ï¼š èµ„æºå‰¥å¤ºæ³•ï¼šæŒ‚èµ·[^2]æŸäº›æ­»é”è¿›ç¨‹ å¹¶å°†å…¶èµ„æºåˆ†ç»™å…¶å®ƒæ­»é”è¿›ç¨‹ æ³¨æ„é˜²æ­¢é¥¥é¥¿ æ’¤é”€è¿›ç¨‹æ³•ï¼šå¼ºåˆ¶æ’¤é”€éƒ¨åˆ†/å…¨éƒ¨æ­»é”è¿›ç¨‹ å¹¶å‰¥å¤ºèµ„æº ä»£ä»·å¤§ è¿›ç¨‹å›é€€æ³•ï¼šä¸€ä¸ª/å¤šä¸ªæ­»é”è¿›ç¨‹å›é€€åˆ°é¿å…æ­»é”çš„åœ°æ­¥ éœ€è®¾ç½®è¿˜åŸç‚¹ è¿›ç¨‹é€‰æ‹©è€ƒè™‘ï¼šè¿›ç¨‹ä¼˜å…ˆçº§ å·²æ‰§è¡Œæ—¶é—´ è¿˜è¦å¤šä¹…å®Œæˆ å·²ä½¿ç”¨å¤šå°‘èµ„æº äº¤äº’å¼oræ‰¹å¤„ç†å¼ å†…å­˜ å†…å­˜åŸºç¡€ å†…å­˜ä¸­å­˜å‚¨ç¨‹åºçš„æœ€å°å•ä½â€”â€”å­˜å‚¨å•å…ƒ æŒ‰å­—èŠ‚ç¼–å€ = æ¯ä¸ªå­˜å‚¨å•å…ƒå¤§å°ä¸º1B 1K=2^10^ 1M=2^20^ 1G=2^30^ é€»è¾‘åœ°å€ï¼ˆç¼–ç¨‹æ—¶æŒ‡å®šçš„ç›¸å¯¹åœ°å€ï¼‰è½¬æ¢ä¸ºç‰©ç†åœ°å€ï¼ˆç»å¯¹åœ°å€ï¼‰æ–¹æ³•ï¼š ç»å¯¹è£…å…¥â€”â€”ç¼–è¯‘æ—¶æŒ‡å®šç»å¯¹åœ°å€ ä¸å­˜åœ¨æ“ä½œç³»ç»Ÿæ—¶åº”ç”¨ é™æ€é‡å®šä½ï¼ˆå¯é‡å®šä½è£…å…¥ï¼‰â€”â€”è£…å…¥æ¨¡å—ï¼ˆexeï¼‰è£…å…¥æ—¶è½¬æ¢ å¿…åˆ†é…è¦æ±‚çš„å…¨éƒ¨å†…å­˜ç©ºé—´ è¿è¡ŒæœŸé—´ä½ç½®ä¸èƒ½ç§»åŠ¨ åŠ¨æ€é‡å®šä½ï¼ˆâ€¦â€¦ï¼‰â€”â€”ç¨‹åºè¦æ‰§è¡Œæ—¶å†è¿›è¡Œè½¬æ¢ éœ€è¦é‡å®šä½å¯„å­˜å™¨â€”â€”å¯„å­˜è£…å…¥æ¨¡å—å­˜æ”¾çš„èµ·å§‹ä½ç½® å…è®¸ç¨‹åºåœ¨å†…å­˜ä¸­ç§»åŠ¨ é“¾æ¥æ–¹å¼ é™æ€é“¾æ¥â€”â€”è¿è¡Œå‰é“¾æ¥ä¸ºè£…å…¥æ¨¡å— è£…å…¥æ—¶åŠ¨æ€é“¾æ¥â€”â€”è£…å…¥å†…å­˜æ—¶ è¾¹è£…å…¥è¾¹é“¾æ¥ è¿è¡Œæ—¶åŠ¨æ€é“¾æ¥â€”â€”æ‰§è¡Œæ—¶éœ€è¦æŸæ¨¡å—æ‰é“¾æ¥ å†…å­˜ç®¡ç† æ¦‚å¿µ åŠŸèƒ½ï¼šå†…å­˜ç©ºé—´çš„åˆ†é…ä¸å›æ”¶ + å†…å­˜ç©ºé—´çš„æ‰©å±• + åœ°å€è½¬æ¢ + å†…å­˜ä¿æŠ¤ å†…å­˜ä¿æŠ¤æ–¹æ³•ï¼š CPUä¸­è®¾ç½®ä¸Šä¸‹é™å¯„å­˜å™¨â€”â€”é™å®šè¿›ç¨‹å¯è®¿é—®çš„ç©ºé—´ é‡å®šä½å¯„å­˜å™¨ï¼ˆåŸºå€å¯„å­˜å™¨ï¼‰+ç•Œåœ°å€å¯„å­˜å™¨ï¼ˆé™é•¿å¯„å­˜å™¨ï¼‰=èµ·å§‹ç‰©ç†åœ°å€ + æœ€å¤§é€»è¾‘åœ°å€ æœ€å¤§é€»è¾‘åœ°å€åˆ¤å®šæ˜¯å¦è¶Šç•Œå¼‚å¸¸ èµ·å§‹ç‰©ç†åœ°å€ç¡®å®šè¢«æŸ¥è¯¢æ•°æ®çš„å…·ä½“ä½ç½® è¦†ç›–ä¸äº¤æ¢ï¼ˆå†…å­˜ç©ºé—´çš„æ‰©å±•ï¼‰ è¦†ç›–ï¼šä¸èƒ½åŒæ—¶è¿›è¡Œçš„ç¨‹åºæ®µå…±äº«åŒä¸€ç‰‡è¦†ç›–åŒº ä¸€ä¸ªå›ºå®šåŒºï¼ˆç¨‹åºæ®µä¸ä¼šè¢«è°ƒå…¥è°ƒå‡ºï¼‰+è‹¥å¹²è¦†ç›–åŒº ç¨‹åºå‘˜æå‰å£°æ˜ å¯¹ç”¨æˆ·ä¸é€æ˜â€”â€”å·²æ·˜æ±° äº¤æ¢ï¼šå†…å­˜ç´§å¼ æ—¶ å†…å­˜ä¸­æŸè¿›ç¨‹æš‚æ—¶æ¢å‡ºå¤–å­˜ å¤–å­˜ä¸­æŸè¿›ç¨‹æ¢å…¥å†…å­˜ å¤–å­˜ï¼ˆç£ç›˜ï¼‰åŒ…æ‹¬æ–‡ä»¶åŒº\u0026amp;å¯¹æ¢åŒºâ€”â€”å¯¹æ¢åŒºIOé€Ÿåº¦æ¯”æ–‡ä»¶åŒºæ›´å¿«ï¼ˆå¯¹æ¢åŒºä¸»è¦è¿½æ±‚æ•ˆç‡ï¼‰ å¯ä¼˜å…ˆæ¢å‡ºé˜»å¡/ä¼˜å…ˆçº§ä½è¿›ç¨‹/â€¦â€¦ PCBå¸¸é©»å†…å­˜ ä¸ä¼šè¢«æ¢å‡ºï¼ˆå‚¨å­˜è¿›ç¨‹æ¢å‡ºåœ¨å¤–å­˜çš„ä½ç½®ï¼‰ è¿ç»­åˆ†é…ç®¡ç†æ–¹å¼ ä¸ºè¿›ç¨‹åˆ†é…è¿ç»­çš„å†…å­˜ç©ºé—´\nå•ä¸€è¿ç»­åˆ†é…ï¼šå†…å­˜ = ç³»ç»ŸåŒº + ç”¨æˆ·åŒº å†…å­˜ä¸­åªèƒ½æœ‰ä¸€ä¸ªç”¨æˆ·ç¨‹åº æ— å¤–éƒ¨ç¢ç‰‡ æœ‰å†…éƒ¨ç¢ç‰‡ï¼ˆåˆ†é…çš„å†…å­˜åŒºåŸŸæœ‰éƒ¨åˆ†æ²¡æœ‰ç”¨ä¸Šï¼‰ å›ºå®šåˆ†åŒºåˆ†é…â€”â€”ç”¨æˆ·ç©ºé—´åˆ’åˆ†ä¸ºå›ºå®šå¤§å°çš„åˆ†åŒº æ¯ä¸ªåˆ†åŒºè¿è¡Œä¸€é“ä½œä¸šï¼ˆåˆ†åŒºå¤§å°å¯ç›¸åŒ/ä¸ç›¸åŒï¼‰ åˆ†åŒºè¯´æ˜è¡¨ï¼ˆæ•°ç»„/é“¾è¡¨è¡¨ç¤ºï¼‰ï¼šè®°å½•åˆ†åŒºå¤§å° èµ·å§‹åœ°å€ çŠ¶æ€ç­‰ æ— å¤–éƒ¨ç¢ç‰‡ but ç”¨æˆ·ç¨‹åºè¿‡å¤§åªèƒ½è¦†ç›– ä¼šäº§ç”Ÿå†…éƒ¨ç¢ç‰‡ åŠ¨æ€åˆ†åŒºåˆ†é…ï¼ˆå¯å˜åˆ†åŒºåˆ†é…ï¼‰ åŠ¨æ€åˆ†åŒºåˆ†é…çš„å‡ ä¸ªé—®é¢˜ ç©ºé—²åˆ†åŒºè¡¨/é“¾å­˜å‚¨å†…å­˜ä½¿ç”¨æƒ…å†µ\nâ€¦é“¾ï¼šç©ºé—²åˆ†åŒºèµ·å§‹åŠ å‰å‘æŒ‡é’ˆ æœ«å°¾åŠ åå‘æŒ‡é’ˆ å¤šä¸ªç©ºé—²åˆ†åŒºåˆ†é…â€”â€”åŠ¨æ€åˆ†åŒºåˆ†é…ç®—æ³•\nåˆ†åŒºçš„åˆ†é…ä¸å›æ”¶â€”â€”ç®€å•çš„ä¿®æ”¹è¡¨é¡¹æ“ä½œ\nç‰¹ç‚¹ï¼šæ²¡æœ‰å†…å­˜ç¢ç‰‡ but æœ‰å¤–éƒ¨ç¢ç‰‡\nå¤–éƒ¨ç¢ç‰‡ï¼šå†…å­˜ä¸­æŸäº›ç©ºé—²åˆ†åŒºå› å¤ªå°è€Œéš¾ä»¥åˆ©ç”¨ å¯é€šè¿‡ç´§å‡‘ï¼ˆæ‹¼å‡‘Compactionï¼‰è§£å†³â€”â€”æ¢å…¥æ¢å‡º è£…å…¥æ–¹å¼é€‰æ‹©ï¼Ÿ åŠ¨æ€é‡å®šä½ ç´§å‡‘ä¹‹åï¼Ÿ ä¿®æ”¹èµ·å§‹åœ°å€â€”â€”PCB ä¹Ÿè¦æ”¾å…¥CPUçš„åŸºå€å¯„å­˜å™¨ åŠ¨æ€åˆ†åŒºåˆ†é…ç®—æ³• é¦–æ¬¡é€‚åº”ç®—æ³•ï¼šä»ä½åœ°å€å¼€å§‹æŸ¥æ‰¾ æ‰¾åˆ°ç¬¬ä¸€ä¸ªæ»¡è¶³å¤§å°çš„ç©ºé—²åˆ†åŒº ç©ºé—²åˆ†åŒºæŒ‰åœ°å€é€’å¢çš„æ¬¡åºæ’åˆ— ç®—æ³•å¼€é”€å° æ€§èƒ½æœ€å¥½ æœ€ä½³é€‚åº”ç®—æ³•ï¼šä¼˜å…ˆä½¿ç”¨æ›´å°çš„ç©ºé—²åŒº æŒ‰å®¹é‡é€’å¢æ¬¡åºæ’åˆ— ä¼šäº§ç”Ÿå¾ˆå¤šå¤–éƒ¨ç¢ç‰‡ + ç®—æ³•å¼€é”€å¤§ æœ€åé€‚åº”ç®—æ³•ï¼šä¼˜å…ˆä½¿ç”¨æœ€å¤§çš„è¿ç»­ç©ºé—²åŒº å®¹é‡é€’å‡æ¬¡åº å¯èƒ½å¤§è¿›ç¨‹æ— å¤„å®‰æ”¾ + ç®—æ³•å¼€é”€å¤§ é‚»è¿‘é€‚åº”ç®—æ³•ï¼šé¦–æ¬¡é€‚åº” + æ¯æ¬¡ä»ä¸Šæ¬¡æŸ¥æ‰¾ç»“æŸçš„ä½ç½®å¼€å§‹æ£€ç´¢ åœ°å€é€’å¢æ¬¡åº\u0026amp;ä¸Šæ¬¡æŸ¥æ‰¾ç»“æŸ é«˜åœ°å€çš„å¤§åˆ†åŒºå¯èƒ½è¢«ç”¨å®Œ åŸºæœ¬åˆ†é¡µå­˜å‚¨ç®¡ç†ï¼ˆéè¿ç»­åˆ†é…ç®¡ç†æ–¹å¼ï¼‰ åˆ†é¡µå­˜å‚¨ï¼š å†…å­˜ç©ºé—´åˆ†ä¸ºå¤§å°ç›¸ç­‰çš„åˆ†åŒº æ¯ä¸ªåˆ†åŒºå°±æ˜¯ä¸€ä¸ªé¡µæ¡† æ¯ä¸ªé¡µæ¡†æœ‰ç¼–å· å³é¡µæ¡†å· é¡µæ¡†=é¡µå¸§=å†…å­˜å—=ç‰©ç†å—=ç‰©ç†é¡µé¢ é¡µæ¡†å·=é¡µå¸§å·=å†…å­˜å—å·=ç‰©ç†å—å·=ç‰©ç†é¡µå· é¡µæ¡†å·ä»0å¼€å§‹ è¿›ç¨‹çš„é€»è¾‘åœ°å€ç©ºé—´åˆ†ä¸ºä¸é¡µæ¡†å¤§å°ç›¸ç­‰çš„éƒ¨åˆ† æ¯ä¸ªéƒ¨åˆ†å³ä¸ºé¡µé¢ æ¯ä¸ªé¡µé¢æ ‡å·ä¸ºé¡µå· é¡µé¢=é¡µ é¡µå·ä»0å¼€å§‹ é¡µé¢ä¸é¡µæ¡†ä¸€ä¸€å¯¹åº” å„é¡µé¢ä¸å¿…è¿ç»­å­˜æ”¾ é¡µè¡¨ é€šå¸¸ä¿å­˜åœ¨PCBä¸­\nä¸€è¿›ç¨‹å¯¹åº”ä¸€å¼ é¡µè¡¨ è¿›ç¨‹çš„æ¯ä¸ªé¡µé¢å¯¹åº”ä¸€ä¸ªé¡µè¡¨é¡¹ï¼ˆ=é¡µå·+å—å·ï¼‰ è®°å½•è¿›ç¨‹é¡µé¢å’Œå®é™…å­˜æ”¾çš„å†…å­˜å—é—´çš„æ˜ å°„å…³ç³» é—®é¢˜ï¼šæ¯ä¸ªé¡µè¡¨é¡¹å å¤šå°‘å­—èŠ‚ï¼Ÿ ä»å†…å­˜å—å·èŒƒå›´ï¼ˆå¦‚0~2^20^-1ï¼‰ç¡®å®šï¼ˆäºŒè¿›åˆ¶è¡¨ç¤ºè‡³å°‘éœ€è¦20bit å³å†…å­˜å—å·å¤§å°ï¼‰ ç”¨Bï¼ˆå­—èŠ‚ï¼‰è¡¨ç¤ºè‡³å°‘3Bï¼ˆ1B=8bitï¼‰ å³è‡³å°‘ç”¨3Bè¡¨ç¤ºå—å· é¡µå·ä¸å å­˜å‚¨ç©ºé—´â€”â€”é¡µè¡¨é¡¹è¿ç»­å­˜æ”¾ é—®é¢˜ï¼šå¦‚ä½•å®ç°åœ°å€è½¬æ¢ï¼Ÿ ç¡®å®šé¡µå·+é¡µå†…åç§»é‡ åŸºæœ¬åœ°å€å˜æ¢æœºæ„ é€»è¾‘åœ°å€åˆ°ç‰©ç†åœ°å€çš„è½¬æ¢\næ³¨æ„è¶Šç•Œæ£€æŸ¥â€”â€”ä»ç³»ç»ŸåŒºçš„PCBè°ƒå‡ºæ•°æ® æ”¾åˆ°é¡µè¡¨å¯„å­˜å™¨ï¼ˆé¡µè¡¨å§‹å€ + é¡µè¡¨é•¿åº¦ï¼‰ é¡µè¡¨é•¿åº¦å³é¡µè¡¨ä¸­æœ‰å¤šå°‘é¡µè¡¨é¡¹ å®é™…ä¼šæ‹“å±•é¡µè¡¨é¡¹å¤§å°â€”â€”æœ€å¥½ä¸€ä¸ªé¡µæ¡†èƒ½è£…ä¸‹æ•´æ•°ä¸ªé¡µè¡¨é¡¹ï¼ˆè·Ÿè¿›ç¨‹å­˜å‚¨ç›¸ç‹¬ç«‹ï¼‰ å…·æœ‰å¿«è¡¨åœ°åœ°å€å˜æ¢æœºæ„ å¿«è¡¨TLBï¼ˆè”æƒ³å¯„å­˜å™¨translation lookaside bufferï¼‰â€”â€”è®¿é—®é€Ÿåº¦æ¯”å†…å­˜å¿«å¾ˆå¤šçš„é«˜é€Ÿç¼“å­˜ï¼ˆCacheï¼‰ éå†…å­˜ï¼ˆå†…å­˜ä¸­çš„é¡µè¡¨è¢«ç§°ä¸ºæ…¢è¡¨ï¼‰ å­˜æ”¾æœ€è¿‘è®¿é—®çš„é¡µè¡¨é¡¹çš„å‰¯æœ¬ æ™®é€šCacheä¸­å­˜æ”¾å…¶å®ƒå†…å®¹çš„å‰¯æœ¬ åœ¨å¿«è¡¨ä¸­æŸ¥è¯¢æ˜¯å¦æœ‰éœ€æŸ¥æ‰¾çš„é¡µè¡¨é¡¹ è‹¥æœªå‘½ä¸­åˆ™è®¿é—®å†…å­˜ä¸­æ…¢è¡¨â€”â€”å†…å­˜ä¸­æœ€è¿‘è®¿é—®è¿‡çš„é¡µè¡¨é¡¹å­˜æ”¾åˆ°å¿«è¡¨ä¸­ ä¸¤çº§é¡µè¡¨ å°†é¡µè¡¨æ‹†åˆ†ä¸ºå¾ˆå¤šå°é¡µè¡¨â€”â€”é¡µç›®å½•è¡¨å­˜å‚¨å°é¡µè¡¨å­˜æ”¾ä½ç½® äºŒçº§é¡µè¡¨å­˜æ”¾è¿›ç¨‹é¡µé¢çš„å­˜æ”¾ä½ç½® äºŒçº§é¡µè¡¨å¯ä»¥ç¦»æ•£å­˜å‚¨ é€»è¾‘åœ°å€ç»“æ„ = ä¸€çº§é¡µå· + äºŒçº§é¡µå· + é¡µå†…åç§»é‡ å„çº§é¡µè¡¨æœ€å¤šå­˜å‚¨é¡µè¡¨é¡¹æ•°é‡ = å„é¡µé¢å¯å­˜æ”¾çš„æœ€å¤šé¡µè¡¨é¡¹ åŸºæœ¬åˆ†æ®µå­˜å‚¨ç®¡ç†ï¼ˆéè¿ç»­åˆ†é…ç®¡ç†æ–¹å¼ï¼‰ åˆ†æ®µï¼šç¨‹åºè‡ªèº«é€»è¾‘åˆ’åˆ†ä¸ºè‹¥å¹²æ®µ æ¯æ®µæœ‰æ®µåï¼ˆä½çº§è¯­è¨€â€”â€”æ±‡ç¼–è¯­è¨€ æŒ‰æ®µåç¼–ç¨‹ï¼‰ æ¯æ®µä»0å¼€å§‹ç¼–å€ æ®µå·ä½æ•°å†³å®šäº†æ¯ä¸ªè¿›ç¨‹æœ€å¤šåˆ†å¤šå°‘æ®µ æ®µå†…åœ°å€æ•°å†³å®šäº†æ¯æ®µæœ€å¤§é•¿åº¦ æ®µè¡¨ï¼šä¿å­˜é€»è¾‘æ®µå­˜æ”¾ä½ç½® = æ®µå· + æ®µé•¿ + åŸºå€ï¼ˆæ®µå·éšå« ä¸å å†…å­˜ï¼‰ å„æ®µè¡¨é¡¹é•¿åº¦ç›¸åŒ åœ°å€å˜æ¢â€”â€”æ®µè¡¨å¯„å­˜å™¨ï¼ˆæ®µè¡¨å§‹å€+æ®µè¡¨é•¿åº¦ï¼‰\u0026amp;æ®µå†…åœ°å€ä¸æ®µé•¿ è¿›è¡Œè¶Šç•Œä¸­æ–­æ£€æŸ¥ åˆ†é¡µ\u0026amp;åˆ†æ®µ é¡µæ˜¯ä¿¡æ¯çš„ç‰©ç†å•ä½ å¯¹ç”¨æˆ·ä¸å¯è§ è¿›ç¨‹åœ°å€ç©ºé—´ä¸ºä¸€ç»´ æ®µæ˜¯ä¿¡æ¯çš„é€»è¾‘å•ä½ å¯¹ç”¨æˆ·å¯è§ è¿›ç¨‹åœ°å€ç©ºé—´ä¸ºäºŒç»´ æ›´æ˜“å®ç°ä¿¡æ¯å…±äº«ä¸ä¿æŠ¤ ä¸ä¼šè¢«ä¿®æ”¹çš„ä»£ç ï¼ˆå³çº¯ä»£ç ï¼‰æ‰å¯ä»¥å…±äº« æ®µé¡µå¼ç®¡ç†æ–¹å¼ï¼ˆéè¿ç»­åˆ†é…ç®¡ç†æ–¹å¼ï¼‰ åˆ†é¡µåˆ†æ®µä¼˜ç¼ºç‚¹ï¼šåˆ†é¡µä¸ä¼šäº§ç”Ÿå¤–éƒ¨ç¢ç‰‡ ä½†ä¸èƒ½æŒ‰é€»è¾‘å®ç°ä¿¡æ¯å…±äº« åˆ†æ®µåä¹‹ æ®µé¡µå¼ = å…ˆåˆ†æ®µ \u0026amp; æ¯æ®µå†åˆ†é¡µ é€»è¾‘åœ°å€ç»“æ„ = æ®µå· + é¡µå· + é¡µå†…åç§»é‡ ä¸€ä¸ªæ®µè¡¨ + nä¸ªé¡µè¡¨ é¡µéƒ¨åˆ†å¯¹ç”¨æˆ·ä¸å¯è§ åªéœ€æŒ‡å®šæ®µå·ä¸æ®µå†…åç§»é‡ æ£€æŸ¥æ®µå· é¡µå·æ˜¯å¦è¶Šç•Œ è™šæ‹Ÿå†…å­˜ï¼ˆå†…å­˜çš„æ‰©å……ï¼‰ å±€éƒ¨æ€§åŸç† æ—¶é—´å±€éƒ¨æ€§â€”â€”æŸæŒ‡ä»¤/æ•°æ®è‹¥è¢«è°ƒç”¨è¿‡ ä¸ä¹…åå¾ˆå¯èƒ½å†æ¬¡è¢«è°ƒç”¨ ç©ºé—´å±€éƒ¨æ€§â€”â€”æŸå­˜å‚¨å•å…ƒè‹¥è¢«è®¿é—®è¿‡ ä¸ä¹…åå…¶é™„è¿‘å­˜å‚¨å•å…ƒå¾ˆå¯èƒ½è¢«è®¿é—® å¾ˆå¤šæ•°æ®åœ¨å†…å­˜ä¸­è¿ç»­å­˜æ”¾ ç¨‹åºæŒ‡ä»¤ä¹Ÿæ˜¯é¡ºåºå­˜æ”¾ è™šæ‹Ÿå†…å­˜â€”â€”å¾ˆå¿«ä¼šç”¨åˆ°çš„éƒ¨åˆ†è£…å…¥å†…å­˜ å‰©ä¸‹çš„åœ¨å¤–å­˜ + è‹¥æ‰§è¡Œæ—¶æŸä¿¡æ¯ä¸åœ¨å†…å­˜ æ“ä½œç³»ç»Ÿå°†å…¶è°ƒå…¥ + å†…å­˜ä¸å¤Ÿæ—¶å°†æš‚æ—¶ä¸ç”¨çš„è°ƒå‡º ç‰¹å¾ï¼š å¤šæ¬¡æ€§â€”â€”æ— éœ€ä¸€æ¬¡æ€§è£…å…¥ å¯¹æ¢æ€§â€”â€”ä½œä¸šè¿è¡Œæ—¶å…è®¸æ¢å…¥æ¢å‡º è™šæ‹Ÿæ€§â€”â€”é€»è¾‘ä¸Šæ‰©å……å†…å­˜å®¹é‡ ç®¡ç†ï¼šè¯·æ±‚åˆ†é¡µç®¡ç†æ–¹å¼\u0026amp;è¯·æ±‚åˆ†æ®µç®¡ç†æ–¹å¼\u0026amp;è¯·æ±‚æ®µé¡µå¼ç®¡ç†æ–¹å¼ å®ç°ï¼šæ“ä½œç³»ç»Ÿæä¾›è¯·æ±‚è°ƒé¡µåŠŸèƒ½ + é¡µé¢ç½®æ¢åŠŸèƒ½ï¼ˆForåˆ†é¡µ åˆ†æ®µç±»ä¼¼ï¼‰ è¯·æ±‚åˆ†é¡µç®¡ç†æ–¹å¼ é¡µè¡¨æœºåˆ¶ï¼šæ“ä½œç³»ç»Ÿéœ€çŸ¥é¡µé¢æ˜¯å¦å·²è°ƒå…¥å†…å­˜/å¤–å­˜å­˜æ”¾ä½ç½® å†…å­˜ç©ºé—´ä¸å¤Ÿæ—¶è¿›è¡Œé¡µé¢ç½®æ¢â€”â€”ä¿®æ”¹è¿‡çš„é¡µé¢è°ƒå‡ºè¦†ç›–å¤–å­˜ä¸­æ—§æ•°æ® æœªä¿®æ”¹çš„ä¸å˜ ç¼ºé¡µä¸­æ–­ï¼šè‹¥é¡µé¢ä¸åœ¨å†…å­˜åˆ™äº§ç”Ÿ ç¼ºé¡µçš„è¿›ç¨‹é˜»å¡ è°ƒé¡µå®Œæˆåå”¤é†’å°±ç»ª ä¸­æ–­å¤„ç†ç¨‹åºéœ€è¦ä¿å­˜CPUç°åœº ä¸­æ–­ä¿¡å·æ¥è‡ªCPU ä¸ºå†…ä¸­æ–­ åœ°å€å˜æ¢æœºæ„ï¼šæ–°å¢è¯·æ±‚è°ƒé¡µ \u0026amp; é¡µé¢ç½®æ¢ \u0026amp; ä¿®æ”¹è¯·æ±‚é¡µè¡¨ä¸­çš„æ–°å¢è¡¨é¡¹ è°ƒå…¥çš„é¡µé¢å¯¹åº”çš„è¡¨é¡¹ä¼šç›´æ¥åŠ å…¥å¿«è¡¨ é¡µé¢ç½®æ¢ç®—æ³• é€‰æ‹©å“ªä¸ªé¡µé¢è¢«æ¢å‡º\næœ€ä½³ç½®æ¢ç®—æ³•OPTï¼šæ·˜æ±°ä»¥åæ°¸ä¸ä½¿ç”¨/æœ€é•¿æ—¶é—´ä¸è®¿é—®çš„é¡µé¢ ä¿è¯æœ€ä½ç¼ºé¡µç‡ ä¸å¯èƒ½å®ç° å…ˆè¿›å…ˆå‡ºFIFOï¼šæ·˜æ±°æœ€æ—©è¿›å…¥å†…å­˜çš„é¡µé¢ ä¸ºè¿›ç¨‹åˆ†é…çš„ç‰©ç†å—æ•°ï¼ˆå†…å­˜å—ï¼‰å¢å¤šæ—¶ ç¼ºé¡µæ¬¡æ•°åè€Œå¢åŠ  = Beladyå¼‚å¸¸ åªæœ‰FIFOæœ‰Belady æ€§èƒ½å·® æœ€è¿‘æœ€ä¹…æœªä½¿ç”¨ç½®æ¢ç®—æ³•LRUï¼šæ·˜æ±°è‡ªä¸Šæ¬¡è®¿é—®è‡³ä»Šæ—¶é—´æœ€é•¿çš„é¡µé¢ æ€§èƒ½å¥½ but å®ç°å›°éš¾å¼€é”€å¤§ æ—¶é’Ÿç½®æ¢CLOCK/æœ€è¿‘æœªç”¨NRUï¼šï¼ˆç®€å•ç‰ˆï¼‰å†…å­˜ä¸­é¡µé¢ç”¨æŒ‡é’ˆé“¾æ¥ä¸ºå¾ªç¯é˜Ÿåˆ— è¢«è®¿é—®æ—¶è®¿é—®ä½è®¾ä¸º1 æ·˜æ±°æ—¶é‡1ç½®0 é‡0æ·˜æ±° æœ€å¤šç»è¿‡ä¸¤è½®æ‰«æè¿›è¡Œæ·˜æ±°é¡µé¢ æœªè€ƒè™‘æ˜¯å¦ä¿®æ”¹ æ”¹è¿›ç‰ˆæ—¶é’Ÿç½®æ¢ï¼šè®¾ç½®ä¿®æ”¹ä½ 0è¡¨ç¤ºæœªè¢«ä¿®æ”¹ 1è¡¨ç¤ºè¢«ä¿®æ”¹ ä¼˜å…ˆæ·˜æ±°(0,0)ï¼ˆè®¿é—®ä½ï¼Œä¿®æ”¹ä½ï¼‰ äºŒè½®æ·˜æ±°(0,1) å¹¶æŠŠæ‰«æè¿‡çš„é¡µé¢è®¿é—®ä½ç½®0 ä¸‰è½®æ·˜æ±°(0,0)ï¼Œå››è½®æ·˜æ±°(0,1)ï¼ˆè®¿é—®ä½å‡ä¸º0ï¼Œæ•…æ€»æœ‰é¡µé¢è¢«æ·˜æ±°ï¼‰ ç®—æ³•å¼€é”€å° \u0026amp; æ€§èƒ½å¯ é¡µé¢åˆ†é…ç­–ç•¥ é©»ç•™é›† è¯·æ±‚åˆ†é¡µå­˜å‚¨ç®¡ç†ä¸­ç»™è¿›ç¨‹åˆ†é…çš„ç‰©ç†å—é›†åˆ\nè™šæ‹Ÿå­˜å‚¨æŠ€æœ¯çš„ç³»ç»Ÿä¸­ é©»ç•™é›†ä¸€èˆ¬å°äºè¿›ç¨‹æ€»å¤§å° é¡µé¢åˆ†é…ç½®æ¢ç­–ç•¥ å›ºå®šåˆ†é… \u0026amp; å¯å˜åˆ†é… é©»ç•™é›†å¤§å°åœ¨è¿›ç¨‹è¿è¡ŒæœŸé—´æ˜¯å¦å¯å˜ å±€éƒ¨ç½®æ¢ \u0026amp; å…¨å±€ç½®æ¢ ç¼ºé¡µæ—¶ åªèƒ½é€‰è¿›ç¨‹è‡ªå·±çš„ç‰©ç†å—è¿›è¡Œç½®æ¢ å¯é€‰å…¶ä»–è¿›ç¨‹çš„ç‰©ç†å—/æ“ä½œç³»ç»Ÿä¿ç•™çš„ç‰©ç†å— å›ºå®šåˆ†é…å±€éƒ¨ç½®æ¢ éš¾ä»¥åœ¨åˆæœŸç¡®å®šåˆç†çš„ç‰©ç†å—æ•°ç›® å¯å˜åˆ†é…å…¨å±€ç½®æ¢â€”â€”é€‰æ‹©æœªé”å®šé¡µé¢æ¢å‡ºå¤–å­˜ å°†å…¶åˆ†é…ï¼ˆåªè¦ç¼ºé¡µå°±åˆ†é…æ–°ç‰©ç†å—ï¼‰ è¢«é€‰ä¸­çš„è¿›ç¨‹ç¼ºé¡µç‡å¢åŠ  å¯å˜åˆ†é…å±€éƒ¨ç½®æ¢â€”â€”é¢‘ç¹ç¼ºé¡µ ç³»ç»Ÿä¼šå¤šåˆ†é…ç‰©ç†å— è°ƒå…¥é¡µé¢æ—¶æœº é¢„è°ƒé¡µç­–ç•¥â€”â€”ç›¸é‚»é¡µé¢è°ƒå…¥ ä¸»è¦ç”¨äºè¿›ç¨‹é¦–æ¬¡è°ƒå…¥ è¯·æ±‚è°ƒé¡µç­–ç•¥â€”â€”ç¼ºé¡µæ—¶è°ƒå…¥ æŠ–åŠ¨ç°è±¡ï¼ˆé¢ ç°¸ï¼‰ åˆšæ¢å‡ºçš„é¡µé¢é©¬ä¸Šéœ€æ¢å…¥å†…å­˜\nåŸå› ï¼šé¢‘ç¹è®¿é—®çš„é¡µé¢æ•°ç›®é«˜äºå¯ç”¨çš„ç‰©ç†å—æ•°ï¼ˆç‰©ç†å—ä¸å¤Ÿï¼‰ å·¥ä½œé›†ï¼šæŸæ—¶é—´é—´éš”é‡Œ è¿›ç¨‹å®é™…è®¿é—®é¡µé¢çš„é›†åˆ ä¸€èˆ¬é©»ç•™é›†\u0026lt;å·¥ä½œé›† å¦åˆ™ä¼šé¢‘ç¹ç¼ºé¡µ å†…å­˜æ˜ å°„æ–‡ä»¶Memory-Mapped Files å°†æ–‡ä»¶æ˜ å°„åˆ°è¿›ç¨‹çš„è™šæ‹Ÿåœ°å€ç©ºé—´â€”â€”ä»¥è®¿é—®å†…å­˜çš„æ–¹å¼è®¿é—®æ–‡ä»¶ è¯»å…¥å†™å‡ºç”±æ“ä½œç³»ç»Ÿè´Ÿè´£ å¤šä¸ªè¿›ç¨‹å¯ä»¥æ˜ å°„åŒä¸ªæ–‡ä»¶ å®ç°å…±äº« æ–‡ä»¶ç®¡ç† åœ¨ç£ç›˜ï¼ˆå¤–å­˜ï¼‰ä¸­\næ–‡ä»¶çš„é€»è¾‘ç»“æ„ é€»è¾‘ç»“æ„ Forç”¨æˆ·ï¼ˆçœ‹æ¥ å†…éƒ¨æ•°æ®å¦‚ä½•ç»„ç»‡ï¼‰ ç‰©ç†ç»“æ„ Foræ“ä½œç³»ç»Ÿï¼ˆçœ‹æ¥ æ–‡ä»¶æ•°æ®å¦‚ä½•å­˜æ”¾åœ¨å¤–å­˜ï¼‰\nflowchart LR é€»è¾‘ç»“æ„--\u0026gt;æ— ç»“æ„æ–‡ä»¶ é€»è¾‘ç»“æ„--\u0026gt;æœ‰ç»“æ„æ–‡ä»¶ æœ‰ç»“æ„æ–‡ä»¶--\u0026gt;é¡ºåºæ–‡ä»¶ æœ‰ç»“æ„æ–‡ä»¶--\u0026gt;ç´¢å¼•æ–‡ä»¶ æœ‰ç»“æ„æ–‡ä»¶--\u0026gt;ç´¢å¼•é¡ºåºæ–‡ä»¶ é¡ºåºæ–‡ä»¶--\u0026gt;é¡ºåºå­˜å‚¨ é¡ºåºæ–‡ä»¶--\u0026gt;é“¾å¼å­˜å‚¨ æ— ç»“æ„æ–‡ä»¶ï¼ˆæµå¼æ–‡ä»¶ï¼‰â€”â€”å†…éƒ¨æ•°æ®ä¸ºä¸€ç³»åˆ—äºŒè¿›åˆ¶æµ/å­—ç¬¦æµ eg.txt æœ‰ç»“æ„æ–‡ä»¶ï¼ˆè®°å½•å¼æ–‡ä»¶ï¼‰ æ¯æ¡è®°å½•æœ‰ä¸€ä¸ªæ•°æ®é¡¹å¯ä½œä¸ºå…³é”®å­— å®šé•¿è®°å½•â€”â€”å„æ¡è®°å½•é•¿åº¦ç›¸ç­‰ å¯å˜é•¿è®°å½•â€”â€”ä¸ç­‰ æœ‰ç»“æ„æ–‡ä»¶çš„é€»è¾‘ç»“æ„ å„è®°å½•æ’åˆ—çš„é¡ºåº\né¡ºåºæ–‡ä»¶ï¼šè®°å½•æŒ‰é¡ºåºæ’åˆ—ï¼ˆé€»è¾‘ä¸Šçš„é¡ºåºï¼‰ å®šé•¿/å¯å˜é•¿è®°å½• ä¸²ç»“æ„â€”â€”è®°å½•çš„é¡ºåºä¸å…³é”®è¯æ— å…³ é¡ºåºç»“æ„â€”â€”è®°å½•é¡ºåºæŒ‰å…³é”®è¯é¡ºåº å®šé•¿è®°å½•çš„é¡ºåºæ–‡ä»¶å¯å®ç°éšæœºå­˜å– è‹¥é‡‡ç”¨é¡ºåºç»“æ„å¯å¿«é€Ÿæ‰¾åˆ°å…³é”®å­—å¯¹åº”çš„è®°å½•ï¼ˆæŠ˜åŠæŸ¥æ‰¾ï¼‰ å¯å˜é•¿è®°å½•çš„é¡ºåºæ–‡ä»¶ä¸èƒ½éšæœºå­˜å– ç´¢å¼•æ–‡ä»¶ï¼ˆåŠ å¿«æ–‡ä»¶æ£€ç´¢é€Ÿåº¦ï¼‰â€”â€”å¯å˜é•¿è®°å½•çš„é¡ºåºæ–‡ä»¶æ”¹è¿› ç´¢å¼•è¡¨è‡ªèº«ä¸ºå®šé•¿è®°å½•çš„é¡ºåºæ–‡ä»¶ å¯èƒ½ä¼šå ç”¨å¾ˆå¤§çš„å†…å­˜ç©ºé—´ ç´¢å¼•é¡ºåºæ–‡ä»¶â€”â€”ç´¢å¼•è¡¨æ”¹è¿› å°†æ–‡ä»¶æ•°æ®åˆ†ç»„ ç´¢å¼•é¡ºåºæ–‡ä»¶å‚¨å­˜åˆ†ç»„ä¿¡æ¯ æŸ¥æ‰¾ï¼šå…ˆåœ¨ç´¢å¼•é¡ºåºæ–‡ä»¶ä¸­é¡ºåºæ‰¾åˆ†ç»„ ååœ¨åˆ†ç»„ä¸­é¡ºåºæ‰¾è®°å½• å¤šçº§ç´¢å¼•é¡ºåºæ–‡ä»¶â€”â€”ç´¢å¼•é¡ºåºæ–‡ä»¶æ”¹è¿› æ–‡ä»¶ç›®å½• æ–‡ä»¶æ§åˆ¶å—FCBâ€”â€”åŒ…å«æ–‡ä»¶åŸºæœ¬ä¿¡æ¯ FCBæœ‰åºé›†åˆå³ä¸ºæ–‡ä»¶ç›®å½• ç›®å½•ç»“æ„ï¼š å•æç›®å½•ç»“æ„ ä¸å…è®¸æ–‡ä»¶é‡å ä¸¤çº§ç›®å½•ç»“æ„ = ä¸»æ–‡ä»¶ç›®å½• + ç”¨æˆ·æ–‡ä»¶ç›®å½• å…è®¸ä¸åŒç”¨æˆ·çš„æ–‡ä»¶é‡å å¤šçº§ç›®å½•ç»“æ„ï¼ˆæ ‘å½¢ç»“æ„ï¼‰â€”â€”ç”¨æ–‡ä»¶è·¯å¾„åæ ‡è¯†æ–‡ä»¶ eg./users/local/bin æ ‘å½¢ç»“æ„ä¸ä¾¿äºæ–‡ä»¶å…±äº« æ— ç¯å›¾ç›®å½•ç»“æ„â€”â€”å¢åŠ ä¸€äº›æŒ‡å‘åŒèŠ‚ç‚¹çš„æœ‰å‘è¾¹ï¼ˆç›¸å½“äºå…±äº«ï¼‰ å¯è®¾ç½®å…±äº«è®¡æ•°å™¨ ç´¢å¼•ç»“ç‚¹ï¼šå­˜æ”¾FCBä¸­é™¤æ–‡ä»¶åå¤–çš„ä¿¡æ¯ï¼ˆç”¨ç´¢å¼•ç»“ç‚¹æŒ‡é’ˆå­˜æ”¾ï¼‰ åŠ å¿«æŸ¥æ‰¾æ•ˆç‡ æ–‡ä»¶ç‰©ç†ç»“æ„ ç£ç›˜å—ï¼šç£ç›˜ä¸­åˆ†ä¸ºmanyç£ç›˜å— å¤§å°ä¸å†…å­˜å—ã€é¡µé¢å¤§å°ç›¸åŒ é€»è¾‘å—å· + å—å†…åœ°å€ = æ–‡ä»¶çš„é€»è¾‘åœ°å€ è¿ç»­åˆ†é…ï¼šè¦æ±‚æ¯ä¸ªæ–‡ä»¶åœ¨ç£ç›˜ä¸Šå æœ‰ä¸€ç»„è¿ç»­çš„å— æ–‡ä»¶ç›®å½•éœ€è®°å½•æ–‡ä»¶å­˜æ”¾åœ¨ç£ç›˜ä¸­çš„èµ·å§‹å—å·\u0026amp;é•¿åº¦ï¼ˆæ€»å…±å ç”¨å‡ å—ï¼‰ ä¼˜ç‚¹ï¼šæ”¯æŒé¡ºåºè®¿é—®ä¸ç›´æ¥è®¿é—® \u0026amp; é¡ºåºè¯»å†™æ—¶é€Ÿåº¦æœ€å¿«ï¼ˆè·ç¦»è¿‘ ç£å¤´ç§»åŠ¨æ›´å¿«ï¼‰ ç¼ºç‚¹ï¼šå­˜å‚¨ç©ºé—´åˆ©ç”¨ç‡ä½ ä¼šäº§ç”Ÿç£ç›˜ç¢ç‰‡ é“¾æ¥åˆ†é…ï¼šç¦»æ•£åˆ†é… æŒ‡é’ˆé“¾æ¥ éšå¼é“¾æ¥â€”â€”å¿…é¡»ä»ä¸Šä¸€ä¸ªé€»è¾‘å—ä¸­è¯»åˆ°ä¸‹ä¸€ä¸ªå—çš„ç‰©ç†åœ°å€ åªæ”¯æŒé¡ºåºè¯»å– but ä¸ä¼šäº§ç”Ÿç¢ç‰‡ æ˜¾å¼é“¾æ¥â€”â€”é“¾æ¥å„ç‰©ç†å—çš„æŒ‡é’ˆæ˜¾å¼å­˜æ”¾åœ¨ä¸€å¼ è¡¨ä¸­ï¼ˆæ–‡ä»¶åˆ†é…è¡¨FAT File Allocation Tableï¼‰ ä¸€ä¸ªç£ç›˜ä»…ä¸€å¼ FAT å¼€æœºæ—¶è¯»å…¥å†…å­˜å¹¶å¸¸é©» FATå„è¡¨é¡¹åœ¨ç‰©ç†ä¸Šè¿ç»­å­˜å‚¨ ä¸”é•¿åº¦ç›¸åŒ æ”¯æŒé¡ºåº/éšæœºè®¿é—® ä¸ä¼šäº§ç”Ÿå¤–éƒ¨ç¢ç‰‡ but FATéœ€è¦å ç”¨ä¸€å®šå­˜å‚¨ç©ºé—´ ç´¢å¼•åˆ†é…ï¼šç¦»æ•£åˆ†é… æ¯ä¸ªæ–‡ä»¶éƒ½æœ‰ä¸€å¼ ç´¢å¼•è¡¨ï¼ˆè®°å½•æ–‡ä»¶é€»è¾‘å—å¯¹åº”çš„ç‰©ç†å—ï¼‰ ç´¢å¼•è¡¨å­˜æ”¾çš„ç£ç›˜å—ç§°ä¸ºç´¢å¼•å—ï¼ˆFCBä¸­è®°å½•ç´¢å¼•å—ä½ç½®ï¼‰ æ–‡ä»¶æ•°æ®å­˜æ”¾çš„ç§°ä¸ºæ•°æ®å— ç´¢å¼•è¡¨è¿‡å¤§ è§£å†³æ–¹æ¡ˆï¼š é“¾æ¥æ–¹æ¡ˆâ€”â€”é¡ºåºè¯»å–å„ç´¢å¼•å— å¤šå±‚ç´¢å¼•â€”â€”éœ€å¤šæ¬¡è¯»ç£ç›˜ æ··åˆç´¢å¼•â€”â€”å¤šç§ç´¢å¼•åˆ†é…æ–¹å¼ç»“åˆ eg.æœ‰çš„ç›´æ¥åœ°å€ç´¢å¼• æœ‰çš„ä¸€çº§é—´æ¥ï¼ˆå•å±‚ç´¢å¼•è¡¨ï¼‰ æœ‰çš„äºŒçº§é—´æ¥ç´¢å¼• å„çº§ç´¢å¼•è¡¨ä¸èƒ½è¶…è¿‡ä¸€ä¸ªå— æ–‡ä»¶å­˜å‚¨ç©ºé—´ç®¡ç† å­˜å‚¨ç©ºé—´åˆ’åˆ†ä¸åˆå§‹åŒ– å°†ç‰©ç†ç£ç›˜åˆ’åˆ†ä¸ºæ–‡ä»¶å·ï¼ˆé€»è¾‘å·/é€»è¾‘ç›˜ï¼‰ eg.Cç›˜ æ–‡ä»¶å·åŒ…æ‹¬ç›®å½•åŒºï¼ˆå­˜æ”¾FCB å­˜å‚¨ç©ºé—´ç®¡ç†çš„ä¿¡æ¯ç­‰ï¼‰\u0026amp;æ–‡ä»¶åŒº ç©ºé—²è¡¨æ³•â€”â€”å»ºç«‹ç©ºé—²è¡¨ï¼ˆåŒ…æ‹¬ç©ºé—²ç›˜å—å·\u0026amp;ç©ºé—²ç›˜å—æ•°ï¼‰ åˆ†é…å›æ”¶ä¸å†…å­˜çš„åŠ¨æ€åˆ†åŒºåˆ†é…ç±»ä¼¼ ç©ºé—²é“¾è¡¨æ³•â€”â€”ç©ºé—²ç›˜å—é“¾/ç©ºé—²ç›˜åŒºé“¾ï¼ˆè¿ç»­çš„ç›˜å—ç»„æˆç›˜åŒºï¼‰ OSä¿å­˜é“¾å¤´é“¾å°¾æŒ‡é’ˆ ç›˜åŒºé“¾é€‚ç”¨äºç¦»æ•£åˆ†é…\u0026amp;è¿ç»­åˆ†é… ä½ç¤ºå›¾æ³• æ¯ä¸€æ ¼ä»£è¡¨ä¸€ä¸ªç›˜å— ç›˜å—å·=ni+jï¼ˆnä¸ºå­—é•¿ iä¸ºå­—å· jä¸ºä½å·ï¼‰ ç©ºé—²æ ‡0 ä¸ç©ºæ ‡1 æˆç»„é“¾æ¥æ³•ï¼ˆUNIXé‡‡ç”¨ï¼‰ ç©ºé—²è¡¨/é“¾è¡¨æ³•ä¸é€‚ç”¨äºå¤§å‹æ–‡ä»¶ç³»ç»Ÿ æ–‡ä»¶åŸºæœ¬æ“ä½œ åˆ›å»ºæ–‡ä»¶ï¼šåœ¨å¤–å­˜ä¸­æ‰¾åˆ°æ–‡ä»¶æ‰€éœ€ç©ºé—´ + åˆ›å»ºè¯¥æ–‡ä»¶å¯¹åº”çš„ç›®å½•é¡¹ åˆ é™¤æ–‡ä»¶ï¼šæ‰¾åˆ°ç›®å½•é¡¹ + å›æ”¶ç£ç›˜å— + åˆ é™¤ç›®å½•é¡¹ æ‰“å¼€æ–‡ä»¶ï¼šæ‰¾åˆ°ç›®å½•é¡¹ï¼ˆæ£€æŸ¥æƒé™ï¼‰ + ç›®å½•é¡¹å¤åˆ¶åˆ°å†…å­˜ä¸­çš„æ‰“å¼€æ–‡ä»¶è¡¨ æ‰“å¼€æ–‡ä»¶è¡¨ ç³»ç»Ÿæœ‰ä¸€æ€»è¡¨ å„è¿›ç¨‹ä¹Ÿæœ‰è¡¨ï¼ˆè®°å½•è¯»å†™æŒ‡é’ˆ è®¿é—®æƒé™ ç³»ç»Ÿè¡¨ç´¢å¼•å·ï¼‰ å…³é—­æ–‡ä»¶ï¼šè¿›ç¨‹çš„æ‰“å¼€æ–‡ä»¶è¡¨é¡¹åˆ é™¤ + å›æ”¶å†…å­˜ + ç³»ç»Ÿæ‰“å¼€æ–‡ä»¶æ€»è¡¨è®¡æ•°å™¨æ›´æ”¹ è¯»/å†™æ–‡ä»¶ï¼šè¯»/å†™æŒ‡é’ˆæŒ‡å‘å¤–å­˜ï¼ˆæ–‡ä»¶æ•°æ®å­˜å‚¨å¤„ï¼‰ OSå°†ç”¨æˆ·æŒ‡å®šçš„æ•°æ®è¯»å…¥å†…å­˜ å†™å›å†™æŒ‡é’ˆæŒ‡å‘çš„å¤–å­˜æ•°æ® æ–‡ä»¶å…±äº« åŸºäºç´¢å¼•ç»“ç‚¹çš„å…±äº«æ–¹å¼â€”â€”ç¡¬é“¾æ¥ ä¸åŒç”¨æˆ·çš„ç›®å½•ä¸‹ç´¢å¼•ç»“ç‚¹æŒ‡é’ˆæŒ‡å‘åŒä¸€ä¸ªç´¢å¼•ç»“ç‚¹ ç´¢å¼•ç»“ç‚¹ä¸­è®¾ç½®é“¾æ¥è®¡æ•°å˜é‡ åŸºäºç¬¦å·é“¾çš„å…±äº«æ–¹å¼â€”â€”è½¯é“¾æ¥ åˆ›å»ºLinkç±»å‹æ–‡ä»¶ æ ¹æ®å…¶è®°å½•çš„è·¯å¾„æŸ¥æ‰¾ç›®å½• eg.å¿«æ·æ–¹å¼ æ–‡ä»¶ä¿æŠ¤ å£ä»¤ä¿æŠ¤ï¼šä¸ºæ–‡ä»¶è®¾ç½®å£ä»¤ï¼ˆä¿å­˜åœ¨FCBä¸­ï¼‰ è¯·æ±‚è®¿é—®æ—¶éªŒè¯ å£ä»¤å­˜æ”¾åœ¨ç³»ç»Ÿå†…éƒ¨ åŠ å¯†ä¿æŠ¤ï¼šå¯¹æ–‡ä»¶åŸå§‹æ•°æ®è¿›è¡ŒåŠ å¯† eg.å¼‚æˆ–åŠ å¯† è®¿é—®æ§åˆ¶ï¼šä¸ºæ–‡ä»¶çš„FCB/ç´¢å¼•ç»“ç‚¹å¢åŠ è®¿é—®æ§åˆ¶åˆ—è¡¨(Access-Control List,ACL) è®°å½•å„ç”¨æˆ·å¯æ‰§è¡Œçš„æ“ä½œ è®¾å¤‡ç®¡ç† I/Oè®¾å¤‡åˆ†ç±» è¾“å…¥è¾“å‡º\nåˆ†ç±»ï¼šäººæœºäº¤äº’ç±»å¤–éƒ¨è®¾å¤‡ + å­˜å‚¨è®¾å¤‡ + ç½‘ç»œé€šä¿¡è®¾å¤‡ eg.çŒ« äººæœºâ€¦ï¼šæ•°æ®ä¼ è¾“é€Ÿåº¦æ…¢ å­˜å‚¨è®¾å¤‡ï¼šæ•°æ®ä¼ è¾“é€Ÿåº¦å¿« åˆ†ç±»ï¼šä½é€Ÿè®¾å¤‡ + ä¸­é€Ÿè®¾å¤‡ + é«˜é€Ÿè®¾å¤‡ åˆ†ç±»ï¼šå—è®¾å¤‡ + å­—ç¬¦è®¾å¤‡ ä»¥å—ä¸ºå•ä½è¿›è¡Œä¿¡æ¯äº¤æ¢ eg.ç§»åŠ¨ç¡¬ç›˜ å­—ç¬¦è®¾å¤‡å¸¸é‡‡ç”¨ä¸­æ–­é©±åŠ¨æ–¹å¼ I/Oæ§åˆ¶å™¨ CPUæ§åˆ¶I/Oæ§åˆ¶å™¨ I/Oæ§åˆ¶å™¨æ§åˆ¶è®¾å¤‡çš„æœºæ¢°éƒ¨ä»¶\nåŠŸèƒ½ï¼š æ¥æ”¶è¯†åˆ«CPUå‘½ä»¤â€”â€”æ§åˆ¶å¯„å­˜å™¨å­˜æ”¾ å‘CPUæŠ¥å‘Šè®¾å¤‡çŠ¶æ€â€”â€”çŠ¶æ€å¯„å­˜å™¨ æ•°æ®äº¤æ¢â€”â€”æ•°æ®å¯„å­˜å™¨ åœ°å€è¯†åˆ«â€”â€”ä¸ºå¯„å­˜å™¨è®¾ç½®åœ°å€ ç»„æˆï¼šCPUä¸æ§åˆ¶å™¨çš„æ¥å£ + I/Oé€»è¾‘ + æ§åˆ¶å™¨ä¸è®¾å¤‡çš„æ¥å£ï¼ˆå¤šä¸ªï¼‰ å„å¯„å­˜å™¨ä¹Ÿå¯èƒ½æœ‰å¤šä¸ª å¯„å­˜å™¨åœ°å€åˆ†ç±»ï¼šå†…å­˜æ˜ åƒI/Oâ€”â€”ä¸å†…å­˜åœ°å€ç»Ÿä¸€ç¼–å€ å¯„å­˜å™¨ç‹¬ç«‹ç¼–å€â€”â€”ä½¿ç”¨å•ç‹¬çš„åœ°å€ éƒ½å‚¨å­˜åœ¨å†…å­˜ä¸­ I/Oæ§åˆ¶æ–¹å¼ ç¨‹åºç›´æ¥æ§åˆ¶æ–¹å¼ï¼šæ•°æ®æœ€åè¦å­˜å‚¨åˆ°å†…å­˜ä¸­ CPUå¹²é¢„é¢‘ç¹ æ¯æ¬¡ä¼ é€ä¸€ä¸ªå­— å®ç°ç®€å• but CPUä¸I/Oåªèƒ½ä¸²è¡Œå·¥ä½œ CPUé•¿æœŸå¤„äºå¿™ç­‰ ä¸­æ–­é©±åŠ¨æ–¹å¼ï¼šCPUå‘å‡ºå‘½ä»¤åå°†ç­‰å¾…I/Oçš„è¿›ç¨‹é˜»å¡ åˆ‡æ¢æ‰§è¡Œå…¶å®ƒè¿›ç¨‹ I/Oå®Œæˆåå‘å‡ºä¸­æ–­ä¿¡å· CPUæ£€æµ‹åˆ°ä¸­æ–­ä¿¡å·åå¤„ç†ä¸­æ–­ï¼ˆè¯»ä¸€ä¸ªå­—ï¼‰ ä¹‹åæ¢å¤è¿›ç¨‹è¿è¡Œç¯å¢ƒï¼ˆç­‰å¾…I/Oæˆ–å…¶å®ƒï¼‰ CPUåœ¨æ¯ä¸ªæŒ‡ä»¤å‘¨æœŸæœ«å°¾æ£€æŸ¥ä¸­æ–­ ä¸­æ–­æ—¶éœ€è¦ä¿å­˜è¿›ç¨‹ç°æœ‰çŠ¶æ€ é¢‘ç¹ä¸­æ–­æ•ˆç‡ä½ DMAç›´æ¥å­˜å‚¨å™¨å­˜å–â€”â€”ä¸»è¦ç”¨äºå—è®¾å¤‡çš„I/Oæ§åˆ¶ æ•°æ®ä»è®¾å¤‡åˆ°å†…å­˜ or ä»å†…å­˜åˆ°è®¾å¤‡ ä¸ç»è¿‡CPU CPUé€šè¿‡MARå†…å­˜åœ°å€å¯„å­˜å™¨ç­‰æŒ‡æ˜å­˜æ”¾ä½ç½®ç­‰ä¿¡æ¯ å¯è¯»å†™ä¸€ä¸ªæˆ–è¿ç»­çš„å¤šä¸ªå— CPUåªåœ¨ä¼ é€çš„å¼€å§‹æˆ–ç»“æŸæ—¶ä»‹å…¥ but åªèƒ½è¯»å†™è¿ç»­çš„æ•°æ®å— é€šé“æ§åˆ¶ = æ›´å¼±çš„CPUï¼ˆç¡¬ä»¶ï¼‰ CPUåªéœ€å‘å‡ºI/Oå‘½ä»¤ å®Œæˆåå‘CPUå‘å‡ºä¸­æ–­ä¿¡å· å¯å¤„ç†ä¸€ç»„å— I/Oè½¯ä»¶å±‚æ¬¡ç»“æ„ knowæŸå¤„ç†æ˜¯åœ¨å“ªå±‚å®Œæˆçš„ ç”¨æˆ·å±‚è½¯ä»¶ï¼šä¸ç”¨æˆ·äº¤äº’ æä¾›åº“å‡½æ•°è¿›è¡Œæ“ä½œ \u0026amp; å°†ç”¨æˆ·è¯·æ±‚è½¬ä¸ºI/Oè¯·æ±‚ ç”¨ç³»ç»Ÿè°ƒç”¨è¯·æ±‚å†…æ ¸æœåŠ¡ è®¾å¤‡ç‹¬ç«‹æ€§è½¯ä»¶ï¼ˆä¸ç¡¬ä»¶ç‰¹æ€§æ— å…³çš„åŠŸèƒ½ï¼‰ å¦‚ï¼šå‘ä¸Šå±‚æä¾›ç³»ç»Ÿè°ƒç”¨æ¥å£\u0026amp;è®¾å¤‡ä¿æŠ¤ï¼ˆå¦‚è®¿é—®æƒé™ï¼‰\u0026amp;å·®é”™å¤„ç†\u0026amp;è®¾å¤‡åˆ†é…å›æ”¶\u0026amp;æ•°æ®ç¼“å†²åŒºç®¡ç†\u0026amp;é€»è¾‘ã€ç‰©ç†è®¾å¤‡åæ˜ å°„ ä¸åŒè®¾å¤‡å†…éƒ¨ç¡¬ä»¶ç‰¹æ€§ä¸åŒâ€”â€”ä¸åŒçš„è®¾å¤‡é©±åŠ¨ç¨‹åº è®¾å¤‡é©±åŠ¨ç¨‹åºï¼šå¯¹ç¡¬ä»¶è®¾å¤‡çš„å…·ä½“æ§åˆ¶ å°†å‘½ä»¤è½¬åŒ–ä¸ºç‰¹å®šè®¾å¤‡çš„æ“ä½œ ä¸­æ–­å¤„ç†ç¨‹åºï¼šI/Oä»»åŠ¡å®Œæˆæ—¶æ§åˆ¶å™¨å‘é€ä¸­æ–­ä¿¡å· ç³»ç»Ÿæ ¹æ®ä¸­æ–­ä¿¡å·ç±»å‹æ‰¾åˆ°ä¸­æ–­å¤„ç†ç¨‹åº è¾“å…¥è¾“å‡ºç®¡ç† I/Oç¨‹åºæ¥å£ï¼š å­—ç¬¦è®¾å¤‡æ¥å£ get/putç³»ç»Ÿè°ƒç”¨ å—è®¾å¤‡ read/write seekâ€”â€”åœ¨è¯»å†™æŒ‡é’ˆå¤„æ“ä½œ ç½‘ç»œè®¾å¤‡ ç½‘ç»œå¥—æ¥å­—socketæ¥å£ eg.localhost:1313 1313å³ä¸ºä¸€ä¸ªå¥—æ¥å­— å¯ä¸å…¶å®ƒipåœ°å€çš„socketç»‘å®š å®ç°ä¿¡æ¯ä¼ è¾“ é˜»å¡I/O å‘å‡ºI/Oç³»ç»Ÿè°ƒç”¨è¿›ç¨‹éœ€è½¬ä¸ºé˜»å¡æ€ éé˜»å¡I/Oä¸éœ€é˜»å¡ç­‰å¾… è®¾å¤‡é©±åŠ¨ç¨‹åºæ¥å£â€”â€”è®¾å¤‡ç‹¬ç«‹è½¯ä»¶å±‚ I/Oæ ¸å¿ƒå­ç³»ç»Ÿ I/Oè°ƒåº¦â€”â€”ç±»å…¶å®ƒè°ƒåº¦ç­–ç•¥ è®¾å¤‡ä¿æŠ¤â€”â€”UNIXå°†è®¾å¤‡è§†ä¸ºç‰¹æ®Šçš„æ–‡ä»¶ å‡è„±æœºæŠ€æœ¯SPOOLing ç”¨æˆ·å±‚è½¯ä»¶ æ¨¡æ‹Ÿè„±æœºæŠ€æœ¯\nç»„æˆï¼šç¼“å†²åŒºä¸äº•éƒ½æš‚å­˜æ•°æ® ä½ç½®ä¸åŒ å…±äº«æ‰“å°æœºåŸç†â€”â€”è¾“å‡ºäº•ä¸ºæ¯ä¸ªæ‰“å°è¯·æ±‚åˆ†é…ä¸€ä¸ªå­˜å‚¨åŒºï¼ˆé€»è¾‘è®¾å¤‡ï¼‰ è®¾å¤‡çš„åˆ†é…ä¸å›æ”¶ è®¾å¤‡ç‹¬ç«‹æ€§è½¯ä»¶\nè®¾å¤‡åˆ†é…è€ƒè™‘ï¼šè®¾å¤‡å›ºæœ‰å±æ€§ è®¾å¤‡åˆ†é…ç®—æ³• è®¾å¤‡åˆ†é…å®‰å…¨æ€§ åˆ†é…æ–¹æ³•ï¼š é™æ€åˆ†é… è¿è¡Œå‰åˆ†é…èµ„æº åŠ¨æ€åˆ†é… è¿‡ç¨‹ä¸­åˆ†é… åˆ†é…ç®¡ç†çš„æ•°æ®ç»“æ„ è®¾å¤‡æ§åˆ¶è¡¨DCT æŒ‡å‘COCTçš„æŒ‡é’ˆ æ§åˆ¶å™¨æ§åˆ¶è¡¨COCT æŒ‡å‘CHCTçš„æŒ‡é’ˆ é€šé“æ§åˆ¶è¡¨CHCT ç­‰å¾…é˜Ÿåˆ—æŒ‡é’ˆ ç³»ç»Ÿè®¾å¤‡è¡¨SDT åŒ…æ‹¬DCT åˆ†é…æ­¥éª¤ï¼šæ ¹æ®ç‰©ç†è®¾å¤‡åæ‰¾SDT ä»SDTæ‰¾åˆ°DCT åˆ°COCTæ‰¾åˆ°æ§åˆ¶å™¨ åˆ°CHCTåˆ†é…é€šé“ è®¾å¤‡ã€æ§åˆ¶å™¨ã€é€šé“éƒ½åˆ†é…æˆåŠŸæ‰æˆåŠŸ å¿…é¡»ä½¿ç”¨ç‰©ç†è®¾å¤‡åâ€”â€”éš¾æ¢ \u0026amp; è‹¥æ­£å¿™è¿›ç¨‹å¿…é¡»é˜»å¡ç­‰å¾… æ”¹è¿›ï¼šç”¨é€»è¾‘è®¾å¤‡åç”³è¯· OSç”¨LUTï¼ˆé€»è¾‘è®¾å¤‡è¡¨ï¼‰å®ç°åç§°æ˜ å°„ ä¸€å¼ LUTä¸­é€»è¾‘è®¾å¤‡åä¸å¯é‡å¤ ä¸€èˆ¬æ¯ä¸ªç”¨æˆ·ä¸€å¼  ç¼“å†²åŒº ä½œç”¨ï¼šç¼“å’ŒCPUä¸I/Oè®¾å¤‡é€Ÿåº¦ä¸åŒ¹é…çš„çŸ›ç›¾ å‡å°‘å¯¹CPUçš„ä¸­æ–­é¢‘ç‡ è§£å†³æ•°æ®ç²’åº¦ä¸åŒ¹é…é—®é¢˜ï¼ˆå­—ç¬¦/å—ï¼‰ å•ç¼“å†²ï¼šä¸»å­˜ä¸­åˆ†é…ç¼“å†²åŒºâ€”â€”éç©ºæ—¶ä¸èƒ½è¿›æ•°æ® ç©ºæ—¶å¯ä»¥è¿›æ•°æ®ä½†å¿…é¡»å……æ»¡ åŒç¼“å†²ï¼šåˆ†é…2ä¸ªç¼“å†²åŒº å¾ªç¯ç¼“å†²åŒºï¼šå¤šä¸ªå¤§å°ç›¸ç­‰çš„ç¼“å†²åŒºé“¾æ¥ä¸ºå¾ªç¯é˜Ÿåˆ— ç¼“å†²æ± ï¼šç³»ç»Ÿä¸­å…±ç”¨çš„ç¼“å†²åŒºç»„æˆ å¯åˆ†ä¸ºç©ºç¼“å†²é˜Ÿåˆ— è£…æ»¡è¾“å…¥æ•°æ®çš„ç¼“å†²é˜Ÿåˆ—ï¼ˆè¾“å…¥é˜Ÿåˆ—ï¼‰ è¾“å‡ºé˜Ÿåˆ— ç¼“å†²åŒºç§ç±»ï¼šæ”¶å®¹è¾“å…¥hin æå–è¾“å…¥sin æ”¶å®¹è¾“å‡ºsout æå–è¾“å‡ºhout ç£ç›˜ ç»“æ„ ç£ç›˜ä¸Šä¸€åœˆä¸ºä¸€ä¸ªç£é“ ç£é“è¢«åˆ†ä¸ºä¸€ä¸ªä¸ªæ‰‡åŒºï¼ˆå³ç£ç›˜å—ï¼‰ å¯èƒ½æœ‰å¾ˆå¤šç›˜é¢ ä½†æ‰€æœ‰ç›˜é¢è¿è½´è½¬ æ¯ä¸ªç£å¤´å…±è¿›é€€ å„æ‰‡åŒºå­˜æ”¾æ•°æ®é‡ç›¸åŒ è¯»å†™æ•°æ®ï¼šç§»åˆ°æŒ‡å®šç£é“ ç£ç›˜è½¬åŠ¨ä½¿ç›®æ ‡æ‰‡åŒºä»ç£å¤´ä¸‹åˆ’è¿‡å®ç° æŸ±é¢å·-ç›˜é¢å·-æ‰‡åŒºå·å®šä½ç£ç›˜å— æŸ±é¢ï¼šæ‰€æœ‰ç›˜é¢ä¸­ç›¸å¯¹ä½ç½®ç›¸åŒçš„ç£é“ï¼ˆä¸‹å›¾é»„è‰²éƒ¨åˆ†ï¼‰ åˆ†ç±»ï¼šæ´»åŠ¨å¤´ç£ç›˜ï¼ˆç£è‡‚å¯ç§»åŠ¨ï¼‰ å›ºå®šå¤´ç£ç›˜ï¼ˆä¸å¯åŠ¨ ä½†æœ‰å¾ˆå¤šç£è‡‚ï¼‰ ä¹Ÿå¯æŒ‰ç›˜ç‰‡å¯å¦æ›´æ¢åˆ†ç±» ç£ç›˜è°ƒåº¦ç®—æ³• ä¸€æ¬¡è¯»å†™æ“ä½œæ—¶é—´ï¼š å¯»æ‰¾æ—¶é—´â€”â€”è¯»å†™æ•°æ®å‰ ç£è‡‚ç§»åŠ¨åˆ°æŒ‡å®šç£é“ å»¶è¿Ÿæ—¶é—´â€”â€”æ—‹è½¬ç£ç›˜ å®šä½æ‰‡åŒº ä¼ è¾“æ—¶é—´â€”â€”ä»ç£ç›˜è¯»å‡º/å†™å…¥æ•°æ® è°ƒåº¦ç®—æ³•ï¼š å…ˆæ¥å…ˆæœåŠ¡FCFSï¼šè¿›ç¨‹è¯·æ±‚ç£ç›˜è®¿é—®çš„å…ˆåé¡ºåº æœ€çŸ­å¯»æ‰¾æ—¶é—´ä¼˜å…ˆSSTFï¼šä¼˜å…ˆå¤„ç†ç¦»å½“å‰ç£å¤´æœ€è¿‘çš„ç£é“ å¯èƒ½é¥¥é¥¿ æ‰«æSCANï¼ˆç”µæ¢¯ç®—æ³•ï¼‰ï¼šç£å¤´ç§»åŠ¨åˆ°æœ€å¤–ä¾§æ‰èƒ½å‘å†…åŠ¨ åä¹‹äº¦ç„¶ ä¸ä¼šé¥¥é¥¿ but ä¸åŒç£é“å“åº”é¢‘ç‡ä¸å¹³å‡ LOOKï¼šè‹¥åœ¨ç§»åŠ¨æ–¹å‘ä¸Šæ— å…¶ä»–è¯·æ±‚ å¯ä»¥ç«‹å³æ”¹å˜ç£å¤´ç§»åŠ¨æ–¹å‘ å¾ªç¯æ‰«æC-SCANï¼šåªæœ‰æœå›ºå®šæ–¹å‘ç§»åŠ¨æ—¶æ‰å¤„ç†ç£é“è®¿é—®è¯·æ±‚ è¿”å›æ—¶ç›´æ¥åˆ°èµ·å§‹æ®µ å“åº”é¢‘ç‡å¹³å‡ but å¹³å‡å¯»é“æ—¶é—´æ›´é•¿ C-LOOKï¼šç§»åŠ¨æ–¹å‘ä¸Šè‹¥æ— å…¶ä»–è¯·æ±‚ç«‹å³è¿”å› å‡å°‘å»¶è¿Ÿæ—¶é—´çš„æ–¹æ³• è¯»å–ä¸€å—åå°±éœ€è¦å¤„ç†â€”â€”ä½†ç£ç›˜è½¬åŠ¨ä¸åœâ€”â€”ä¸‹ä¸€å—è¦è½¬åœˆ\näº¤æ›¿ç¼–å·â€”â€”é€»è¾‘ä¸Šç›¸é‚»çš„æ‰‡åŒºåœ¨ç‰©ç†ä¸Šæœ‰é—´éš” ç£ç›˜åœ°å€ç»“æ„è®¾è®¡ï¼š ä¸ºä»€ä¹ˆæŸ±é¢å·åœ¨å‰ï¼Ÿ é¢å¯¹è¿ç»­çš„åœ°å€å¦‚000,00,000-000,01,111 æŸ±é¢å·åœ¨å‰æ—¶ä¸ç”¨ç§»åŠ¨ç£è‡‚ï¼›ç›˜é¢å·åœ¨å‰éœ€ç§»åŠ¨ç£è‡‚ é”™ä½å‘½åâ€”â€”æ”¹å˜ç›¸é‚»ç›˜é¢å¯¹åº”é¡ºåºï¼ˆç›¸é‚»åœ°å€è¯»å–æ—¶é—´é—®é¢˜ï¼‰ ç£ç›˜ç®¡ç†ï¼ˆç†è§£ï¼‰ ç£ç›˜åˆå§‹åŒ–ï¼š ä½çº§æ ¼å¼åŒ–ï¼ˆç‰©ç†æ ¼å¼åŒ–ï¼‰â€”â€”åˆ’åˆ†æ‰‡åŒº åˆ†ä¸ºå¤´ã€æ•°æ®åŒºåŸŸã€å°¾ ç£ç›˜åˆ†åŒºâ€”â€”æ¯ä¸ªåˆ†åŒºç”±è‹¥å¹²æŸ±é¢ç»„æˆeg.Cç›˜ é€»è¾‘æ ¼å¼åŒ–â€”â€”åˆ›å»ºæ–‡ä»¶ç³»ç»Ÿï¼ˆåˆ›å»ºæ ¹ç›®å½• åˆå§‹åŒ–æ•°æ®ç»“æ„eg.ä½ç¤ºå›¾ï¼‰ å¼•å¯¼å—ï¼ˆå¯åŠ¨å—/å¯åŠ¨åˆ†åŒºï¼‰â€”â€”å­˜æ”¾å®Œæ•´çš„è‡ªä¸¾ç¨‹åº å¯åŠ¨å—ä½äºç£ç›˜çš„å›ºå®šä½ç½® æ‹¥æœ‰å¯åŠ¨åˆ†åŒºçš„ç£ç›˜ = å¯åŠ¨ç£ç›˜/ç³»ç»Ÿç£ç›˜eg.Cç›˜ åå—ï¼ˆæ— æ³•æ­£ç¡®ä½¿ç”¨çš„æ‰‡åŒºï¼‰ ç®€å•çš„ç£ç›˜å¯åœ¨é€»è¾‘æ ¼å¼åŒ–æ—¶æ£€æŸ¥å¹¶æ ‡æ˜ å¤æ‚çš„ç”¨ç£ç›˜æ§åˆ¶å™¨ç»´æŠ¤åå—é“¾ ç®¡ç†å¤‡ç”¨æ‰‡åŒº å›ºæ€ç¡¬ç›˜SSD é‡ç‚¹å¦‚ä¸‹\nä¸»è¦ç»“æ„ï¼š ä»¥é¡µä¸ºå•ä½è¯»å†™ ä»¥å—ä¸ºå•ä½è¿›è¡Œæ•°æ®æ“¦é™¤ æ–¹å¯é‡å†™æ¯é¡µ å…ˆæŠŠä¸éœ€æ“¦é™¤çš„é¡µå¤åˆ¶åˆ°å…¶å®ƒé—ªå­˜èŠ¯ç‰‡å¯¹åº”ä½ç½® åœ¨å…¶å®ƒèŠ¯ç‰‡ä¸Šå†™åæ•´ä½“ç§»å…¥åŸèŠ¯ç‰‡ æ˜ å°„çš„ç‰©ç†ä½ç½®å¯ä»¥æ”¹å˜ è¯»å¿«å†™æ…¢ SSDçš„ä¸€ä¸ªå—è¢«å¤šæ¬¡æ“¦é™¤å¯èƒ½ä¼šæŸå ç£¨æŸå‡è¡¡æŠ€æœ¯ï¼šå°†æ“¦é™¤å¹³å‡åˆ†å¸ƒåœ¨å„ä¸ªå—ä¸Š åŠ¨æ€ç£¨æŸå‡è¡¡ï¼šå†™å…¥æ•°æ®æ—¶ ä¼˜å…ˆé€‰æ‹©ç´¯è®¡æ“¦é™¤æ¬¡æ•°å°‘çš„æ–°é—ªå­˜å— é™æ€ç£¨æŸå‡è¡¡ï¼šSSDåˆ†é…æ•°æ® è®©è€æ—§é—ªå­˜å—æ‰¿æ‹…ä»¥è¯»ä¸ºä¸»ä»»åŠ¡ æ–°çš„ä»¥å†™ä¸ºä¸»ğŸ¥³ğŸ¥³ ","permalink":"https://Sattiluvcat.github.io/en/posts/notes/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/","summary":"æ‰€æœ‰å›¾ç‰‡æ¥è‡ªï¼šç‹é“è®¡ç®—æœºè€ƒç ” æ“ä½œç³»ç»Ÿï¼Œé“¾æ¥è§æ–‡ç« ","title":"æ“ä½œç³»ç»ŸOS"},{"content":"Â OI WIKI åŸºç¡€ ä¸‰è¦ç´  æ•°æ®ç»“æ„ = é€»è¾‘ç»“æ„ + æ•°æ®è¿ç®— + ç‰©ç†ç»“æ„ é€»è¾‘ç»“æ„=é›†åˆ+çº¿æ€§+æ ‘å½¢+å›¾çŠ¶ è¿ç®—=å¢åˆ æ”¹æŸ¥ ç‰©ç†ç»“æ„=å­˜å‚¨ç»“æ„=é¡ºåº+é“¾å¼+ç´¢å¼•+æ•£åˆ— å­˜å‚¨ æ—¶é—´å¤æ‚åº¦æ’åºï¼šO(1) \u0026lt; O(log~2~n) \u0026lt; O(n) \u0026lt; O(nlog~2~n) \u0026lt; O(n^2^) \u0026lt; O(n^3^) \u0026lt; O(2^n^) \u0026lt; O(n!) \u0026lt; O(n^n^) æœ€å\u0026amp;å¹³å‡æ—¶é—´å¤æ‚åº¦åº¦é‡ æœ€æ·±å±‚å¾ªç¯çš„å¾ªç¯æ¬¡æ•°ä¸nçš„å…³ç³» ä¹˜æ³•è§„åˆ™ï¼šç›¸ä¹˜ååº¦é‡ ç©ºé—´å¤æ‚åº¦ å†…å­˜ä¸­çš„å˜é‡å­˜å‚¨å¤§å° é€’å½’\u0026amp;åŠ¨æ€è§„åˆ’ é€’å½’ï¼šé€‰å®šé€’å½’åŸº + è®¤å®šè¯¥æ–¹æ³•å¯ä»¥è§£å†³è¯¥é—®é¢˜\nç©ºé—´å¤æ‚åº¦è¾ƒé«˜ åŠ¨æ€è§„åˆ’ï¼šéƒ¨åˆ†æˆ–å®Œå…¨æ¶ˆé™¤ç®—æ³•ä¸­çš„é€’å½’æˆåˆ†ï¼ˆç”¨æœ‰é™ç©ºé—´è®°å½•å­é—®é¢˜çš„è§£ ä»¥é¿å…é‡å¤è®¿é—®å­é—®é¢˜ï¼‰ æ¡ä»¶ï¼š\næœ€ä¼˜å­ç»“æ„ï¼ˆå¯èƒ½é€‚ç”¨è´ªå¿ƒï¼‰ æ— åæ•ˆæ€§ï¼šå·²æ±‚è§£çš„å­é—®é¢˜ä¸å—åç»­å†³ç­–å½±å“ å­é—®é¢˜é‡å  çº¿æ€§è¡¨ ç›¸åŒæ•°æ®ç±»å‹ æœ‰é™åºåˆ—ï¼ˆæœ‰æ¬¡åºï¼‰ aiä¸­iä¸ºä½åº\nåŸºç¡€ åŸºæœ¬æ“ä½œ InitList(\u0026amp;L) DestroyList(\u0026amp;L) å¢åˆ æ”¹æŸ¥: ListInsert(\u0026amp;L,i,e) ListDelete(\u0026amp;L,i,\u0026amp;e) LocateElem(L,e)æŒ‰å€¼æŸ¥æ‰¾ GetElem(L,i)æŒ‰ä½æŸ¥æ‰¾ Length(L) \u0026amp; PrintList(L) \u0026amp; Empty(L) ä¼ å…¥\u0026amp;ï¼šéœ€è¦ç”¨åˆ°ä¿®æ”¹åçš„å€¼ æ ˆ åè¿›å…ˆå‡º (last in first out,LIFO)\nCppçš„STLä¸­stackå®¹å™¨æä¾›æˆå‘˜å‡½æ•°ï¼š st.top()è¿”å›æ ˆé¡¶ st.push()è¿›æ ˆåˆ°é¡¶ st.pop()å¼¹å‡ºæ ˆ st.empty() st.size()æ ˆå®¹é‡ Pythonæ¨¡æ‹Ÿæ ˆ st=[1,2,3] st.append(2) # å…¥æ ˆ st.append(3) # [1,2,3,2,3] st.pop() st.clear() é˜Ÿåˆ— å…ˆè¿›å…ˆå‡º (first in first out,FIFO)\næ•°ç»„æ¨¡æ‹Ÿé˜Ÿåˆ— æ ‡è®°é˜Ÿåˆ—é¦–å°¾(ql,qr) åˆ é™¤å…ƒç´ ï¼šql++ æ¸…ç©ºé˜Ÿåˆ—ï¼šql=1,qr=0(ql\u0026gt;qrå³å¯) åŒæ ˆæ¨¡æ‹Ÿé˜Ÿåˆ— Fä¸ºé˜Ÿå°¾æ ˆ Sä¸ºé˜Ÿé¦–æ ˆ popæ—¶è‹¥Sä¸ºç©º åˆ™å°†Få…ƒç´ å¼¹å‡ºåæ’å…¥S å†è¿›è¡Œpop åŒç«¯é˜Ÿåˆ— é˜Ÿé¦–é˜Ÿå°¾å‡å¯æ’å…¥åˆ é™¤å…ƒç´  Pythonä¸­å®¹å™¨ä¸ºcollections.deque å¾ªç¯é˜Ÿåˆ— ä¸‹æ ‡ä¸º0çš„ä½ç½®è§†ä¸ºæœ€åä½çš„åç»§ é˜Ÿåˆ—å‘æ•°ç»„å°¾éƒ¨ç§»åŠ¨ æœ€ç»ˆå…¥é˜Ÿå³ä½¿æœ‰ç©ºä½ä¹Ÿä¼šæº¢å‡ºï¼ˆå‡æº¢å‡ºï¼‰ å•è°ƒæ ˆä¸å•è°ƒé˜Ÿåˆ— ä¿è¯å…ƒç´ å•è°ƒæ€§çš„æ ˆ/é˜Ÿåˆ—ï¼ˆé€’å¢oré€’å‡ï¼‰\nç»´æŠ¤ä¸€ä¸ªå•å¢/å•å‡çš„æ•°ç»„ å®ç°æœ€å°/æœ€å¤§å€¼æŸ¥æ‰¾\\\n(ä»¥å•å‡æ‰¾æœ€å¤§ä¸ºä¾‹) æ–°å…ƒç´ ä¸é˜Ÿå°¾å…ƒç´ æ¯”è¾ƒ è‹¥æ›´å°åˆ™è¿›é˜Ÿ è‹¥æ›´å¤§ åˆ™ä»é˜Ÿå°¾å¼€å§‹å°†æ‰€æœ‰æ¯”ä¹‹æ›´å°çš„å…ƒç´ è¸¹å‡ºé˜Ÿ lc.239æ»‘åŠ¨çª—å£æ‰¾æœ€å¤§\\ int head=0,tail=-1; int i=0; int[] win=new int[nums.length]; for(;i\u0026lt;k;i++){ while(head\u0026lt;=tail\u0026amp;\u0026amp;nums[win[tail]]\u0026lt;=nums[i]){ tail--; } win[++tail]=i; System.out.println(\u0026#34;now tail is \u0026#34;+tail); } System.out.println(nums[win[head]]); for(;i\u0026lt;nums.length;i++){ while(head\u0026lt;=tail\u0026amp;\u0026amp;nums[win[tail]]\u0026lt;=nums[i]){ tail--; } win[++tail]=i; while(win[head]\u0026lt;=i-k) head++; System.out.println(nums[win[head]]); } ç±»ä¼¼è¿˜æœ‰lc.84/739/862/901/907ç­‰å¯ç”¨ç±»ä¼¼æ–¹æ³•\né“¾è¡¨ å¢åˆ  O(1) æŸ¥è¯» O(n)\nå•å‘é“¾è¡¨ æŒ‡é’ˆ + æ•°æ® åŒå‘é“¾è¡¨ æŒ‡é’ˆï¼ˆå·¦ã€å³ï¼‰ + æ•°æ® struct Node{ int value; Node *left; Node *right; }; æ’å…¥æ•°æ® å•å‘é“¾è¡¨ new nodeçš„nextæŒ‡å‘pçš„next node pçš„next nodeæŒ‡å‘new node node-\u0026gt;value=i; node-\u0026gt;next=p-\u0026gt;next; p-\u0026gt;next=node; å•å‘å¾ªç¯é“¾è¡¨ é¦–å°¾ç›¸è¿ æ’å…¥æ—¶åˆ¤æ–­æ˜¯å¦ä¸ºç©º è‹¥ä¸ºç©º new nodeçš„nextæŒ‡å‘è‡ªå·± pæŒ‡å‘new node if(p==NULL){ p=node; node-\u0026gt;next=node; } åŒå‘å¾ªç¯é“¾è¡¨ åˆ¤æ–­æ˜¯å¦ä¸ºç©º \u0026amp; ä¿®æ”¹å·¦å³ä¸¤ä¸ªæŒ‡é’ˆ éç©º node-\u0026gt;left = p; node-\u0026gt;right = p-\u0026gt;right; p-\u0026gt;right-\u0026gt;left = node; p-\u0026gt;right = node; åˆ é™¤æ•°æ® å•å‘å¾ªç¯é“¾è¡¨ åˆ é™¤p = p-\u0026gt;nextçš„å€¼ç»™p \u0026amp; è·³è¿‡p-\u0026gt;next p-\u0026gt;value = p-\u0026gt;next-\u0026gt;value; Node *t = p-\u0026gt;next; p-\u0026gt;next = p-\u0026gt;next-\u0026gt;next; åŒå‘å¾ªç¯é“¾è¡¨ p-\u0026gt;left-\u0026gt;right = p-\u0026gt;right; p-\u0026gt;right-\u0026gt;left = p-\u0026gt;left; Node *t = p; p = p-\u0026gt;right; delete t; å“ˆå¸Œè¡¨ key-\u0026gt;å“ˆå¸Œå‡½æ•°-\u0026gt;ç´¢å¼•â‰ˆå†…å­˜ä½ç½®-\u0026gt;value\nå“ˆå¸Œå†²çª = ä¸åŒkeyè®¡ç®—çš„ç´¢å¼•ç›¸åŒ æ‹‰é“¾æ³•ï¼ˆå¼€æ•£åˆ—æ³•ï¼‰å¤šé”®å€¼ç´¢å¼•åˆ°åŒä¸€ä½ç½® åœ¨è¯¥ä½ç½®å»ºç«‹é“¾è¡¨ é—­æ•£åˆ—æ³• æ‰€æœ‰è®°å½•è®°å½•åœ¨æ•£åˆ—è¡¨ä¸­ å‘ç”Ÿå†²çªåˆ™æ ¹æ®æŸæ–¹å¼ç»§ç»­æ¢æŸ¥ å † æ ‘ æ¯ä¸ªèŠ‚ç‚¹çš„é”®å€¼éƒ½å¤§äºç­‰äº/å°äºrootèŠ‚ç‚¹çš„é”®å€¼\nå¤§äºç­‰äºçš„ä¸ºæœ€å°åŒ–å † åä¹‹ä¸ºæœ€å¤§åŒ–å †ï¼ˆå·¦å­å¤§äºå³å­ï¼‰\näºŒå‰å † ç»“æ„ï¼šå®Œå…¨äºŒå‰æ ‘ï¼ˆä»¥ä¸‹ä»¥æœ€å¤§åŒ–å †ä¸ºä¾‹ï¼‰ æ’å…¥ï¼šæœ€ä¸‹å±‚æœ€å³å¶å­æ’å…¥ å‘ä¸Šè°ƒæ•´ å¤æ‚åº¦O(logn) åˆ é™¤ï¼ˆrootï¼‰ï¼šrootä¸æœ€åçš„èŠ‚ç‚¹äº¤æ¢ å‘ä¸‹è°ƒæ•´ å‘ä¸‹è°ƒæ•´ = å­èŠ‚ç‚¹ä¸­æœ€å¤§çš„ä¸æ–°rootäº¤æ¢ å¤æ‚åº¦O(logn) å®ç°ï¼šåœ¨åºåˆ—ä¸­ Hiçš„å­èŠ‚ç‚¹ä¸ºH2iä¸H2i+1 void up(int x) { while (x \u0026gt; 1 \u0026amp;\u0026amp; h[x] \u0026gt; h[x / 2]) { std::swap(h[x], h[x / 2]); x /= 2; } } void down(int x) { while (x * 2 \u0026lt;= n) { t = x * 2; if (t + 1 \u0026lt;= n \u0026amp;\u0026amp; h[t + 1] \u0026gt; h[t]) t++; if (h[t] \u0026lt;= h[x]) break; std::swap(h[x], h[t]); x = t; } } å»ºå †ï¼šå‘ä¸Š/å‘ä¸‹è°ƒæ•´ å‘ä¸Šè°ƒæ•´ ä»å¶å­å¼€å§‹å‘å †ä¸Šéƒ¨ç§»åŠ¨ å¤æ‚åº¦O(nlogn) å‘ä¸‹è°ƒæ•´ ä»rootå¼€å§‹å‘å †ä¸‹éƒ¨ç§»åŠ¨ å¤æ‚åº¦O(n) äºŒå‰æ ‘ äºŒå‰æœç´¢æ ‘ å·¦å­\u0026lt;root\u0026lt;å³å­\nåˆ é™¤å…ƒç´ ï¼šè‹¥æœ‰ä¸¤ä¸ªéç©ºå­èŠ‚ç‚¹ ç”¨å·¦å­æ ‘çš„æœ€å¤§å€¼/å³å­æ ‘çš„æœ€å°å€¼ä»£æ›¿å®ƒååˆ é™¤\nå¹³è¡¡æ ‘ æ¯ä¸ªèŠ‚ç‚¹çš„å·¦å­æ ‘å’Œå³å­æ ‘é«˜åº¦å·®æœ€å¤šä¸º1\nè°ƒæ•´è¿‡ç¨‹ å³æ—‹ rootå·¦å­æˆä¸ºæ–°root rootæˆä¸ºæ–°rootçš„å³å­ æ–°rootåŸå³å­æˆä¸ºrootå·¦å­ TreeNode* newRoot = root-\u0026gt;left; root-\u0026gt;left = newRoot-\u0026gt;right; newRoot-\u0026gt;right = root; å››ç§å¹³è¡¡ç ´åæƒ…å†µ LL RRçœç•¥ LR å·¦å­çš„å³å­æ ‘è¿‡é•¿ RL å³å­çš„å·¦å­æ ‘è¿‡é•¿ï¼ˆç±»ä¸Šï¼‰ AVLæ ‘ å¹³è¡¡çš„äºŒå‰æœç´¢æ ‘\næ€§è´¨ï¼š\nAVLçš„å·¦å³å­æ ‘ä¹Ÿæ˜¯AVLæ ‘ ä¸”å·¦å³å­æ ‘é«˜åº¦ç›¸å·®ä¸å¤§äº1ï¼ˆå¹³è¡¡å› å­ = å³å­æ ‘é«˜ - å·¦å­æ ‘é«˜ï¼‰ æ ‘é«˜logn è°ƒæ•´ï¼šè‹¥å¹³è¡¡å› å­=-2 == å·¦å­å·¦æ—‹årootå³æ—‹ Bæ ‘ æ¯ä¸ªèŠ‚ç‚¹å¯ä»¥æ‹¥æœ‰ä¸¤ä¸ªä»¥ä¸Šçš„å­èŠ‚ç‚¹ å¢åˆ æ”¹æŸ¥åœ¨å¯¹æ•°æ—¶é—´å®Œæˆ\næœ€ä¸‹å±‚çš„èŠ‚ç‚¹ç§°ä¸ºå¶å­èŠ‚ç‚¹ æ€§è´¨ï¼šï¼ˆmé˜¶ï¼‰\næ¯ä¸ªèŠ‚ç‚¹æœ€å¤šæœ‰mä¸ªå­èŠ‚ç‚¹ éå¶å­èŠ‚ç‚¹ï¼ˆé™¤rootï¼‰æœ€å°‘æœ‰m/2ä¸ªå­èŠ‚ç‚¹ è‹¥rootä¸æ˜¯å¶å­èŠ‚ç‚¹ åˆ™è‡³å°‘æœ‰2ä¸ªå­èŠ‚ç‚¹ æ’åº å†’æ³¡æ’åº å¯¹åºåˆ—é€ä¸ªæ‰«æ næ¬¡æ‰«æåæ’åºå®Œæ¯•\næœ€å\u0026amp;å¹³å‡æƒ…å†µä¸‹æ—¶é—´å¤æ‚åº¦O(n^2^) æœ€å¥½æƒ…å†µä¸‹æ—¶é—´å¤æ‚åº¦O(n)\nbool flag = true; while (flag) { flag = false; for (int i = 1; i \u0026lt; n; ++i) { if (a[i] \u0026gt; a[i + 1]) { flag = true; int t = a[i]; a[i] = a[i + 1]; a[i + 1] = t; } } } æ’å…¥æ’åº æœ€å\u0026amp;å¹³å‡æƒ…å†µä¸‹æ—¶é—´å¤æ‚åº¦O(n^2^) æœ€å¥½æƒ…å†µä¸‹æ—¶é—´å¤æ‚åº¦O(n)\\\nä»å¤´å¼€å§‹éå†æ¯ä¸ªéœ€æ’å…¥çš„æ•°æ® ä¸å…¶å‰å·²æ’åºçš„æ•°æ®çš„æœ«å°¾å‘å¤´é€ä¸€æ¯”è¾ƒ for (int i = 1; i \u0026lt; len; ++i) { int key = arr[i]; int j = i - 1; while (j \u0026gt;= 0 \u0026amp;\u0026amp; arr[j] \u0026gt; key) { arr[j + 1] = arr[j]; j--; } arr[j + 1] = key; } æŠ˜åŠæ’å…¥ äºŒåˆ†ç®—æ³•ä¼˜åŒ– æ—¶é—´å¤æ‚åº¦ä¸å˜ å¿«é€Ÿæ’åº å°†æ•°åˆ—åˆ’åˆ†ä¸º2parts é€’å½’åˆ°ä¸¤å­åºåˆ—ä¸­è¿›è¡Œå¿«æ’ = æŒ–å‘å¡«æ•°\næœ€ä¼˜/å¹³å‡æ—¶é—´å¤æ‚åº¦O(nlogn) æœ€åO(n^2^)\nè‹¥é€‰ç¬¬ä¸€ä¸ªæ•°ä¸ºåŸºå‡†æ•° æ•°ç»„é¦–å°¾ä¸¤æŒ‡é’ˆ i\u0026amp;j\nä»jå¼€å§‹å‘å‰æ‰¾å°äºæˆ–ç­‰äºåŸºå‡†æ•°çš„ æ”¾åˆ°åŸåŸºå‡†æ•°çš„ä½ç½®\nä»iå¼€å§‹å‘åæ‰¾å¤§äºåŸºå‡†æ•°çš„ æ”¾åˆ°åŸjçš„ä½ç½®\nä»¥æ­¤å¾ªç¯ æœ€åi=jæ”¾å…¥åŸºå‡†æ•°\nåœ¨å‰åä¸¤partså†ç»§ç»­è¿›è¡Œä»¥ä¸Šæ­¥éª¤\nä¸‰æ•°å–ä¸­ï¼šå‰ä¸­åä¸‰ä¸ªæ•°å…ˆæ’åºâ€”â€”ä¸­ä¸åæ¢ï¼ˆåçš„å‰ä¸€ä¸ªä¹Ÿå¯ä»¥ï¼‰â€”â€”ä» å‰ åˆ° åçš„å‰ä¸€ä¸ª è¿›è¡Œå¤§å°åˆ¤æ–­ï¼ˆå‰æŒ‡é’ˆå…ˆåŠ¨ï¼‰â€”â€”åå’ŒæŒ‡é’ˆä½ç½®å¤„æ•°å­—äº¤æ¢â€”â€”é‡å¤\næ’åºåå†é€‰pivot whileå†…æ¯ä¸€æ­¥ä¹Ÿè¦é™å®ši\u0026lt;jæˆ–i\u0026lt;=jï¼ˆä¸”æ”¾åœ¨\u0026amp;\u0026amp;å·ä¹‹å‰ï¼‰ void quick_sort(int s[],int l,int r){ if(l\u0026lt;r) { int i=l,j=r,base=s[l]; while(i\u0026lt;j){ while(i\u0026lt;j\u0026amp;\u0026amp;s[j]\u0026gt;base) j--; if(i\u0026lt;j){ s[i++]=s[j]; } while(i\u0026lt;j\u0026amp;\u0026amp;s[i]\u0026lt;=base) i++; if(i\u0026lt;j){ s[j--]=s[i]; } } } s[i]=base; quick_sort(s,l,i-1); quick_sort(s,i+1,r); } ä¼˜åŒ–ï¼š\nä¸‰è·¯å¿«é€Ÿæ’åº ä¸‰è·¯å–ä¸­ï¼ˆé¦–ã€ä¸­ã€å°¾ä¸‰å…ƒç´ è¿›è¡Œæ¯”è¾ƒåé€‰æ‹©baseï¼‰ ä¸baseç›¸ç­‰çš„å…ƒç´ èšé›†åœ¨å…¶å‘¨è¾¹ çŸ­åºåˆ—ç”¨æ’æ’ å½’å¹¶æ’åº æ—¶é—´å¤æ‚åº¦O(nlogn) ç©ºé—´å¤æ‚åº¦O(n) ç±»ä¼¼å¿«æ’ï¼Œä½†å¿«æ’å°†æ•°ç»„åˆ†ä¸ºå¤§å°ä¸¤åŠ çœç•¥äº†æœ€åå°†ä¸¤éƒ¨åˆ†æ•°ç»„åˆäºŒä¸ºä¸€çš„æ­¥éª¤\nå †æ’åº äºŒå‰å † = å®Œå…¨äºŒå‰æ ‘ï¼ˆ/è¿‘ä¼¼ï¼‰ æœ€å¤§å †/æœ€å°å † æ—¶é—´å¤æ‚åº¦ï¼š$O(nlogn)$ ç©ºé—´å¤æ‚åº¦ï¼š$log(n)$ é€’å½’ä½¿ç”¨æ ˆçš„ç©ºé—´ä»£ä»·\næ‹¥æœ‰ä¸€ä¸ªarr å¯¹arrå»ºæœ€å¤§å †â€”â€”åªæ£€æŸ¥å€’æ•°ç¬¬äºŒè¡ŒåŠä»¥ä¸Šï¼Œä½¿ç”¨heapify å¾ªç¯æ£€æŸ¥ ä»æœ€åä¸€ä¸ªæ•°å­—æ£€æŸ¥åˆ°ç¬¬äºŒè¡Œï¼ˆå³ä¸åŒ…æ‹¬rootï¼‰â€”â€”å°†rootä¸å½“å‰æ•°å­—äº¤æ¢åï¼Œä»é¡¶å‘ä¸‹heapify è¿‡ç¨‹ä¸­å¯ä»¥å°†len\u0026ndash;ï¼ˆåé¢çš„å·²ç»æ£€æŸ¥è¿‡äº†ï¼‰ heapifyï¼šå·¦å­å³å­å®šä¹‰â€”â€”æ£€æŸ¥parentæ˜¯å¦æ¯”å·¦å­å³å­å¤§â€”â€”å¦ åˆ™å°†å…¶ä¸æœ€å¤§å€¼äº¤æ¢åå‘ä¸‹ç»§ç»­heapifyï¼ˆæ›´æ–°è¢«äº¤æ¢çš„å­çš„å­æ ‘ï¼‰ public static void main(String[] args) { int[] arr={6,3,8,2,9,4,7,1,5}; int len=arr.length; buildMaxHeap(arr,len); for(int i=len-1;i\u0026gt;0;i--){ swap(arr,0,i); len--; heapify(arr,0,len); } System.out.println(Arrays.toString(arr)); } public static void buildMaxHeap(int[] arr,int len) { for(int i=len/2;i\u0026gt;=0;i--){ heapify(arr,i,len); } } public static void heapify(int[] arr,int i,int len) { int left=i*2+1; int right=i*2+2; int largest=i; if(left\u0026lt;len \u0026amp;\u0026amp; arr[left]\u0026gt;arr[largest]) largest=left; if(right\u0026lt;len\u0026amp;\u0026amp; arr[right]\u0026gt;arr[largest]) largest=right; if(largest!=i){ swap(arr,largest,i); heapify(arr,largest,len); } } public static void swap(int[] arr, int i, int j) { int temp = arr[i]; arr[i] = arr[j]; arr[j] = temp; } è®¡æ•°æ’åº åŸç†ï¼šç¡®å®šæ•°ç»„ä¸­max minï¼Œæ‰€æœ‰å…ƒç´ æ’å…¥count[value-min]ä¸­ï¼Œç›¸åŒå…ƒç´ åˆ™countåŠ ä¸€ã€‚ æ’å…¥å®Œæ¯•ï¼Œcount[n]+=count[n-1]â€”â€”ä¸ºäº†ç¡®å®šåœ¨æ–°æ•°ç»„ä¸­çš„ä½ç½® ä»åå‘å‰éå†åŸæ•°ç»„ï¼ˆç›¸åŒå…ƒç´ æ’å…¥æ—¶ä»å‰å‘åï¼Œå–å‡ºæ—¶ä»åå‘å‰ç¬¦åˆindexï¼‰ åœ¨æ–°æ•°ç»„ä¸­çš„count[n]-1ä½ç½®ï¼ˆæ•°ç»„ä»0å¼€å§‹ä½†countæœ€å°ä½ä¸º1ï¼‰æ”¾å…¥arr[i]ï¼Œcount[n]å‡ä¸€ åŸºæ•°æ’åº åŸç†ï¼šä»æ¯ä¸ªæ•°çš„ä¸ªä½åˆ°åä½åˆ°æœ€é«˜ä½ä¾æ¬¡æ’åºï¼Œæ’è¿›0-9çš„é˜Ÿåˆ—ä¸­ï¼Œä¸€ç›´åˆ°maxçš„æœ€é«˜ä½ è®¡æ•°\u0026amp;åŸºæ•°\u0026amp;æ¡¶ è®¡æ•°ï¼šæ¯ä¸ªæ¡¶æ”¾å•ä¸€é”®å€¼ åŸºæ•°ï¼šæ ¹æ®é”®å€¼çš„æ¯ä½æ•°å­—åˆ†é…æ¡¶ï¼ˆæ¡¶çš„æ˜ å°„å‡½æ•°æ–¹æ³•ä¸åŒï¼‰ æ¡¶ï¼šæ¯ä¸ªæ¡¶å­˜å‚¨ä¸€å®šèŒƒå›´çš„æ•°å€¼ ç‰¹æ®Šåº”ç”¨ åº·æ‰˜å±•å¼€ æ•°å­¦æ–¹æ³• è¯¦è§wiki\nåº”ç”¨ï¼šLC.60æ’åˆ—æ’åºpermutation-sequence\n","permalink":"https://Sattiluvcat.github.io/en/posts/notes/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/","summary":"éƒ¨åˆ†ä»£ç æ¥è‡ªï¼šOI WIKIï¼Œé“¾æ¥è§æ–‡ç« ","title":"æ•°æ®ç»“æ„"},{"content":"Â å­˜å‚¨å¼•æ“ MySqlä½“ç³»ç»“æ„ MySqlæœåŠ¡å™¨ flowchart LR è¿æ¥å±‚--\u0026gt;æœåŠ¡å±‚ æœåŠ¡å±‚\u0026lt;--\u0026gt;SQLæ¥å£ æœåŠ¡å±‚\u0026lt;--\u0026gt;è§£æå™¨ æœåŠ¡å±‚\u0026lt;--\u0026gt;æŸ¥è¯¢ä¼˜åŒ–å™¨ æœåŠ¡å±‚\u0026lt;--\u0026gt;ç¼“å­˜ SQLæ¥å£--\u0026gt;d((å¯æ’æ‹”å¼å­˜å‚¨å¼•æ“)) è§£æå™¨--\u0026gt;d æŸ¥è¯¢ä¼˜åŒ–å™¨--\u0026gt;d ç¼“å­˜--\u0026gt;d d--\u0026gt;å­˜å‚¨å±‚ å­˜å‚¨å¼•æ“åŒ…æ‹¬InnoDBç­‰ï¼ŒIndexä¿¡æ¯ä¹Ÿå­˜å‚¨åœ¨å…¶ä¸­ å­˜å‚¨å±‚å­˜å‚¨ç³»ç»Ÿæ–‡ä»¶ã€æ–‡ä»¶å’Œæ—¥å¿—ç­‰ å­˜å‚¨å¼•æ“ å­˜å‚¨å¼•æ“ç®€ä»‹ å­˜æ•°æ®ã€å»ºç´¢å¼•ã€æ›´æ–°æ•°æ®ç­‰çš„å®ç°æ–¹å¼ï¼ŒåŸºäºè¡¨ä¸åŸºäºåº“ï¼ˆè¢«ç§°ä¸ºè¡¨ç±»å‹ï¼‰\nå»ºè¡¨æ—¶æŒ‡å®šå­˜å‚¨å¼•æ“\nCREATE TABLE è¡¨å( â€¦ \\)ENGINE=INNODB â€¦ SHOW ENGINES; æ˜¾ç¤ºæ”¯æŒçš„å­˜å‚¨å¼•æ“\nå­˜å‚¨å¼•æ“ç‰¹ç‚¹ InnoDB DMLæ“ä½œéµå¾ªACIDæ¨¡å‹ æ”¯æŒäº‹åŠ¡ è¡Œçº§é” æé«˜å¹¶å‘è®¿é—®æ€§èƒ½ æ”¯æŒå¤–é”® ä»¥.idbè¡¨ç©ºé—´æ–‡ä»¶å­˜å‚¨è¯¥è¡¨çš„è¡¨ç»“æ„(frm sdi)ã€æ•°æ®ä¸ç´¢å¼• ç”¨cmdæ‰“å¼€ idb2sdi ***.idb æŸ¥çœ‹è¡¨ç»“æ„ æ•°æ®æ®µå³ä¸ºB+æ ‘çš„å¶å­èŠ‚ç‚¹ ç´¢å¼•æ®µä¸ºéå¶å­èŠ‚ç‚¹ flowchart LR Tablespace--\u0026gt;Segment--\u0026gt;Extent--\u0026gt;Page--\u0026gt;row è¡¨ç©ºé—´--\u0026gt;æ®µ--\u0026gt;åŒº--\u0026gt;é¡µ--\u0026gt;è¡Œ MyISAM ä¸æ”¯æŒäº‹åŠ¡ å¤–é”® æ”¯æŒè¡¨é” ä¸æ”¯æŒè¡Œé” è®¿é—®é€Ÿåº¦å¿« âœ•âœ•.sdi å­˜å‚¨è¡¨ç»“æ„ä¿¡æ¯ âœ•âœ•.MYD å­˜å‚¨æ•°æ® âœ•âœ•.MYI å­˜å‚¨ç´¢å¼• Memory å­˜å‚¨åœ¨å†…å­˜ä¸­ åªåšä¸´æ—¶æ–‡ä»¶\nå†…å­˜å­˜æ”¾ hashç´¢å¼• âœ•âœ•.sdi å­˜å‚¨è¡¨ç»“æ„ æ¯”è¾ƒ ç‰¹ç‚¹ InnoDB MyISAM Memory äº‹åŠ¡å®‰å…¨ æ”¯æŒ - - é”æœºåˆ¶ è¡Œé” è¡¨é” è¡¨é” æ”¯æŒå¤–é”® æ”¯æŒ - - B+treeç´¢å¼• æ”¯æŒ æ”¯æŒ æ”¯æŒ Hashç´¢å¼• - - æ”¯æŒ å…¨æ–‡ç´¢å¼• æ”¯æŒ æ”¯æŒ - ç©ºé—´ä½¿ç”¨ é«˜ ä½ N/A å†…å­˜ä½¿ç”¨ é«˜ ä½ ä¸­ æ‰¹é‡æ’å…¥é€Ÿåº¦ ä½ é«˜ é«˜ é€‰æ‹© InnoDB äº‹åŠ¡å®Œæ•´æ€§\u0026amp;å¹¶å‘æ¡ä»¶ å„ç§æ“ä½œéƒ½å¾ˆå¤š MyISAM ä»¥è¯»\u0026amp;æ’å…¥æ“ä½œä¸ºä¸» å°‘æ›´æ–°\u0026amp;åˆ é™¤ å¯¹äº‹åŠ¡çš„å®Œæ•´æ€§ä¸å¹¶å‘æ€§è¦æ±‚ä¸é«˜(è¢«ControlDBå–ä»£) Memory ä¸´æ—¶è¡¨çš„ç¼“å­˜ å¯¹è¡¨çš„å¤§å°æœ‰é™åˆ¶ å®‰å…¨æ€§æ²¡æœ‰ä¿éšœ(è¢«Rediså–ä»£) ç´¢å¼• ç´¢å¼•æ¦‚è¿° å¸®MySqlé«˜æ•ˆè·å–æ•°æ®çš„æ•°æ®ç»“æ„ï¼ˆæœ‰åºï¼‰ åœ¨å­˜å‚¨å¼•æ“ä¸­å®ç° ä¼˜ç‚¹ï¼š æé«˜æŸ¥è¯¢æ•ˆç‡ é™ä½IOæˆæœ¬ é™ä½æ’åºæˆæœ¬ é™ä½CPUæ¶ˆè€— ç¼ºç‚¹ï¼š å ç”¨ç£ç›˜ç©ºé—´ é™ä½æ›´æ–°è¡¨çš„é€Ÿåº¦ ç´¢å¼•ç»“æ„ ä¸»è¦ç´¢å¼•ï¼š ç´¢å¼•ç»“æ„ æè¿° B+Treeç´¢å¼• å¤§éƒ¨åˆ†å¼•æ“éƒ½æ”¯æŒ æœ€å¸¸è§ Hashç´¢å¼• ä¸æ”¯æŒèŒƒå›´æŸ¥è¯¢ ç²¾ç¡®åŒ¹é…ç´¢å¼•åˆ—çš„æŸ¥è¯¢æ‰æœ‰æ•ˆ R-Tree(ç©ºé—´ç´¢å¼•) MyISAMçš„ç‰¹æ®Šç´¢å¼• ç”¨äºåœ°ç†ç©ºé—´æ•°æ®ç±»å‹ Full-text(å…¨æ–‡ç´¢å¼•) å»ºç«‹å€’æ’ç´¢å¼• å¿«é€ŸåŒ¹é…æ–‡æ¡£ æ”¯æŒå¼•æ“ï¼š ç´¢å¼• InnoDB MyISAM Memory B+Tree æ”¯æŒ æ”¯æŒ æ”¯æŒ Hashç´¢å¼• ä¸æ”¯æŒ ä¸æ”¯æŒ æ”¯æŒ R-Tree ä¸æ”¯æŒ æ”¯æŒ ä¸æ”¯æŒ Full-text æ”¯æŒ æ”¯æŒ ä¸æ”¯æŒ ä¸€èˆ¬ç´¢å¼•ç›´æ¥æŒ‡B+Treeç´¢å¼• B+Tree\u0026amp;å…¶å®ƒTree äºŒå‰æ ‘ï¼šå·¦å­å°äºäº²ç‚¹ å³å­å¤§äºäº²ç‚¹ é¡ºåºæ’å…¥æ—¶ä¼šå½¢æˆé“¾è¡¨ å¤§æ•°æ®é‡ä¸‹ å±‚çº§è¾ƒæ·± æ•ˆç‡ä½ çº¢é»‘æ ‘ï¼šæ–°æ•°æ®ä¼šå…ˆä¸æ ¹èŠ‚ç‚¹åˆ¤æ–­å¤§å° å¤§æ•°æ®é‡ä¸‹ å±‚çº§è¾ƒæ·± B Tree(å¤šè·¯å¹³è¡¡æŸ¥æ‰¾æ ‘)ï¼š æœ€å¤§åº¦æ•°ä¸ºnï¼Œæœ€å¤šnä¸ªå­èŠ‚ç‚¹ï¼Œæ¯ä¸ªèŠ‚ç‚¹æœ€å¤šå­˜å‚¨n-1ä¸ªkey(å…ƒç´ )ï¼Œnä¸ªæŒ‡é’ˆ ä¸­é—´èŠ‚ç‚¹å‘ä¸Šåˆ†è£‚ B+Tree æ‰€æœ‰å…ƒç´ éƒ½ä¼šå‡ºç°åœ¨å¶å­èŠ‚ç‚¹(æ ‘åªèµ·åˆ°ç´¢å¼•ä½œç”¨) æ‰€æœ‰å¶å­èŠ‚ç‚¹å½¢æˆå•å‘é“¾è¡¨ B+Tree in MySql å¢åŠ äº†æŒ‡å‘ç›¸é‚»å¶å­èŠ‚ç‚¹çš„é“¾è¡¨æŒ‡é’ˆ å½¢æˆå¸¦é¡ºåºæŒ‡é’ˆçš„B+Tree ä¸€é¡µ(ä¸€ä¸ªç£ç›˜å—)åªå­˜æ”¾æŒ‡é’ˆå’Œkeyä¸å­˜æ”¾æ•°æ®ï¼Œåˆ™ä¸€é¡µä¸Šå¯ä»¥å­˜æ”¾çš„æŒ‡é’ˆä¸keyç›¸æ¯”BTreeæ›´å¤šï¼Œæ•…å±‚çº§æ›´å°‘ Hash é”®å€¼æ¢ç®—æˆæ–°çš„hashå€¼ æ˜ å°„åˆ°å¯¹åº”æ§½ä½ å­˜å‚¨åœ¨hashè¡¨ä¸­ hashå†²çª(å¤šä¸ªé”®å€¼æ˜ å°„åˆ°åŒä¸ªæ§½ä½)æ—¶ç”¨é“¾è¡¨è§£å†³ ç‰¹ç‚¹ï¼š åªèƒ½ç”¨äºå¯¹ç­‰æ¯”è¾ƒ ä¸æ”¯æŒèŒƒå›´æŸ¥è¯¢ æ— æ³•åˆ©ç”¨ç´¢å¼•è¿›è¡Œæ’åº æŸ¥è¯¢æ•ˆç‡é«˜ é€šå¸¸åªéœ€ä¸€æ¬¡æ£€ç´¢ é€šå¸¸æ•ˆç‡é«˜äºB+Tree ç´¢å¼•åˆ†ç±» åˆ†ç±»ï¼š ç´¢å¼• å«ä¹‰ ç‰¹ç‚¹ å…³é”®å­— ä¸»é”®ç´¢å¼• é’ˆå¯¹ä¸»é”®åˆ›å»ºçš„ é»˜è®¤è‡ªåŠ¨åˆ›å»º onlyone PRIMARY å”¯ä¸€ç´¢å¼• é¿å…åŒè¡¨ä¸­æŸåˆ—æ•°æ®çš„å€¼é‡å¤ å¯æœ‰å¤šä¸ª UNIQUE å¸¸è§„ç´¢å¼• å¿«é€Ÿå®šä½ç‰¹å®šæ•°æ® å¯å¤šä¸ª å…¨æ–‡ç´¢å¼• æŸ¥æ‰¾æ–‡æœ¬å…³é”®è¯ éæ¯”è¾ƒç´¢å¼•ä¸­çš„å€¼ å¯å¤š FULLTEXT æ ¹æ®ç´¢å¼•çš„å­˜å‚¨å½¢å¼åˆ†ç±»ï¼š èšé›†ç´¢å¼• å°†æ•°æ®å­˜å‚¨ä¸ç´¢å¼•æ”¾åˆ°ä¸€èµ· ç´¢å¼•çš„å¶å­èŠ‚ç‚¹ä¿å­˜è¡Œæ•°æ®(æœ‰ä¸”ä»…æœ‰1ä¸ª) èšé›†ç´¢å¼•é€‰å–è§„åˆ™ï¼šä¸»é”®\u0026gt;ç¬¬ä¸€ä¸ªå”¯ä¸€ç´¢å¼•\u0026gt;innoDBç”Ÿæˆrowidä½œä¸ºéšè—èšé›†ç´¢å¼• äºŒçº§ç´¢å¼• å°†æ•°æ®ä¸ç´¢å¼•åˆ†å¼€å­˜å‚¨ å¶å­èŠ‚ç‚¹å…³è”å¯¹åº”ä¸»é”®(å¯æœ‰å¤šä¸ª) å¦‚å»ºç«‹nameçš„ç´¢å¼• å¶å­èŠ‚ç‚¹å³å­˜å‚¨id å›è¡¨æŸ¥è¯¢ eg.æŸ¥è¯¢Sattiçš„æ‰€æœ‰ä¿¡æ¯ å…ˆäºŒçº§ç´¢å¼•æŸ¥ä¸»é”® åèšé›†ç´¢å¼•æŸ¥rowä¿¡æ¯ ç´¢å¼•è¯­æ³• CREATE [UNIQUE/FULLTEXT] INDEX ç´¢å¼•å ON è¡¨å (å­—æ®µå,â€¦); åˆ›å»ºç´¢å¼• å­—æ®µååå¯æŒ‡å®šå‡é™åºå»ºç«‹ç´¢å¼• ç´¢å¼•åä¸€èˆ¬ä¸º idx_è¡¨å_å­—æ®µå1_å­—æ®µå2 å¯ä»¥å…³è”å¤šä¸ªå­—æ®µ SHOW INDEX FROM è¡¨å[\\G]; æŸ¥çœ‹ç´¢å¼• \\Gå¯ä»¥æŠŠä»¥è¡Œæ˜¾ç¤ºçš„ç´¢å¼•è½¬æ¢ä¸ºåˆ—æ˜¾ç¤º DROP INDEX ç´¢å¼•å ON è¡¨å; åˆ é™¤ç´¢å¼• SQLæ€§èƒ½ æ€§èƒ½åˆ†æ SHOW GLOBAL STATUS LIKE'Com____' æŸ¥è¯¢å‘½ä»¤(Deleteç­‰)æ‰§è¡Œé¢‘æ¬¡ SHOW GLOBAL STATUSæä¾›æœåŠ¡å™¨çŠ¶æ€ 7ä¸ªä¸‹åˆ’çº¿ æ…¢æŸ¥è¯¢æ—¥å¿— è®°å½•è¶…è¿‡æŒ‡å®šæ—¶é—´çš„SQLè¯­å¥ SHOW VARIABLES LIKE'SLOW_QUERY_LOGâ€˜; æ£€æŸ¥æ…¢æŸ¥è¯¢æ—¥å¿—æ˜¯å¦å¼€å¯ å¼€å¯æ…¢æŸ¥è¯¢æ—¥å¿—ï¼š åœ¨MySqlé…ç½®æ–‡ä»¶/etc/my.cnfä¸­é…ç½®\n#å¼€å¯æ…¢æŸ¥è¯¢ slow_query_log=1\n#è®¾ç½®æ…¢æ—¥å¿—æ—¶é•¿\nlong_query_time=2 æŸ¥çœ‹è®°å½•ä¿¡æ¯ /var/lib/mysql/localhost-slow.log profileè¯¦æƒ… SELECT @@have_profiling; æ˜¯å¦æ”¯æŒprofileæ“ä½œ å¼€å¯profile SET PROFILING=1 SHOW PROFILES; æŸ¥çœ‹æ‰€æœ‰æŒ‡ä»¤è€—æ—¶ SHOW PROFILES [CPU] FOR QUERY queryå·; æŸ¥çœ‹æŸä¸ªqueryçš„è€—æ—¶(ä¸cpuæ¶ˆè€—) explainæ‰§è¡Œè®¡åˆ’ åœ¨selectè¯­å¥å‰åŠ  desc æˆ– explain id selectæŸ¥è¯¢çš„åºåˆ—å·ï¼ˆæ“ä½œé¡ºåºï¼‰ idç›¸åŒ é¡ºåºä»ä¸Šåˆ°ä¸‹ idä¸åŒ å€¼è¶Šå¤§è¶Šå…ˆæ‰§è¡Œ type æ€§èƒ½æŒ‡æ ‡ä»å¥½åˆ°å·®ï¼š NULL\u0026gt;system\u0026gt;const(ä»¥ä¸Šè¾ƒå¥½)\u0026gt;eq_ref\u0026gt;ref\u0026gt;range\u0026gt;index\u0026gt;all ä¸»é”®/å”¯ä¸€ç´¢å¼•==const possible_key å¯èƒ½ç”¨åˆ°çš„ç´¢å¼• key å®é™…ç”¨åˆ°çš„ç´¢å¼• key_len ç´¢å¼•å­—æ®µæœ€å¤§å¯èƒ½é•¿åº¦ rows é¢„ä¼°æ‰§è¡ŒæŸ¥è¯¢çš„è¡Œæ•° filtered è¿”å›ç»“æœè¡Œæ•°å è¯»å–è¡Œæ•°çš„æ¯”ä¾‹(è¶Šå¤§è¶Šå¥½) ç´¢å¼•ä½¿ç”¨åŸåˆ™ æœ€å·¦å‰ç¼€æ³•åˆ™ è”åˆç´¢å¼•æ—¶éµå®ˆ\næŸ¥è¯¢ä»ç´¢å¼•çš„æœ€å·¦åˆ—å¼€å§‹ ä¸”ä¸è·³è¿‡ç´¢å¼•ä¸­çš„åˆ—ï¼ˆå³ä»è”åˆç´¢å¼•çš„ç¬¬ä¸€ä¸ªå­—æ®µå¼€å§‹ï¼‰ è‹¥è·³è¿‡ç´¢å¼•ä¸­æŸå­—æ®µ åˆ™åé¢çš„å­—æ®µå¤±æ•ˆ èŒƒå›´æŸ¥è¯¢ è”åˆç´¢å¼•æ—¶éµå®ˆ\nå³\u0026gt; \u0026lt;ç­‰èŒƒå›´é™å®š è‹¥å‡ºç° å…¶å³ä¾§åˆ—ç´¢å¼•å¤±æ•ˆ è‹¥ä½¿ç”¨\u0026gt;=æˆ–\u0026lt;=åˆ™ä¸å­˜åœ¨æ­¤é—®é¢˜ å¤±æ•ˆé—®é¢˜ ç´¢å¼•åˆ—è¿ç®— è‹¥å¯¹ç´¢å¼•ä¸­çš„å­—æ®µè¿›è¡Œè¿ç®— ç´¢å¼•å¤±æ•ˆ åŒ…æ‹¬substringç­‰ å­—ç¬¦ä¸²ä¸åŠ å¼•å· å­—ç¬¦ä¸²ç±»å‹å­—æ®µè‹¥ä¸åŠ å¼•å· ç´¢å¼•å¤±æ•ˆ æ¨¡ç³ŠæŸ¥è¯¢ å°¾éƒ¨æ¨¡ç³ŠæŸ¥è¯¢ ä¸å¤±æ•ˆ å¤´éƒ¨æ¨¡ç³ŠæŸ¥è¯¢ ç´¢å¼•å¤±æ•ˆ orè¿æ¥ orä¸­ä¸€æ¡ä»¶ä¸­çš„å­—æ®µæœ‰ç´¢å¼• + å¦ä¸€åˆ—æ— ç´¢å¼• = ç´¢å¼•å¤±æ•ˆ æ•°æ®åˆ†å¸ƒå½±å“ å¦‚ç´¢å¼•æ•ˆç‡ä¸å¦‚å…¨è¡¨æ‰«ææ—¶ å¯ç”¨å…¨è¡¨æ‰«æ SQLæç¤º EXPLAIN selectè¯­å¥ USE INDEX(ç´¢å¼•å) å»ºè®®ä½¿ç”¨æŸç´¢å¼• EXPLAIN selectè¯­å¥ IGNORE INDEX(ç´¢å¼•å) ä¸ç”¨æŸç´¢å¼• EXPLAIN selectè¯­å¥ USE INDEX(ç´¢å¼•å) å¿…ç”¨æŸç´¢å¼• è¦†ç›–ç´¢å¼• éœ€è¦è¿”å›çš„åˆ—åœ¨ç´¢å¼•ä¸­å¯å…¨éƒ¨æ‰¾åˆ° \u0026ldquo;using where;using index\u0026rdquo; åœ¨åˆ— \u0026ldquo;using index condition\u0026rdquo; éœ€å›è¡¨æŸ¥è¯¢ å‰ç¼€ç´¢å¼• å­—æ®µç±»å‹ä¸ºvarchar textç­‰ éœ€ç´¢å¼•å¾ˆé•¿å­—ç¬¦ä¸²â€”â€”å‰ç¼€ç´¢å¼• CREATE INDEX ç´¢å¼•å ON è¡¨å(COLUMN(N)); åˆ›å»ºå‰ç¼€ç´¢å¼• Nä¸ºå‰ç¼€é•¿åº¦ é€‰æ‹©æ€§è®¡ç®—ï¼šCOUNT(DEISTINCT SUBSTRING(å­—æ®µå,m,n))/COUNT(\\)* æ ¹æ®é€‰æ‹©æ€§å–èˆé€‰æ‹©Nçš„å¤§å° å•åˆ—ä¸è”åˆç´¢å¼•çš„é€‰æ‹© ä¸šåŠ¡åœºæ™¯ä¸­å­˜åœ¨å¤šä¸ªæŸ¥è¯¢æ¡ä»¶ å»ºè®®é‡‡ç”¨è”åˆç´¢å¼• å•åˆ—æ˜“äº§ç”Ÿå›è¡¨æŸ¥è¯¢ ç´¢å¼•è®¾è®¡åŸåˆ™ æ•°æ®é‡è¾ƒå¤§ï¼ˆ\u0026gt;å‡ åä¸‡ï¼‰ æŸ¥è¯¢é¢‘ç¹ å¸¸ä½œä¸ºwhereã€order byã€group byæ¡ä»¶çš„å­—æ®µ åŒºåˆ†åº¦é«˜çš„åˆ—ï¼ˆç›¸å¯¹å”¯ä¸€ å¦‚èº«ä»½è¯å·ç­‰ï¼‰ è‹¥ä¸ºå­—ç¬¦ä¸²ç±»å‹ å­—æ®µé•¿åº¦è¾ƒé•¿â€”â€”å‰ç¼€ç´¢å¼• å°½é‡ä½¿ç”¨è”åˆç´¢å¼• æ§åˆ¶ç´¢å¼•æ•°é‡ è‹¥ç´¢å¼•åˆ—ä¸èƒ½æœ‰NULL å»ºè¡¨æ—¶å³è§„å®šNOT NULL ä¾¿äºä¼˜åŒ–å™¨é€‰ç”¨ç´¢å¼• SQLä¼˜åŒ– æ’å…¥ä¼˜åŒ– åŸºæœ¬ä¼˜åŒ– æ‰¹é‡æ’å…¥(500-1000æ¡) æ‰‹åŠ¨æäº¤äº‹åŠ¡ ä¸»é”®é¡ºåºæ’å…¥ å¤§æ‰¹é‡æ’å…¥æ•°æ®\n# å®¢æˆ·ç«¯è¿æ¥æœåŠ¡ç«¯æ—¶åŠ \u0026ndash;LOCAL-INFILE\nMYSQL --LOCAL-INFILE -U ROOT -P;\n# è®¾ç½®å…¨å±€å‚æ•°ä¸º1 å…è®¸ä»æœ¬åœ°åŠ è½½æ–‡ä»¶å¯¼å…¥æ•°æ®\nSET GLOBAL LOCAL_INFILE=1;\n# æ‰§è¡ŒloadåŠ è½½æ•°æ®\nLOAD DATA LOCAL INFILE 'æ•°æ®åœ°å€' INTO TABLE 'è¡¨å' FIELDS TERMINATED BY ',' LINES TERMINATED BY '\\n'; linuxå‘½ä»¤è¡Œï¼šhead æ–‡ä»¶åæŸ¥çœ‹æ–‡ä»¶å‰åè¡Œ ä¸»é”®ä¼˜åŒ– æ•°æ®ç»„ç»‡æ–¹å¼ InnoDBä¸­ è¡¨æ•°æ®æŒ‰ä¸»é”®é¡ºåºç»„ç»‡å­˜æ”¾ æ­¤ç§è¡¨å³ä¸ºç´¢å¼•ç»„ç»‡è¡¨(IOT) é¡µåˆ†è£‚ ï¼ˆé¡µä¸­å­˜æ”¾çš„æ˜¯è¡Œæ•°æ®ï¼‰\næ¯ä¸ªé¡µåŒ…å«2~nä¸ªæ•°æ®ï¼ˆè‹¥1ä¸ª åˆ™ç›¸å½“äºä¸€ä¸ªé“¾è¡¨ï¼‰ æ ¹æ®ä¸»é”®æ’åˆ— è‹¥ä¹±åºæ’å…¥ å¯èƒ½å‘ç”Ÿé¡µåˆ†è£‚ å‰ä¸€é¡µå50%éƒ¨åˆ†ä¸æ–°æ•°æ®æŒªè‡³æ–°é¡µ æ–°é¡µæ’å…¥å‰ä¸€é¡µä¸åä¸€é¡µé—´ é¡µåˆå¹¶ å½“é¡µä¸­åˆ é™¤çš„rowè¾¾åˆ°MERGE-THRESHOLDï¼ˆé»˜è®¤50%ï¼‰ InnoDBä¼šå¯»æ‰¾é è¿‘çš„é¡µè¿›è¡Œåˆå¹¶ MERGE-THRESHOLD åˆå¹¶é¡µçš„é˜ˆå€¼ å¯è‡ªå®šä¹‰ ä¸»é”®è®¾è®¡åŸåˆ™ å°½é‡é™ä½ä¸»é”®é•¿åº¦ï¼ˆå ç”¨çš„å­—èŠ‚å¤§å°ï¼‰ å°½é‡é¡ºåºæ’å…¥ï¼ˆè‡ªå¢ä¸»é”®ï¼‰ å°½é‡ä¸ç”¨UUIDï¼ˆé€šç”¨å”¯ä¸€è¯†åˆ«ç ï¼‰æˆ–å…¶å®ƒè‡ªç„¶ä¸»é”®ï¼ˆå¦‚èº«ä»½è¯å·ï¼‰ä¸ºä¸»é”® å› ä¸ºæ— åº é¿å…ä¿®æ”¹ä¸»é”® order byä¼˜åŒ– extraæ˜¾ç¤º Using index é€šè¿‡ç´¢å¼•æ’åº Using filesort ä¸å¯é€šè¿‡ç´¢å¼•ç›´æ¥è¿”å›æ’åºç»“æœ ç´¢å¼•å‡åºåˆ›å»ºæ—¶ è‹¥å€’åºæ’åºåˆ™éœ€filesort ä¼˜åŒ– æ ¹æ®æ’åºå­—æ®µå»ºç«‹åˆé€‚ç´¢å¼• å¤šå­—æ®µæ’åºæ—¶ä¹Ÿéµå¾ªæœ€å·¦å‰ç¼€ å°½é‡ä½¿ç”¨è¦†ç›–ç´¢å¼•\u0026amp;æ³¨æ„å‡é™åºè®¾å®š ä¸å¯é¿å…å‡ºç°filesortå¤§æ•°æ®é‡æ’åºæ—¶ é€‚å½“å¢åŠ æ’åºç¼“å†²åŒºsort_buffer_sizeå¤§å° group byä¼˜åŒ– extraæ˜¾ç¤º Using temporary ä½¿ç”¨ä¸´æ—¶è¡¨ï¼ˆæ€§èƒ½ä½ï¼‰ Using index ä½¿ç”¨ç´¢å¼• æ»¡è¶³æœ€å·¦å‰ç¼€ limitä¼˜åŒ–ï¼ˆåˆ†é¡µï¼‰ limitä¸èƒ½ç”¨åœ¨in/all/any/someå­è¯­å¥ä¸­==å¤šè¡¨æŸ¥è¯¢ å°†limitçš„ç»“æœè§†ä¸ºæ–°è¡¨ è¦†ç›–ç´¢å¼• + å­æŸ¥è¯¢ åŸè¡¨ä¸åˆ†é¡µæŸ¥åˆ°çš„ä¸»é”®idè¡¨è”åˆæŸ¥è¯¢nameç­‰ç´¢å¼•è¦†ç›–çš„å­—æ®µ countä¼˜åŒ– MyISAMå°†è¡¨çš„æ€»è¡Œå­˜åœ¨ç£ç›˜ä¸­ æ•ˆç‡é«˜ InnoDBéœ€å°†æ•°æ®ä»å¼•æ“ä¸­è¯»å‡ºåç´¯è®¡è®¡æ•° ä¼˜åŒ–æ€è·¯ è‡ªå·±è®¡æ•°ï¼ˆè®¾å®šè®¡æ•°å™¨cntï¼‰ ç”¨æ³• count(*) ä¸å–å€¼ ç›´æ¥ç´¯åŠ  count(ä¸»é”®) å–ä¸»é”®idå€¼ æŒ‰è¡Œç´¯åŠ  ä¸»é”®ä¸å¯èƒ½ä¸ºNULL count(å­—æ®µ) å­—æ®µä¸ºNULLæ—¶ countä¸åŠ 1 å­—æ®µæœ‰not nullçº¦æŸæ—¶ ä¸éœ€åˆ¤æ–­null count(1) å¯ä»¥å–-1ç­‰ æœåŠ¡å±‚å¯¹è¿”å›çš„æ¯ä¸€è¡Œæ”¾1ï¼ˆæˆ–-1ï¼‰è¿›å» åé€è¡Œç´¯åŠ  æ•ˆç‡ï¼šå­—æ®µ \u0026lt; ä¸»é”®id \u0026lt; 1 \u0026lt; * updateä¼˜åŒ– updateä¼˜å…ˆè¡Œé”ï¼ˆæœ‰ç´¢å¼•å­—æ®µæ—¶ é”ä½è¯¥è¡Œï¼‰è‹¥æ— ç´¢å¼• æ‰§è¡Œè¡¨é” InnoDBçš„è¡Œé”é’ˆå¯¹ç´¢å¼• è§†å›¾ è™šæ‹Ÿå­˜åœ¨çš„è¡¨ åªä¿å­˜æŸ¥è¯¢çš„é€»è¾‘ä¸ä¿å­˜ç»“æœ\nè§†å›¾è¯­æ³• CREATE [OR REPLACE] VIEW è§†å›¾åç§°[(åˆ—ååˆ—è¡¨)] AS SELECTè¯­å¥ [WITH [CASCADED |LOCAL] CHECK OPTION]\nåˆ›å»ºè§†å›¾ï¼ˆOR REPLACEæˆ–æ›¿æ¢è§†å›¾ï¼‰ SHOW CREATE VIEW è§†å›¾å\næŸ¥çœ‹åˆ›å»ºè§†å›¾è¯­å¥\nSELECT * FROM è§†å›¾å\næŸ¥çœ‹è§†å›¾ ç±»ä¼¼è¡¨ CREATE [OR REPLACE] VIEW è§†å›¾åç§°[(åˆ—ååˆ—è¡¨)] AS SELECTè¯­å¥ [WITH [CASCADED/LOCAL] CHECK OPTION]\nä¿®æ”¹è§†å›¾ï¼ˆREPLACEä¸ºä¸»è¦ï¼‰\nALTER VIEW è§†å›¾åç§°[(åˆ—ååˆ—è¡¨)] AS SELECTè¯­å¥ [WITH [CASCADED/LOCAL] CHECK OPTION]\nä¿®æ”¹è§†å›¾ DROP VIEW [IF EXISTS] è§†å›¾åç§° åˆ é™¤è§†å›¾ æ£€æŸ¥é€‰é¡¹ WITH [CASCADED/LOCAL] CHECK OPTION ä½¿ä¹‹åå¯¹è§†å›¾è¿›è¡Œçš„å¢åˆ æ”¹æ“ä½œç¬¦åˆè§†å›¾æœ€åˆçš„å®šä¹‰ CASCADED/LOCAL æ£€æŸ¥ä¾èµ–è§†å›¾çš„è§„åˆ™ ä¿æŒä¸€è‡´æ€§ äºŒè€…é™å®šçš„èŒƒå›´ä¸åŒ CASCADED ï¼ˆè‹¥v1æœªæŒ‡å®šè§†å›¾æ£€æŸ¥ ä½†ä¸ºv2çš„ä¾èµ–è§†å›¾ ä¹Ÿä¼šæ£€æŸ¥v1ï¼‰æ£€æŸ¥æ‰€æœ‰äº²è¾ˆçš„é™åˆ¶ æ— è®ºå…¶æ˜¯å¦æŒ‡å®š LOCAL è‹¥v1æœªæŒ‡å®š åˆ™ä¸æ£€æŸ¥v1 è§†å›¾æ›´æ–° å¯æ›´æ–°çš„è§†å›¾ï¼šè§†å›¾ä¸­çš„è¡Œä¸åŸºç¡€è¡¨çš„è¡Œä¸€ä¸€å¯¹åº” åŒ…å« èšåˆ/DISTINCT/GROUP BY/HAVING/UNION/â€¦ çš„è§†å›¾ä¸å¯æ›´æ–° è§†å›¾ä½œç”¨ ç®€å• ç®€åŒ–ç†è§£\u0026amp;æ“ä½œï¼ˆå¤æ‚ä¸”å¤šæ¬¡ä½¿ç”¨åˆ°çš„æ£€ç´¢å¯ä»¥å½¢æˆè§†å›¾ï¼‰ å®‰å…¨ å¯ä»¥åªæŸ¥çœ‹æŸè¡¨çš„éƒ¨åˆ†å†…å®¹ï¼ˆæˆæƒåªèƒ½ç²¾ç¡®åˆ°è¡¨ï¼‰ æ•°æ®ç‹¬ç«‹ å±è”½åŸºè¡¨å˜åŒ–å¯¹æŸ¥çœ‹ä¿¡æ¯å¸¦æ¥çš„å½±å“ å­˜å‚¨è¿‡ç¨‹ SQLè¯­è¨€çš„ä»£ç å°è£…ä¸é‡ç”¨\nç‰¹ç‚¹ å°è£… å¤ç”¨ å¯ä»¥æ¥æ”¶å‚æ•° è¿”å›æ•°æ® å‡å°‘åº”ç”¨é€”å¾„ä¸æ•°æ®åº“é—´çš„ç½‘ç»œäº¤äº’ æå‡æ•ˆç‡ è¯­æ³• åˆ›å»ºå­˜å‚¨è¿‡ç¨‹ CREATE PROCEDURE å­˜å‚¨è¿‡ç¨‹å([å‚æ•°åˆ—è¡¨])* BEGIN â€”â€”SQLè¯­å¥ END; å‘½ä»¤è¡Œä¸­è§£å†³é‡ ; å³åœé—®é¢˜ï¼šç”¨delimiter æŸç¬¦å·æŒ‡å®šè¯­å¥ç»“æŸä½ç½® åœ¨DataGripä¸­å­˜å‚¨ä¸ºroutines ä¸­æ–‡â€œä¾‹ç¨‹â€\nCALL å­˜å‚¨è¿‡ç¨‹å([å‚æ•°åˆ—è¡¨]) è°ƒç”¨å­˜å‚¨è¿‡ç¨‹ SELECT * FROM INFORMATION_SCHEMA.ROUTINES WHERE ROUTINE_SCHEMA='è¡¨å';\næŸ¥è¯¢æŒ‡å®šæ•°æ®åº“çš„å­˜å‚¨è¿‡ç¨‹ä¸çŠ¶æ€\nSELECT CREATE PROCEDURE å­˜å‚¨è¿‡ç¨‹å\næŸ¥è¯¢æŸå­˜å‚¨è¿‡ç¨‹çš„å®šä¹‰ DROP PROCEDURE å­˜å‚¨è¿‡ç¨‹å åˆ é™¤å­˜å‚¨è¿‡ç¨‹ å˜é‡ ç³»ç»Ÿå˜é‡ ç”±æœåŠ¡å™¨æä¾› åˆ†ä¸ºå…¨å±€å˜é‡GLOBALä¸ä¼šè¯å˜é‡SESSIONï¼ˆä»…åœ¨å½“å‰ä¼šè¯ å³å½“å‰æ§åˆ¶å° ç”Ÿæ•ˆï¼‰ é»˜è®¤SESSION ç³»ç»Ÿé‡å¯åå…¨å±€å‚æ•°å¤±æ•ˆ å¯åœ¨/etc/my.cnfä¸­é…ç½® SHOW [SESSION/GLOBAL] VARIABLES;\næŸ¥çœ‹æ‰€æœ‰ç³»ç»Ÿå˜é‡\nSHOW [SESSION/GLOBAL] VARIABLES LIKE 'â€¦';\næ¨¡ç³ŠåŒ¹é…\nSELECT @@[SESSION/GLOBAL] ç³»ç»Ÿå˜é‡å;\næŸ¥çœ‹æŒ‡å®šå˜é‡çš„å€¼ ç³»ç»Ÿå˜é‡ç”¨@@ SET [SESSION/GLOBAL] ç³»ç»Ÿå˜é‡å=å€¼\nSELECT @@[SESSION/GLOBAL] ç³»ç»Ÿå˜é‡å=å€¼\nè®¾ç½®ç³»ç»Ÿå˜é‡ SET SESSION AUTOCOMMIT =0 åˆ‡æ¢åˆ°æ‰‹åŠ¨æäº¤ ç”¨æˆ·è‡ªå®šä¹‰å˜é‡ ä¸ç”¨æå‰å£°æ˜ é€šè¿‡â€œ@å˜é‡åâ€ä½¿ç”¨(æœªå®šä¹‰æ—¶è°ƒç”¨è¿”å›null) ä½œç”¨åŸŸä¸ºå½“å‰\nSET @å˜é‡å=å€¼;\nSET @å˜é‡å:=å€¼;\nSELECT @å˜é‡å=å€¼;\nèµ‹å€¼ å¯å¤šä¸ªåŒæ—¶èµ‹å€¼\nSELECT å­—æ®µå INTO @å˜é‡å FROM è¡¨å; å°†å­—æ®µåç»“æœèµ‹å€¼ç»™å˜é‡ SELECT @å˜é‡å ä½¿ç”¨å˜é‡ å±€éƒ¨å˜é‡ ä½œç”¨åŸŸåœ¨beginâ€¦endå—ä¹‹é—´ å…ˆå£°æ˜åè°ƒç”¨\nDECLARE å˜é‡å å˜é‡ç±»å‹ [DEFAULT â€¦]; å£°æ˜ï¼ˆæœ‰å¦é»˜è®¤å€¼ï¼‰ SET å˜é‡å := å€¼\nSELECT å­—æ®µå INTO å˜é‡å FROM è¡¨å;\nä¸ºå˜é‡èµ‹å€¼ æ¡ä»¶åˆ¤æ–­\u0026amp;å¾ªç¯ if IF æ¡ä»¶1 THEN â€¦; ELSEIF æ¡ä»¶2 THEN â€¦; ELSE â€¦; END IF; ç”¨SELECTè¯­å¥æ˜¾ç¤ºè¿”å›å€¼\nå‚æ•° ç±»å‹ ç±»å‹ å«ä¹‰ å¤‡æ³¨ IN è¾“å…¥ è°ƒç”¨æ—¶ä¼ å…¥å€¼ é»˜è®¤ OUT è¾“å‡º å¯ä¸ºè¿”å›å€¼ INOUT è¾“å…¥\u0026amp;è¾“å‡º CREATE PROCEDURE å­˜å‚¨è¿‡ç¨‹å([IN/OUT/INOUT å‚æ•°å å‚æ•°ç±»å‹]) case CASE [å˜é‡] WHEN â€¦ THEN â€¦; â€¦ ELSE â€¦ END CASE; while WHILE æ¡ä»¶ DO SQLé€»è¾‘ END WHILE æ¡ä»¶ä¸ºtrueæ—¶è¿›è¡Œ repeat REPEAT SQLé€»è¾‘ UNTIL æ¡ä»¶ END REPEAT å…ˆæ‰§è¡Œä¸€æ¬¡é€»è¾‘ è‹¥æ¡ä»¶æ»¡è¶³åˆ™åœæ­¢å¾ªç¯ loop [begin_label:] LOOP â€¦ END LOOP [end_label]; é…åˆè¯­å¥ï¼š LEAVE LABEL; é€€å‡ºå¾ªç¯ ITERATE LABEL; åªå¯åœ¨å¾ªç¯ä¸­ä½¿ç”¨ è·³è¿‡å½“å‰å¾ªç¯å‰©ä¸‹çš„è¯­å¥è¿›å…¥ä¸‹ä¸€æ¬¡å¾ªç¯ æ¸¸æ ‡\u0026amp;æ¡ä»¶å¤„ç†ç¨‹åº æ¸¸æ ‡ æš‚æ—¶å­˜å‚¨æŸ¥è¯¢ç»“æœé›†çš„æ•°æ®ç±»å‹ï¼ˆé›†åˆï¼‰\nDECLARE æ¸¸æ ‡å CURSOR FOR æŸ¥è¯¢è¯­å¥; å£°æ˜æ¸¸æ ‡ OPEN æ¸¸æ ‡å æ‰“å¼€æ¸¸æ ‡ FETCH æ¸¸æ ‡å INTO å˜é‡; è·å–æ¸¸æ ‡è®°å½•ï¼ˆå¯ä»¥æ˜¯å¤šä¸ªå˜é‡ï¼‰ CLOSE æ¸¸æ ‡å å…³é—­æ¸¸æ ‡ ä½¿ç”¨æ¸¸æ ‡è®°å½•ç»“æœé›† å¼€å¯æ¸¸æ ‡é€šè¿‡å¾ªç¯è·å–æ¸¸æ ‡å†…çš„æ•°æ® æ¡ä»¶å¤„ç†ç¨‹åº å®šä¹‰åœ¨æµç¨‹æ§åˆ¶ç»“æ„æ‰§è¡Œè¿‡ç¨‹ä¸­é‡åˆ°é—®é¢˜çš„å¤„ç†æ­¥éª¤\nDECLARE å¤„ç†åŠ¨ä½œ HANDLER FOR çŠ¶å†µå€¼ â€¦ statement; å¤„ç†åŠ¨ä½œï¼š CONTINUE ç»§ç»­æ‰§è¡Œå½“å‰ç¨‹åº EXIT ç»ˆæ­¢ çŠ¶å†µå€¼ï¼š SQLSTATE çŠ¶æ€ç  å¯ç”¨ä¸‹åˆ—æ›¿ä»£ SQLWARNINGï¼ˆ01å¼€å¤´çš„çŠ¶æ€ç ï¼‰ NOT FOUNDï¼ˆ02å¼€å¤´çš„çŠ¶æ€ç ï¼‰ SQLEXCEPTIONï¼ˆé™¤ä»¥ä¸Šä¸¤ç§çš„å…¶å®ƒï¼‰ å­˜å‚¨å‡½æ•° æœ‰è¿”å›å€¼ å‚æ•°å¿…ä¸ºINç±»å‹ï¼ˆåº”ç”¨å°‘ï¼‰\nCREATE FUNCTION å­˜å‚¨å‡½æ•°å([å‚æ•°åˆ—è¡¨]) RETURNS æ•°æ®ç±»å‹ [characteristic] BEGIN â€”â€”SQLè¯­å¥ END; characteristicï¼šï¼ˆäºŒçº§æ—¥å¿—å¼€å¯ é»˜è®¤éœ€åŠ ï¼‰\nDETERMINISTIC ç›¸åŒè¾“å…¥äº§ç”Ÿç›¸åŒç»“æœ NO SQL ä¸åŒ…å«SQLè¯­å¥ READ SQL DATA åŒ…å«è¯»å–æ•°æ®çš„è¯­å¥ ä¸åŒ…å«å†™å…¥æ•°æ®çš„è¯­å¥ è§¦å‘å™¨ è§¦å‘å™¨å®šä¹‰ ä¸è¡¨æœ‰å…³çš„æ•°æ®åº“å¯¹è±¡ã€‚åœ¨insert/update/deleteä¹‹å‰æˆ–ä¹‹åï¼Œè§¦å‘å¹¶æ‰§è¡Œå…¶å®šä¹‰çš„è¯­å¥ï¼ˆå¤šä¸ºè®°å½•æ•°æ®å˜æ›´æ—¥å¿—ï¼‰ OLDä¸NEWå¼•ç”¨è§¦å‘å™¨ä¸­å‘ç”Ÿå˜åŒ–çš„è®°å½•å†…å®¹ å¦‚insertç”¨NEWï¼›updateç”¨OLDï¼ˆå¼•ç”¨éœ€ä¿®æ”¹çš„å†…å®¹ï¼‰ä¸NEWï¼ˆå¼•ç”¨ä¿®æ”¹åçš„å†…å®¹ï¼‰ åªæ”¯æŒè¡Œçº§è§¦å‘å™¨ ä¸æ”¯æŒè¯­å¥çº§è§¦å‘ è§¦å‘å™¨è¯­æ³• CREATE TRIGGER è§¦å‘å™¨å BEFORE/AFTER INSERT/â€¦ ON è¡¨å FOR EACH ROWâ€”â€”è¡Œçº§è§¦å‘å™¨ BEGIN è¯­å¥ï¼ˆå°†ä¿®æ”¹çš„å†…å®¹æ”¾å…¥æ–°å»ºçš„æ—¥å¿—è¡¨ä¸­ï¼‰ END; åˆ›å»ºè§¦å‘å™¨ â€œè¯­å¥â€ä¸ºå°†æ–°æ“ä½œè®°å½•æ’å…¥æ—¥å¿—è¡¨ï¼ˆè‡ªå»ºï¼‰ å¯ä»¥è®°å½•æ’å…¥çš„è¯¦ç»†ä¿¡æ¯ ç”¨ concat() æ‹¼æ¥å­—ç¬¦ä¸² SHOW TRIGGERS; æŸ¥çœ‹è§¦å‘å™¨ DROP TRIGGER [æ•°æ®åº“å.]è§¦å‘å™¨å; åˆ é™¤è§¦å‘å™¨ é” æ¦‚è¿° åè°ƒå¤šè¿›ç¨‹æˆ–çº¿ç¨‹å¹¶å‘è®¿é—®æŸèµ„æºçš„æœºåˆ¶ äº‹åŠ¡ä¸­è¿›è¡Œ åˆ†ç±» å…¨å±€é” æ•°æ®åº“ä¸­æ‰€æœ‰è¡¨ è¡¨çº§é” è¡Œçº§é” å…¨å±€é” é€šå¸¸ç”¨åšå…¨æ•°æ®åº“çš„é€»è¾‘å¤‡ä»½\nè¯­æ³• FLUSH TABLES WITH READ LOCK åŠ å…¨å±€é” MYSQLDUMP -UROOT -P1234 æ•°æ®åº“å\u0026gt;ä¿å­˜åœ°ç‚¹ å¤‡ä»½æ•°æ®åº“ åœ¨å‘½ä»¤è¡Œä¸­è¿è¡Œ émysqlè¯­å¥ ç”¨æˆ·åroot å¯†ç 1234 UNLOCK TABLES é‡Šæ”¾é” ç‰¹ç‚¹ï¼ˆä¸é‡è¦ï¼‰ è‹¥ä¸»åº“å¤‡ä»½ å¤‡ä»½æœŸé—´ä¸èƒ½æ›´æ–°ä¸»åº“ è‹¥ä»åº“å¤‡ä»½ å¤‡ä»½æœŸé—´ä»åº“ä¸èƒ½æ‰§è¡Œä¸»åº“åŒæ­¥æ¥çš„äºŒè¿›åˆ¶æ—¥å¿— å¯¼è‡´ä¸»ä»å»¶è¿Ÿ MYSQLDUMP --SINGLE-TRANSACTION -UROOT -P1234 æ•°æ®åº“å\u0026gt;ä¿å­˜åœ°ç‚¹ ä¸éœ€åŠ å…¨å±€é”çš„å¤‡ä»½ è¡¨çº§é” é”å®šç²’åº¦å¤§ å‘ç”Ÿæ‰€å†²çªçš„æ¦‚ç‡æœ€é«˜ å¹¶å‘åº¦æœ€ä½\nåˆ†ç±»ï¼š è¡¨é” å…ƒæ•°æ®é” æ„å‘é” è¡¨é” åˆ†ç±»ï¼š è¡¨å…±äº«è¯»é” è¡¨ç‹¬å å†™é” LOCK TABLES è¡¨åâ€¦ READ/WRITE åŠ é” è¯»é” æ‰€æœ‰å®¢æˆ·ç«¯éƒ½å¯è¯» ä¸å¯å†™ å†™é” å½“å‰å®¢æˆ·ç«¯å¯è¯» / å†™ å…¶ä»–å®¢æˆ·ç«¯ä¸å¯è¯» / å†™ UNLOCK TABLES é‡Šæ”¾é” å…ƒæ•°æ®é”(meta data lock,MDL) ç³»ç»Ÿè‡ªåŠ¨æ§åˆ¶\nç»´æŠ¤è¡¨å…ƒæ•°æ®çš„æ•°æ®ä¸€è‡´æ€§==è¡¨ä¸Šæœ‰æ´»åŠ¨äº‹åŠ¡æ—¶ä¸å¯å¯¹å…ƒæ•°æ®è¿›è¡Œå†™å…¥ é¿å…DMLä¸DDLå†²çª MySql5.5å DMLå¢åˆ æ”¹æŸ¥åŠ è¯»é” DDLå¯¹è¡¨ç»“æ„å˜æ›´åŠ å†™é” SELECT OBJECT_SCHEMA,OBJECT_NAME,INDEX_NAME,LOCK_TYPE,LOCK_MODE,LOCK_DATA FROM PERFORMANCE_SCHEMA.METADATA_LOCKS; æŸ¥çœ‹å…ƒæ•°æ®é” æ„å‘é” ä½¿è¡¨é”ä¸ç”¨æ£€æŸ¥æ¯è¡Œæ•°æ®æ˜¯å¦åŠ è¡Œé” é¿å…DMLæ‰§è¡Œæ—¶è¡Œé”ä¸è¡¨é”å†²çª åˆ†ç±»ï¼š æ„å‘å…±äº«é”(IS) æ„å‘æ’ä»–é”(IX) SELECT OBJECT_SCHEMA,OBJECT_NAME,INDEX_NAME,LOCK_TYPE,LOCK_MODE,LOCK_DATA FROM PERFORMANCE_SCHEMA.DATA_LOCKS;\næŸ¥çœ‹é” æ—¥å¿—ä¸­RECORDé”ç±»å‹ä»£è¡¨è¡Œé” æ„å‘é”é—´ä¸äº’æ–¥\nIS æ„å‘å…±äº«é” ç”±SELECTè¯­å¥ LOCK IN SHARE MODEæ·»åŠ  ä¸è¡¨é”å…±äº«è¯»é”(read)å…¼å®¹ ä¸è¡¨é”æ’å®ƒå†™é”(write)äº’æ–¥ IX æ„å‘æ’ä»–é” ç”±å¢åˆ æ”¹è¯­å¥ FOR UPDATEæ·»åŠ  ä¸è¡¨é”å…±äº«è¯»é”(read)äº’æ–¥ ä¸è¡¨é”æ’å®ƒå†™é”(write)äº’æ–¥ è¡Œçº§é” é”å®šç²’åº¦æœ€å° é”å†²çªæ”¹ç‡æœ€ä½ å¹¶å‘åº¦æœ€é«˜ åœ¨InnoDBå­˜å‚¨å¼•æ“ä¸­åº”ç”¨\nåˆ†ç±»ï¼š è¡Œé” é”å®šå•ä¸ªè¡Œè®°å½•â€”â€”åœ¨RC RRéš”ç¦»çº§åˆ«ä¸‹éƒ½æ”¯æŒï¼ˆåŒ…æ‹¬å…±äº«é”ä¸æ’ä»–é”ï¼‰ é—´éš™é” ç¡®ä¿ç´¢å¼•è®°å½•é—´éš™ä¸å˜ é˜²æ­¢insertäº§ç”Ÿå¹»è¯»â€”â€”åœ¨RRä¸‹æ”¯æŒ ä¸´é”®é” è¡Œé”+é—´éš™é”ï¼ˆè¯¥è¡Œä¹‹å‰çš„é—´éš™ï¼‰â€”â€”RRä¸‹æ”¯æŒ è¡Œé”ç±»å‹ SQL è¡Œé”ç±»å‹ è¯´æ˜ å¢åˆ æ”¹ æ’ä»–é” è‡ªåŠ¨åŠ  SELECTè¯­å¥ æ— é” SELECTåŠ å…±äº«é” å…±äº«é”S æ‰‹åŠ¨ SELECTâ€¦FOR UPDATE æ’ä»–é”X æ‰‹åŠ¨ è¡Œé” InnoDBä½¿ç”¨next-keyï¼ˆä¸´é”®é”ï¼‰è¿›è¡Œæœç´¢ä¸ç´¢å¼•æ‰«æ ä»¥é˜²æ­¢å¹»è¯»\né’ˆå¯¹å”¯ä¸€ç´¢å¼•æ£€ç´¢æ—¶ å¯¹å­˜åœ¨çš„è®°å½•è¿›è¡Œç­‰å€¼åŒ¹é…ï¼ˆé€šè¿‡ â€œ=â€ æ£€ç´¢ï¼‰æ—¶ä¼šè‡ªåŠ¨å°†next-keyé”ä¼˜åŒ–ä¸ºè¡Œé” InnoDBä¸­ä¸é€šè¿‡ç´¢å¼•æ£€ç´¢æ•°æ®ä¼šå‡çº§ä¸ºè¡¨é” é—´éš™é”\u0026amp;ä¸´é”®é” ç†è§£ å”¯ä¸€ç´¢å¼•çš„ç­‰å€¼æŸ¥è¯¢ ç»™ä¸å­˜åœ¨çš„è®°å½•åŠ é”æ—¶ ä¼˜åŒ–ä¸ºé—´éš™é” æ™®é€šç´¢å¼•çš„ç­‰å€¼æŸ¥è¯¢ å‘å³éå†åˆ°æœ€åä¸€ä¸ªå€¼ä¸æ»¡è¶³æŸ¥è¯¢éœ€æ±‚æ—¶ ä¸´é”®é”é€€åŒ–ä¸ºé—´éš™é” å”¯ä¸€ç´¢å¼•çš„èŒƒå›´æŸ¥è¯¢ è®¿é—®åˆ°ä¸æ»¡è¶³æ¡ä»¶çš„ç¬¬ä¸€ä¸ªå€¼ä¸ºæ­¢ï¼ˆåŠ é”ï¼‰ é—´éš™é”å¯ä»¥å…±å­˜ï¼ˆåªä¸ºé˜²æ­¢å…¶å®ƒäº‹åŠ¡æ’å…¥é—´éš™soï¼‰ InnoDBå¼•æ“ ç†è§£ æ•´ä½“æ¶æ„ å†…å­˜æ¶æ„ ç›´æ¥æ“ä½œ\nç¼“å†²æ±  Buffer Pool Change Buffer å¯¹éå”¯ä¸€çš„äºŒçº§ç´¢å¼•è¿›è¡Œä¿®æ”¹ æ“ä½œå­˜å‚¨åœ¨æ­¤ï¼ˆå…ˆåˆ°ç¼“å†²æ±  ååˆ°ç£ç›˜ï¼‰ Adaptive Hash Index ä¼˜åŒ–å¯¹ç¼“å†²æ± æ•°æ®çš„æŸ¥è¯¢(è‡ªåŠ¨ç”Ÿæˆ) ç”¨SHOW VARIABLES LIKE '%HASH_INDEX%';æŸ¥çœ‹å…¶æ˜¯å¦å¯ç”¨ï¼ˆæ¨¡ç³ŠåŒ¹é…ï¼‰ Log Buffer æ—¥å¿—ç¼“å†²åŒº ä¿å­˜è¦å†™å…¥ç£ç›˜çš„log INNODB_LOG_BUFFER_SIZEæŸ¥çœ‹å¤§å° INNODB_FLUSH_LOG_AT_TRX_COMMITåˆ·æ–°åˆ°ç£ç›˜çš„æ—¶æœºï¼ˆå¯è®¾ç½®0 1 2 å…·ä½“å«ä¹‰ç•¥ï¼‰ ç£ç›˜ç»“æ„ System Tablespacesç³»ç»Ÿè¡¨ç©ºé—´ ä¸»è¦å­˜æ”¾Change Buffer %DATA_FILE_PATH%æ¨¡ç³ŠåŒ¹é… General Tablespacesé€šç”¨è¡¨ç©ºé—´ éœ€åœ¨åˆ›å»ºè¡¨æ—¶æŒ‡å®š CREATE TABLESPACEåˆ›å»ºè¯¥è¡¨ç©ºé—´ Undo Tablespacesæ’¤é”€è¡¨ç©ºé—´ è‡ªåŠ¨åˆ›å»ºä¸¤ä¸ª Temporary Tablespacesä¸´æ—¶è¡¨ç©ºé—´ DoubleWrite Buffer FilesåŒå†™ç¼“å†²åŒºï¼ˆç¼“å†²æ± åˆ·æ–°åˆ°ç£ç›˜å‰å…ˆå†™å…¥æ­¤ï¼‰ Redo Logé‡åšæ—¥å¿— å®ç°äº‹åŠ¡æŒä¹…æ€§ï¼ˆåŒ…æ‹¬é‡åšæ—¥å¿—ç¼“å†² å‚¨å­˜åœ¨å†…å­˜ä¸­ï¼‰ åå°çº¿ç¨‹ å°†ç¼“å†²åŒºæ•°æ®åˆ·æ–°åˆ°ç£ç›˜ä¸­\nMaster Threadæ ¸å¿ƒåå°çº¿ç¨‹ è°ƒåº¦å…¶ä»–çº¿ç¨‹ IO Thread è´Ÿè´£IOè¯·æ±‚çš„å›è°ƒ Purge Thread å›æ”¶äº‹åŠ¡å·²æäº¤çš„undo log Page Cleaner Threadå‡è½»ä¸»çº¿ç¨‹åˆ·æ–°è„é¡µçš„å‹åŠ› äº‹åŠ¡åŸç† redo log åˆ·æ–°è„é¡µåˆ°ç£ç›˜å‘ç”Ÿé”™è¯¯æ—¶è¿›è¡Œæ•°æ®æ¢å¤ï¼ˆç‰©ç†æ—¥å¿—ï¼‰ undo log å›æ»šæ—¥å¿—ï¼ˆé€»è¾‘æ—¥å¿—ï¼‰ è®°å½•æ•°æ®è¢«ä¿®æ”¹å‰çš„ä¿¡æ¯ MVCCéœ€è¦ MVCCâ­ å¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶ Multi-Version Concurrency Control\nåŸºæœ¬æ¦‚å¿µ å½“å‰è¯» è¯»å–è®°å½•æ•°æ®çš„æœ€æ–°ç‰ˆæœ¬å¹¶å¯¹è®°å½•åŠ é” å…±äº«é”/æ’ä»–é”/å¢åˆ æ”¹ å¿«ç…§è¯» è¯»å–è®°å½•æ•°æ®çš„å¯è§ï¼ˆå†å²ï¼‰ç‰ˆæœ¬ ä¸åŠ é” RCéš”æ–­ä¸‹ æ¯æ¬¡selectç”Ÿæˆä¸€ä¸ªå¿«ç…§è¯» RR å¼€å¯äº‹åŠ¡åç¬¬ä¸€ä¸ªselectæ‰æ˜¯å¿«ç…§è¯» S å¿«ç…§è¯»é€€åŒ–ä¸ºå½“å‰è¯» MVCC ç»´æŠ¤ä¸€ä¸ªæ•°æ®çš„å¤šä¸ªç‰ˆæœ¬ ä½¿è¯»å†™æ“ä½œæ²¡æœ‰å†²çª å¿«ç…§è¯»ä¸ºå…¶æä¾›éé˜»å¡è¯»åŠŸèƒ½ ä¾èµ–äºï¼š æ•°æ®åº“è®°å½•ä¸­çš„ä¸‰ä¸ªéšå¼å­—æ®µ undo log readView å®ç°åŸç† ä¸‰ä¸ªéšå¼å­—æ®µ ï¼ˆInnoDBéšå¼ç”Ÿæˆï¼‰\néšè—å­—æ®µ å«ä¹‰ DB_TRX-ID æœ€è¿‘ä¿®æ”¹äº‹åŠ¡ID DB_ROLL_PTR å›æ»šæŒ‡é’ˆ æŒ‡å‘è¿™æ¡è®°å½•çš„ä¸Šä¸ªç‰ˆæœ¬ é…åˆundo log DB_ROW_ID éšè—ä¸»é”® è‹¥æ— æŒ‡å®šä¸»é”®åˆ™ç”Ÿæˆæ­¤å­—æ®µ undo logæ—¥å¿—ï¼ˆå¢åˆ æ”¹æ—¶äº§ç”Ÿä¾¿äºæ•°æ®å›æ»šçš„æ—¥å¿—ï¼‰\ninsert åªåœ¨å›æ»šæ—¶éœ€è¦log äº‹åŠ¡æäº¤åå¯è¢«åˆ é™¤ åˆ æ”¹ åœ¨å›æ»šä¸å¿«ç…§è¯»æ—¶éœ€è¦ï¼ˆä¸ä¼šè¢«ç«‹å³åˆ é™¤ï¼‰ ç”Ÿæˆundo logç‰ˆæœ¬é“¾ å¤´éƒ¨æ˜¯æœ€æ–°çš„å†å²è®°å½• å°¾éƒ¨æ˜¯æœ€æ—§çš„å†å²è®°å½• ReadView è®°å½•å¹¶ç»´æŠ¤ç³»ç»Ÿå½“å‰æ´»è·ƒï¼ˆæœªæäº¤ï¼‰çš„äº‹åŠ¡idï¼ˆMVCCæå–æ•°æ®çš„ä¾æ®ï¼‰\nå››ä¸ªæ ¸å¿ƒå­—æ®µ å­—æ®µ å«ä¹‰ m_ids å½“å‰æ´»è·ƒäº‹åŠ¡IDé›†åˆ min_trx_id æœ€å°æ´»è·ƒäº‹åŠ¡ID max_trx_id é¢„åˆ†é…äº‹åŠ¡IDï¼ˆå½“å‰æœ€å¤§äº‹åŠ¡ID+1 è‡ªå¢ï¼‰ creator_trx_id ReadViewåˆ›å»ºè€…çš„äº‹åŠ¡ID ç‰ˆæœ¬é“¾æ•°æ®è®¿é—®è§„åˆ™ï¼ˆå½“å‰äº‹åŠ¡IDä¸ºtrx_id å³DB_TRX_IDï¼‰ç†è§£ åªå¯ç¬¦åˆä¸‹åˆ—å››ä¸ªæ¡ä»¶ è‹¥éƒ½ä¸ç¬¦åˆ åˆ™æ¢ä¸‹ä¸€æ¡undo log trx_id==creator_trx_id âœ” è¯´æ˜æ•°æ®ç”±å½“å‰äº‹åŠ¡æ›´æ”¹ trx_id\u0026lt;min_trx_id âœ” è¯´æ˜æ•°æ®å·²æäº¤ trx_id\u0026gt;max_trx_id âœ– äº‹åŠ¡åœ¨RVç”Ÿæˆåæ‰å¼€å§‹ min_trx_id\u0026lt;=trx_id\u0026lt;=max_trx_id ä¸”trx_idä¸åœ¨m_idsä¸­ âœ” è¯´æ˜æ•°æ®å·²æäº¤ RCéš”ç¦»çº§åˆ« äº‹åŠ¡ä¸­æ¯æ¬¡æ‰§è¡Œå¿«ç…§è¯»æ—¶ç”ŸæˆReadView RRéš”ç¦»çº§åˆ« äº‹åŠ¡ä¸­ç¬¬ä¸€æ¬¡æ‰§è¡Œå¿«ç…§è¯»æ—¶ç”Ÿæˆ åå¤ç”¨ MySqlç®¡ç† ç³»ç»Ÿæ•°æ®åº“ è‡ªå¸¦å››ä¸ªæ•°æ®åº“ æ•°æ®åº“ ä½œç”¨ mysql æœåŠ¡å™¨è¿è¡Œéœ€è¦çš„ä¿¡æ¯ï¼ˆæ—¶åŒº ä¸»ä» ç”¨æˆ· æƒé™ç­‰ï¼‰ information_schema è®¿é—®å…ƒæ•°æ®çš„è¡¨ã€è§†å›¾ç­‰ performance_schema åº•å±‚ç›‘æ§æœåŠ¡å™¨è¿è¡ŒçŠ¶æ€ æ”¶é›†å…¶æ€§èƒ½å‚æ•° sys æ–¹ä¾¿DBA ä¾¿äºæ€§èƒ½è°ƒä¼˜ä¸è¯Šæ–­çš„è§†å›¾ å¸¸ç”¨å·¥å…· MySQL æ•°æ®åº“å -e \u0026quot;æ‰§è¡Œè¯­å¥\u0026quot; -eæ‰§è¡Œsqlè¯­å¥å¹¶é€€å‡º é€‚ç”¨äºshellè„šæœ¬ mysqladmin -uroot -p****** â€¦ æŸ¥çœ‹å¸®åŠ©æ–‡æ¡£å¹¶è¿›è¡Œç›¸å…³æ“ä½œ mysqlbinlog log1 æŸ¥çœ‹äºŒè¿›åˆ¶æ—¥å¿—æ–‡ä»¶ mysqlshow â€¦ æŸ¥æ‰¾æ•°æ®åº“/è¡¨/åˆ—/ç´¢å¼•ç­‰ mysqldump [options] db_nameå¤‡ä»½æ•°æ®åº“ mysqllimportæˆ–source å®¢æˆ·ç«¯æ•°æ®ï¼ˆmysqldumpåŠ -Tå‚æ•°å¯¼å‡ºçš„æ–‡æœ¬æ–‡ä»¶ï¼‰å¯¼å…¥ ğŸ‰ğŸ‰ ","permalink":"https://Sattiluvcat.github.io/en/posts/java/mysql/","summary":"åº•å±‚ç»†èŠ‚","title":"MySql"},{"content":"Â ç®€ä»‹ NoSql éå…³ç³»å‹æ•°æ®åº“ No Structured Relational\nç‰¹ç‚¹ï¼š è¡¨å‹ JSONå‹ å›¾å‹==éç»“æ„åŒ– Redisä¸ºé”®å€¼ç±»å‹ JSONè¡¨==æ•°æ®æ— å…³è” æŸ¥è¯¢æ–¹å¼==éSQLï¼ˆè¯­æ³•ä¸ç»Ÿä¸€ï¼‰ äº‹åŠ¡ACIDæ— æ³•å…¨éƒ¨æ»¡è¶³==BASE å­˜å‚¨==å†…å­˜ ä½¿ç”¨åœºæ™¯ï¼š æ•°æ®ç»“æ„ä¸å›ºå®š å¯¹ä¸€è‡´æ€§ å®‰å…¨æ€§è¦æ±‚ä¸é«˜ æ€§èƒ½è¦æ±‚ Redis ç‰¹å¾ï¼š é”®å€¼å‹ key-value æ”¯æŒå¤šç§æ•°æ®ç»“æ„ å•çº¿ç¨‹ å‘½ä»¤å…·åŸå­æ€§ ä½å»¶è¿Ÿ å†…å­˜ IOå¤šè·¯å¤ç”¨ ç¼–ç é£æ ¼ æ”¯æŒæ•°æ®æŒä¹…åŒ– æ”¯æŒä¸»ä»é›†ç¾¤ åˆ†ç‰‡é›†ç¾¤ï¼ˆä¸»è¡¨\u0026amp;ä»è¡¨ï¼‰ å¤šè¯­è¨€å®¢æˆ·ç«¯ redis-cli -h 192.168.211.129 -p 6379 -a å¯†ç \nå¯åŠ¨ï¼ˆä¸å®‰å…¨ï¼‰ systemctl stop rediså…³é—­ è¿æ¥è™šæ‹Ÿæœºä¸å›¾å½¢åŒ–ç•Œé¢å¤±è´¥=æ£€æŸ¥é˜²ç«å¢™\nåŸºæœ¬è¯­æ³• ä¸åŒºåˆ†å¤§å°å†™\næ•°æ®ç»“æ„ valueç±»å‹ åŸºæœ¬ç±»å‹ï¼šString Hash Listï¼ˆå¯é‡å¤ï¼‰ Set SortedSetï¼ˆæ’åºé›†åˆ ä¸å¯é‡å¤ï¼‰ ç‰¹æ®Šç±»å‹ï¼šGEOï¼ˆåœ°ç†åæ ‡ï¼‰ BitMap HyperLog å¸®åŠ©æ–‡æ¡£ or å‘½ä»¤è¡Œ help\né€šç”¨å‘½ä»¤ ç”¨help å‘½ä»¤åæŸ¥çœ‹å‘½ä»¤çš„å…·ä½“ä½¿ç”¨æ–¹æ³•\nKEYSæŸ¥çœ‹ç¬¦åˆæ¨¡æ¿patternå¦‚a**çš„æ‰€æœ‰keyï¼ˆä»¥aå¼€å¤´çš„keyï¼‰ æ…¢ DELåˆ key ä¼šè¿”å›åˆ é™¤çš„ä¸ªæ•° EXISTSåˆ¤æ–­æ˜¯å¦å­˜åœ¨ EXPIREè®¾ç½®keyçš„æœ‰æ•ˆæœŸ TTLæŸ¥çœ‹keyçš„å‰©ä½™æœ‰æ•ˆæœŸ ç±»å‹\u0026amp;å‘½ä»¤ String åˆ†ç±» ç±»å‹ æ•°æ®ç»“æ„ string å­—ç¬¦ä¸² int æ•´å‹ float æµ®ç‚¹æ•° å¸¸è§å‘½ä»¤ å‘½ä»¤ ä½œç”¨ SET æ·»åŠ /ä¿®æ”¹é”®å€¼å¯¹ GET ç”±keyå¾—value MSET/MGET æ‰¹é‡æ“ä½œ INCR æ•´å‹keyè‡ªå¢1 INCRBY æ•´å‹è‡ªå¢æŒ‡å®šæ­¥é•¿ INCRBYFLOAT æµ®ç‚¹ç±»å‹è‡ªå¢æŒ‡å®šæ­¥é•¿ SETNX æ·»åŠ Stringé”®å€¼å¯¹ å‰ækeyä¸å­˜åœ¨ SETEX æ·»åŠ Stringé”®å€¼å¯¹ æŒ‡å®šæœ‰æ•ˆæœŸ SETNX==SET key value NX\nè¿”å›0è¡¨ç¤ºé”®å€¼å·²å­˜åœ¨ä¸ä¼šæ·»åŠ \nè¿”å›1è¡¨ç¤ºä¸å­˜åœ¨å·²æ·»åŠ  å±‚çº§ç»“æ„ keyçš„å±‚çº§ç»“æ„ï¼šç”¨:éš”å¼€\nè‹¥å€¼ä¸ºJavaå¯¹è±¡ å¯ç”¨JSONå½¢å¼å­˜å‚¨ï¼š eg.'{\u0026quot;id\u0026quot;:1, \u0026quot;name\u0026quot;:\u0026quot;Satti\u0026quot;, \u0026quot;age\u0026quot;:20}'å•å¼• Hashç±»å‹ æ— åºå­—å…¸ ç±»HashMap CRUD å¢åˆ æ”¹æŸ¥\nç›¸å¯¹Stringç±»å‹çš„JSONå­—ç¬¦ä¸² å¯ä»¥å°†æ¯ä¸ªå­—æ®µç‹¬ç«‹å­˜å‚¨ KEYä¿å­˜é”®å VALUEä¸­fieldä¿å­˜å­—æ®µå valueä¿å­˜å€¼ å¸¸è§å‘½ä»¤ å‘½ä»¤ ä½œç”¨ HSET æ·»åŠ /ä¿®æ”¹hashç±»å‹ä¸€å¯¹field\u0026amp;value HGET hashç±»å‹ç”±keyå¾—filed HMSET/HMGET å¯¹ä¸€ä¸ªkeyæ‰¹é‡æ“ä½œ HGETALL ç”±keyå¾—æ‰€æœ‰field value HKEYS keyä¸­æ‰€æœ‰field HVALS keyä¸­æ‰€æœ‰value HINCRBY å­—æ®µå€¼æŒ‰æŒ‡å®šæ­¥é•¿è‡ªå¢ HSETNX æ·»åŠ field å‰æfieldä¸å­˜åœ¨ Listç±»å‹ ç±»ä¼¼LinkedList ä½†åŒå‘é“¾è¡¨\nç‰¹å¾ï¼šæœ‰åº å¯é‡å¤ æ’å…¥åˆ é™¤å¿« æŸ¥è¯¢é€Ÿåº¦ä¸€èˆ¬ å¸¸è§å‘½ä»¤ å‘½ä»¤ ä½œç”¨ LPUSH/RPUSH åˆ—è¡¨å·¦/å³ä¾§æ’å…¥ LPOP/RPOP ç§»é™¤å·¦/å³ä¾§ç¬¬ä¸€ä¸ª LRANGE è¿”å›ä¸€æ®µè§’æ ‡èŒƒå›´å†…çš„æ‰€æœ‰å…ƒç´  BLPOP/BRPOP æ²¡æœ‰å…ƒç´ æ—¶ç­‰å¾…æŒ‡å®šçš„æ—¶é—´ ç§»é™¤æ—¶æ— å…ƒç´  è¿”å›nil è§’æ ‡ = åºå· ä»0å¼€å§‹ Setç±»å‹ ç±»HashSet =\u0026gt; valueä¸ºnullçš„HashMap\nç‰¹å¾ï¼š æ— åº ä¸å¯é‡å¤ æŸ¥æ‰¾å¿« æ”¯æŒäº¤å¹¶å·®é›† å¸¸è§å‘½ä»¤ï¼š å‘½ä»¤ ä½œç”¨ SADD å‘setæ·»åŠ å…ƒç´  å¯å¤šä¸ª SREM ç§»é™¤æŒ‡å®šå…ƒç´  SCARD è¿”å›å…ƒç´ ä¸ªæ•° SISMEMBER æ˜¯å¦æœ‰æŸå…ƒç´  SMEMBERS è¿”å›æ‰€æœ‰value å‘½ä»¤ ä½œç”¨ SINTER æ±‚ä¸¤é”®äº¤é›† SDIFF key1ç›¸å¯¹äºkey2ä¸åŒçš„å€¼ï¼ˆå·®é›†ï¼‰ SUNION å¹¶é›† SDIFFä¸­keyæœ‰å…ˆåé¡ºåº SortedSet ç±»TreeSetï¼ˆå¯æ’åºçš„setï¼‰ æ•°æ®ç»“æ„ä¸åŒ\næ¯ä¸ªå…ƒç´ å…·æœ‰scoreå±æ€§ é€šè¿‡å±æ€§æ’åº=SkipList+Hash ç‰¹æ€§ï¼š å¯æ’åº å…ƒç´ ä¸é‡å¤ æŸ¥è¯¢é€Ÿåº¦å¿« å¸¸è§å‘½ä»¤ï¼šZADD ZREM ZCARD ZINCRBY ZDIFF ZINTER ZUNION addæ—¶æç¤ºNX|XX NX-ä¸å­˜åœ¨æ—¶æ‰æ’å…¥è¯¥é”® XX-å­˜åœ¨æ—¶æ‰æ’å…¥è¯¥é”® å‘½ä»¤ ä½œç”¨ ZSORE è·å–æŒ‡å®šå…ƒç´ score ZRANK è·å–æŒ‡å®šå…ƒç´ æ’å ZCOUNT scoreåœ¨æŸèŒƒå›´å†…çš„å…ƒç´ ä¸ªæ•° ZRANGE æŒ‰scoreæ’åºå¾—æŒ‡å®šæ’åèŒƒå›´å†…å…ƒç´  ZRANGEBYSCORE æŒ‡å®šscoreèŒƒå›´å†… é»˜è®¤å‡åºæ’åº ZååŠ REVå³ä¸ºé™åº Jedis å¼€å¯æµ‹è¯•åé€šè¿‡newå¯¹è±¡å»ºç«‹è¿æ¥\njedis=new Jedis(ip,port);\nè®¾ç½®å¯†ç \njedis.auth(password)\né€‰æ‹©åº“\njedis.select(index) SpringDataRedis RedisTemplateå·¥å…·ç±» redisTemplate.opsForValue()ç±»ä¼¼è¯­å¥è°ƒç”¨ä¸Šè¿°æ•°æ®ç±»å‹\nè¿”å›å€¼ç±»å‹å¦‚ValueOperations æ­¥éª¤ï¼š å¼•å…¥spring-boot-starter-data-redisä¾èµ– application.yamlé…ç½®Redis ç¼–å†™RedisTemplateé…ç½®ç±» è®¾ç½®@Bean testä¸­Autowiredæ³¨å…¥RedisTemplate\u0026amp;è¿›è¡ŒTestè¯•éªŒ å‡½æ•°opsForValue()ç­‰è°ƒç”¨valueç­‰å¯¹è±¡ï¼ˆæ–¹æ³•åæœ‰å˜åŠ¨ï¼‰ StringRedisTemplateæ‰‹åŠ¨åºåˆ—åŒ–\u0026amp;ååºåˆ—åŒ– èŠ‚çœå†…å­˜ å¯ä»¥jsonå½¢å¼å­˜å‚¨ã€è¯»å–æ•°æ® or ç¼–ç ä¸ºå­—ç¬¦ä¸²ç±»å‹ ä½¿ç”¨å‡½æ•°StringRedisSerializer ä»¥å¯¹è±¡å½¢å¼åˆå§‹åŒ–ã€æ¥æ”¶ æ•…éœ€è¦æ‰‹åŠ¨è¿›è¡Œåºåˆ—åŒ–è½¬æ¢ ","permalink":"https://Sattiluvcat.github.io/en/posts/java/redis%E7%9A%84%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%E7%AC%94%E8%AE%B0/","summary":"æ•°æ®ç±»å‹ä¸åŸºç¡€æ“ä½œ","title":"Redis_base"},{"content":"Â åŸºæœ¬æ¦‚å¿µ RDBMS å…³ç³»å‹æ•°æ®åº“ based onå…³ç³»æ¨¡å‹ï¼Œå¤šå¼ äºŒç»´è¡¨ç›¸äº’è¿æ¥ sqlæ“ä½œåˆ†ç±» åˆ†ç±» å…¨ç§° è¯´æ˜ DDL Data Definition Language å®šä¹‰æ•°æ®åº“ã€è¡¨ã€å­—æ®µç­‰ DML Manipulation å¯¹è¡¨ä¸­æ•°æ®è¿›è¡Œå¢åˆ æ”¹ DQL Query æŸ¥è¯¢è¡¨çš„è®°å½• DCL Control åˆ›å»ºåº“ç”¨æˆ· æ§åˆ¶æƒé™ å¯åŠ¨ä¸åœæ­¢ net start mysql80 \u0026amp; net stop mysql80\nMySql å¼€æœºè‡ªå¯ï¼Œåœ¨cmdä¸­å¯æ‰‹åŠ¨åœæ­¢ mysql -u root -p\n-u æç¤ºç”¨æˆ·ä¸º rootï¼Œ-p æç¤ºå°†è¾“å…¥å¯†ç  SQL åŸºæœ¬ ä»¥åˆ†å·ç»“å°¾ï¼Œè¡Œæ•°ä¸è®ºï¼Œç©ºæ ¼ä¸ç¼©è¿›ä¸è®º ä¸åŒºåˆ†å¤§å°å†™ï¼Œå…³é”®å­—æœ€å¥½å¤§å†™ \u0026ndash; æˆ– # æ³¨é‡Šå†…å®¹ å¤šè¡Œæ³¨é‡Š /* å†…å®¹ */ DDL DDLæ•°æ®åº“æ“ä½œ SHOW DATABASES;\næŸ¥è¯¢æ‰€æœ‰æ•°æ®åº“ SELECT DATABASE();\næŸ¥è¯¢å½“å‰ï¼ˆæ˜¯åœ¨å“ªä¸ªï¼‰æ•°æ®åº“ åˆ›å»ºæ•°æ®åº“ï¼ˆæ‹¬å·å†…å®¹å¯ä»¥ä¸åŠ  é‡‡ç”¨é»˜è®¤è§„åˆ™ï¼‰ CREATE DATABASE [IF NOT EXISTS] æ•°æ®åº“å [DEFAULT CHARSET å­—ç¬¦é›†] [COLLATE æ’åºè§„åˆ™]; charset utf8mb4 è®¾å®šä¸ºå®¹çº³4ä¸ªå­—èŠ‚çš„utf8 åœ¨DataGripä¸­å¯ä»¥ä½¿ç”¨SCHEMAæ›¿ä»£DATABASE DROP DATABASE [IF EXISTS] æ•°æ®åº“å;\nåˆ é™¤æ•°æ®åº“ USE æ•°æ®åº“å;\nä½¿ç”¨æ•°æ®åº“ DDLè¡¨æ“ä½œ æŸ¥è¯¢ SHOW TABLES;\næŸ¥è¯¢å½“å‰æ•°æ®åº“æ‰€æœ‰è¡¨ DESC è¡¨å æŸ¥è¯¢è¡¨ç»“æ„ SHOW CREATE TABLE è¡¨å æŸ¥è¯¢æŒ‡å®šè¡¨çš„å»ºè¡¨è¯­å¥ åˆ›å»º CREATE TABLE è¡¨å( å­—æ®µ1 å­—æ®µ1ç±»å‹[COMMENT 'ä¸­æ–‡'], å­—æ®µ2 å­—æ®µ2ç±»å‹[COMMENT 'â€¦â€¦'], â€¦â€¦ å­—æ®µ3 å­—æ®µ3ç±»å‹[COMMENT 'â€¦â€¦'] )[COMMENT 'â€¦â€¦']; å­—æ®µ1 æ˜¯è¡¨å¤´åç§°ï¼Œå¦‚name å­—æ®µ1ç±»å‹ï¼š æ•°å€¼ç±»å‹ tinyint,smallint,mediumint,int-4å­—èŠ‚,bigint,float,double tinyint unsignedè¡¨ç¤ºæ— ç¬¦å· å³æ­£æ•°èŒƒå›´ å¯æŒ‡å®šdouble(m,n)ï¼Œmè¡¨ç¤ºæœ€é•¿ä½æ•°ï¼Œnè¡¨ç¤ºå°æ•°ç‚¹åæœ€é•¿ä½æ•° å­—ç¬¦ä¸² char(æŒ‡å®šé•¿åº¦),varchar(æŒ‡å®šé•¿åº¦), charä¸ºå®šé•¿å­—ç¬¦ä¸²ï¼Œvarcharå˜é•¿(ä¼šè®¡ç®—æ‰€éœ€ç©ºé—´æ˜¯å¦éœ€è¦å˜åŒ–) æ—¥æœŸ date,time,datetime,year,timestamp(æˆªè‡³2038å¹´) ä¿®æ”¹ ALTER TABLE è¡¨å ADD å­—æ®µå å­—æ®µç±»å‹ [COMMENT æ³¨é‡Š] [çº¦æŸ]; å¢åŠ å­—æ®µ ALTER TABLE è¡¨å MODIFY å­—æ®µå æ–°å­—æ®µç±»å‹ [COMMENT æ³¨é‡Š]; ä¿®æ”¹å­—æ®µç±»å‹ ALTER TABLE è¡¨å CHANGE æ—§å­—æ®µå æ–°å­—æ®µå æ–°å­—æ®µç±»å‹ [COMMENT æ³¨é‡Š]; ä¿®æ”¹å­—æ®µå\u0026amp;å­—æ®µç±»å‹ ALTER TABLE è¡¨å RENAME TO æ–°è¡¨å ä¿®æ”¹è¡¨å åˆ é™¤ ALTER TABLE è¡¨å DROP å­—æ®µå; åˆ é™¤å­—æ®µ DROP TABLE [IF EXISTS] è¡¨å; åˆ é™¤è¡¨ TRUNCATE TABLE è¡¨å; åˆ é™¤å¹¶é‡æ–°åˆ›å»ºè¯¥è¡¨ DataGripä¸­å­—æ®µç¿»è¯‘ä¸ºåˆ—\nDML æ·»åŠ æ•°æ® INSERT INTO è¡¨å(å­—æ®µå1,å­—æ®µå2,â€¦) VALUES (å€¼1,å€¼2,â€¦); æŒ‡å®šå­—æ®µæ·»åŠ æ•°æ® INSERT INTO è¡¨å VALUES (å€¼1,å€¼2,â€¦); å…¨éƒ¨å­—æ®µæ·»åŠ æ•°æ® æ­¤å¤„æ‹¬å·ä¸ºåˆ†éš”ç¬¦å·ï¼Œä¸å¯çœç•¥ï¼Œ[]è¡¨ç¤ºå¯ä»¥å¿½ç•¥ Sql ä»¥æŸæ•°æ®åº“ä¸ºåŸç‚¹ï¼Œè‹¥éœ€ä¿®æ”¹æŸè¡¨ï¼Œåœ¨æŒ‡ä»¤ä¸­éœ€æŒ‡æ˜è¯¥è¡¨å å­—ç¬¦ä¸²ä¸æ—¶é—´ç±»å‹ç”¨ 'â€¦' è¡¨ç¤º ä¿®æ”¹åˆ é™¤ UPDATE è¡¨å SET å­—æ®µå1=å€¼1,å­—æ®µå2=å€¼2,â€¦[WHERE æ¡ä»¶]; æ¡ä»¶å¯ä»¥å†™ä¸º id=1 ç­‰ DELETE FROM è¡¨å [WHERE æ¡ä»¶] ä¸èƒ½åˆ é™¤æŸä¸ªå¯¹è±¡ä¸­ç‰¹å®šå­—æ®µçš„å€¼ï¼ˆåªèƒ½åˆ é™¤è¡Œï¼‰ æ²¡æœ‰è¢«ç‰©ç†åˆ é™¤ è¢«æ ‡è®°ä¸ºåˆ é™¤ä½¿å…¶ç©ºé—´å¯è¢«â™» DQL ç”¨*è¡¨ç¤ºæ˜¾ç¤ºæ‰€æœ‰ä¿¡æ¯ï¼Œæ”¾åœ¨å…¶å®ƒç‰¹æ®Šæ£€ç´¢å†…å®¹å‰\nåŸºæœ¬æŸ¥è¯¢ SELECT å­—æ®µ1ï¼Œå­—æ®µ2ï¼Œâ€¦ FROM è¡¨å; SELECT * FROM è¡¨å æŸ¥è¯¢å¤šä¸ªå­—æ®µ SELECT å­—æ®µ1 [AS åˆ«å1],å­—æ®µ2 [AS åˆ«å2],â€¦ FROM è¡¨å; è®¾ç½®åˆ«å(æ˜¾ç¤ºåœ¨æœç´¢ç»“æœçš„è¡¨å¤´) SELECT DISTINCT å­—æ®µåˆ—è¡¨ FROM è¡¨å; æ˜¾ç¤ºæŸ¥è¯¢åˆ°çš„éé‡å¤ç»“æœ æ¡ä»¶æŸ¥è¯¢ SELECT å­—æ®µåˆ—è¡¨ FROM è¡¨å WHERE æ¡ä»¶åˆ—è¡¨ æ¡ä»¶ç±»å‹ï¼š æ¯”è¾ƒè¿ç®— \u0026gt;,\u0026lt;,\u0026gt;=,\u0026lt;=,\u0026lt;\u0026gt;æˆ–!=è¡¨ç¤ºä¸ç­‰äº æ‰€æœ‰æ•°æ®ç±»å‹é€‚ç”¨ï¼ˆåŒ…æ‹¬æ—¥æœŸï¼‰ BETWEEN â€¦ AND â€¦ å«æœ€å¤§æœ€å°å€¼çš„èŒƒå›´ å‰å°åå¤§ æ•°æ®æœ‰å…ˆåé¡ºåº IN(â€¦) åˆ—è¡¨ä¸­çš„å€¼ LIKE å ä½ç¬¦ æ¨¡ç³ŠåŒ¹é… _è¡¨ç¤ºå•å­—ç¬¦ %è¡¨ç¤ºä»»æ„ä¸ªå­—ç¬¦ IS NULL æˆ– IS NOT NULL é€»è¾‘è¿ç®— AND æˆ– \u0026amp;\u0026amp; OR æˆ– || NOT æˆ– ! èšåˆå‡½æ•°\u0026amp;åˆ†ç»„æŸ¥è¯¢ SELECT èšåˆå‡½æ•°(å­—æ®µåˆ—è¡¨) FROM è¡¨å;\nå¸¸è§èšåˆå‡½æ•°ï¼š å‡½æ•° åŠŸèƒ½ count ç»Ÿè®¡æ•°é‡ max æœ€å¤§ min æœ€å° avg å¹³å‡ sum æ±‚å’Œ SELECT å­—æ®µåˆ—è¡¨ FROM è¡¨å [WHERE æ¡ä»¶] GROUP BY åˆ†ç»„å­—æ®µå [HAVING åˆ†ç»„åè¿‡æ»¤æ¡ä»¶];\nâ€œå­—æ®µåˆ—è¡¨â€å¯ä»¥å†™èšåˆå‡½æ•°\u0026amp;æœç´¢çš„å­—æ®µåï¼ˆå¯æ˜¾ç¤ºè¡¨å¤´ï¼‰ æ‰§è¡Œé¡ºåºï¼šWHERE\u0026gt;èšåˆå‡½æ•°\u0026gt;HAVING èšåˆå‡½æ•°(æŸ) åˆ«å èµ·åˆ«åæ–¹æ³• èšåˆå‡½æ•°å¤šåŠå¯ä»¥ç›´æ¥å†™ä¸º SUM(\\*) æ’åºæŸ¥è¯¢ SELECT å­—æ®µåˆ—è¡¨ FROM è¡¨å ORDER BY å­—æ®µ1 æ’åºæ–¹å¼1,å­—æ®µ2 æ’åºæ–¹å¼2;\næ’åºæ–¹å¼ï¼š ASC å‡åº(é»˜è®¤) DESC é™åº å­—æ®µ1ï¼Œå­—æ®µ2æœ‰å…ˆåé¡ºåº åˆ†é¡µæŸ¥è¯¢ SELECT å­—æ®µåˆ—è¡¨ FROM è¡¨å LIMIT èµ·å§‹ç´¢å¼•,æŸ¥è¯¢è®°å½•æ•°;\nèµ·å§‹ç´¢å¼•ä»0å¼€å§‹ï¼Œä¸ºæŸ¥è¯¢é¡µçš„èµ·å§‹id\nç¬¬ä¸€é¡µå¯ä»¥å†™ä¸º LIMIT æŸ¥è¯¢è®°å½•æ•° é¡ºåº ç¼–å†™é¡ºåºï¼š SELECT$\\rightarrow$FROM$\\rightarrow$WHERE$\\rightarrow$GROUP BY$\\rightarrow$HAVING$\\rightarrow$ORDER BY$\\rightarrow$LIMIT DCL ç®¡ç†ç”¨æˆ· USE mysql SELECT * FROM user æŸ¥è¯¢ç”¨æˆ· CREATE USER 'ç”¨æˆ·å'@'ä¸»æœºå' IDENTIFIED BY 'å¯†ç '; åˆ›å»ºç”¨æˆ· ä¸»æœºåä¸º % è¡¨ç¤ºå¯åœ¨ä»»æ„ä¸»æœºè®¿é—® ALTER USER 'ç”¨æˆ·å'@'ä¸»æœºå' IDENTIFIED WITH mysql_native_password BY 'æ–°å¯†ç '; ä¿®æ”¹å¯†ç  DROP USER 'ç”¨æˆ·å'@'ä¸»æœºå'; åˆ é™¤ç”¨æˆ· æƒé™æ§åˆ¶ å¸¸ç”¨æƒé™ç±»å‹ï¼š æƒé™ è¯´æ˜ ALL(PRIVILEGES) æ‰€æœ‰æƒé™ SELECT æŸ¥è¯¢ INSERT æ’å…¥ UPDATE ä¿®æ”¹ DELETE åˆ é™¤ ALTER ä¿®æ”¹è¡¨ DROP åˆ é™¤åº“/è¡¨/è§†å›¾ CREATE åˆ›å»ºåº“/è¡¨ SHOW GRANTS FOR 'ç”¨æˆ·å'@'ä¸»æœºå'; æŸ¥è¯¢æƒé™ GRANT æƒé™åˆ—è¡¨ ON æ•°æ®åº“å.è¡¨å TO 'ç”¨æˆ·å'@'ä¸»æœºå'; æˆäºˆæƒé™ æƒé™åˆ—è¡¨å†™ ALL ä½œé€šé… REVOKE æƒé™åˆ—è¡¨ ON æ•°æ®åº“å.è¡¨åFROM 'ç”¨æˆ·å'@'ä¸»æœºå'; æ’¤é”€æƒé™ æ•°æ®åº“ã€è¡¨ç”¨\\*ä½œé€šé… å‡½æ•° ä½¿ç”¨ SELECT å‡½æ•° è¿›è¡Œå‡½æ•°è¯•éªŒ\nå­—ç¬¦ä¸²å‡½æ•° å¸¸ç”¨å‡½æ•°ï¼š\nå‡½æ•° åŠŸèƒ½ CONCAT(S1,S2,â€¦,Sn) æ‹¼æ¥å­—ç¬¦ä¸² LOWER(str) å…¨å°å†™ UPPER(str) å…¨å¤§å†™ LPAD(str,n,pad) padä»å·¦å¡«å……stråˆ°né•¿åº¦ RPAD(str,n,pad) padä»å³å¡«å……stråˆ°né•¿åº¦ TRIM(str) å»å¤´å°¾ç©ºæ ¼ SUBSTRING(str,start,len) è¿”å›strä»startå¤„èµ·çš„lenä¸ªå­—ç¬¦ å­—ç¬¦ä¸²ä»1å¼€å§‹ é0 ä¸»è¦ç»“åˆå‰æ–‡è¯­æ³•è¿›è¡Œåº”ç”¨ æ•°å€¼å‡½æ•° å¸¸è§å‡½æ•°ï¼š\nå‡½æ•° åŠŸèƒ½ CEIL(x) å‘ä¸Šå–æ•´ FLOOR(x) å‘ä¸‹å–æ•´ MOD(x,y) x/yçš„æ¨¡ RAND() 0~1å†…éšæœºæ•° ROUND(x,y) xå››èˆäº”å…¥ yä½å°æ•° æ—¥æœŸå‡½æ•° å¸¸è§å‡½æ•°ï¼š\nå‡½æ•° åŠŸèƒ½ CURDATE() å½“å‰æ—¥æœŸ CURTIME() å½“å‰æ—¶é—´ NOW() å½“å‰æ—¥æœŸä¸æ—¶é—´ YEAR(date) è·å¾—dateçš„å¹´ä»½ MONTH(date) dateçš„æœˆä»½ DAY(date) dateçš„æ—¥ DATE_ADD(date,INTERVAL expr type) dateåŠ ä¸Šæ—¶é—´é—´éš”expråçš„æ—¶é—´ DATEDIFF(date1,date2) date1åˆ°date2çš„å¤©æ•° DATE_ADD ä¸­ expr å¯ä¸ºæ•°å­— typeå¯ä¸º DAY æµç¨‹æ§åˆ¶å‡½æ•° å¸¸ç”¨å‡½æ•°ï¼š\nå‡½æ•° åŠŸèƒ½ IF(v,t,f) vä¸ºtrueè¿”å›t å¦ä¹‹ä¸ºf IFNULL(value1,value2) v1ä¸ä¸ºç©ºåˆ™è¿”å›v1 å¦ä¹‹ä¸ºv2 CASE WHEN [val1] THEN [res1] â€¦ ELSE [default] END v1çœŸåˆ™è¿”å›res1 å¦ä¹‹ä¸ºd CASE [expr] WHEN [val1] THEN [res1] â€¦ ELSE [default] END exprç­‰äºv1è¿”å›res1 å¦ä¹‹ä¸ºd val1å¤„ä¸èƒ½å¹¶åˆ—å¤šä¸ªval ç”¨æ­¤ç±»å‡½æ•°åšç­›é€‰ä¸ç”¨åŠ whereï¼Œæ ¼å¼ä¸ºï¼š==SELECT \\*,(CASE â€¦) AS 'åˆ«å' FROM è¡¨å== çº¦æŸ çº¦æŸæ¦‚è¿° ç›®çš„ï¼šä¿è¯æ•°æ®åº“ä¸­æ•°æ®çš„æ­£ç¡®æœ‰æ•ˆä¸å®Œæ•´\nçº¦æŸåˆ†ç±» çº¦æŸ æè¿° å…³é”®å­— éç©ºçº¦æŸ è¯¥å­—æ®µæ•°æ®ä¸ä¸ºnull NOT NULL å”¯ä¸€çº¦æŸ è¯¥å­—æ®µæ‰€æœ‰æ•°æ®ä¸é‡å¤ UNIQUE ä¸»é”®çº¦æŸ ä¸€è¡Œæ•°æ®çš„å”¯ä¸€æ ‡è¯† éç©ºä¸”å”¯ä¸€ PRIMARY KEY é»˜è®¤çº¦æŸ æœªæŒ‡å®šåˆ™é‡‡ç”¨é»˜è®¤å€¼ DEFAULT æŸ æ£€æŸ¥çº¦æŸ ä¿è¯å­—æ®µæ»¡è¶³æŸæ¡ä»¶ CHECK id int PRIMARY KEY AUTO_INCREMENTä¸»é”®ä¸”è‡ªåŠ¨å¢é•¿(å¤šä¸ªçº¦æŸç”¨ç©ºæ ¼éš”å¼€) ä½œç”¨äºè¡¨ä¸­å­—æ®µ åˆ›å»º/ä¿®æ”¹è¡¨æ—¶æ·»åŠ  ä¸€èˆ¬æŠŠåºå·è®¾ä¸ºä¸»é”® å¤–é”®çº¦æŸ è®©ä¸¤è¡¨æ•°æ®å»ºç«‹è¿æ¥ ä¿è¯æ•°æ®å®Œæ•´ä¸€è‡´\nå…·æœ‰å¤–é”®çš„è¡¨=å­è¡¨ è¢«å…³è”çš„è¡¨=äº²è¡¨\næ ¼å¼ï¼š\nåˆ›å»ºæ—¶æ·»åŠ  [CONSTRAINT] [å¤–é”®å] FOREIGN KEY(å¤–é”®å­—æ®µå) REFERENCES ä¸»è¡¨(ä¸»è¡¨åˆ—å) ä¿®æ”¹æ—¶æ·»åŠ  ALTER TABLE è¡¨å ADD CONSTRAINT å¤–é”®å FOREIGN KEY(å¤–é”®å­—æ®µå) REFERENCES ä¸»è¡¨(ä¸»è¡¨åˆ—å) å¤–é”®åæ˜¯ç»™å¤–é”®è‡ªå®šä¹‰çš„æ–°åå­— æ³¨æ„æ•°æ®ç±»å‹éœ€å®Œå…¨ç›¸åŒ ALTER TABLE è¡¨å DROP FOREIGN KEY å¤–é”®åç§°; åˆ é™¤å¤–é”®\n[ON UPDATE æ¨¡å¼ ON DELETE æ¨¡å¼] åœ¨æ·»åŠ è¯­å¥åæŒ‡å®šåˆ é™¤/æ›´æ–°æ¨¡å¼\næ¨¡å¼ è¯´æ˜ NO ACTION æœ‰å¤–é”®åˆ™ä¸å…è®¸æ›´æ–° RESTRICT åŒä¸Š CASCADE äº²å­è¡¨åŒæ—¶æ›´æ–° SET NULL äº²è¡¨åˆ é™¤ å­è¡¨è®¾null SET DEFAULT å­è¡¨è®¾ä¸ºé»˜è®¤(Innodbä¸æ”¯æŒ) å¤šè¡¨æŸ¥è¯¢ å¤šè¡¨å…³ç³» ä¸€å¯¹å¤šï¼šå»ºç«‹å¤–é”®è¿æ¥ eg.å‘˜å·¥\u0026amp;éƒ¨é—¨ å¤šå¯¹å¤šï¼šå»ºç«‹ç¬¬ä¸‰è¡¨ è‡³å°‘åŒ…å«ä¸¤å¤–é”® åˆ†åˆ«å…³è”ä¸¤æ–¹ä¸»é”® eg.å­¦ç”Ÿ\u0026amp;è¯¾ç¨‹ ä¸€å¯¹ä¸€ï¼šä»»æ„ä¸€æ–¹åŠ å¤–é”® å¹¶è®¾ç½®ä¸ºUNIQUE å¤šç”¨äºå•è¡¨æ‹†åˆ† åŸºç¡€å­—æ®µåœ¨ä¸€è¡¨ è¯¦æƒ…å­—æ®µåœ¨å¦ä¸€è¡¨ UNIQUE åœ¨å®šä¹‰idçš„æ—¶å€™æ·»åŠ  eg.ç”¨æˆ·\u0026amp;ç”¨æˆ·è¯¦æƒ… å¤šè¡¨æŸ¥è¯¢æ¦‚è¿° å¹¶åˆ—å¤šè¡¨æ—¶éœ€è¦æ¶ˆé™¤æ— æ•ˆçš„ç¬›å¡å°”ç§¯æƒ…å†µ(æŒ‡A*B) åˆ†ç±»ï¼š flowchart LR; test((è¿æ¥æŸ¥è¯¢)) test--\u0026gt;å†…è¿æ¥ test--\u0026gt;å¤–è¿æ¥ test--\u0026gt;è‡ªè¿æ¥ å¤šè¡¨æŸ¥è¯¢--\u0026gt;test å¤šè¡¨æŸ¥è¯¢--\u0026gt;å­æŸ¥è¯¢ å¤–è¿æ¥--\u0026gt;å·¦å¤–è¿æ¥ å¤–è¿æ¥--\u0026gt;å³å¤–è¿æ¥ å†…è¿æ¥ è¿”å›A Bè¡¨çš„äº¤é›†\nSELECT å­—æ®µåˆ—è¡¨ FROM è¡¨1,è¡¨2 WHERE æ¡ä»¶ â€¦; éšå¼å†…è¿æ¥ æ¡ä»¶ç±»ä¼¼employee.dept_id=dept\\.id SELECT å­—æ®µåˆ—è¡¨ FROM è¡¨1 [INNER] JOIN è¡¨2 ON è¿æ¥æ¡ä»¶ â€¦; æ˜¾å¼å†…è¿æ¥ å¤–è¿æ¥ SELECT å­—æ®µåˆ—è¡¨ FROM è¡¨1 LEFT [OUTER] JOIN è¡¨2 ON æ¡ä»¶ â€¦; å·¦å¤–è¿æ¥ æŸ¥è¯¢å·¦è¡¨ä¸äº¤é›†éƒ¨åˆ†çš„æ•°æ® SELECT å­—æ®µåˆ—è¡¨ FROM è¡¨1 RIGHT [OUTER] JOIN è¡¨2 ON æ¡ä»¶ â€¦; å·¦å¤–è¿æ¥ å³è¡¨\u0026amp;äº¤é›† è‡ªè¿æ¥ SELECT å­—æ®µåˆ—è¡¨ FROM è¡¨1 åˆ«å1 JOIN è¡¨1 åˆ«å2 ON æ¡ä»¶ â€¦; å¯å†…è¿æ¥ä¹Ÿå¯å¤–è¿æ¥ è”åˆæŸ¥è¯¢ SELECT å­—æ®µåˆ—è¡¨ FROM è¡¨1 â€¦ UNION [ALL] SELECT å­—æ®µåˆ—è¡¨ FROM è¡¨2 â€¦; æœ‰ALLç»“æœç›´æ¥åˆå¹¶ æ— ALLå»é‡ å­—æ®µåˆ—è¡¨ä¸ç±»å‹ç›¸åŒ å­æŸ¥è¯¢ï¼ˆåµŒå¥—æŸ¥è¯¢ï¼‰ å¤–éƒ¨å¯ä»¥æ˜¯INSERT/UPDATE/DELETE/SELECT æ ¹æ®å­æŸ¥è¯¢ç»“æœçš„ä¸åŒåˆ†ç±»ï¼š åç§° æ„ä¹‰ æ ‡é‡å­æŸ¥è¯¢ ç»“æœä¸ºå•ä¸ªå€¼ åˆ—å­æŸ¥è¯¢ ç»“æœä¸ºä¸€åˆ— è¡Œå­æŸ¥è¯¢ ä¸ºä¸€è¡Œ è¡¨å­æŸ¥è¯¢ å¤šè¡Œå¤šåˆ— å¯åœ¨WHERE/FROM/SELECTä¹‹åè¿›è¡Œ åˆ—å­æŸ¥è¯¢ è¿”å›ä¸€åˆ—ç»“æœ å¸¸ç”¨æ“ä½œç¬¦ï¼š æ“ä½œç¬¦ ç”¨é€” ==IN== é›†åˆèŒƒå›´ä¹‹å†… å¤šé€‰ä¸€ NOT IN ä¸åœ¨é›†åˆèŒƒå›´å†… ANY ä»»æ„ä¸€ä¸ªæ»¡è¶³ SOME åŒANY ALL æ‰€æœ‰å€¼éƒ½æ»¡è¶³ è¡Œå­æŸ¥è¯¢ å¸¸ç”¨æ“ä½œç¬¦ =ã€\u0026lt;\u0026gt;ã€INã€NOT IN å¯ä»¥ç”¨ (1200,1)=(salary,manager) è¡¨ç¤ºä¸€ä¸€å¯¹åº” è¡¨å­æŸ¥è¯¢ å¸¸ç”¨æ“ä½œç¬¦ IN äº‹åŠ¡ æ“ä½œ ç®€ä»‹ï¼šä¸€ç»„æ“ä½œçš„é›†åˆ æ•´ä½“æäº¤ è‡ªåŠ¨å¼€å§‹ SELECT @@AUTOCOMMIT; å¼€å§‹äº‹åŠ¡(è‡ªåŠ¨æäº¤) SELECT @@AUTOCOMMIT=0; â€¦â€¦ COMMIT; æ‰‹åŠ¨æäº¤äº‹åŠ¡ ROLLBACK; äº‹åŠ¡å›æ»š æ‰‹åŠ¨å¼€å§‹ START TRANSACTION; å¼€å¯äº‹åŠ¡ COMMIT; æäº¤äº‹åŠ¡ ROLLBACK; å›æ»šäº‹åŠ¡ ç‰¹æ€§ åŸå­æ€§ ä¸å¯åˆ†å‰²çš„æœ€å°æ“ä½œå•å…ƒ ä¸€è‡´æ€§ äº‹åŠ¡å®Œæˆæ—¶æ‰€æœ‰æ•°æ®ä¿æŒä¸€è‡´çŠ¶æ€ éš”ç¦»æ€§ æ•°æ®åº“çš„éš”ç¦»æœºåˆ¶ï¼Œäº‹åŠ¡è¿›è¡Œä¸å—å¤–éƒ¨å¹¶å‘æ“ä½œå½±å“ æŒä¹…æ€§ æäº¤æˆ–å›æ»šåï¼Œæ•°æ®çš„æ”¹å˜æ˜¯æ°¸ä¹…çš„ ==ACIDæ¨¡å‹== å¹¶å‘äº‹åŠ¡é—®é¢˜ è„è¯» ä¸€ä¸ªäº‹åŠ¡è¯»åˆ°å¦ä¸€ä¸ªäº‹åŠ¡æœªæäº¤çš„æ•°æ® ä¸å¯é‡å¤è¯» å…ˆåè¯»å–åŒä¸€è®°å½•ä½†æ•°æ®ä¸åŒ å¹»è¯» æŒ‰æ¡ä»¶æŸ¥è¯¢æ•°æ®ï¼Œæ— å¯¹åº”æ•°æ®è¡Œï¼Œä½†æ’å…¥æ•°æ®æ—¶å‘ç°è¯¥è¡Œæ•°æ®å·²å­˜åœ¨ äº‹åŠ¡éš”ç¦»çº§åˆ« åˆ†ç±»ï¼š éš”ç¦»çº§åˆ« è„è¯» ä¸å¯é‡å¤è¯» å¹»è¯» READ UNCOMMITTED âœ” âœ” âœ” READ COMMITTED âœ– âœ” âœ” REPEATABLE READ(é»˜è®¤) âœ– âœ– âœ” SERIALIZABLE âœ– âœ– âœ– ORACLEé»˜è®¤READ COMMITTED æ€§èƒ½é€’å‡ å®‰å…¨æ€§é€’å¢ SELECT @@TRANSACTION_ISOLATION; æŸ¥çœ‹äº‹åŠ¡éš”ç¦»çº§åˆ« SET [SESSIONæˆ–GLOBAL] TRANSACTION ISOLATION LEVEL {éš”ç¦»çº§åˆ«}; è®¾å®šéš”ç¦»çº§åˆ« SESSIONä¸ºå½“å‰è¿æ¥ GLOBALä¸ºå…¨å±€ï¼Œä¸åŒ…å«å½“å‰è¿æ¥ ","permalink":"https://Sattiluvcat.github.io/en/posts/java/mysql_base/","summary":"DDLä¸DML","title":"MySqlåŸºç¡€"},{"content":" æˆ‘å«Lulu æ˜¯ä¸€åªçŸ®è„šå°çŒ«ğŸ˜¼\nè¯·æ”¶é›†æŸ æª¬åŠ©åŠ›æˆ‘è¿›åŒ–æˆLululemonï¼ è¯·å…³æ³¨ Lulu ä¸»äººçš„ Youtube å’Œ ins å¥½å—å¥½çš„ OK(*^â–½^*) Thanks for your lemon(s)! æŸ æª¬æ”¶é›†åº¦ï¼š0/8848 æˆ‘ç”Ÿæ´»åœ¨éŸ©å›½\nå’Œ ä¸€ä¸ªäººç±» å°å£°å‘Šè¯‰ä½  å¥¹å« Claire å–”\nè¿˜æœ‰ ååªçŒ«çŒ« ä½åœ¨ä¸€èµ·\nè™½ç„¶æˆ‘å¾ˆå¯çˆ± å¯æ˜¯çŸ®è„šçŒ«æœ‰åŸºå› ç¼ºé™· è¯·è°¨æ…å…»å® !\nè¿™å°±æ˜¯æˆ‘çš„ä¸–ç•Œ å–œæ¬¢æˆ‘çš„è¯å°±å¾€ä¸‹çœ‹çœ‹å§ğŸ¥°\næˆ‘çš„äººå‹æŠ±æ•ğŸ¥° Secret !\nluluä¸æ˜¯ä¸å–œæ¬¢ Claire æ˜¯å¥¹çš„é£Ÿç‰©å’Œç©å…·å¤ªæœ‰å¸å¼•åŠ›äº†\nClaire åœ¨ Youtube\nå’Œ Instagram\nä¸Šå‘å¸ƒæˆ‘ä»¬çš„åŠ¨æ€\nç­”åº”æˆ‘ å¦‚æœå–œæ¬¢æˆ‘ä»¬çš„è¯è¦å»å…³æ³¨å¥¹\nè®¤å‡† Claire _luvcaté¢‘é“ä¸è¿·è·¯ğŸ˜‹ Claire æ˜¯æˆ‘ä»¬çš„ç®¡å®¶ï¼\nè‚¾è¡°çš„TTå§å§ è·Ÿæˆ‘ä¸€æ ·æŠ˜è€³çš„ChuChu\nClaire éƒ½å¸¦æˆ‘ä»¬æ²»ç—…\nå–œæ¬¢å¥¹ğŸ¥°\nèˆ”ç‹—luluğŸ˜— åªæ˜¯å–œæ¬¢çš„çœŸæƒ…æµéœ²\nç›—çªƒå°åˆ†é˜ŸğŸ˜‹\nå–œæ¬¢DD\nMoMoä¼šé•¿ğŸ˜—\nä¸€å£åƒæ‰\nç›—çªƒå°åˆ†é˜Ÿâ…¡\nä¹Ÿå–œæ¬¢CoCo\nå”¯ä¸€çš„Queenâ€”â€”TTå§å§ğŸ¤©\nå‹‡æ•¢lulu ä¸æ€•å›°éš¾ğŸ˜¼ lulu ï¼ˆå’Œå¼Ÿå¼ŸTOTO,DODOï¼‰æ˜¯æœ€ å‹‡çŒ› çš„å°çŒ«ğŸ˜¼\nå› ä¸ºåŸºå›  luluå¯ä»¥ ç«™ èµ·æ¥ luluåœ¨çœ‹ç€ä½ ğŸ¥º\nClaire åœ¨åƒä»€ä¹ˆ å¯ä»¥ç»™luluå°ä¸€å£å—\nluluçˆ±ç¡è§‰ luluä¸€å¤©åˆ°æ™šç¡è§‰\nå±äºæŠ˜è€³çŒ«çš„ç—…ç—› çŸ­ç²—çš„å°¾å·´ ç•¸å½¢çš„è€³æœµ\næ˜¯ æŠ˜è€³ åŸºå› çš„å½±å“ğŸ˜¢\nè½¯éª¨å‘è‚²ä¸å…¨ä¼šå¸¦æ¥ ç—›è‹¦\næ‰€ä»¥è¯·ä¸è¦å…»æŠ˜è€³çŒ«ï¼\nTo Be Continued\n","permalink":"https://Sattiluvcat.github.io/en/lulu/","summary":"lulu","title":"Luluçš„ä¸€åˆ‡"},{"content":" ä¸€ç›´å¾ˆæƒ³åœ¨äº’è”ç½‘ä¸Šæ‹¥æœ‰å±äºè‡ªå·±çš„ç©ºé—´ğŸ˜¸\nè®°å½•ä¸€äº›å…³äºè‡ªå·±å’Œæœ€å–œæ¬¢çš„å°çŒ«â€”â€”Luluï¼çš„æ•…äº‹\nğŸ¥°ğŸ¥°\nå–œæ¬¢ç”µå½±å’Œæ–‡å­— å¦‚æœ‰åŒå¥½è¯·é€šè¿‡åšæ–‡è¯„è®ºåŒºè·Ÿæˆ‘äº¤æµğŸƒğŸ‰\n","permalink":"https://Sattiluvcat.github.io/en/about/","summary":"about","title":"å…³äºæˆ‘"}]